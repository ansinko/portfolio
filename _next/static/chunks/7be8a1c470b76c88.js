(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98641,(e,t,r)=>{e.e,t.exports=function(){var e=[function(e,t,r){"use strict";var n=r(1),i=function(){function e(e,t,r){void 0===e&&(e=NaN),void 0===t&&(t=NaN),void 0===r&&(r=!1),this._minFPS=t,this._maxFPS=e,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new n.default,this._onPause=new n.default,this._onTick=new n.default,this._onTickOncePerFrame=new n.default,r||this.resume()}return e.prototype.updateOnce=function(e){e(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},e.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},e.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},e.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(e.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(e){this._timeScale!==e&&(this._timeScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),e.prototype.animateOnce=function(){var e=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return e.onFrame()})},e.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},e.prototype.update=function(e,t){void 0===t&&(t=!0),this._currentTick++,this._currentTime+=e,this._tickDeltaTime=e,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),t&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},e.prototype.getTimer=function(){return Date.now()},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){e.exports=function(){var e=[function(e,t){"use strict";var r=function(){function e(){this.functions=[]}return e.prototype.add=function(e){return -1===this.functions.indexOf(e)&&(this.functions.push(e),!0)},e.prototype.remove=function(e){var t=this.functions.indexOf(e);return t>-1&&(this.functions.splice(t,1),!0)},e.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},e.prototype.dispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.functions.concat().forEach(function(t){t.apply(void 0,e)})},Object.defineProperty(e.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}];function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}()}];function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}()},24478,(e,t,r)=>{"use strict";r.ConcurrentRoot=1,r.ContinuousEventPriority=8,r.DefaultEventPriority=32,r.DiscreteEventPriority=2,r.IdleEventPriority=0x10000000,r.LegacyRoot=0,r.NoEventPriority=0},39695,(e,t,r)=>{"use strict";t.exports=e.r(24478)},24792,(e,t,r)=>{"use strict";var n=e.r(71645),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=n.useState,s=n.useEffect,o=n.useLayoutEffect,l=n.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!i(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=a({inst:{value:r,getSnapshot:t}}),i=n[0].inst,c=n[1];return o(function(){i.value=r,i.getSnapshot=t,u(i)&&c({inst:i})},[e,r,t]),s(function(){return u(i)&&c({inst:i}),e(function(){u(i)&&c({inst:i})})},[e]),l(r),r};r.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:c},2239,(e,t,r)=>{"use strict";t.exports=e.r(24792)},52822,(e,t,r)=>{"use strict";var n=e.r(71645),i=e.r(2239),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=i.useSyncExternalStore,o=n.useRef,l=n.useEffect,u=n.useMemo,c=n.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var h=o(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;var A=s(e,(h=u(function(){function e(e){if(!l){if(l=!0,s=e,e=n(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return o=t}return o=e}if(t=o,a(s,e))return t;var r=n(e);return void 0!==i&&i(t,r)?(s=e,t):(s=e,o=r)}var s,o,l=!1,u=void 0===r?null:r;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]},[t,r,n,i]))[0],h[1]);return l(function(){d.hasValue=!0,d.value=A},[A]),c(A),A}},30224,(e,t,r)=>{"use strict";t.exports=e.r(52822)},29779,(e,t,r)=>{"use strict";function n(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<s(i,t))e[n]=t,e[r]=i,r=n;else break}}function i(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,a=i>>>1;n<a;){var o=2*(n+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,r))u<i&&0>s(c,l)?(e[n]=c,e[u]=r,n=u):(e[n]=l,e[o]=r,n=o);else if(u<i&&0>s(c,r))e[n]=c,e[u]=r,n=u;else break}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(r.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o,l=performance;r.unstable_now=function(){return l.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var h=[],d=[],A=1,p=null,f=3,m=!1,g=!1,y=!1,v="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var t=i(d);null!==t;){if(null===t.callback)a(d);else if(t.startTime<=e)a(d),t.sortIndex=t.expirationTime,n(h,t);else break;t=i(d)}}function S(e){if(y=!1,b(e),!g)if(null!==i(h))g=!0,I();else{var t=i(d);null!==t&&L(S,t.startTime-e)}}var T=!1,w=-1,M=5,E=-1;function R(){return!(r.unstable_now()-E<M)}function C(){if(T){var e=r.unstable_now();E=e;var t=!0;try{e:{g=!1,y&&(y=!1,x(w),w=-1),m=!0;var n=f;try{t:{for(b(e),p=i(h);null!==p&&!(p.expirationTime>e&&R());){var s=p.callback;if("function"==typeof s){p.callback=null,f=p.priorityLevel;var l=s(p.expirationTime<=e);if(e=r.unstable_now(),"function"==typeof l){p.callback=l,b(e),t=!0;break t}p===i(h)&&a(h),b(e)}else a(h);p=i(h)}if(null!==p)t=!0;else{var u=i(d);null!==u&&L(S,u.startTime-e),t=!1}}break e}finally{p=null,f=n,m=!1}}}finally{t?o():T=!1}}}if("function"==typeof _)o=function(){_(C)};else if("undefined"!=typeof MessageChannel){var N=new MessageChannel,P=N.port2;N.port1.onmessage=C,o=function(){P.postMessage(null)}}else o=function(){v(C,0)};function I(){T||(T=!0,o())}function L(e,t){w=v(function(){e(r.unstable_now())},t)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(e){e.callback=null},r.unstable_continueExecution=function(){g||m||(g=!0,I())},r.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},r.unstable_getCurrentPriorityLevel=function(){return f},r.unstable_getFirstCallbackNode=function(){return i(h)},r.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},r.unstable_scheduleCallback=function(e,t,a){var s=r.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=0x3fffffff;break;case 4:o=1e4;break;default:o=5e3}return o=a+o,e={id:A++,callback:t,priorityLevel:e,startTime:a,expirationTime:o,sortIndex:-1},a>s?(e.sortIndex=a,n(d,e),null===i(h)&&e===i(d)&&(y?(x(w),w=-1):y=!0,L(S,a-s))):(e.sortIndex=o,n(h,e),g||m||(g=!0,I())),e},r.unstable_shouldYield=R,r.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},51849,(e,t,r)=>{"use strict";t.exports=e.r(29779)},40336,(e,t,r)=>{"use strict";var n=e.i(47167);t.exports=function(t){function r(e,t,r,n){return new nN(e,t,r,n)}function i(){}function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=ii&&e[ii]||e["@@iterator"])?e:null}function o(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===ia?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case nJ:return"Fragment";case nZ:return"Portal";case n0:return"Profiler";case n$:return"StrictMode";case n5:return"Suspense";case n6:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case n3:return(e.displayName||"Context")+".Provider";case n2:return(e._context.displayName||"Context")+".Consumer";case n4:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case n7:return null!==(t=e.displayName||null)?t:o(e.type)||"Memo";case n8:t=e._payload,e=e._init;try{return o(e(t))}catch(e){}}return null}function l(e){if(void 0===ie)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);ie=t&&t[1]||"",it=-1<e.stack.indexOf("\n    at")?" (<anonymous>)":-1<e.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+ie+e+it}function u(e,t){if(!e||io)return"";io=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(e){var n=e}Reflect.construct(e,[],r)}else{try{r.call()}catch(e){n=e}e.call(r.prototype)}}else{try{throw Error()}catch(e){n=e}(r=e())&&"function"==typeof r.catch&&r.catch(function(){})}}catch(e){if(e&&n&&"string"==typeof e.stack)return[e.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=n.DetermineComponentFrameRoot(),s=a[0],o=a[1];if(s&&o){var u=s.split("\n"),c=o.split("\n");for(i=n=0;n<u.length&&!u[n].includes("DetermineComponentFrameRoot");)n++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(n===u.length||i===c.length)for(n=u.length-1,i=c.length-1;1<=n&&0<=i&&u[n]!==c[i];)i--;for(;1<=n&&0<=i;n--,i--)if(u[n]!==c[i]){if(1!==n||1!==i)do if(n--,i--,0>i||u[n]!==c[i]){var h="\n"+u[n].replace(" at new "," at ");return e.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",e.displayName)),h}while(1<=n&&0<=i)break}}}finally{io=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?l(r):""}function c(e){try{var t="";do t+=function(e){switch(e.tag){case 26:case 27:case 5:return l(e.type);case 16:return l("Lazy");case 13:return l("Suspense");case 19:return l("SuspenseList");case 0:case 15:return u(e.type,!1);case 11:return u(e.type.render,!1);case 1:return u(e.type,!0);default:return""}}(e),e=e.return;while(e)return t}catch(e){return"\nError generating stack: "+e.message+"\n"+e.stack}}function h(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do 0!=(4098&(t=e).flags)&&(r=t.return),e=t.return;while(e)}return 3===t.tag?r:null}function d(e){if(h(e)!==e)throw Error(a(188))}function A(e){var t=e.alternate;if(!t){if(null===(t=h(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return d(i),e;if(s===n)return d(i),t;s=s.sibling}throw Error(a(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}function p(e){return{current:e}}function f(e){0>a4||(e.current=a3[a4],a3[a4]=null,a4--)}function m(e,t){a3[++a4]=e.current,e.current=t}function g(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 0x1000000:case 0x2000000:return 0x3c00000&e;case 0x4000000:return 0x4000000;case 0x8000000:return 0x8000000;case 0x10000000:return 0x10000000;case 0x20000000:return 0x20000000;case 0x40000000:return 0;default:return e}}function y(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=e.warmLanes;e=0!==e.finishedLanes;var o=0x7ffffff&r;return 0!==o?0!=(r=o&~i)?n=g(r):0!=(a&=o)?n=g(a):e||0!=(s=o&~s)&&(n=g(s)):0!=(o=r&~i)?n=g(o):0!==a?n=g(a):e||0!=(s=r&~s)&&(n=g(s)),0===n?0:0!==t&&t!==n&&0==(t&i)&&((i=n&-n)>=(s=t&-t)||32===i&&0!=(4194176&s))?t:n}function v(e,t){return 0==(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function x(){var e=a9;return 0==(4194176&(a9<<=1))&&(a9=128),e}function _(){var e=se;return 0==(0x3c00000&(se<<=1))&&(se=4194304),e}function b(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function S(e,t){e.pendingLanes|=t,0x10000000!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function T(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-a6(t);e.entangledLanes|=t,e.entanglements[n]=0x40000000|e.entanglements[n]|4194218&r}function w(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-a6(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}function M(e){return 2<(e&=-e)?8<e?0!=(0x7ffffff&e)?32:0x10000000:8:2}function E(e,t){if("object"==typeof e&&null!==e){var r=sA.get(e);return void 0!==r?r:(t={value:e,source:t,stack:c(t)},sA.set(e,t),t)}return{value:e,source:t,stack:c(t)}}function R(e,t){sp[sf++]=sg,sp[sf++]=sm,sm=e,sg=t}function C(e,t,r){sy[sv++]=s_,sy[sv++]=sb,sy[sv++]=sx,sx=e;var n=s_;e=sb;var i=32-a6(n)-1;n&=~(1<<i),r+=1;var a=32-a6(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,s_=1<<32-a6(t)+i|r<<i|n,sb=a+e}else s_=1<<a|r<<i|n,sb=e}function N(e){null!==e.return&&(R(e,1),C(e,1,0))}function P(e){for(;e===sm;)sm=sp[--sf],sp[sf]=null,sg=sp[--sf],sp[sf]=null;for(;e===sx;)sx=sy[--sv],sy[sv]=null,sb=sy[--sv],sy[sv]=null,s_=sy[--sv],sy[sv]=null}function I(e,t){m(sw,t),m(sT,e),m(sS,null),e=iA(t),f(sS),m(sS,e)}function L(){f(sS),f(sT),f(sw)}function D(e){null!==e.memoizedState&&m(sM,e);var t=sS.current,r=ip(t,e.type);t!==r&&(m(sT,e),m(sS,r))}function B(e){sT.current===e&&(f(sS),f(sT)),sM.current===e&&(f(sM),iM?iG._currentValue=iq:iG._currentValue2=iq)}function F(e){throw V(E(Error(a(418,"")),e)),sI}function U(e,t){if(!iC)throw Error(a(175));aM(e.stateNode,e.type,e.memoizedProps,t,e)||F(e)}function O(e){for(sE=e.return;sE;)switch(sE.tag){case 3:case 27:sP=!0;return;case 5:case 13:sP=!1;return;default:sE=sE.return}}function k(e){if(!iC||e!==sE)return!1;if(!sC)return O(e),sC=!0,!1;var t=!1;if(aZ?3!==e.tag&&27!==e.tag&&(5!==e.tag||aD(e.type)&&!i_(e.type,e.memoizedProps))&&(t=!0):3!==e.tag&&(5!==e.tag||aD(e.type)&&!i_(e.type,e.memoizedProps))&&(t=!0),t&&sR&&F(e),O(e),13===e.tag){if(!iC)throw Error(a(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));sR=aC(e)}else sR=sE?av(e.stateNode):null;return!0}function z(){iC&&(sR=sE=null,sC=!1)}function V(e){null===sN?sN=[e]:sN.push(e)}function q(){for(var e=sD,t=sB=sD=0;t<e;){var r=sL[t];sL[t++]=null;var n=sL[t];sL[t++]=null;var i=sL[t];sL[t++]=null;var a=sL[t];if(sL[t++]=null,null!==n&&null!==i){var s=n.pending;null===s?i.next=i:(i.next=s.next,s.next=i),n.pending=i}0!==a&&W(r,i,a)}}function G(e,t,r,n){sL[sD++]=e,sL[sD++]=t,sL[sD++]=r,sL[sD++]=n,sB|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function H(e,t,r,n){return G(e,t,r,n),X(e)}function j(e,t){return G(e,null,null,t),X(e)}function W(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var i=!1,a=e.return;null!==a;)a.childLanes|=r,null!==(n=a.alternate)&&(n.childLanes|=r),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;i&&null!==t&&3===e.tag&&(a=e.stateNode,i=31-a6(r),null===(e=(a=a.hiddenUpdates)[i])?a[i]=[t]:e.push(t),t.lane=0x20000000|r)}function X(e){if(50<lc)throw lc=0,lh=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}function Q(e){var t;e!==sU&&null===e.next&&(null===sU?sF=sU=e:sU=sU.next=e),sk=!0,sO||(sO=!0,t=K,ij?iW(function(){0!=(6&oW)?st(ss,t):t()}):st(ss,t))}function Y(e,t){if(!sz&&sk){sz=!0;do for(var r=!1,n=sF;null!==n;){if(!t)if(0!==e){var i=n.pendingLanes;if(0===i)var a=0;else{var s=n.suspendedLanes,o=n.pingedLanes;a=0xc000055&(a=(1<<31-a6(42|e)+1)-1&(i&~(s&~o)))?0xc000055&a|1:a?2|a:0}0!==a&&(r=!0,$(n,a))}else a=oY,0==(3&(a=y(n,n===oX?a:0)))||v(n,a)||(r=!0,$(n,a));n=n.next}while(r)sz=!1}}function K(){sk=sO=!1;var e=0;0!==sV&&(iB()&&(e=sV),sV=0);for(var t=sa(),r=null,n=sF;null!==n;){var i=n.next,a=Z(n,t);0===a?(n.next=null,null===r?sF=i:r.next=i,null===i&&(sU=r)):(r=n,(0!==e||0!=(3&a))&&(sk=!0)),n=i}Y(e,!1)}function Z(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=-0x3c00001&e.pendingLanes;0<a;){var s=31-a6(a),o=1<<s,l=i[s];-1===l?(0==(o&r)||0!=(o&n))&&(i[s]=function(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}if(t=oX,r=oY,r=y(e,e===t?r:0),n=e.callbackNode,0===r||e===t&&2===oK||null!==e.cancelPendingCommit)return null!==n&&null!==n&&sr(n),e.callbackNode=null,e.callbackPriority=0;if(0==(3&r)||v(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&sr(n),M(r)){case 2:case 8:r=so;break;case 32:default:r=sl;break;case 0x10000000:r=su}return r=st(r,n=J.bind(null,e)),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&sr(n),e.callbackPriority=2,e.callbackNode=null,2}function J(e,t){var r=e.callbackNode;if(nb()&&e.callbackNode!==r)return null;var n=oY;return 0===(n=y(e,e===oX?n:0))?null:(nr(e,n,t),Z(e,sa()),null!=e.callbackNode&&e.callbackNode===r?J.bind(null,e):null)}function $(e,t){if(nb())return null;nr(e,t,!0)}function ee(){return 0===sV&&(sV=x()),sV}function et(){if(0==--sG&&null!==sq){null!==sj&&(sj.status="fulfilled");var e=sq;sq=null,sH=0,sj=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function er(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function en(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ei(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ea(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!=(2&oW)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,t=X(e),W(e,null,r),t}return G(e,n,t,r),X(e)}function es(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194176&r))){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,w(e,r)}}function eo(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===a?i=a=s:a=a.next=s,r=r.next}while(null!==r)null===a?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,callbacks:n.callbacks},e.updateQueue=r;return}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function el(){if(sX){var e=sj;if(null!==e)throw e}}function eu(e,t,r,n){sX=!1;var i=e.updateQueue;sW=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,u=l.next;l.next=null,null===s?a=u:s.next=u,s=l;var c=e.alternate;null!==c&&(o=(c=c.updateQueue).lastBaseUpdate)!==s&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l)}if(null!==a){var h=i.baseState;for(s=0,c=u=l=null,o=a;;){var d=-0x20000001&o.lane,A=d!==o.lane;if(A?(oY&d)===d:(n&d)===d){0!==d&&d===sH&&(sX=!0),null!==c&&(c=c.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,f=o;switch(d=t,f.tag){case 1:if("function"==typeof(p=f.payload)){h=p.call(r,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(d="function"==typeof(p=f.payload)?p.call(r,h,d):p))break e;h=nQ({},h,d);break e;case 2:sW=!0}}null!==(d=o.callback)&&(e.flags|=64,A&&(e.flags|=8192),null===(A=i.callbacks)?i.callbacks=[d]:A.push(d))}else A={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=A,l=h):c=c.next=A,s|=d;if(null===(o=o.next))if(null===(o=i.shared.pending))break;else o=(A=o).next,A.next=null,i.lastBaseUpdate=A,i.shared.pending=null}null===c&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null===a&&(i.shared.lanes=0),o3|=s,e.lanes=s,e.memoizedState=h}}function ec(e,t){if("function"!=typeof e)throw Error(a(191,e));e.call(t)}function eh(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)ec(r[e],t)}function ed(e,t){if(sd(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!sQ.call(t,i)||!sd(e[i],t[i]))return!1}return!0}function eA(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ep(){}function ef(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(ep,ep),t=r),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===sY)throw Error(a(483));throw e;default:if("string"==typeof t.status)t.then(ep,ep);else{if(null!==(e=oX)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===sY)throw Error(a(483));throw e}throw sJ=t,sY}}function em(){if(null===sJ)throw Error(a(459));var e=sJ;return sJ=null,e}function eg(e){var t=s0;return s0+=1,null===s$&&(s$=[]),ef(s$,e,t)}function ey(e,t){e.ref=void 0!==(t=t.props.ref)?t:null}function ev(e,t){if(t.$$typeof===nY)throw Error(a(525));throw Error(a(31,"[object Object]"===(e=Object.prototype.toString.call(t))?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ex(e){return(0,e._init)(e._payload)}function e_(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function n(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,t){return(e=nI(e,t)).index=0,e.sibling=null,e}function l(t,r,n){return(t.index=n,e)?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=0x2000002,r):n:(t.flags|=0x2000002,r):(t.flags|=1048576,r)}function u(t){return e&&null===t.alternate&&(t.flags|=0x2000002),t}function c(e,t,r,n){return null===t||6!==t.tag?(t=nU(r,e.mode,n)).return=e:(t=o(t,r)).return=e,t}function h(e,t,r,n){var i=r.type;return i===nJ?A(e,t,r.props.children,n,r.key):(null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===n8&&ex(i)===t.type)?ey(t=o(t,r.props),r):ey(t=nD(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function d(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?(t=nO(r,e.mode,n)).return=e:(t=o(t,r.children||[])).return=e,t}function A(e,t,r,n,i){return null===t||7!==t.tag?(t=nB(r,e.mode,n,i)).return=e:(t=o(t,r)).return=e,t}function p(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=nU(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case nK:return ey(r=nD(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case nZ:return(t=nO(t,e.mode,r)).return=e,t;case n8:return p(e,t=(0,t._init)(t._payload),r)}if(il(t)||s(t))return(t=nB(t,e.mode,r,null)).return=e,t;if("function"==typeof t.then)return p(e,eg(t),r);if(t.$$typeof===n3)return p(e,rl(e,t),r);ev(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return null!==i?null:c(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case nK:return r.key===i?h(e,t,r,n):null;case nZ:return r.key===i?d(e,t,r,n):null;case n8:return f(e,t,r=(i=r._init)(r._payload),n)}if(il(r)||s(r))return null!==i?null:A(e,t,r,n,null);if("function"==typeof r.then)return f(e,t,eg(r),n);if(r.$$typeof===n3)return f(e,t,rl(e,r),n);ev(e,r)}return null}function m(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return c(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case nK:return h(t,e=e.get(null===n.key?r:n.key)||null,n,i);case nZ:return d(t,e=e.get(null===n.key?r:n.key)||null,n,i);case n8:return m(e,t,r,n=(0,n._init)(n._payload),i)}if(il(n)||s(n))return A(t,e=e.get(r)||null,n,i,null);if("function"==typeof n.then)return m(e,t,r,eg(n),i);if(n.$$typeof===n3)return m(e,t,r,rl(t,n),i);ev(t,n)}return null}return function(c,h,d,A){try{s0=0;var g=function r(c,h,d,A){if("object"==typeof d&&null!==d&&d.type===nJ&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case nK:e:{for(var g=d.key;null!==h;){if(h.key===g){if((g=d.type)===nJ){if(7===h.tag){n(c,h.sibling),(A=o(h,d.props.children)).return=c,c=A;break e}}else if(h.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===n8&&ex(g)===h.type){n(c,h.sibling),ey(A=o(h,d.props),d),A.return=c,c=A;break e}n(c,h);break}t(c,h),h=h.sibling}d.type===nJ?(A=nB(d.props.children,c.mode,A,d.key)).return=c:(ey(A=nD(d.type,d.key,d.props,null,c.mode,A),d),A.return=c),c=A}return u(c);case nZ:e:{for(g=d.key;null!==h;){if(h.key===g)if(4===h.tag&&h.stateNode.containerInfo===d.containerInfo&&h.stateNode.implementation===d.implementation){n(c,h.sibling),(A=o(h,d.children||[])).return=c,c=A;break e}else{n(c,h);break}t(c,h),h=h.sibling}(A=nO(d,c.mode,A)).return=c,c=A}return u(c);case n8:return r(c,h,d=(g=d._init)(d._payload),A)}if(il(d))return function(r,a,s,o){for(var u=null,c=null,h=a,d=a=0,A=null;null!==h&&d<s.length;d++){h.index>d?(A=h,h=null):A=h.sibling;var g=f(r,h,s[d],o);if(null===g){null===h&&(h=A);break}e&&h&&null===g.alternate&&t(r,h),a=l(g,a,d),null===c?u=g:c.sibling=g,c=g,h=A}if(d===s.length)return n(r,h),sC&&R(r,d),u;if(null===h){for(;d<s.length;d++)null!==(h=p(r,s[d],o))&&(a=l(h,a,d),null===c?u=h:c.sibling=h,c=h);return sC&&R(r,d),u}for(h=i(h);d<s.length;d++)null!==(A=m(h,r,d,s[d],o))&&(e&&null!==A.alternate&&h.delete(null===A.key?d:A.key),a=l(A,a,d),null===c?u=A:c.sibling=A,c=A);return e&&h.forEach(function(e){return t(r,e)}),sC&&R(r,d),u}(c,h,d,A);if(s(d)){if("function"!=typeof(g=s(d)))throw Error(a(150));return function(r,s,o,u){if(null==o)throw Error(a(151));for(var c=null,h=null,d=s,A=s=0,g=null,y=o.next();null!==d&&!y.done;A++,y=o.next()){d.index>A?(g=d,d=null):g=d.sibling;var v=f(r,d,y.value,u);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),s=l(v,s,A),null===h?c=v:h.sibling=v,h=v,d=g}if(y.done)return n(r,d),sC&&R(r,A),c;if(null===d){for(;!y.done;A++,y=o.next())null!==(y=p(r,y.value,u))&&(s=l(y,s,A),null===h?c=y:h.sibling=y,h=y);return sC&&R(r,A),c}for(d=i(d);!y.done;A++,y=o.next())null!==(y=m(d,r,A,y.value,u))&&(e&&null!==y.alternate&&d.delete(null===y.key?A:y.key),s=l(y,s,A),null===h?c=y:h.sibling=y,h=y);return e&&d.forEach(function(e){return t(r,e)}),sC&&R(r,A),c}(c,h,d=g.call(d),A)}if("function"==typeof d.then)return r(c,h,eg(d),A);if(d.$$typeof===n3)return r(c,h,rl(c,d),A);ev(c,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==h&&6===h.tag?(n(c,h.sibling),(A=o(h,d)).return=c):(n(c,h),(A=nU(d,c.mode,A)).return=c),u(c=A)):n(c,h)}(c,h,d,A);return s$=null,g}catch(e){if(e===sY)throw e;var y=r(29,e,null,c.mode);return y.lanes=A,y.return=c,y}finally{}}}function eb(e,t){m(s4,e=o1),m(s3,t),o1=e|t.baseLanes}function eS(){m(s4,o1),m(s3,s3.current)}function eT(){o1=s4.current,f(s3),f(s4)}function ew(e){var t=e.alternate;m(s7,1&s7.current),m(s5,e),null===s6&&(null===t||null!==s3.current?s6=e:null!==t.memoizedState&&(s6=e))}function eM(e){if(22===e.tag){if(m(s7,s7.current),m(s5,e),null===s6){var t=e.alternate;null!==t&&null!==t.memoizedState&&(s6=e)}}else eE(e)}function eE(){m(s7,s7.current),m(s5,s5.current)}function eR(e){f(s5),s6===e&&(s6=null),f(s7)}function eC(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||aA(r)||ap(r)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function eN(){throw Error(a(321))}function eP(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sd(e[r],t[r]))return!1;return!0}function eI(e,t,r,n,i,a){return s8=a,s9=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.H=null===e||null===e.memoizedState?oh:od,oi=!1,a=r(n,i),oi=!1,on&&(a=eD(t,r,n,i)),eL(e),a}function eL(e){is.H=oc;var t=null!==oe&&null!==oe.next;if(s8=0,ot=oe=s9=null,or=!1,os=0,oo=null,t)throw Error(a(300));null===e||og||null!==(e=e.dependencies)&&ra(e)&&(og=!0)}function eD(e,t,r,n){s9=e;var i=0;do{if(on&&(oo=null),os=0,on=!1,25<=i)throw Error(a(301));if(i+=1,ot=oe=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}is.H=oA,s=t(r,n)}while(on)return s}function eB(){var e=is.H,t=e.useState()[0];return t="function"==typeof t.then?eV(t):t,e=e.useState()[0],(null!==oe?oe.memoizedState:null)!==e&&(s9.flags|=1024),t}function eF(){var e=0!==oa;return oa=0,e}function eU(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function eO(e){if(or){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}or=!1}s8=0,ot=oe=s9=null,on=!1,os=oa=0,oo=null}function ek(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ot?s9.memoizedState=ot=e:ot=ot.next=e,ot}function ez(){if(null===oe){var e=s9.alternate;e=null!==e?e.memoizedState:null}else e=oe.next;var t=null===ot?s9.memoizedState:ot.next;if(null!==t)ot=t,oe=e;else{if(null===e){if(null===s9.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(oe=e).memoizedState,baseState:oe.baseState,baseQueue:oe.baseQueue,queue:oe.queue,next:null},null===ot?s9.memoizedState=ot=e:ot=ot.next=e}return ot}function eV(e){var t=os;return os+=1,null===oo&&(oo=[]),e=ef(oo,e,t),t=s9,null===(null===ot?t.memoizedState:ot.next)&&(is.H=null===(t=t.alternate)||null===t.memoizedState?oh:od),e}function eq(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return eV(e);if(e.$$typeof===n3)return ro(e)}throw Error(a(438,String(e)))}function eG(e){var t=null,r=s9.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=s9.alternate;null!==n&&null!==(n=n.updateQueue)&&null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===r&&(r=ou(),s9.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=ir;return t.index++,r}function eH(e,t){return"function"==typeof t?t(e):t}function ej(e){return eW(ez(),oe,e)}function eW(e,t,r){var n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=r;var i=e.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}t.baseQueue=i=s,n.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{t=i.next;var l=o=null,u=null,c=t,h=!1;do{var d=-0x20000001&c.lane;if(d!==c.lane?(oY&d)===d:(s8&d)===d){var A=c.revertLane;if(0===A)null!==u&&(u=u.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),d===sH&&(h=!0);else if((s8&A)===A){c=c.next,A===sH&&(h=!0);continue}else d={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(l=u=d,o=s):u=u.next=d,s9.lanes|=A,o3|=A;d=c.action,oi&&r(s,d),s=c.hasEagerState?c.eagerState:r(s,d)}else A={lane:d,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(l=u=A,o=s):u=u.next=A,s9.lanes|=d,o3|=d;c=c.next}while(null!==c&&c!==t)if(null===u?o=s:u.next=l,!sd(s,e.memoizedState)&&(og=!0,h&&null!==(r=sj)))throw r;e.memoizedState=s,e.baseState=o,e.baseQueue=u,n.lastRenderedState=s}return null===i&&(n.lanes=0),[e.memoizedState,n.dispatch]}function eX(e){var t=ez(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i)sd(s,t.memoizedState)||(og=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function eQ(e,t,r){var n=s9,i=ez(),s=sC;if(s){if(void 0===r)throw Error(a(407));r=r()}else r=t();var o=!sd((oe||i).memoizedState,r);if(o&&(i.memoizedState=r,og=!0),i=i.queue,tu(eZ.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==ot&&1&ot.memoizedState.tag){if(n.flags|=2048,ti(9,eK.bind(null,n,i,r,t),{destroy:void 0},null),null===oX)throw Error(a(349));s||0!=(60&s8)||eY(n,t,r)}return r}function eY(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=s9.updateQueue)?(t=ou(),s9.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function eK(e,t,r,n){t.value=r,t.getSnapshot=n,eJ(t)&&e$(e)}function eZ(e,t,r){return r(function(){eJ(t)&&e$(e)})}function eJ(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sd(e,r)}catch(e){return!0}}function e$(e){var t=j(e,2);null!==t&&nt(t,e,2)}function e0(e){var t=ek();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eH,lastRenderedState:e},t}function e1(e,t,r,n){return e.baseState=r,eW(e,oe,"function"==typeof n?n:eH)}function e2(e,t,r,n,i){if(tC(e))throw Error(a(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==is.T?r(!0):s.isTransition=!1,n(s),null===(r=t.pending)?(s.next=t.pending=s,e3(t,s)):(s.next=r.next,t.pending=r.next=s)}}function e3(e,t){var r=t.action,n=t.payload,i=e.state;if(t.isTransition){var a=is.T,s={};is.T=s;try{var o=r(i,n),l=is.S;null!==l&&l(s,o),e4(e,t,o)}catch(r){e6(e,t,r)}finally{is.T=a}}else try{a=r(i,n),e4(e,t,a)}catch(r){e6(e,t,r)}}function e4(e,t,r){null!==r&&"object"==typeof r&&"function"==typeof r.then?r.then(function(r){e5(e,t,r)},function(r){return e6(e,t,r)}):e5(e,t,r)}function e5(e,t,r){t.status="fulfilled",t.value=r,e7(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,e3(e,r)))}function e6(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do t.status="rejected",t.reason=r,e7(t),t=t.next;while(t!==n)}e.action=null}function e7(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function e8(e,t){return t}function e9(e,t){if(sC){var r=oX.formState;if(null!==r){e:{var n=s9;if(sC){if(sR){var i=ag(sR,sP);if(i){sR=av(i),n=ay(i);break e}}F(n)}n=!1}n&&(t=r[0])}}(r=ek()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e8,lastRenderedState:t},r.queue=n,r=tM.bind(null,s9,n),n.dispatch=r,n=e0(!1);var a=tR.bind(null,s9,!1,n.queue);return n=ek(),i={state:t,dispatch:null,action:e,pending:null},n.queue=i,r=e2.bind(null,s9,i,a,r),i.dispatch=r,n.memoizedState=e,[t,r,!1]}function te(e){return tt(ez(),oe,e)}function tt(e,t,r){t=eW(e,t,e8)[0],e=ej(eH)[0],t="object"==typeof t&&null!==t&&"function"==typeof t.then?eV(t):t;var n=ez(),i=n.queue,a=i.dispatch;return r!==n.memoizedState&&(s9.flags|=2048,ti(9,tr.bind(null,i,r),{destroy:void 0},null)),[t,a,e]}function tr(e,t){e.action=t}function tn(e){var t=ez(),r=oe;if(null!==r)return tt(t,r,e);ez(),t=t.memoizedState;var n=(r=ez()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function ti(e,t,r,n){return e={tag:e,create:t,inst:r,deps:n,next:null},null===(t=s9.updateQueue)&&(t=ou(),s9.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function ta(){return ez().memoizedState}function ts(e,t,r,n){var i=ek();s9.flags|=e,i.memoizedState=ti(1|t,r,{destroy:void 0},void 0===n?null:n)}function to(e,t,r,n){var i=ez();n=void 0===n?null:n;var a=i.memoizedState.inst;null!==oe&&null!==n&&eP(n,oe.memoizedState.deps)?i.memoizedState=ti(t,r,a,n):(s9.flags|=e,i.memoizedState=ti(1|t,r,a,n))}function tl(e,t){ts(8390656,8,e,t)}function tu(e,t){to(2048,8,e,t)}function tc(e,t){return to(4,2,e,t)}function th(e,t){return to(4,4,e,t)}function td(e,t){if("function"==typeof t){var r=t(e=e());return function(){"function"==typeof r?r():t(null)}}if(null!=t)return t.current=e=e(),function(){t.current=null}}function tA(e,t,r){r=null!=r?r.concat([e]):null,to(4,4,td.bind(null,t,e),r)}function tp(){}function tf(e,t){var r=ez();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&eP(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function tm(e,t){var r=ez();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&eP(t,n[1])?n[0]:(r.memoizedState=[n=e(),t],n)}function tg(e,t,r){return void 0===r||0!=(0x40000000&s8)?e.memoizedState=t:(e.memoizedState=r,e=ne(),s9.lanes|=e,o3|=e,r)}function ty(e,t,r,n){return sd(r,t)?r:null!==s3.current?(sd(e=tg(e,r,n),t)||(og=!0),e):0==(42&s8)?(og=!0,e.memoizedState=r):(e=ne(),s9.lanes|=e,o3|=e,t)}function tv(e,t,r,n,i){var a=iL();iI(0!==a&&8>a?a:8);var s=is.T,o={};is.T=o,tR(e,!1,t,r);try{var l=i(),u=is.S;if(null!==u&&u(o,l),null!==l&&"object"==typeof l&&"function"==typeof l.then){var c,h,d=(c=[],h={status:"pending",value:null,reason:null,then:function(e){c.push(e)}},l.then(function(){h.status="fulfilled",h.value=n;for(var e=0;e<c.length;e++)(0,c[e])(n)},function(e){for(h.status="rejected",h.reason=e,e=0;e<c.length;e++)(0,c[e])(void 0)}),h);tE(e,t,d,r9(e))}else tE(e,t,n,r9(e))}catch(r){tE(e,t,{then:function(){},status:"rejected",reason:r},r9())}finally{iI(a),is.T=s}}function tx(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:iq,baseState:iq,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eH,lastRenderedState:iq},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eH,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function t_(){return ro(iG)}function tb(){return ez().memoizedState}function tS(){return ez().memoizedState}function tT(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=r9(),n=ea(t,e=ei(r),r);null!==n&&(nt(n,t,r),es(n,t,r)),t={cache:rc()},e.payload=t;return}t=t.return}}function tw(e,t,r){var n=r9();r={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},tC(e)?tN(t,r):null!==(r=H(e,t,r,n))&&(nt(r,e,n),tP(r,t,n))}function tM(e,t,r){tE(e,t,r,r9())}function tE(e,t,r,n){var i={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(tC(e))tN(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,sd(o,s))return G(e,t,i,0),null===oX&&q(),!1}catch(e){}finally{}if(null!==(r=H(e,t,i,n)))return nt(r,e,n),tP(r,t,n),!0}return!1}function tR(e,t,r,n){if(n={lane:2,revertLane:ee(),action:n,hasEagerState:!1,eagerState:null,next:null},tC(e)){if(t)throw Error(a(479))}else null!==(t=H(e,r,n,2))&&nt(t,e,2)}function tC(e){var t=e.alternate;return e===s9||null!==t&&t===s9}function tN(e,t){on=or=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function tP(e,t,r){if(0!=(4194176&r)){var n=t.lanes;n&=e.pendingLanes,t.lanes=r|=n,w(e,r)}}function tI(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:nQ({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}function tL(e,t,r,n,i,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!t.prototype||!t.prototype.isPureReactComponent||!ed(r,n)||!ed(i,a)}function tD(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&op.enqueueReplaceState(t,t.state,null)}function tB(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var i in r===t&&(r=nQ({},r)),e)void 0===r[i]&&(r[i]=e[i]);return r}function tF(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(e){setTimeout(function(){throw e})}}function tU(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(e){setTimeout(function(){throw e})}}function tO(e,t,r){return(r=ei(r)).tag=3,r.payload={element:null},r.callback=function(){tF(e,t)},r}function tk(e){return(e=ei(e)).tag=3,e}function tz(e,t,r,n){var i=r.type.getDerivedStateFromError;if("function"==typeof i){var a=n.value;e.payload=function(){return i(a)},e.callback=function(){tU(t,r,n)}}var s=r.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){tU(t,r,n),"function"!=typeof i&&(null===li?li=new Set([this]):li.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}function tV(e,t,r,n){t.child=null===e?s2(t,null,r,n):s1(t,e.child,r,n)}function tq(e,t,r,n,i){r=r.render;var a=t.ref;if("ref"in n){var s={};for(var o in n)"ref"!==o&&(s[o]=n[o])}else s=n;return(rs(t),n=eI(e,t,r,s,a,i),o=eF(),null===e||og)?(sC&&o&&N(t),t.flags|=1,tV(e,t,n,i),t.child):(eU(e,t,i),t7(e,t,i))}function tG(e,t,r,n,i){if(null===e){var a=r.type;return"function"!=typeof a||nP(a)||void 0!==a.defaultProps||null!==r.compare?((e=nD(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,tH(e,t,a,n,i))}if(a=e.child,!t8(e,i)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:ed)(s,n)&&e.ref===t.ref)return t7(e,t,i)}return t.flags|=1,(e=nI(a,n)).ref=t.ref,e.return=t,t.child=e}function tH(e,t,r,n,i){if(null!==e){var a=e.memoizedProps;if(ed(a,n)&&e.ref===t.ref)if(og=!1,t.pendingProps=n=a,!t8(e,i))return t.lanes=e.lanes,t7(e,t,i);else 0!=(131072&e.flags)&&(og=!0)}return tQ(e,t,r,n,i)}function tj(e,t,r){var n=t.pendingProps,i=n.children,a=0!=(2&t.stateNode._pendingVisibility),s=null!==e?e.memoizedState:null;if(tX(e,t),"hidden"===n.mode||a){if(0!=(128&t.flags)){if(n=null!==s?s.baseLanes|r:r,null!==e){for(a=0,i=t.child=e.child;null!==i;)a=a|i.lanes|i.childLanes,i=i.sibling;t.childLanes=a&~n}else t.childLanes=0,t.child=null;return tW(e,t,n,r)}if(0==(0x20000000&r))return t.lanes=t.childLanes=0x20000000,tW(e,t,null!==s?s.baseLanes|r:r,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&rA(t,null!==s?s.cachePool:null),null!==s?eb(t,s):eS(),eM(t)}else null!==s?(rA(t,s.cachePool),eb(t,s),eE(t),t.memoizedState=null):(null!==e&&rA(t,null),eS(),eE(t));return tV(e,t,i,r),t.child}function tW(e,t,r,n){var i=rd();return t.memoizedState={baseLanes:r,cachePool:i=null===i?null:{parent:iM?ow._currentValue:ow._currentValue2,pool:i}},null!==e&&rA(t,null),eS(),eM(t),null!==e&&ri(e,t,n,!0),null}function tX(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!=typeof r&&"object"!=typeof r)throw Error(a(284));(null===e||e.ref!==r)&&(t.flags|=2097664)}}function tQ(e,t,r,n,i){return(rs(t),r=eI(e,t,r,n,void 0,i),n=eF(),null===e||og)?(sC&&n&&N(t),t.flags|=1,tV(e,t,r,i),t.child):(eU(e,t,i),t7(e,t,i))}function tY(e,t,r,n,i,a){return(rs(t),t.updateQueue=null,r=eD(t,n,r,i),eL(e),n=eF(),null===e||og)?(sC&&n&&N(t),t.flags|=1,tV(e,t,r,a),t.child):(eU(e,t,a),t7(e,t,a))}function tK(e,t,r,n,i){if(rs(t),null===t.stateNode){var a=a5,s=r.contextType;"object"==typeof s&&null!==s&&(a=ro(s)),t.memoizedState=null!==(a=new r(n,a)).state&&void 0!==a.state?a.state:null,a.updater=op,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=n,a.state=t.memoizedState,a.refs={},er(t),s=r.contextType,a.context="object"==typeof s&&null!==s?ro(s):a5,a.state=t.memoizedState,"function"==typeof(s=r.getDerivedStateFromProps)&&(tI(t,r,s,n),a.state=t.memoizedState),"function"==typeof r.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(s=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&op.enqueueReplaceState(a,a.state,null),eu(t,n,a,i),el(),a.state=t.memoizedState),"function"==typeof a.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){a=t.stateNode;var o=t.memoizedProps,l=tB(r,o);a.props=l;var u=a.context,c=r.contextType;s=a5,"object"==typeof c&&null!==c&&(s=ro(c));var h=r.getDerivedStateFromProps;c="function"==typeof h||"function"==typeof a.getSnapshotBeforeUpdate,o=t.pendingProps!==o,c||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(o||u!==s)&&tD(t,a,n,s),sW=!1;var d=t.memoizedState;a.state=d,eu(t,n,a,i),el(),u=t.memoizedState,o||d!==u||sW?("function"==typeof h&&(tI(t,r,h,n),u=t.memoizedState),(l=sW||tL(t,r,l,n,d,u,s))?(c||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),a.props=n,a.state=u,a.context=s,n=l):("function"==typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,en(e,t),c=tB(r,s=t.memoizedProps),a.props=c,h=t.pendingProps,d=a.context,u=r.contextType,l=a5,"object"==typeof u&&null!==u&&(l=ro(u)),(u="function"==typeof(o=r.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==h||d!==l)&&tD(t,a,n,l),sW=!1,d=t.memoizedState,a.state=d,eu(t,n,a,i),el();var A=t.memoizedState;s!==h||d!==A||sW||null!==e&&null!==e.dependencies&&ra(e.dependencies)?("function"==typeof o&&(tI(t,r,o,n),A=t.memoizedState),(c=sW||tL(t,r,c,n,d,A,l)||null!==e&&null!==e.dependencies&&ra(e.dependencies))?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(n,A,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,A,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=A),a.props=n,a.state=A,a.context=l,n=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return a=n,tX(e,t),n=0!=(128&t.flags),a||n?(a=t.stateNode,r=n&&"function"!=typeof r.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&n?(t.child=s1(t,e.child,null,i),t.child=s1(t,null,r,i)):tV(e,t,r,i),t.memoizedState=a.state,e=t.child):e=t7(e,t,i),e}function tZ(e,t,r,n){return z(),t.flags|=256,tV(e,t,r,n),t.child}function tJ(e){return{baseLanes:e,cachePool:rp()}}function t$(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=o6),e}function t0(e,t,n){var i,s=t.pendingProps,o=!1,l=0!=(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!=(2&s7.current)),i&&(o=!0,t.flags&=-129),i=0!=(32&t.flags),t.flags&=-33,null===e){if(sC){if(o?ew(t):eE(t),sC){var u,c=sR;(u=c)&&(null!==(c=aw(c,sP))?(t.memoizedState={dehydrated:c,treeContext:null!==sx?{id:s_,overflow:sb}:null,retryLane:0x20000000},(u=r(18,null,null,0)).stateNode=c,u.return=t,t.child=u,sE=t,sR=null,u=!0):u=!1),u||F(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return ap(c)?t.lanes=16:t.lanes=0x20000000,null;eR(t)}return(c=s.children,s=s.fallback,o)?(eE(t),c=t2({mode:"hidden",children:c},o=t.mode),s=nB(s,o,n,null),c.return=t,s.return=t,c.sibling=s,t.child=c,(o=t.child).memoizedState=tJ(n),o.childLanes=t$(e,i,n),t.memoizedState=oy,s):(ew(t),t1(t,c))}if(null!==(u=e.memoizedState)&&null!==(c=u.dehydrated)){if(l)256&t.flags?(ew(t),t.flags&=-257,t=t3(e,t,n)):null!==t.memoizedState?(eE(t),t.child=e.child,t.flags|=128,t=null):(eE(t),o=s.fallback,c=t.mode,s=t2({mode:"visible",children:s.children},c),o=nB(o,c,n,null),o.flags|=2,s.return=t,o.return=t,s.sibling=o,t.child=s,s1(t,e.child,null,n),(s=t.child).memoizedState=tJ(n),s.childLanes=t$(e,i,n),t.memoizedState=oy,t=o);else if(ew(t),ap(c))i=af(c).digest,(s=Error(a(419))).stack="",s.digest=i,V({value:s,source:null,stack:null}),t=t3(e,t,n);else if(og||ri(e,t,n,!1),i=0!=(n&e.childLanes),og||i){if(null!==(i=oX)){if(0!=(42&(s=n&-n)))s=1;else switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 0x1000000:case 0x2000000:s=64;break;case 0x10000000:s=0x8000000;break;default:s=0}if(0!==(s=0!=(s&(i.suspendedLanes|n))?0:s)&&s!==u.retryLane)throw u.retryLane=s,j(e,s),nt(i,e,s),om}aA(c)||nA(),t=t3(e,t,n)}else aA(c)?(t.flags|=128,t.child=e.child,am(c,t=nR.bind(null,e)),t=null):(e=u.treeContext,iC&&(sR=ab(c),sE=t,sC=!0,sN=null,sP=!1,null!==e&&(sy[sv++]=s_,sy[sv++]=sb,sy[sv++]=sx,s_=e.id,sb=e.overflow,sx=t)),t=t1(t,s.children),t.flags|=4096);return t}return o?(eE(t),o=s.fallback,c=t.mode,l=(u=e.child).sibling,(s=nI(u,{mode:"hidden",children:s.children})).subtreeFlags=0x1e00000&u.subtreeFlags,null!==l?o=nI(l,o):(o=nB(o,c,n,null),o.flags|=2),o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,null===(c=e.child.memoizedState)?c=tJ(n):(null!==(u=c.cachePool)?(l=iM?ow._currentValue:ow._currentValue2,u=u.parent!==l?{parent:l,pool:l}:u):u=rp(),c={baseLanes:c.baseLanes|n,cachePool:u}),o.memoizedState=c,o.childLanes=t$(e,i,n),t.memoizedState=oy,s):(ew(t),e=(n=e.child).sibling,(n=nI(n,{mode:"visible",children:s.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function t1(e,t){return(t=t2({mode:"visible",children:t},e.mode)).return=e,e.child=t}function t2(e,t){return nF(e,t,0,null)}function t3(e,t,r){return s1(t,e.child,null,r),e=t1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function t4(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),rr(e.return,t,r)}function t5(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function t6(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(tV(e,t,n.children,r),0!=(2&(n=s7.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&t4(e,r,t);else if(19===e.tag)t4(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(m(s7,n),i){case"forwards":for(i=null,r=t.child;null!==r;)null!==(e=r.alternate)&&null===eC(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),t5(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eC(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}t5(t,!0,r,null,a);break;case"together":t5(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function t7(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),o3|=t.lanes,0==(r&t.childLanes)){if(null===e)return null;else if(ri(e,t,r,!1),0==(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=nI(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=nI(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function t8(e,t){return 0!=(e.lanes&t)||!!(null!==(e=e.dependencies)&&ra(e))}function t9(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)og=!0;else{if(!t8(e,r)&&0==(128&t.flags))return og=!1,function(e,t,r){switch(t.tag){case 3:I(t,t.stateNode.containerInfo),re(t,ow,e.memoizedState.cache),z();break;case 27:case 5:D(t);break;case 4:I(t,t.stateNode.containerInfo);break;case 10:re(t,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n){if(null!==n.dehydrated)return ew(t),t.flags|=128,null;if(0!=(r&t.child.childLanes))return t0(e,t,r);return ew(t),null!==(e=t7(e,t,r))?e.sibling:null}ew(t);break;case 19:var i=0!=(128&e.flags);if((n=0!=(r&t.childLanes))||(ri(e,t,r,!1),n=0!=(r&t.childLanes)),i){if(n)return t6(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),m(s7,s7.current),!n)return null;break;case 22:case 23:return t.lanes=0,tj(e,t,r);case 24:re(t,ow,e.memoizedState.cache)}return t7(e,t,r)}(e,t,r);og=0!=(131072&e.flags)}else og=!1,sC&&0!=(1048576&t.flags)&&C(t,sg,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,i=n._init;if(n=i(n._payload),t.type=n,"function"==typeof n)nP(n)?(e=tB(n,e),t.tag=1,t=tK(null,t,n,e,r)):(t.tag=0,t=tQ(null,t,n,e,r));else{if(null!=n){if((i=n.$$typeof)===n4){t.tag=11,t=tq(null,t,n,e,r);break e}else if(i===n7){t.tag=14,t=tG(null,t,n,e,r);break e}}throw Error(a(306,t=o(n)||n,""))}}return t;case 0:return tQ(e,t,t.type,t.pendingProps,r);case 1:return i=tB(n=t.type,t.pendingProps),tK(e,t,n,i,r);case 3:e:{if(I(t,t.stateNode.containerInfo),null===e)throw Error(a(387));var s=t.pendingProps;n=(i=t.memoizedState).element,en(e,t),eu(t,s,null,r);var l=t.memoizedState;if(re(t,ow,s=l.cache),s!==i.cache&&rn(t,[ow],r,!0),el(),s=l.element,iC&&i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=tZ(e,t,s,r);break e}else if(s!==n){V(n=E(Error(a(424)),t)),t=tZ(e,t,s,r);break e}else for(iC&&(sR=a_(t.stateNode.containerInfo),sE=t,sC=!0,sN=null,sP=!0),r=s2(t,null,s,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling;else{if(z(),s===n){t=t7(e,t,r);break e}tV(e,t,s,r)}t=t.child}return t;case 26:if(aU)return tX(e,t),null===e?(r=az(t.type,null,t.pendingProps,null))?t.memoizedState=r:sC||(t.stateNode=aW(t.type,t.pendingProps,sw.current,t)):t.memoizedState=az(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:if(aZ)return D(t),null===e&&aZ&&sC&&(n=t.stateNode=aJ(t.type,t.pendingProps,sw.current,sS.current,!1),sE=t,sP=!0,sR=ax(n)),n=t.pendingProps.children,null!==e||sC?tV(e,t,n,r):t.child=s1(t,null,n,r),tX(e,t),t.child;case 5:return null===e&&sC&&(aB(t.type,t.pendingProps,sS.current),(i=n=sR)&&(null!==(n=aS(n,t.type,t.pendingProps,sP))?(t.stateNode=n,sE=t,sR=ax(n),sP=!1,i=!0):i=!1),i||F(t)),D(t),i=t.type,s=t.pendingProps,l=null!==e?e.memoizedProps:null,n=s.children,i_(i,s)?n=null:null!==l&&i_(i,l)&&(t.flags|=32),null!==t.memoizedState&&(i=eI(e,t,eB,null,null,r),iM?iG._currentValue=i:iG._currentValue2=i),tX(e,t),tV(e,t,n,r),t.child;case 6:return null===e&&sC&&(aF(t.pendingProps,sS.current),(e=r=sR)&&(null!==(r=aT(r,t.pendingProps,sP))?(t.stateNode=r,sE=t,sR=null,e=!0):e=!1),e||F(t)),null;case 13:return t0(e,t,r);case 4:return I(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=s1(t,null,n,r):tV(e,t,n,r),t.child;case 11:return tq(e,t,t.type,t.pendingProps,r);case 7:return tV(e,t,t.pendingProps,r),t.child;case 8:case 12:return tV(e,t,t.pendingProps.children,r),t.child;case 10:return n=t.pendingProps,re(t,t.type,n.value),tV(e,t,n.children,r),t.child;case 9:return i=t.type._context,n=t.pendingProps.children,rs(t),n=n(i=ro(i)),t.flags|=1,tV(e,t,n,r),t.child;case 14:return tG(e,t,t.type,t.pendingProps,r);case 15:return tH(e,t,t.type,t.pendingProps,r);case 19:return t6(e,t,r);case 22:return tj(e,t,r);case 24:return rs(t),n=ro(ow),null===e?(null===(i=rd())&&(i=oX,s=rc(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=r),i=s),t.memoizedState={parent:n,cache:i},er(t),re(t,ow,i)):(0!=(e.lanes&r)&&(en(e,t),eu(t,null,null,r),el()),i=e.memoizedState,s=t.memoizedState,i.parent!==n?(i={parent:n,cache:n},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),re(t,ow,n)):(re(t,ow,n=s.cache),n!==i.cache&&rn(t,[ow],r,!0))),tV(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function re(e,t,r){iM?(m(ov,t._currentValue),t._currentValue=r):(m(ov,t._currentValue2),t._currentValue2=r)}function rt(e){var t=ov.current;iM?e._currentValue=t:e._currentValue2=t,f(ov)}function rr(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function rn(e,t,r,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var o=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var u=0;u<t.length;u++)if(l.context===t[u]){s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),rr(s.return,r,e),n||(o=null);break e}s=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(a(341));o.lanes|=r,null!==(s=o.alternate)&&(s.lanes|=r),rr(o,r,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function ri(e,t,r,n){e=null;for(var i=t,s=!1;null!==i;){if(!s){if(0!=(524288&i.flags))s=!0;else if(0!=(262144&i.flags))break}if(10===i.tag){var o=i.alternate;if(null===o)throw Error(a(387));if(null!==(o=o.memoizedProps)){var l=i.type;sd(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===sM.current){if(null===(o=i.alternate))throw Error(a(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(iG):e=[iG])}i=i.return}null!==e&&rn(t,e,r,n),t.flags|=262144}function ra(e){for(e=e.firstContext;null!==e;){var t=e.context;if(!sd(iM?t._currentValue:t._currentValue2,e.memoizedValue))return!0;e=e.next}return!1}function rs(e){ox=e,o_=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ro(e){return ru(ox,e)}function rl(e,t){return null===ox&&rs(e),ru(e,t)}function ru(e,t){var r=iM?t._currentValue:t._currentValue2;if(t={context:t,memoizedValue:r,next:null},null===o_){if(null===e)throw Error(a(308));o_=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else o_=o_.next=t;return r}function rc(){return{controller:new ob,data:new Map,refCount:0}}function rh(e){e.refCount--,0===e.refCount&&oS(oT,function(){e.controller.abort()})}function rd(){var e=oE.current;return null!==e?e:oX.pooledCache}function rA(e,t){null===t?m(oE,oE.current):m(oE,t.pool)}function rp(){var e=rd();return null===e?null:{parent:iM?ow._currentValue:ow._currentValue2,pool:e}}function rf(e){e.flags|=4}function rm(e,t){if(null!==e&&e.child===t.child)return!1;if(0!=(16&t.flags))return!0;for(e=t.child;null!==e;){if(0!=(13878&e.flags)||0!=(13878&e.subtreeFlags))return!0;e=e.sibling}return!1}function rg(e,t,r,n){if(iE)for(r=t.child;null!==r;){if(5===r.tag||6===r.tag)iv(e,r.stateNode);else if(!(4===r.tag||aZ&&27===r.tag)&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else if(iR)for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;r&&n&&(a=ah(a,i.type,i.memoizedProps)),iv(e,a)}else if(6===i.tag)a=i.stateNode,r&&n&&(a=ad(a,i.memoizedProps)),iv(e,a);else if(4!==i.tag){if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),rg(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function ry(e,t){if(iR&&rm(e,t)){var r=(e=t.stateNode).containerInfo,n=ao();!function e(t,r,n,i){if(iR)for(var a=r.child;null!==a;){if(5===a.tag){var s=a.stateNode;n&&i&&(s=ah(s,a.type,a.memoizedProps)),al(t,s)}else if(6===a.tag)s=a.stateNode,n&&i&&(s=ad(s,a.memoizedProps)),al(t,s);else if(4!==a.tag){if(22===a.tag&&null!==a.memoizedState)null!==(s=a.child)&&(s.return=a),e(t,a,null===a.memoizedProps||"manual"!==a.memoizedProps.mode,!0);else if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===r)break;for(;null===a.sibling;){if(null===a.return||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}}(n,t,!1,!1),e.pendingChildren=n,rf(t),au(r,n)}}function rv(e,t,r,n){if(iE)e.memoizedProps!==n&&rf(t);else if(iR){var i=e.stateNode,a=e.memoizedProps;if((e=rm(e,t))||a!==n){var s=sS.current;(a=as(i,r,a,n,!e,null))===i?t.stateNode=i:(ix(a,r,n,s)&&rf(t),t.stateNode=a,e?rg(a,t,!1,!1):rf(t))}else t.stateNode=i}}function rx(e,t,r){if(iU(t,r)){if(e.flags|=0x1000000,!iO(t,r))if(nc())e.flags|=8192;else throw sJ=sZ,sK}else e.flags&=-0x1000001}function r_(e,t){if(aQ(t)){if(e.flags|=0x1000000,!aY(t))if(nc())e.flags|=8192;else throw sJ=sZ,sK}else e.flags&=-0x1000001}function rb(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?_():0x20000000,e.lanes|=t,o7|=t)}function rS(e,t){if(!sC)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function rT(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=0x1e00000&i.subtreeFlags,n|=0x1e00000&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function rw(e,t){switch(P(t),t.tag){case 3:rt(ow),L();break;case 26:case 27:case 5:B(t);break;case 4:L();break;case 13:eR(t);break;case 19:f(s7);break;case 10:rt(t.type);break;case 22:case 23:eR(t),eT(),null!==e&&f(oE);break;case 24:rt(ow)}}function rM(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var i=n.next;r=i;do{if((r.tag&e)===e){n=void 0;var a=r.create;r.inst.destroy=n=a()}r=r.next}while(r!==i)}}catch(e){nT(t,t.return,e)}}function rE(e,t,r){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var a=i.next;n=a;do{if((n.tag&e)===e){var s=n.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,i=t;try{o()}catch(e){nT(i,r,e)}}}n=n.next}while(n!==a)}}catch(e){nT(t,t.return,e)}}function rR(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{eh(t,r)}catch(t){nT(e,e.return,t)}}}function rC(e,t,r){r.props=tB(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(r){nT(e,t,r)}}function rN(e,t){try{var r=e.ref;if(null!==r){var n=e.stateNode;switch(e.tag){case 26:case 27:case 5:var i=id(n);break;default:i=n}"function"==typeof r?e.refCleanup=r(i):r.current=i}}catch(r){nT(e,t,r)}}function rP(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"==typeof n)try{n()}catch(r){nT(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof r)try{r(null)}catch(r){nT(e,t,r)}else r.current=null}function rI(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{i4(n,t,r,e)}catch(t){nT(e,e.return,t)}}function rL(e,t,r){try{i5(e.stateNode,e.type,r,t,e)}catch(t){nT(e,e.return,t)}}function rD(e){return 5===e.tag||3===e.tag||!!aU&&26===e.tag||!!aZ&&27===e.tag||4===e.tag}function rB(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rD(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&(aZ?27!==e.tag:1)&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function rF(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i6(r,e,t):i1(r,e);else if(!(4===n||aZ&&27===n)&&null!==(e=e.child))for(rF(e,t,r),e=e.sibling;null!==e;)rF(e,t,r),e=e.sibling}function rU(e,t,r){e=e.containerInfo;try{ac(e,r)}catch(e){nT(t,t.return,e)}}function rO(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:rW(e,r),4&n&&rM(5,r);break;case 1:if(rW(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(e){nT(r,r.return,e)}else{var i=tB(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(e){nT(r,r.return,e)}}64&n&&rR(r),512&n&&rN(r,r.return);break;case 3:if(rW(e,r),64&n&&null!==(n=r.updateQueue)){if(e=null,null!==r.child)switch(r.child.tag){case 27:case 5:e=id(r.child.stateNode);break;case 1:e=r.child.stateNode}try{eh(n,e)}catch(e){nT(r,r.return,e)}}break;case 26:if(aU){rW(e,r),512&n&&rN(r,r.return);break}case 27:case 5:rW(e,r),null===t&&4&n&&rI(r),512&n&&rN(r,r.return);break;case 12:default:rW(e,r);break;case 13:rW(e,r),4&n&&rV(e,r);break;case 22:if(!(i=null!==r.memoizedState||oR)){t=null!==t&&null!==t.memoizedState||oC;var a=oR,s=oC;oR=i,(oC=t)&&!s?function e(t,r,n){for(n=n&&0!=(8772&r.subtreeFlags),r=r.child;null!==r;){var i=r.alternate,a=t,s=r,o=s.flags;switch(s.tag){case 0:case 11:case 15:e(a,s,n),rM(4,s);break;case 1:if(e(a,s,n),"function"==typeof(a=(i=s).stateNode).componentDidMount)try{a.componentDidMount()}catch(e){nT(i,i.return,e)}if(null!==(a=(i=s).updateQueue)){var l=i.stateNode;try{var u=a.shared.hiddenCallbacks;if(null!==u)for(a.shared.hiddenCallbacks=null,a=0;a<u.length;a++)ec(u[a],l)}catch(e){nT(i,i.return,e)}}n&&64&o&&rR(s),rN(s,s.return);break;case 26:case 27:case 5:e(a,s,n),n&&null===i&&4&o&&rI(s),rN(s,s.return);break;case 12:default:e(a,s,n);break;case 13:e(a,s,n),n&&4&o&&rV(a,s);break;case 22:null===s.memoizedState&&e(a,s,n),rN(s,s.return)}r=r.sibling}}(e,r,0!=(8772&r.subtreeFlags)):rW(e,r),oR=a,oC=s}512&n&&("manual"===r.memoizedProps.mode?rN(r,r.return):rP(r,r.return))}}function rk(e,t,r){for(r=r.child;null!==r;)rz(e,t,r),r=r.sibling}function rz(e,t,r){if(sh&&"function"==typeof sh.onCommitFiberUnmount)try{sh.onCommitFiberUnmount(sc,r)}catch(e){}switch(r.tag){case 26:if(aU){oC||rP(r,t),rk(e,t,r),r.memoizedState?aq(r.memoizedState):r.stateNode&&aj(r.stateNode);break}case 27:if(aZ){oC||rP(r,t);var n=oD,i=oB;oD=r.stateNode,rk(e,t,r),a1(r.stateNode),oD=n,oB=i;break}case 5:oC||rP(r,t);case 6:if(iE){if(n=oD,i=oB,oD=null,rk(e,t,r),oD=n,oB=i,null!==oD)if(oB)try{i9(oD,r.stateNode)}catch(e){nT(r,t,e)}else try{i8(oD,r.stateNode)}catch(e){nT(r,t,e)}}else rk(e,t,r);break;case 18:iE&&null!==oD&&(oB?aL(oD,r.stateNode):aI(oD,r.stateNode));break;case 4:iE?(n=oD,i=oB,oD=r.stateNode.containerInfo,oB=!0,rk(e,t,r),oD=n,oB=i):(iR&&rU(r.stateNode,r,ao()),rk(e,t,r));break;case 0:case 11:case 14:case 15:oC||rE(2,r,t),oC||rE(4,r,t),rk(e,t,r);break;case 1:oC||(rP(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount&&rC(r,t,n)),rk(e,t,r);break;case 21:default:rk(e,t,r);break;case 22:oC||rP(r,t),oC=(n=oC)||null!==r.memoizedState,rk(e,t,r),oC=n}}function rV(e,t){if(iC&&null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{aP(e)}catch(e){nT(t,t.return,e)}}function rq(e,t){var r=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new oP),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new oP),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){var n=nC.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}function rG(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n],s=e,o=t;if(iE){var l=o;e:for(;null!==l;){switch(l.tag){case 27:case 5:oD=l.stateNode,oB=!1;break e;case 3:case 4:oD=l.stateNode.containerInfo,oB=!0;break e}l=l.return}if(null===oD)throw Error(a(160));rz(s,o,i),oD=null,oB=!1}else rz(s,o,i);null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)rH(t,e),t=t.sibling}function rH(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:rG(t,e),rj(e),4&n&&(rE(3,e,e.return),rM(3,e),rE(5,e,e.return));break;case 1:rG(t,e),rj(e),512&n&&(oC||null===r||rP(r,r.return)),64&n&&oR&&null!==(e=e.updateQueue)&&null!==(n=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?n:r.concat(n));break;case 26:if(aU){var i=oF;rG(t,e),rj(e),512&n&&(oC||null===r||rP(r,r.return)),4&n&&(n=null!==r?r.memoizedState:null,t=e.memoizedState,null===r?null===t?null===e.stateNode?e.stateNode=aG(i,e.type,e.memoizedProps,e):aH(i,e.type,e.stateNode):e.stateNode=aV(i,t,e.memoizedProps):n!==t?(null===n?null!==r.stateNode&&aj(r.stateNode):aq(n),null===t?aH(i,e.type,e.stateNode):aV(i,t,e.memoizedProps)):null===t&&null!==e.stateNode&&rL(e,e.memoizedProps,r.memoizedProps));break}case 27:if(aZ&&4&n&&null===e.alternate){i=e.stateNode;var s=e.memoizedProps;try{a$(i),a0(e.type,s,i,e)}catch(t){nT(e,e.return,t)}}case 5:if(rG(t,e),rj(e),512&n&&(oC||null===r||rP(r,r.return)),iE){if(32&e.flags){t=e.stateNode;try{ae(t)}catch(t){nT(e,e.return,t)}}4&n&&null!=e.stateNode&&(t=e.memoizedProps,rL(e,t,null!==r?r.memoizedProps:t)),1024&n&&(oN=!0)}break;case 6:if(rG(t,e),rj(e),4&n&&iE){if(null===e.stateNode)throw Error(a(162));n=e.memoizedProps,r=null!==r?r.memoizedProps:n,t=e.stateNode;try{i3(t,r,n)}catch(t){nT(e,e.return,t)}}break;case 3:if(aU?(aX(),i=oF,oF=ak(t.containerInfo),rG(t,e),oF=i):rG(t,e),rj(e),4&n){if(iE&&iC&&null!==r&&r.memoizedState.isDehydrated)try{aN(t.containerInfo)}catch(t){nT(e,e.return,t)}if(iR){n=t.containerInfo,r=t.pendingChildren;try{ac(n,r)}catch(t){nT(e,e.return,t)}}}oN&&(oN=!1,function e(t){if(1024&t.subtreeFlags)for(t=t.child;null!==t;){var r=t;e(r),5===r.tag&&1024&r.flags&&iH(r.stateNode),t=t.sibling}}(e));break;case 4:aU?(r=oF,oF=ak(e.stateNode.containerInfo),rG(t,e),rj(e),oF=r):(rG(t,e),rj(e)),4&n&&iR&&rU(e.stateNode,e,e.stateNode.pendingChildren);break;case 12:default:rG(t,e),rj(e);break;case 13:rG(t,e),rj(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==r&&null!==r.memoizedState)&&(lt=sa()),4&n&&null!==(n=e.updateQueue)&&(e.updateQueue=null,rq(e,n));break;case 22:512&n&&(oC||null===r||rP(r,r.return)),i=null!==e.memoizedState;var o=null!==r&&null!==r.memoizedState,l=oR,u=oC;if(oR=l||i,oC=u||o,rG(t,e),oC=u,oR=l,rj(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&n&&(t._visibility=i?-2&t._visibility:1|t._visibility,i&&(t=oR||oC,null===r||o||t||function e(t){for(t=t.child;null!==t;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:rE(4,r,r.return),e(r);break;case 1:rP(r,r.return);var n=r.stateNode;"function"==typeof n.componentWillUnmount&&rC(r,r.return,n),e(r);break;case 26:case 27:case 5:rP(r,r.return),e(r);break;case 22:rP(r,r.return),null===r.memoizedState&&e(r);break;default:e(r)}t=t.sibling}}(e)),iE&&(null===e.memoizedProps||"manual"!==e.memoizedProps.mode))){e:if(r=null,iE)for(t=e;;){if(5===t.tag||aU&&26===t.tag||aZ&&27===t.tag){if(null===r){o=r=t;try{s=o.stateNode,i?at(s):an(o.stateNode,o.memoizedProps)}catch(e){nT(o,o.return,e)}}}else if(6===t.tag){if(null===r){o=t;try{var c=o.stateNode;i?ar(c):ai(c,o.memoizedProps)}catch(e){nT(o,o.return,e)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}}4&n&&null!==(n=e.updateQueue)&&null!==(r=n.retryQueue)&&(n.retryQueue=null,rq(e,r));break;case 19:rG(t,e),rj(e),4&n&&null!==(n=e.updateQueue)&&(e.updateQueue=null,rq(e,n));case 21:}}function rj(e){var t=e.flags;if(2&t){try{if(iE&&(!aZ||27!==e.tag)){e:{for(var r=e.return;null!==r;){if(rD(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 27:if(aZ){var i=n.stateNode,s=rB(e);rF(e,s,i);break}case 5:var o=n.stateNode;32&n.flags&&(ae(o),n.flags&=-33);var l=rB(e);rF(e,l,o);break;case 3:case 4:var u=n.stateNode.containerInfo,c=rB(e);!function e(t,r,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,r?i7(n,t,r):i2(n,t);else if(!(4===i||aZ&&27===i)&&null!==(t=t.child))for(e(t,r,n),t=t.sibling;null!==t;)e(t,r,n),t=t.sibling}(e,c,u);break;default:throw Error(a(161))}}}catch(t){nT(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function rW(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)rO(e,t.alternate,t),t=t.sibling}function rX(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&rh(r))}function rQ(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&rh(e))}function rY(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)rK(e,t,r,n),t=t.sibling}function rK(e,t,r,n){var i=t.flags;switch(t.tag){case 0:case 11:case 15:rY(e,t,r,n),2048&i&&rM(9,t);break;case 3:rY(e,t,r,n),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&rh(e)));break;case 12:if(2048&i){rY(e,t,r,n),e=t.stateNode;try{var a=t.memoizedProps,s=a.id,o=a.onPostCommit;"function"==typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(e){nT(t,t.return,e)}}else rY(e,t,r,n);break;case 23:break;case 22:a=t.stateNode,null!==t.memoizedState?4&a._visibility?rY(e,t,r,n):rZ(e,t):4&a._visibility?rY(e,t,r,n):(a._visibility|=4,function e(t,r,n,i,a){for(a=a&&0!=(10256&r.subtreeFlags),r=r.child;null!==r;){var s=r,o=s.flags;switch(s.tag){case 0:case 11:case 15:e(t,s,n,i,a),rM(8,s);break;case 23:break;case 22:var l=s.stateNode;null!==s.memoizedState?4&l._visibility?e(t,s,n,i,a):rZ(t,s):(l._visibility|=4,e(t,s,n,i,a)),a&&2048&o&&rX(s.alternate,s);break;case 24:e(t,s,n,i,a),a&&2048&o&&rQ(s.alternate,s);break;default:e(t,s,n,i,a)}r=r.sibling}}(e,t,r,n,0!=(10256&t.subtreeFlags))),2048&i&&rX(t.alternate,t);break;case 24:rY(e,t,r,n),2048&i&&rQ(t.alternate,t);break;default:rY(e,t,r,n)}}function rZ(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=t,n=r.flags;switch(r.tag){case 22:rZ(e,r),2048&n&&rX(r.alternate,r);break;case 24:rZ(e,r),2048&n&&rQ(r.alternate,r);break;default:rZ(e,r)}t=t.sibling}}function rJ(e){if(e.subtreeFlags&oU)for(e=e.child;null!==e;)r$(e),e=e.sibling}function r$(e){switch(e.tag){case 26:rJ(e),e.flags&oU&&(null!==e.memoizedState?aK(oF,e.memoizedState,e.memoizedProps):iz(e.type,e.memoizedProps));break;case 5:rJ(e),e.flags&oU&&iz(e.type,e.memoizedProps);break;case 3:case 4:if(aU){var t=oF;oF=ak(e.stateNode.containerInfo),rJ(e),oF=t}else rJ(e);break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=oU,oU=0x1000000,rJ(e),oU=t):rJ(e));break;default:rJ(e)}}function r0(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(null!==e)}}function r1(e){var t=e.deletions;if(0!=(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];oI=n,r3(n,e)}r0(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)r2(e),e=e.sibling}function r2(e){switch(e.tag){case 0:case 11:case 15:r1(e),2048&e.flags&&rE(9,e,e.return);break;case 3:case 12:default:r1(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,function e(t){var r=t.deletions;if(0!=(16&t.flags)){if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];oI=i,r3(i,t)}r0(t)}for(t=t.child;null!==t;){switch((r=t).tag){case 0:case 11:case 15:rE(8,r,r.return),e(r);break;case 22:4&(n=r.stateNode)._visibility&&(n._visibility&=-5,e(r));break;default:e(r)}t=t.sibling}}(e)):r1(e)}}function r3(e,t){for(;null!==oI;){var r=oI;switch(r.tag){case 0:case 11:case 15:rE(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:rh(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,oI=n;else for(r=e;null!==oI;){var i=(n=oI).sibling,a=n.return;if(!function e(t){var r=t.alternate;null!==r&&(t.alternate=null,e(r)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(r=t.stateNode)&&iF(r),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}(n),n===r){oI=null;break}if(null!==i){i.return=a,oI=i;break}oI=a}}}function r4(e){var t=iN(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(a(364));return t}if(null===(e=iQ(e)))throw Error(a(362));return e.stateNode.current}function r5(e,t){var r=e.tag;switch(t.$$typeof){case ok:if(e.type===t.value)return!0;break;case oz:e:{for(r=0,t=t.value,e=[e,0];r<e.length;){var n=e[r++],i=n.tag,s=e[r++],o=t[s];if(5!==i&&26!==i&&27!==i||!iZ(n)){for(;null!=o&&r5(n,o);)o=t[++s];if(s===t.length){t=!0;break e}for(n=n.child;null!==n;)e.push(n,s),n=n.sibling}}t=!1}return t;case oV:if((5===r||26===r||27===r)&&iJ(e.stateNode,t.value))return!0;break;case oG:if((5===r||6===r||26===r||27===r)&&null!==(e=iK(e))&&0<=e.indexOf(t.value))return!0;break;case oq:if((5===r||26===r||27===r)&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error(a(365))}return!1}function r6(e){switch(e.$$typeof){case ok:return"<"+(o(e.value)||"Unknown")+">";case oz:return":has("+(r6(e)||"")+")";case oV:return'[role="'+e.value+'"]';case oG:return'"'+e.value+'"';case oq:return'[data-testname="'+e.value+'"]';default:throw Error(a(365))}}function r7(e,t){var r=[];e=[e,0];for(var n=0;n<e.length;){var i=e[n++],a=i.tag,s=e[n++],o=t[s];if(5!==a&&26!==a&&27!==a||!iZ(i)){for(;null!=o&&r5(i,o);)o=t[++s];if(s===t.length)r.push(i);else for(i=i.child;null!==i;)e.push(i,s),i=i.sibling}}return r}function r8(e,t){if(!iX)throw Error(a(363));e=r7(e=r4(e),t),t=[],e=Array.from(e);for(var r=0;r<e.length;){var n=e[r++],i=n.tag;if(5===i||26===i||27===i)iZ(n)||t.push(n.stateNode);else for(n=n.child;null!==n;)e.push(n),n=n.sibling}return t}function r9(){if(0!=(2&oW)&&0!==oY)return oY&-oY;if(null!==is.T){var e=sH;return 0!==e?e:ee()}return iD()}function ne(){0===o6&&(o6=0==(0x20000000&oY)||sC?x():0x20000000);var e=s5.current;return null!==e&&(e.flags|=32),o6}function nt(e,t,r){(e===oX&&2===oK||null!==e.cancelPendingCommit)&&(nl(e,0),na(e,oY,o6,!1)),S(e,r),(0==(2&oW)||e!==oX)&&(e===oX&&(0==(2&oW)&&(o4|=r),4===o2&&na(e,oY,o6,!1)),Q(e))}function nr(e,t,r){if(0!=(6&oW))throw Error(a(327));for(var n=!r&&0==(60&t)&&0==(t&e.expiredLanes)||v(e,t),i=n?function(e,t){var r=oW;oW|=2;var n=nh(),i=nd();oX!==e||oY!==t?(ln=null,lr=sa()+500,nl(e,t)):o$=v(e,t);e:for(;;)try{if(0!==oK&&null!==oQ){t=oQ;var s=oZ;t:switch(oK){case 1:oK=0,oZ=null,ng(e,t,s,1);break;case 2:if(eA(s)){oK=0,oZ=null,nm(t);break}t=function(){2===oK&&oX===e&&(oK=7),Q(e)},s.then(t,t);break e;case 3:oK=7;break e;case 4:oK=5;break e;case 7:eA(s)?(oK=0,oZ=null,nm(t)):(oK=0,oZ=null,ng(e,t,s,7));break;case 5:var o=null;switch(oQ.tag){case 26:o=oQ.memoizedState;case 5:case 27:var l=oQ,u=l.type,c=l.pendingProps;if(o?aY(o):iO(u,c)){oK=0,oZ=null;var h=l.sibling;if(null!==h)oQ=h;else{var d=l.return;null!==d?(oQ=d,ny(d)):oQ=null}break t}}oK=0,oZ=null,ng(e,t,s,5);break;case 6:oK=0,oZ=null,ng(e,t,s,6);break;case 8:no(),o2=6;break e;default:throw Error(a(462))}}for(;null!==oQ&&!sn();)nf(oQ);break}catch(t){nu(e,t)}return(o_=ox=null,is.H=n,is.A=i,oW=r,null!==oQ)?0:(oX=null,oY=0,q(),o2)}(e,t):np(e,t,!0),s=n;;){if(0===i)o$&&!n&&na(e,t,0,!1);else if(6===i)na(e,t,0,!oJ);else{if(r=e.current.alternate,s&&!function(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&null!==(r=t.updateQueue)&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!sd(a(),i))return!1}catch(e){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)){i=np(e,t,!1),s=!1;continue}if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!=(o=-0x20000001&e.pendingLanes)?o:0x20000000&o?0x20000000:0;if(0!==o){t=o;e:{i=o8;var l=iC&&e.current.memoizedState.isDehydrated;if(l&&(nl(e,o).flags|=256),2!==(o=np(e,o,!1))){if(o0&&!l){e.errorRecoveryDisabledLanes|=s,o4|=s,i=4;break e}s=o9,o9=i,null!==s&&nn(s)}i=o}if(s=!1,2!==i)continue}}if(1===i){nl(e,0),na(e,t,0,!0);break}e:{switch(n=e,i){case 0:case 1:throw Error(a(345));case 4:if((4194176&t)===t){na(n,t,o6,!oJ);break e}break;case 2:o9=null;break;case 3:case 5:break;default:throw Error(a(329))}if(n.finishedWork=r,n.finishedLanes=t,(0x3c00000&t)===t&&10<(s=lt+300-sa())){if(na(n,t,o6,!oJ),0!==y(n,0))break e;n.timeoutHandle=iS(ni.bind(null,n,r,o9,ln,le,t,o6,o4,o7,oJ,2,-0,0),s);break e}ni(n,r,o9,ln,le,t,o6,o4,o7,oJ,0,-0,0)}}break}Q(e)}function nn(e){null===o9?o9=e:o9.push.apply(o9,e)}function ni(e,t,r,n,i,a,s,o,l,u,c,h,d){var A=t.subtreeFlags;if((8192&A||0x1002000==(0x1002000&A))&&(ik(),r$(t),null!==(t=iV()))){e.cancelPendingCommit=t(nx.bind(null,e,r,n,i,s,o,l,1,h,d)),na(e,a,s,!u);return}nx(e,r,n,i,s,o,l,c,h,d)}function na(e,t,r,n){t&=~o5,t&=~o4,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var i=t;0<i;){var a=31-a6(i),s=1<<a;n[a]=-1,i&=~s}0!==r&&T(e,r,t)}function ns(){return 0!=(6&oW)||(Y(0,!1),!1)}function no(){if(null!==oQ){if(0===oK)var e=oQ.return;else e=oQ,o_=ox=null,eO(e),s$=null,s0=0,e=oQ;for(;null!==e;)rw(e.alternate,e),e=e.return;oQ=null}}function nl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;r!==iw&&(e.timeoutHandle=iw,iT(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),no(),oX=e,oQ=r=nI(e.current,null),oY=t,oK=0,oZ=null,oJ=!1,o$=v(e,t),o0=!1,o7=o6=o5=o4=o3=o2=0,o9=o8=null,le=!1,0!=(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var i=31-a6(n),a=1<<i;t|=e[i],n&=~a}return o1=t,q(),r}function nu(e,t){s9=null,is.H=oc,t===sY?(t=em(),oK=3):t===sK?(t=em(),oK=4):oK=t===om?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,oZ=t,null===oQ&&(o2=1,tF(e,E(t,e.current)))}function nc(){var e=s5.current;return null===e||((4194176&oY)===oY?null===s6:((0x3c00000&oY)===oY||0!=(0x20000000&oY))&&e===s6)}function nh(){var e=is.H;return is.H=oc,null===e?oc:e}function nd(){var e=is.A;return is.A=oO,e}function nA(){o2=4,oJ||(4194176&oY)!==oY&&null!==s5.current||(o$=!0),0==(0x7ffffff&o3)&&0==(0x7ffffff&o4)||null===oX||na(oX,oY,o6,!1)}function np(e,t,r){var n=oW;oW|=2;var i=nh(),a=nd();(oX!==e||oY!==t)&&(ln=null,nl(e,t)),t=!1;var s=o2;e:for(;;)try{if(0!==oK&&null!==oQ){var o=oQ,l=oZ;switch(oK){case 8:no(),s=6;break e;case 3:case 2:case 6:null===s5.current&&(t=!0);var u=oK;if(oK=0,oZ=null,ng(e,o,l,u),r&&o$){s=0;break e}break;default:u=oK,oK=0,oZ=null,ng(e,o,l,u)}}(function(){for(;null!==oQ;)nf(oQ)})(),s=o2;break}catch(t){nu(e,t)}return t&&e.shellSuspendCounter++,o_=ox=null,oW=n,is.H=i,is.A=a,null===oQ&&(oX=null,oY=0,q()),s}function nf(e){var t=t9(e.alternate,e,o1);e.memoizedProps=e.pendingProps,null===t?ny(e):oQ=t}function nm(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=tY(r,t,t.pendingProps,t.type,void 0,oY);break;case 11:t=tY(r,t,t.pendingProps,t.type.render,t.ref,oY);break;case 5:eO(t);default:rw(r,t),t=t9(r,t=oQ=nL(t,o1),o1)}e.memoizedProps=e.pendingProps,null===t?ny(e):oQ=t}function ng(e,t,r,n){o_=ox=null,eO(t),s$=null,s0=0;var i=t.return;try{if(function(e,t,r,n,i){if(r.flags|=32768,null!==n&&"object"==typeof n&&"function"==typeof n.then){if(null!==(t=r.alternate)&&ri(t,r,i,!0),null!==(r=s5.current)){switch(r.tag){case 13:return null===s6?nA():null===r.alternate&&0===o2&&(o2=3),r.flags&=-257,r.flags|=65536,r.lanes=i,n===sZ?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([n]):t.add(n),nw(e,n,i)),!1;case 22:return r.flags|=65536,n===sZ?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([n]):r.add(n),nw(e,n,i)),!1}throw Error(a(435,r.tag))}return nw(e,n,i),nA(),!1}if(sC)return null!==(t=s5.current)?(0==(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,n!==sI&&V(E(e=Error(a(422),{cause:n}),r))):(n!==sI&&V(E(t=Error(a(423),{cause:n}),r)),e=e.current.alternate,e.flags|=65536,i&=-i,e.lanes|=i,n=E(n,r),i=tO(e.stateNode,n,i),eo(e,i),4!==o2&&(o2=2)),!1;var s=Error(a(520),{cause:n});if(s=E(s,r),null===o8?o8=[s]:o8.push(s),4!==o2&&(o2=2),null===t)return!0;n=E(n,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=i&-i,r.lanes|=e,e=tO(r.stateNode,n,e),eo(r,e),!1;case 1:if(t=r.type,s=r.stateNode,0==(128&r.flags)&&("function"==typeof t.getDerivedStateFromError||null!==s&&"function"==typeof s.componentDidCatch&&(null===li||!li.has(s))))return r.flags|=65536,i&=-i,r.lanes|=i,tz(i=tk(i),e,r,n),eo(r,i),!1}r=r.return}while(null!==r)return!1}(e,i,t,r,oY)){o2=1,tF(e,E(r,e.current)),oQ=null;return}}catch(t){if(null!==i)throw oQ=i,t;o2=1,tF(e,E(r,e.current)),oQ=null;return}32768&t.flags?(sC||1===n?e=!0:o$||0!=(0x20000000&oY)?e=!1:(oJ=e=!0,(2===n||3===n||6===n)&&null!==(n=s5.current)&&13===n.tag&&(n.flags|=16384)),nv(t,e)):ny(t)}function ny(e){var t=e;do{if(0!=(32768&t.flags))return void nv(t,oJ);e=t.return;var r=function(e,t,r){var n=t.pendingProps;switch(P(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return rT(t),null;case 3:return r=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),rt(ow),L(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(null===e||null===e.child)&&(k(t)?rf(t):null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==sN&&(nn(sN),sN=null))),ry(e,t),rT(t),null;case 26:if(aU){r=t.type;var i=t.memoizedState;return null===e?(rf(t),null!==i?(rT(t),r_(t,i)):(rT(t),rx(t,r,n))):i?i!==e.memoizedState?(rf(t),rT(t),r_(t,i)):(rT(t),t.flags&=-0x1000001):(iE?e.memoizedProps!==n&&rf(t):rv(e,t,r,n),rT(t),rx(t,r,n)),null}case 27:if(aZ){if(B(t),r=sw.current,i=t.type,null!==e&&null!=t.stateNode)iE?e.memoizedProps!==n&&rf(t):rv(e,t,i,n);else{if(!n){if(null===t.stateNode)throw Error(a(166));return rT(t),null}e=sS.current,k(t)?U(t,e):(e=aJ(i,n,r,e,!0),t.stateNode=e,rf(t))}return rT(t),null}case 5:if(B(t),r=t.type,null!==e&&null!=t.stateNode)rv(e,t,r,n);else{if(!n){if(null===t.stateNode)throw Error(a(166));return rT(t),null}e=sS.current,k(t)?U(t,e):(rg(i=iy(r,n,sw.current,e,t),t,!1,!1),t.stateNode=i,ix(i,r,n,e)&&rf(t))}return rT(t),rx(t,t.type,t.pendingProps),null;case 6:if(e&&null!=t.stateNode)r=e.memoizedProps,iE?r!==n&&rf(t):iR&&(r!==n?(t.stateNode=ib(n,sw.current,sS.current,t),rf(t)):t.stateNode=e.stateNode);else{if("string"!=typeof n&&null===t.stateNode)throw Error(a(166));if(e=sw.current,r=sS.current,k(t)){if(!iC)throw Error(a(176));if(e=t.stateNode,r=t.memoizedProps,n=null,null!==(i=sE))switch(i.tag){case 27:case 5:n=i.memoizedProps}aE(e,r,t,n)||F(t)}else t.stateNode=ib(n,e,r,t)}return rT(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=k(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!iC)throw Error(a(344));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));aR(i,t)}else z(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;rT(t),i=!1}else null!==sN&&(nn(sN),sN=null),i=!0;if(!i){if(256&t.flags)return eR(t),t;return eR(t),null}}if(eR(t),0!=(128&t.flags))return t.lanes=r,t;if(r=null!==n,e=null!==e&&null!==e.memoizedState,r){n=t.child,i=null,null!==n.alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(i=n.alternate.memoizedState.cachePool.pool);var s=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==i&&(n.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),rb(t,t.updateQueue),rT(t),null;case 4:return L(),ry(e,t),null===e&&iP(t.stateNode.containerInfo),rT(t),null;case 10:return rt(t.type),rT(t),null;case 19:if(f(s7),null===(i=t.memoizedState))return rT(t),null;if(n=0!=(128&t.flags),null===(s=i.rendering))if(n)rS(i,!1);else{if(0!==o2||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=eC(e))){for(t.flags|=128,rS(i,!1),e=s.updateQueue,t.updateQueue=e,rb(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)nL(r,e),r=r.sibling;return m(s7,1&s7.current|2),t.child}e=e.sibling}null!==i.tail&&sa()>lr&&(t.flags|=128,n=!0,rS(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=eC(s))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,rb(t,e),rS(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!sC)return rT(t),null}else 2*sa()-i.renderingStartTime>lr&&0x20000000!==r&&(t.flags|=128,n=!0,rS(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}if(null!==i.tail)return t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=sa(),t.sibling=null,e=s7.current,m(s7,n?1&e|2:1&e),t;return rT(t),null;case 22:case 23:return eR(t),eT(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!=(0x20000000&r)&&0==(128&t.flags)&&(rT(t),6&t.subtreeFlags&&(t.flags|=8192)):rT(t),null!==(r=t.updateQueue)&&rb(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==r&&(t.flags|=2048),null!==e&&f(oE),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),rt(ow),rT(t),null;case 25:return null}throw Error(a(156,t.tag))}(t.alternate,t,o1);if(null!==r){oQ=r;return}if(null!==(t=t.sibling)){oQ=t;return}oQ=t=e}while(null!==t)0===o2&&(o2=5)}function nv(e,t){do{var r=function(e,t){switch(P(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return rt(ow),L(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return B(t),null;case 13:if(eR(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));z()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return f(s7),null;case 4:return L(),null;case 10:return rt(t.type),null;case 22:case 23:return eR(t),eT(),null!==e&&f(oE),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return rt(ow),null;default:return null}}(e.alternate,e);if(null!==r){r.flags&=32767,oQ=r;return}if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling)){oQ=e;return}oQ=e=r}while(null!==e)o2=6,oQ=null}function nx(e,t,r,n,i,s,o,l,u,c){var h=is.T,d=iL();try{iI(2),is.T=null,function(e,t,r,n,i,s,o,l){do nb();while(null!==ls)if(0!=(6&oW))throw Error(a(327));var u,c,h=e.finishedWork;if(n=e.finishedLanes,null!==h){if(e.finishedWork=null,e.finishedLanes=0,h===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var d=h.lanes|h.childLanes;!function(e,t,r,n,i,a){var s=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,u=e.hiddenUpdates;for(r=s&~r;0<r;){var c=31-a6(r),h=1<<c;o[c]=0,l[c]=-1;var d=u[c];if(null!==d)for(u[c]=null,c=0;c<d.length;c++){var A=d[c];null!==A&&(A.lane&=-0x20000001)}r&=~h}0!==n&&T(e,n,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(s&~t))}(e,n,d|=sB,s,o,l),e===oX&&(oQ=oX=null,oY=0),0==(10256&h.subtreeFlags)&&0==(10256&h.flags)||la||(la=!0,ll=d,lu=r,u=sl,c=function(){return nb(!0),null},st(u,c)),r=0!=(15990&h.flags),0!=(15990&h.subtreeFlags)||r?(r=is.T,is.T=null,s=iL(),iI(2),o=oW,oW|=4,function(e,t){for(im(e.containerInfo),oI=t;null!==oI;)if(t=(e=oI).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,oI=t;else for(;null!==oI;){var r=(e=oI).alternate;switch(t=e.flags,e.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!=(1024&t)&&null!==r){t=void 0;var n=e,i=r.memoizedProps;r=r.memoizedState;var s=n.stateNode;try{var o=tB(n.type,i,n.elementType===n.type);t=s.getSnapshotBeforeUpdate(o,r),s.__reactInternalSnapshotBeforeUpdate=t}catch(e){nT(n,n.return,e)}}break;case 3:0!=(1024&t)&&iE&&aa(e.stateNode.containerInfo);break;default:if(0!=(1024&t))throw Error(a(163))}if(null!==(t=e.sibling)){t.return=e.return,oI=t;break}oI=e.return}o=oL,oL=!1}(e,h),rH(h,e),ig(e.containerInfo),e.current=h,rO(e,h.alternate,h),si(),oW=o,iI(s),is.T=r):e.current=h,la?(la=!1,ls=e,lo=n):n_(e,d),0===(d=e.pendingLanes)&&(li=null);var A=h.stateNode;if(sh&&"function"==typeof sh.onCommitFiberRoot)try{sh.onCommitFiberRoot(sc,A,void 0,128==(128&A.current.flags))}catch(e){}if(Q(e),null!==t)for(i=e.onRecoverableError,h=0;h<t.length;h++)i((d=t[h]).value,{componentStack:d.stack});0!=(3&lo)&&nb(),d=e.pendingLanes,0!=(4194218&n)&&0!=(42&d)?e===lh?lc++:(lc=0,lh=e):lc=0,Y(0,!1)}}(e,t,r,n,d,i,s,o,l,u,c)}finally{is.T=h,iI(d)}}function n_(e,t){0==(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,rh(t))}function nb(){if(null!==ls){var e=ls,t=ll;ll=0;var r=M(lo),n=32>r?32:r;r=is.T;var i=iL();try{if(iI(n),is.T=null,null===ls)var s=!1;else{n=lu,lu=null;var o=ls,l=lo;if(ls=null,lo=0,0!=(6&oW))throw Error(a(331));var u=oW;if(oW|=4,r2(o.current),rK(o,o.current,l,n),oW=u,Y(0,!1),sh&&"function"==typeof sh.onPostCommitFiberRoot)try{sh.onPostCommitFiberRoot(sc,o)}catch(e){}s=!0}return s}finally{iI(i),is.T=r,n_(e,t)}}return!1}function nS(e,t,r){t=E(r,t),t=tO(e.stateNode,t,2),null!==(e=ea(e,t,2))&&(S(e,2),Q(e))}function nT(e,t,r){if(3===e.tag)nS(e,e,r);else for(;null!==t;){if(3===t.tag){nS(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===li||!li.has(n))){e=E(r,e),null!==(n=ea(t,r=tk(2),2))&&(tz(r,n,t,e),S(n,2),Q(n));break}}t=t.return}}function nw(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new oj;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(o0=!0,i.add(r),e=nM.bind(null,e,t,r),t.then(e,e))}function nM(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,oX===e&&(oY&r)===r&&(4===o2||3===o2&&(0x3c00000&oY)===oY&&300>sa()-lt?0==(2&oW)&&nl(e,0):o5|=r,o7===oY&&(o7=0)),Q(e)}function nE(e,t){0===t&&(t=_()),null!==(e=j(e,t))&&(S(e,t),Q(e))}function nR(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),nE(e,r)}function nC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==n&&n.delete(t),nE(e,r)}function nN(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nP(e){return!(!(e=e.prototype)||!e.isReactComponent)}function nI(e,t){var n=e.alternate;return null===n?((n=r(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=0x1e00000&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function nL(e,t){e.flags&=0x1e00002;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,e.dependencies=null===(t=r.dependencies)?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function nD(e,t,n,i,s,o){var l=0;if(i=e,"function"==typeof e)nP(e)&&(l=1);else if("string"==typeof e)l=aU&&aZ?aO(e,n,sS.current)?26:a2(e)?27:5:aU?aO(e,n,sS.current)?26:5:aZ&&a2(e)?27:5;else e:switch(e){case nJ:return nB(n.children,s,o,t);case n$:l=8,s|=24;break;case n0:return(e=r(12,n,t,2|s)).elementType=n0,e.lanes=o,e;case n5:return(e=r(13,n,t,s)).elementType=n5,e.lanes=o,e;case n6:return(e=r(19,n,t,s)).elementType=n6,e.lanes=o,e;case n9:return nF(n,s,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case n1:case n3:l=10;break e;case n2:l=9;break e;case n4:l=11;break e;case n7:l=14;break e;case n8:l=16,i=null;break e}l=29,n=Error(a(130,null===e?"null":typeof e,"")),i=null}return(t=r(l,n,t,s)).elementType=e,t.type=i,t.lanes=o,t}function nB(e,t,n,i){return(e=r(7,e,i,t)).lanes=n,e}function nF(e,t,n,i){(e=r(22,e,i,t)).elementType=n9,e.lanes=n;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=s._current;if(null===e)throw Error(a(456));if(0==(2&s._pendingVisibility)){var t=j(e,2);null!==t&&(s._pendingVisibility|=2,nt(t,e,2))}},attach:function(){var e=s._current;if(null===e)throw Error(a(456));if(0!=(2&s._pendingVisibility)){var t=j(e,2);null!==t&&(s._pendingVisibility&=-3,nt(t,e,2))}}};return e.stateNode=s,e}function nU(e,t,n){return(e=r(6,e,null,t)).lanes=n,e}function nO(e,t,n){return(t=r(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function nk(e,t,r,n,i,a,s,o){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=iw,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=b(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=b(0),this.hiddenUpdates=b(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function nz(e,t,n,i,a,s,o,l,u,c,h,d){return e=new nk(e,t,n,o,l,u,c,d),t=1,!0===s&&(t|=24),s=r(3,null,null,t),e.current=s,s.stateNode=e,t=rc(),t.refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:t},er(s),e}function nV(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw Error(a(268,e=Object.keys(e).join(",")))}return null===(e=null!==(e=A(t))?function e(t){var r=t.tag;if(5===r||26===r||27===r||6===r)return t;for(t=t.child;null!==t;){if(null!==(r=e(t)))return r;t=t.sibling}return null}(e):null)?null:id(e.stateNode)}function nq(e,t,r,n,i,a){i=i?a5:a5,null===n.context?n.context=i:n.pendingContext=i,(n=ei(t)).payload={element:r},null!==(a=void 0===a?null:a)&&(n.callback=a),null!==(r=ea(e,n,t))&&(nt(r,e,t),es(r,e,t))}function nG(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function nH(e,t){nG(e,t),(e=e.alternate)&&nG(e,t)}var nj={},nW=e.r(71645),nX=e.r(51849),nQ=Object.assign,nY=Symbol.for("react.element"),nK=Symbol.for("react.transitional.element"),nZ=Symbol.for("react.portal"),nJ=Symbol.for("react.fragment"),n$=Symbol.for("react.strict_mode"),n0=Symbol.for("react.profiler"),n1=Symbol.for("react.provider"),n2=Symbol.for("react.consumer"),n3=Symbol.for("react.context"),n4=Symbol.for("react.forward_ref"),n5=Symbol.for("react.suspense"),n6=Symbol.for("react.suspense_list"),n7=Symbol.for("react.memo"),n8=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var n9=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var ie,it,ir=Symbol.for("react.memo_cache_sentinel"),ii=Symbol.iterator,ia=Symbol.for("react.client.reference"),is=nW.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,io=!1,il=Array.isArray,iu=t.rendererVersion,ic=t.rendererPackageName,ih=t.extraDevToolsConfig,id=t.getPublicInstance,iA=t.getRootHostContext,ip=t.getChildHostContext,im=t.prepareForCommit,ig=t.resetAfterCommit,iy=t.createInstance,iv=t.appendInitialChild,ix=t.finalizeInitialChildren,i_=t.shouldSetTextContent,ib=t.createTextInstance,iS=t.scheduleTimeout,iT=t.cancelTimeout,iw=t.noTimeout,iM=t.isPrimaryRenderer;t.warnsIfNotActing;var iE=t.supportsMutation,iR=t.supportsPersistence,iC=t.supportsHydration,iN=t.getInstanceFromNode;t.beforeActiveInstanceBlur,t.afterActiveInstanceBlur;var iP=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var iI=t.setCurrentUpdatePriority,iL=t.getCurrentUpdatePriority,iD=t.resolveUpdatePriority;t.resolveEventType,t.resolveEventTimeStamp;var iB=t.shouldAttemptEagerTransition,iF=t.detachDeletedInstance;t.requestPostPaintCallback;var iU=t.maySuspendCommit,iO=t.preloadInstance,ik=t.startSuspendingCommit,iz=t.suspendInstance,iV=t.waitForCommitToBeReady,iq=t.NotPendingTransition,iG=t.HostTransitionContext,iH=t.resetFormInstance;t.bindToConsole;var ij=t.supportsMicrotasks,iW=t.scheduleMicrotask,iX=t.supportsTestSelectors,iQ=t.findFiberRoot,iY=t.getBoundingRect,iK=t.getTextContent,iZ=t.isHiddenSubtree,iJ=t.matchAccessibilityRole,i$=t.setFocusIfFocusable,i0=t.setupIntersectionObserver,i1=t.appendChild,i2=t.appendChildToContainer,i3=t.commitTextUpdate,i4=t.commitMount,i5=t.commitUpdate,i6=t.insertBefore,i7=t.insertInContainerBefore,i8=t.removeChild,i9=t.removeChildFromContainer,ae=t.resetTextContent,at=t.hideInstance,ar=t.hideTextInstance,an=t.unhideInstance,ai=t.unhideTextInstance,aa=t.clearContainer,as=t.cloneInstance,ao=t.createContainerChildSet,al=t.appendChildToContainerChildSet,au=t.finalizeContainerChildren,ac=t.replaceContainerChildren,ah=t.cloneHiddenInstance,ad=t.cloneHiddenTextInstance,aA=t.isSuspenseInstancePending,ap=t.isSuspenseInstanceFallback,af=t.getSuspenseInstanceFallbackErrorDetails,am=t.registerSuspenseInstanceRetry,ag=t.canHydrateFormStateMarker,ay=t.isFormStateMarkerMatching,av=t.getNextHydratableSibling,ax=t.getFirstHydratableChild,a_=t.getFirstHydratableChildWithinContainer,ab=t.getFirstHydratableChildWithinSuspenseInstance,aS=t.canHydrateInstance,aT=t.canHydrateTextInstance,aw=t.canHydrateSuspenseInstance,aM=t.hydrateInstance,aE=t.hydrateTextInstance,aR=t.hydrateSuspenseInstance,aC=t.getNextHydratableInstanceAfterSuspenseInstance,aN=t.commitHydratedContainer,aP=t.commitHydratedSuspenseInstance,aI=t.clearSuspenseBoundary,aL=t.clearSuspenseBoundaryFromContainer,aD=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var aB=t.validateHydratableInstance,aF=t.validateHydratableTextInstance,aU=t.supportsResources,aO=t.isHostHoistableType,ak=t.getHoistableRoot,az=t.getResource,aV=t.acquireResource,aq=t.releaseResource,aG=t.hydrateHoistable,aH=t.mountHoistable,aj=t.unmountHoistable,aW=t.createHoistableInstance,aX=t.prepareToCommitHoistables,aQ=t.mayResourceSuspendCommit,aY=t.preloadResource,aK=t.suspendResource,aZ=t.supportsSingletons,aJ=t.resolveSingletonInstance,a$=t.clearSingleton,a0=t.acquireSingletonInstance,a1=t.releaseSingletonInstance,a2=t.isHostSingletonType,a3=[],a4=-1,a5={},a6=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(a7(e)/a8|0)|0},a7=Math.log,a8=Math.LN2,a9=128,se=4194304,st=nX.unstable_scheduleCallback,sr=nX.unstable_cancelCallback,sn=nX.unstable_shouldYield,si=nX.unstable_requestPaint,sa=nX.unstable_now,ss=nX.unstable_ImmediatePriority,so=nX.unstable_UserBlockingPriority,sl=nX.unstable_NormalPriority,su=nX.unstable_IdlePriority,sc=(nX.log,nX.unstable_setDisableYieldValue,null),sh=null,sd="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},sA=new WeakMap,sp=[],sf=0,sm=null,sg=0,sy=[],sv=0,sx=null,s_=1,sb="",sS=p(null),sT=p(null),sw=p(null),sM=p(null),sE=null,sR=null,sC=!1,sN=null,sP=!1,sI=Error(a(519)),sL=[],sD=0,sB=0,sF=null,sU=null,sO=!1,sk=!1,sz=!1,sV=0,sq=null,sG=0,sH=0,sj=null,sW=!1,sX=!1,sQ=Object.prototype.hasOwnProperty,sY=Error(a(460)),sK=Error(a(474)),sZ={then:function(){}},sJ=null,s$=null,s0=0,s1=e_(!0),s2=e_(!1),s3=p(null),s4=p(0),s5=p(null),s6=null,s7=p(0),s8=0,s9=null,oe=null,ot=null,or=!1,on=!1,oi=!1,oa=0,os=0,oo=null,ol=0,ou=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},oc={readContext:ro,use:eq,useCallback:eN,useContext:eN,useEffect:eN,useImperativeHandle:eN,useLayoutEffect:eN,useInsertionEffect:eN,useMemo:eN,useReducer:eN,useRef:eN,useState:eN,useDebugValue:eN,useDeferredValue:eN,useTransition:eN,useSyncExternalStore:eN,useId:eN};oc.useCacheRefresh=eN,oc.useMemoCache=eN,oc.useHostTransitionStatus=eN,oc.useFormState=eN,oc.useActionState=eN,oc.useOptimistic=eN;var oh={readContext:ro,use:eq,useCallback:function(e,t){return ek().memoizedState=[e,void 0===t?null:t],e},useContext:ro,useEffect:tl,useImperativeHandle:function(e,t,r){r=null!=r?r.concat([e]):null,ts(4194308,4,td.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ts(4194308,4,e,t)},useInsertionEffect:function(e,t){ts(4,2,e,t)},useMemo:function(e,t){var r=ek();t=void 0===t?null:t;var n=e();return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=ek();if(void 0!==r)var i=r(t);else i=t;return n.memoizedState=n.baseState=i,n.queue=e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},e=e.dispatch=tw.bind(null,s9,e),[n.memoizedState,e]},useRef:function(e){return ek().memoizedState={current:e}},useState:function(e){var t=(e=e0(e)).queue,r=tM.bind(null,s9,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:tp,useDeferredValue:function(e,t){return tg(ek(),e,t)},useTransition:function(){var e=e0(!1);return e=tv.bind(null,s9,e.queue,!0,!1),ek().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var n=s9,i=ek();if(sC){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===oX)throw Error(a(349));0!=(60&oY)||eY(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,tl(eZ.bind(null,n,s,e),[e]),n.flags|=2048,ti(9,eK.bind(null,n,s,r,t),{destroy:void 0},null),r},useId:function(){var e=ek(),t=oX.identifierPrefix;if(sC){var r=sb,n=s_;t=":"+t+"R"+(r=(n&~(1<<32-a6(n)-1)).toString(32)+r),0<(r=oa++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ol++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return ek().memoizedState=tT.bind(null,s9)}};oh.useMemoCache=eG,oh.useHostTransitionStatus=t_,oh.useFormState=e9,oh.useActionState=e9,oh.useOptimistic=function(e){var t=ek();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=tR.bind(null,s9,!0,r),r.dispatch=t,[e,t]};var od={readContext:ro,use:eq,useCallback:tf,useContext:ro,useEffect:tu,useImperativeHandle:tA,useInsertionEffect:tc,useLayoutEffect:th,useMemo:tm,useReducer:ej,useRef:ta,useState:function(){return ej(eH)},useDebugValue:tp,useDeferredValue:function(e,t){return ty(ez(),oe.memoizedState,e,t)},useTransition:function(){var e=ej(eH)[0],t=ez().memoizedState;return["boolean"==typeof e?e:eV(e),t]},useSyncExternalStore:eQ,useId:tb};od.useCacheRefresh=tS,od.useMemoCache=eG,od.useHostTransitionStatus=t_,od.useFormState=te,od.useActionState=te,od.useOptimistic=function(e,t){return e1(ez(),oe,e,t)};var oA={readContext:ro,use:eq,useCallback:tf,useContext:ro,useEffect:tu,useImperativeHandle:tA,useInsertionEffect:tc,useLayoutEffect:th,useMemo:tm,useReducer:eX,useRef:ta,useState:function(){return eX(eH)},useDebugValue:tp,useDeferredValue:function(e,t){var r=ez();return null===oe?tg(r,e,t):ty(r,oe.memoizedState,e,t)},useTransition:function(){var e=eX(eH)[0],t=ez().memoizedState;return["boolean"==typeof e?e:eV(e),t]},useSyncExternalStore:eQ,useId:tb};oA.useCacheRefresh=tS,oA.useMemoCache=eG,oA.useHostTransitionStatus=t_,oA.useFormState=tn,oA.useActionState=tn,oA.useOptimistic=function(e,t){var r=ez();return null!==oe?e1(r,oe,e,t):(r.baseState=e,[e,r.queue.dispatch])};var op={isMounted:function(e){return!!(e=e._reactInternals)&&h(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=r9(),i=ei(n);i.payload=t,null!=r&&(i.callback=r),null!==(t=ea(e,i,n))&&(nt(t,e,n),es(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=r9(),i=ei(n);i.tag=1,i.payload=t,null!=r&&(i.callback=r),null!==(t=ea(e,i,n))&&(nt(t,e,n),es(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=r9(),n=ei(r);n.tag=2,null!=t&&(n.callback=t),null!==(t=ea(e,n,r))&&(nt(t,e,r),es(t,e,r))}},of="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof n.default&&"function"==typeof n.default.emit)return void n.default.emit("uncaughtException",e);console.error(e)},om=Error(a(461)),og=!1,oy={dehydrated:null,treeContext:null,retryLane:0},ov=p(null),ox=null,o_=null,ob="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},oS=nX.unstable_scheduleCallback,oT=nX.unstable_NormalPriority,ow={$$typeof:n3,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},oM=is.S;is.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===sq){var r=sq=[];sG=0,sH=ee(),sj={status:"pending",value:void 0,then:function(e){r.push(e)}}}sG++,t.then(et,et)}(0,t),null!==oM&&oM(e,t)};var oE=p(null),oR=!1,oC=!1,oN=!1,oP="function"==typeof WeakSet?WeakSet:Set,oI=null,oL=!1,oD=null,oB=!1,oF=null,oU=8192,oO={getCacheForType:function(e){var t=ro(ow),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r}},ok=0,oz=1,oV=2,oq=3,oG=4;if("function"==typeof Symbol&&Symbol.for){var oH=Symbol.for;ok=oH("selector.component"),oz=oH("selector.has_pseudo_class"),oV=oH("selector.role"),oq=oH("selector.test_id"),oG=oH("selector.text")}var oj="function"==typeof WeakMap?WeakMap:Map,oW=0,oX=null,oQ=null,oY=0,oK=0,oZ=null,oJ=!1,o$=!1,o0=!1,o1=0,o2=0,o3=0,o4=0,o5=0,o6=0,o7=0,o8=null,o9=null,le=!1,lt=0,lr=1/0,ln=null,li=null,la=!1,ls=null,lo=0,ll=0,lu=null,lc=0,lh=null;return nj.attemptContinuousHydration=function(e){if(13===e.tag){var t=j(e,0x4000000);null!==t&&nt(t,e,0x4000000),nH(e,0x4000000)}},nj.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=r9(),r=j(e,t);null!==r&&nt(r,e,t),nH(e,t)}},nj.attemptSynchronousHydration=function(e){switch(e.tag){case 3:if((e=e.stateNode).current.memoizedState.isDehydrated){var t=g(e.pendingLanes);if(0!==t){for(e.pendingLanes|=2,e.entangledLanes|=2;t;){var r=1<<31-a6(t);e.entanglements[1]|=r,t&=~r}Q(e),0==(6&oW)&&(lr=sa()+500,Y(0,!1))}}break;case 13:null!==(t=j(e,2))&&nt(t,e,2),ns(),nH(e,2)}},nj.batchedUpdates=function(e,t){return e(t)},nj.createComponentSelector=function(e){return{$$typeof:ok,value:e}},nj.createContainer=function(e,t,r,n,i,a,s,o,l,u){return nz(e,t,!1,null,r,n,a,s,o,l,u,null)},nj.createHasPseudoClassSelector=function(e){return{$$typeof:oz,value:e}},nj.createHydrationContainer=function(e,t,r,n,i,a,s,o,l,u,c,h,d){var A;return(e=nz(r,n,!0,e,i,a,o,l,u,c,h,d)).context=(A=null,a5),r=e.current,(i=ei(n=r9())).callback=null!=t?t:null,ea(r,i,n),e.current.lanes=n,S(e,n),Q(e),e},nj.createPortal=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:nZ,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}},nj.createRoleSelector=function(e){return{$$typeof:oV,value:e}},nj.createTestNameSelector=function(e){return{$$typeof:oq,value:e}},nj.createTextSelector=function(e){return{$$typeof:oG,value:e}},nj.defaultOnCaughtError=function(e){console.error(e)},nj.defaultOnRecoverableError=function(e){of(e)},nj.defaultOnUncaughtError=function(e){of(e)},nj.deferredUpdates=function(e){var t=is.T,r=iL();try{return iI(32),is.T=null,e()}finally{iI(r),is.T=t}},nj.discreteUpdates=function(e,t,r,n,i){var a=is.T,s=iL();try{return iI(2),is.T=null,e(t,r,n,i)}finally{iI(s),is.T=a,0===oW&&(lr=sa()+500)}},nj.findAllNodes=r8,nj.findBoundingRects=function(e,t){if(!iX)throw Error(a(363));t=r8(e,t),e=[];for(var r=0;r<t.length;r++)e.push(iY(t[r]));for(t=e.length-1;0<t;t--){r=e[t];for(var n=r.x,i=n+r.width,s=r.y,o=s+r.height,l=t-1;0<=l;l--)if(t!==l){var u=e[l],c=u.x,h=c+u.width,d=u.y,A=d+u.height;if(n>=c&&s>=d&&i<=h&&o<=A){e.splice(t,1);break}if(n!==c||r.width!==u.width||A<s||d>o){if(!(s!==d||r.height!==u.height||h<n||c>i)){c>n&&(u.width+=c-n,u.x=n),h<i&&(u.width=i-c),e.splice(t,1);break}}else{d>s&&(u.height+=d-s,u.y=s),A<o&&(u.height=o-d),e.splice(t,1);break}}}return e},nj.findHostInstance=nV,nj.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=A(e))?function e(t){var r=t.tag;if(5===r||26===r||27===r||6===r)return t;for(t=t.child;null!==t;){if(4!==t.tag&&null!==(r=e(t)))return r;t=t.sibling}return null}(e):null)?null:id(e.stateNode)},nj.findHostInstanceWithWarning=function(e){return nV(e)},nj.flushPassiveEffects=nb,nj.flushSyncFromReconciler=function(e){var t=oW;oW|=1;var r=is.T,n=iL();try{if(iI(2),is.T=null,e)return e()}finally{iI(n),is.T=r,0==(6&(oW=t))&&Y(0,!1)}},nj.flushSyncWork=ns,nj.focusWithin=function(e,t){if(!iX)throw Error(a(363));for(t=Array.from(t=r7(e=r4(e),t)),e=0;e<t.length;){var r=t[e++],n=r.tag;if(!iZ(r)){if((5===n||26===n||27===n)&&i$(r.stateNode))return!0;for(r=r.child;null!==r;)t.push(r),r=r.sibling}}return!1},nj.getFindAllNodesFailureDescription=function(e,t){if(!iX)throw Error(a(363));var r=0,n=[];e=[r4(e),0];for(var i=0;i<e.length;){var s=e[i++],o=s.tag,l=e[i++],u=t[l];if((5!==o&&26!==o&&27!==o||!iZ(s))&&(r5(s,u)&&(n.push(r6(u)),++l>r&&(r=l)),l<t.length))for(s=s.child;null!==s;)e.push(s,l),s=s.sibling}if(r<t.length){for(e=[];r<t.length;r++)e.push(r6(t[r]));return"findAllNodes was able to match part of the selector:\n  "+n.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},nj.getPublicRootInstance=function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 27:case 5:return id(e.child.stateNode);default:return e.child.stateNode}},nj.injectIntoDevTools=function(){var e={bundleType:0,version:iu,rendererPackageName:ic,currentDispatcherRef:is,findFiberByHostInstance:iN,reconcilerVersion:"19.0.0"};if(null!==ih&&(e.rendererConfig=ih),"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{sc=t.inject(e),sh=t}catch(e){}e=!!t.checkDCE}}return e},nj.isAlreadyRendering=function(){return!1},nj.observeVisibleRects=function(e,t,r,n){if(!iX)throw Error(a(363));var i=i0(e=r8(e,t),r,n).disconnect;return{disconnect:function(){i()}}},nj.shouldError=function(){return null},nj.shouldSuspend=function(){return!1},nj.startHostTransition=function(e,t,r,n){if(5!==e.tag)throw Error(a(476));var s=tx(e).queue;tv(e,s,t,iq,null===r?i:function(){var t=tx(e).next.queue;return tE(e,t,{},r9()),r(n)})},nj.updateContainer=function(e,t,r,n){var i=t.current,a=r9();return nq(i,a,e,t,r,n),a},nj.updateContainerSync=function(e,t,r,n){return 0===t.tag&&nb(),nq(t.current,2,e,t,r,n),2},nj},t.exports.default=t.exports,Object.defineProperty(t.exports,"__esModule",{value:!0})},98133,(e,t,r)=>{"use strict";t.exports=e.r(40336)},45015,(e,t,r)=>{"use strict";function n(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<s(i,t))e[n]=t,e[r]=i,r=n;else break}}function i(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,a=i>>>1;n<a;){var o=2*(n+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,r))u<i&&0>s(c,l)?(e[n]=c,e[u]=r,n=u):(e[n]=l,e[o]=r,n=o);else if(u<i&&0>s(c,r))e[n]=c,e[u]=r,n=u;else break}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(r.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o,l=performance;r.unstable_now=function(){return l.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var h=[],d=[],A=1,p=null,f=3,m=!1,g=!1,y=!1,v="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var t=i(d);null!==t;){if(null===t.callback)a(d);else if(t.startTime<=e)a(d),t.sortIndex=t.expirationTime,n(h,t);else break;t=i(d)}}function S(e){if(y=!1,b(e),!g)if(null!==i(h))g=!0,I();else{var t=i(d);null!==t&&L(S,t.startTime-e)}}var T=!1,w=-1,M=5,E=-1;function R(){return!(r.unstable_now()-E<M)}function C(){if(T){var e=r.unstable_now();E=e;var t=!0;try{e:{g=!1,y&&(y=!1,x(w),w=-1),m=!0;var n=f;try{t:{for(b(e),p=i(h);null!==p&&!(p.expirationTime>e&&R());){var s=p.callback;if("function"==typeof s){p.callback=null,f=p.priorityLevel;var l=s(p.expirationTime<=e);if(e=r.unstable_now(),"function"==typeof l){p.callback=l,b(e),t=!0;break t}p===i(h)&&a(h),b(e)}else a(h);p=i(h)}if(null!==p)t=!0;else{var u=i(d);null!==u&&L(S,u.startTime-e),t=!1}}break e}finally{p=null,f=n,m=!1}}}finally{t?o():T=!1}}}if("function"==typeof _)o=function(){_(C)};else if("undefined"!=typeof MessageChannel){var N=new MessageChannel,P=N.port2;N.port1.onmessage=C,o=function(){P.postMessage(null)}}else o=function(){v(C,0)};function I(){T||(T=!0,o())}function L(e,t){w=v(function(){e(r.unstable_now())},t)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(e){e.callback=null},r.unstable_continueExecution=function(){g||m||(g=!0,I())},r.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},r.unstable_getCurrentPriorityLevel=function(){return f},r.unstable_getFirstCallbackNode=function(){return i(h)},r.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},r.unstable_scheduleCallback=function(e,t,a){var s=r.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=0x3fffffff;break;case 4:o=1e4;break;default:o=5e3}return o=a+o,e={id:A++,callback:t,priorityLevel:e,startTime:a,expirationTime:o,sortIndex:-1},a>s?(e.sortIndex=a,n(d,e),null===i(h)&&e===i(d)&&(y?(x(w),w=-1):y=!0,L(S,a-s))):(e.sortIndex=o,n(h,e),g||m||(g=!0,I())),e},r.unstable_shouldYield=R,r.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},95087,(e,t,r)=>{"use strict";t.exports=e.r(45015)},83958,e=>{e.v(JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[74.92,37.24],[74.57,37.03],[72.56,36.82],[71.24,36.13],[71.65,35.42],[71.08,34.06],[69.91,34.04],[70.33,33.33],[69.51,33.03],[69.33,31.94],[66.72,31.21],[66.26,29.85],[62.48,29.41],[60.87,29.86],[61.85,31.02],[60.84,31.5],[60.58,33.07],[60.94,33.52],[60.51,34.14],[61.28,35.61],[62.72,35.25],[63.12,35.86],[64.5,36.28],[64.8,37.12],[66.54,37.37],[67.78,37.19],[69.32,37.12],[70.97,38.47],[71.59,37.9],[71.68,36.68],[73.31,37.46],[74.92,37.24]]]]},"properties":{"name":"Afghanistan"},"id":"AF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[19.44,41.02],[19.37,41.85],[19.65,42.62],[20.07,42.56],[20.59,41.88],[20.82,40.91],[20.98,40.86],[20.01,39.69],[19.29,40.42],[19.44,41.02]]]]},"properties":{"name":"Albania"},"id":"AL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[2.96,36.8],[8.62,36.94],[8.18,36.52],[8.25,34.64],[7.49,33.89],[9.06,32.1],[9.54,30.23],[9.95,27.82],[9.87,26.51],[9.4,26.15],[10.25,24.61],[11.56,24.3],[11.99,23.52],[5.81,19.45],[4.25,19.15],[3.33,18.98],[3.23,19.82],[1.8,20.31],[-4.81,25],[-6.66,26.13],[-8.67,27.29],[-8.67,27.67],[-8.67,28.71],[-3.63,30.97],[-3.82,31.7],[-1.18,32.11],[-1.75,34.75],[-2.21,35.09],[0.95,36.45],[2.96,36.8]]]]},"properties":{"name":"Algeria"},"id":"DZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-170.64,-14.29],[-170.83,-14.33],[-170.56,-14.27],[-170.64,-14.29]]],[[[-169.44,-14.26],[-169.51,-14.28],[-169.54,-14.23],[-169.44,-14.26]]]]},"properties":{"name":"Samoa"},"id":"WS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[1.78,42.57],[1.72,42.51],[1.45,42.6],[1.78,42.57]]]]},"properties":{"name":"Andorra"},"id":"AD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[14,-5.85],[16.58,-5.9],[17.62,-8.1],[19.37,-8],[19.54,-7],[21.78,-7.28],[22.25,-11.21],[23.99,-10.87],[24.02,-13.01],[22,-13],[22,-16.17],[23.48,-17.63],[23.28,-17.66],[20.85,-18.02],[18.45,-17.39],[13.99,-17.42],[13.16,-16.95],[11.75,-17.25],[12.51,-13.43],[13.79,-11.79],[12.98,-9.09],[13.39,-8.39],[12.24,-6.1],[13.18,-5.86],[14,-5.85]]],[[[13.09,-4.66],[12.21,-5.77],[12.03,-5.01],[12.78,-4.39],[13.09,-4.63],[13.09,-4.66]]]]},"properties":{"name":"Angola"},"id":"AO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-61.69,17.02],[-61.89,17.11],[-61.79,17.16],[-61.69,17.02]]],[[[-61.73,17.61],[-61.85,17.58],[-61.87,17.7],[-61.73,17.61]]]]},"properties":{"name":"Antigua and Barbuda"},"id":"AG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[45.08,39.77],[45.82,39.55],[46.18,38.84],[45,39.42],[44.81,39.63],[44.78,39.71],[45.08,39.77]]],[[[45.51,40.61],[45.52,40.67],[45.57,40.63],[45.51,40.61]]],[[[46.57,41.87],[47.77,41.2],[48.58,41.84],[50.37,40.26],[49.49,40.15],[48.89,38.44],[48.02,38.84],[48.36,39.39],[47.98,39.72],[46.54,38.88],[46.54,39.56],[45.6,39.98],[46,40.23],[45.15,41.2],[45.02,41.3],[46.52,41.05],[46.45,41.9],[46.57,41.87]]]]},"properties":{"name":"Azerbaijan"},"id":"AZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-68.26,-52.99],[-68.54,-53.23],[-67.36,-54.03],[-65.14,-54.65],[-66.45,-55.05],[-68.64,-54.79],[-68.62,-52.64],[-68.26,-52.99]]],[[[-65.75,-22.11],[-65.19,-22.09],[-64.59,-22.21],[-64.32,-22.87],[-63.94,-22],[-62.64,-22.24],[-61.01,-23.81],[-57.76,-25.18],[-57.58,-25.55],[-58.6,-27.32],[-55.74,-27.44],[-54.7,-26.44],[-54.6,-25.57],[-53.86,-25.68],[-53.81,-27.13],[-55.77,-28.23],[-57.61,-30.18],[-57.81,-30.75],[-58.2,-32.45],[-58.15,-33.05],[-58.43,-33.1],[-58.53,-33.52],[-58.47,-34.54],[-57.19,-35.32],[-57.38,-35.96],[-56.66,-36.9],[-58.3,-38.49],[-62.38,-38.8],[-62.02,-39.38],[-62.39,-40.9],[-65.13,-40.85],[-65.01,-42.09],[-64.45,-42.45],[-63.75,-42.09],[-63.58,-42.62],[-64.96,-42.67],[-64.3,-42.99],[-65.32,-43.65],[-65.6,-45.02],[-66.95,-45.26],[-67.58,-46],[-66.82,-46.99],[-65.78,-47.19],[-66.24,-47.86],[-65.79,-47.96],[-67.58,-49.03],[-67.9,-49.99],[-69.01,-50.01],[-68.37,-50.15],[-69.41,-51.08],[-68.97,-51.57],[-69.61,-51.63],[-68.99,-51.62],[-68.44,-52.38],[-71.91,-52],[-72.4,-51.51],[-72.29,-50.65],[-73.17,-50.75],[-73.58,-49.54],[-72.56,-48.8],[-72.36,-47.47],[-71.67,-46.68],[-71.78,-45.65],[-71.3,-45.29],[-72.08,-44.77],[-71.11,-44.54],[-71.86,-44.37],[-72.13,-42.29],[-71.73,-42.1],[-71.7,-39.58],[-70.82,-38.57],[-71.19,-36.84],[-70.42,-36.14],[-70.57,-35.25],[-69.81,-34.24],[-70.53,-31.19],[-69.83,-30.19],[-69.66,-28.4],[-68.29,-26.92],[-68.57,-24.77],[-67.34,-24.02],[-67.18,-22.82],[-66.22,-21.78],[-65.75,-22.11]]]]},"properties":{"name":"Argentina"},"id":"AR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[145.11,-40.82],[146.59,-41.19],[148.22,-40.85],[148,-43.23],[147.32,-42.85],[146.92,-43.62],[146.04,-43.5],[144.68,-41.22],[144.7,-40.76],[145.11,-40.82]]],[[[142.51,-10.87],[143.78,-14.41],[144.51,-14.17],[145.32,-14.95],[146.28,-18.88],[148.78,-20.23],[149.66,-22.5],[150.64,-22.34],[150.87,-23.51],[153.18,-25.95],[153.03,-27.18],[153.63,-28.67],[153.05,-31.04],[150.16,-35.94],[149.97,-37.52],[147.76,-37.98],[146.22,-38.71],[146.39,-39.15],[145.45,-38.23],[144.9,-38.5],[144.93,-37.87],[143.54,-38.86],[141.57,-38.42],[139.81,-37.3],[139.82,-36.55],[139.08,-35.68],[139.67,-36.23],[139.1,-35.62],[139.36,-35.37],[138.09,-35.62],[138.51,-35.03],[138.1,-34.14],[137.74,-35.14],[136.83,-35.25],[137.44,-34.93],[137.95,-33.56],[137.77,-32.52],[135.95,-35.01],[135.11,-34.6],[135.51,-34.62],[134.18,-32.49],[131.15,-31.47],[125.97,-32.27],[124.28,-32.99],[123.54,-33.91],[120,-33.93],[117.93,-35.13],[115.01,-34.26],[114.99,-33.52],[115.71,-33.27],[115.74,-31.87],[114.89,-29.2],[113.22,-26.24],[113.86,-26.51],[113.47,-25.54],[114.22,-26.31],[113.39,-24.43],[114.02,-21.85],[114.15,-22.53],[116.71,-20.65],[121.03,-19.59],[122.35,-18.11],[122.17,-17.24],[122.92,-16.42],[123.58,-17.6],[123.6,-16.99],[123.92,-17.2],[123.57,-16.17],[123.73,-16.14],[123.89,-16.38],[123.96,-16.25],[124.24,-16.41],[124.9,-16.42],[124.4,-16.33],[124.43,-16.1],[124.59,-16.11],[124.73,-15.81],[124.4,-15.87],[124.45,-15.49],[125.18,-15.52],[124.83,-15.16],[125.43,-15.14],[125.14,-14.74],[125.61,-14.22],[125.64,-14.64],[126.04,-14.52],[126.02,-13.92],[126.29,-14.23],[126.86,-13.75],[127.42,-13.95],[128.17,-14.7],[128.01,-15.5],[128.53,-14.76],[129.73,-15.2],[129.94,-14.77],[129.37,-14.33],[130.58,-12.4],[132.75,-12.13],[131.98,-11.13],[135.23,-12.29],[135.91,-11.76],[135.67,-12.2],[136.04,-12.47],[136.56,-11.93],[136.98,-12.36],[136.46,-13.25],[135.92,-13.28],[135.46,-14.94],[139.26,-17.34],[140.49,-17.64],[141.43,-16.08],[141.58,-12.99],[141.94,-12.88],[141.59,-12.55],[142.51,-10.87]]]]},"properties":{"name":"Australia"},"id":"AU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[13.83,48.77],[14.7,48.58],[15.03,49.02],[16.95,48.62],[17.17,48.01],[16.45,47.7],[16.51,47.01],[16.11,46.87],[13.72,46.53],[12.13,47],[10.47,46.87],[9.6,47.06],[9.53,47.27],[9.57,47.54],[13.02,47.47],[12.76,48.12],[13.83,48.77]]]]},"properties":{"name":"Austria"},"id":"AT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-73.04,21.14],[-73.69,20.94],[-73.02,21.33],[-73.04,21.14]]],[[[-77.74,24.03],[-77.68,24.3],[-77.57,23.74],[-77.74,24.03]]],[[[-78.19,25.2],[-77.72,24.51],[-78.02,24.27],[-78.44,24.61],[-78.19,25.2]]],[[[-77.92,26.75],[-78.71,26.49],[-78.98,26.7],[-77.92,26.75]]],[[[-77.74,26.91],[-77.04,26.51],[-77.2,25.88],[-77.15,26.55],[-77.74,26.91]]]]},"properties":{"name":"Bahamas, The"},"id":"BS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[50.53,26.23],[50.57,25.81],[50.46,25.97],[50.53,26.23]]]]},"properties":{"name":"Bahrain"},"id":"BH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[90.76,22.06],[90.6,22.78],[90.88,22.46],[90.76,22.06]]],[[[88.43,26.55],[89.74,26.16],[89.85,25.29],[92.41,25.03],[91.16,23.64],[91.61,22.94],[92.28,23.71],[92.6,21.98],[92.26,21.05],[92.32,20.74],[91.7,22.49],[90.83,22.69],[90.59,23.6],[90.27,21.85],[90.02,21.86],[90.07,22.16],[89.93,22],[90,22.48],[89.58,21.7],[89.62,22.32],[89.25,21.64],[89.06,22.12],[88.75,24.22],[88.04,24.68],[89.01,25.29],[88.11,25.84],[88.43,26.55]],[[90.24,22.19],[90.06,21.99],[90.22,22.11],[90.24,22.19]]]]},"properties":{"name":"Bangladesh"},"id":"BD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[45.15,41.2],[46,40.23],[45.6,39.98],[46.54,39.56],[46.54,38.88],[46.18,38.84],[45.82,39.55],[45.08,39.77],[44.78,39.71],[43.66,40.11],[43.46,41.11],[45.02,41.3],[45.15,41.2]],[[45.57,40.63],[45.52,40.67],[45.51,40.61],[45.57,40.63]]]]},"properties":{"name":"Armenia"},"id":"AM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-59.53,13.05],[-59.64,13.33],[-59.43,13.16],[-59.53,13.05]]]]},"properties":{"name":"Barbados"},"id":"BB"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[4.3,51.26],[4.25,51.38],[5.04,51.49],[6.01,50.76],[6.13,50.13],[6.03,50.18],[5.81,49.55],[4.83,50.17],[4.15,49.98],[2.54,51.09],[3.37,51.37],[4.24,51.35],[4.3,51.26]]]]},"properties":{"name":"Belgium"},"id":"BE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-64.78,32.27],[-64.86,32.27],[-64.67,32.38],[-64.78,32.27]]]]},"properties":{"name":"Bermuda"},"id":"BM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[90.47,28.07],[91.66,27.76],[92.07,26.86],[89.64,26.72],[88.92,27.32],[89.59,28.14],[90.47,28.07]]]]},"properties":{"name":"Bhutan"},"id":"BT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-65.19,-22.09],[-65.75,-22.11],[-66.22,-21.78],[-67.18,-22.82],[-67.88,-22.83],[-68.76,-20.41],[-68.44,-19.43],[-69.48,-17.64],[-69.5,-17.51],[-68.82,-16.34],[-69.42,-15.62],[-68.67,-12.5],[-69.57,-10.95],[-68.58,-11.11],[-66.63,-9.91],[-65.38,-9.7],[-64.99,-12.01],[-60.47,-13.81],[-60.16,-16.26],[-58.33,-16.28],[-58.4,-17.25],[-57.52,-18.2],[-58.16,-20.17],[-59.1,-19.35],[-61.74,-19.65],[-62.64,-22.24],[-63.94,-22],[-64.32,-22.87],[-64.59,-22.21],[-65.19,-22.09]]]]},"properties":{"name":"Bolivia"},"id":"BO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[17.65,42.89],[17.58,42.94],[16.14,44.2],[15.79,45.17],[19.04,44.86],[19.62,44.05],[19.23,43.51],[18.46,42.57],[17.65,42.89]]]]},"properties":{"name":"Bosnia and Herzegovina"},"id":"BA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[26.96,-23.75],[25.51,-25.68],[23.01,-25.3],[21.67,-26.86],[20.64,-26.83],[20.81,-25.88],[20,-24.77],[20,-22.01],[20.99,-22],[20.99,-18.32],[23.3,-18],[23.62,-18.49],[25.26,-17.8],[26.17,-19.53],[27.71,-20.51],[28.02,-21.57],[29.37,-22.19],[26.96,-23.75]]]]},"properties":{"name":"Botswana"},"id":"BW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[3.36,-54.46],[3.37,-54.4],[3.48,-54.4],[3.36,-54.46]]]]},"properties":{"name":"Bouvet Island"},"id":"BV"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-51.9,-1.48],[-51.89,-1.18],[-51.66,-1.08],[-51.61,-0.73],[-51.2,-0.53],[-51.27,-1.01],[-51.9,-1.48]]],[[[-49.71,-0.23],[-48.37,-0.29],[-48.63,-1.06],[-49.17,-1.61],[-50.58,-1.8],[-50.66,-0.28],[-49.71,-0.23]]],[[[-60.1,5.22],[-60.15,4.52],[-59.57,3.9],[-59.99,2.69],[-59.64,1.73],[-58.81,1.19],[-56.47,1.94],[-55.9,1.89],[-55.97,2.53],[-54.6,2.33],[-52.91,2.2],[-51.68,4.03],[-51.54,4.39],[-51.09,3.91],[-50.68,2.16],[-49.93,1.71],[-49.9,1.17],[-51.26,-0.14],[-51.7,-0.75],[-51.71,-1.03],[-51.92,-1.17],[-51.94,-1.34],[-52.71,-1.6],[-52.21,-1.69],[-50.85,-0.92],[-50.66,-1.77],[-51.34,-1.65],[-51.45,-2.27],[-51.31,-1.76],[-50.85,-2.51],[-50.68,-1.81],[-49.29,-1.71],[-49.49,-2.56],[-48.7,-1.47],[-48.18,-1.47],[-48.5,-1.46],[-48.24,-0.87],[-47.43,-0.58],[-45.33,-1.31],[-45.35,-1.74],[-44.86,-1.43],[-44.36,-2.34],[-44.79,-3.3],[-44.06,-2.41],[-44.34,-2.83],[-43.35,-2.37],[-41.25,-3.02],[-40,-2.85],[-37.17,-4.92],[-35.42,-5.21],[-34.8,-7.63],[-35.29,-9.18],[-37.15,-10.75],[-38.04,-12.63],[-38.49,-13.02],[-38.9,-12.71],[-39.13,-17.68],[-40.97,-21.99],[-42.03,-22.92],[-43.08,-22.67],[-44.66,-23.05],[-44.58,-23.36],[-46.38,-23.87],[-48.21,-25.46],[-48.72,-25.42],[-48.36,-25.58],[-48.8,-26.07],[-48.49,-27.21],[-48.77,-28.52],[-52.07,-32.17],[-50.57,-30.46],[-51.28,-30.01],[-51.27,-30.8],[-53.37,-33.74],[-53.52,-33.15],[-53.09,-32.73],[-53.88,-31.97],[-55.58,-30.85],[-56.01,-31.08],[-56.81,-30.11],[-57.61,-30.18],[-55.77,-28.23],[-53.81,-27.13],[-53.86,-25.68],[-54.6,-25.57],[-54.33,-24.68],[-54.41,-23.92],[-55.41,-23.96],[-55.85,-22.29],[-57.99,-22.09],[-58.16,-20.17],[-57.52,-18.2],[-58.4,-17.25],[-58.33,-16.28],[-60.16,-16.26],[-60.47,-13.81],[-64.99,-12.01],[-65.38,-9.7],[-66.63,-9.91],[-68.58,-11.11],[-69.57,-10.95],[-70.63,-11.01],[-70.51,-9.43],[-72.14,-10],[-72.37,-9.49],[-73.21,-9.41],[-72.96,-8.98],[-74.01,-7.54],[-73.12,-6.45],[-72.85,-5.12],[-70.77,-4.15],[-69.96,-4.24],[-69.38,-1.34],[-70.04,0.59],[-69.12,0.65],[-69.84,1.07],[-69.85,1.71],[-67.91,1.75],[-67.42,2.14],[-66.87,1.22],[-65.52,0.65],[-63.39,2.15],[-64.05,2.48],[-64.8,4.28],[-62.88,3.56],[-62.75,4.03],[-60.99,4.52],[-60.73,5.2],[-60.1,5.22]]]]},"properties":{"name":"Brazil"},"id":"BR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-88.38,18.48],[-88.3,18.48],[-88.21,16.97],[-88.91,15.89],[-89.22,15.89],[-89.14,17.82],[-88.38,18.48]]]]},"properties":{"name":"Belize"},"id":"BZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[72.49,-7.38],[72.36,-7.27],[72.45,-7.23],[72.49,-7.38]]]]},"properties":{"name":"British Indian Ocean Territory"},"id":"IO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[161.55,-10.28],[162.39,-10.84],[161.28,-10.33],[161.55,-10.28]]],[[[159.94,-9.43],[160.83,-9.86],[159.83,-9.8],[159.6,-9.32],[159.94,-9.43]]],[[[160.97,-8.85],[161.38,-9.64],[160.58,-8.33],[160.97,-8.85]]],[[[157.63,-8.24],[157.81,-8.62],[157.21,-8.24],[157.63,-8.24]]],[[[159.85,-8.33],[159.89,-8.57],[158.49,-7.55],[159.85,-8.33]]],[[[157.43,-7.32],[156.94,-7.22],[156.44,-6.64],[157.43,-7.32]]]]},"properties":{"name":"Solomon Islands"},"id":"SB"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-64.42,18.44],[-64.41,18.51],[-64.32,18.51],[-64.42,18.44]]]]},"properties":{"name":"British Virgin Islands"},"id":"VG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[115.22,4.8],[115.34,4.31],[115.03,4.82],[115.15,4.9],[115.22,4.8]]],[[[114.98,4.89],[115.02,4.9],[114.64,4.02],[114.1,4.59],[114.98,4.89]]]]},"properties":{"name":"Brunei"},"id":"BN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[27.88,42.84],[27.45,42.47],[28.01,41.98],[27.39,42.01],[26.36,41.71],[26.29,41.71],[25.29,41.24],[22.94,41.34],[22.37,42.32],[23,43.19],[22.37,43.83],[22.68,44.22],[24.18,43.68],[27.04,44.15],[28.58,43.75],[27.88,42.84]]]]},"properties":{"name":"Bulgaria"},"id":"BG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[97.81,28.34],[98.7,27.54],[98.78,26.64],[98.71,25.86],[97.55,24.74],[97.54,23.94],[98.89,24.16],[98.93,23.19],[99.57,22.94],[99.16,22.16],[99.96,22.05],[100.21,21.43],[101.15,21.57],[100.09,20.35],[100.08,20.35],[98.05,19.81],[97.77,18.57],[97.35,18.56],[98.93,16.39],[98.2,15.07],[99.17,13.73],[99.66,11.83],[98.74,10.35],[98.55,9.98],[98.89,11.7],[97.8,14.88],[97.74,16.56],[97.38,16.49],[96.88,17.45],[96.78,16.7],[96.24,16.8],[95.43,15.73],[95.36,16.14],[94.85,15.78],[94.99,16.25],[94.65,15.85],[94.63,16.34],[94.25,15.96],[94.61,17.55],[93.99,19.46],[93.73,19.93],[93.13,19.84],[93.08,20.55],[92.86,20.12],[92.26,21.05],[92.6,21.98],[93.2,22.26],[93.34,24.08],[94.15,23.86],[95.14,26.61],[96.19,27.27],[97.14,27.09],[96.89,27.61],[97.35,28.22],[97.81,28.34]]]]},"properties":{"name":"Burma"},"id":"MM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[29.23,-3.75],[29.02,-2.74],[29.85,-2.76],[29.95,-2.31],[30.57,-2.4],[30.83,-3.26],[29.42,-4.45],[29.23,-3.75]]]]},"properties":{"name":"Burundi"},"id":"BI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[26.61,55.67],[28.17,56.15],[30.93,55.6],[30.78,54.79],[32.74,53.46],[31.27,53.02],[31.78,52.11],[30.94,52.07],[30.55,51.25],[25.78,51.94],[23.6,51.53],[23.64,52.08],[23.17,52.28],[23.94,52.73],[23.5,53.95],[25.79,54.16],[25.79,54.87],[26.82,55.28],[26.61,55.67]]]]},"properties":{"name":"Belarus"},"id":"BY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[107.49,14.45],[107.55,12.35],[105.85,11.66],[106.2,10.77],[105.1,10.96],[104.45,10.42],[103.62,10.5],[103.56,11.16],[103.13,10.88],[102.92,11.64],[102.38,13.57],[103.18,14.33],[105.21,14.35],[106.06,13.93],[106,14.37],[107.55,14.71],[107.49,14.45]]]]},"properties":{"name":"Cambodia"},"id":"KH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[14.58,12.74],[15.68,9.99],[13.96,9.64],[15.2,8.49],[15.5,7.53],[14.42,6.04],[14.73,4.62],[16.21,2.22],[16.07,1.65],[13.29,2.16],[12.52,2.28],[11.34,2.17],[10.03,2.17],[9.81,2.34],[9.72,3.87],[8.98,4.1],[8.59,4.81],[9.8,6.8],[10.62,7.07],[11.34,6.44],[11.86,7.08],[13.81,11.06],[14.65,11.58],[14.07,13.08],[14.5,13],[14.58,12.74]]]]},"properties":{"name":"Cameroon"},"id":"CM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-127.23,50.64],[-125.45,50.32],[-123.29,48.41],[-125.11,48.73],[-124.81,49.24],[-125.48,48.92],[-125.9,49.44],[-126.54,49.37],[-126.09,49.66],[-127.9,50.11],[-127.41,50.59],[-128.42,50.77],[-127.23,50.64]]],[[[-53.76,48.5],[-52.98,48.6],[-53.95,48.18],[-53.55,47.53],[-52.83,48.1],[-53.27,47.61],[-52.61,47.52],[-53.1,46.64],[-53.62,46.64],[-53.59,47.16],[-54.19,46.82],[-53.87,47.4],[-54.2,47.86],[-55.69,46.86],[-55.98,46.95],[-54.94,47.78],[-55.59,47.4],[-56.17,47.5],[-55.77,47.96],[-56.84,47.52],[-59.41,47.89],[-58.42,48.49],[-59.26,48.48],[-58.4,49.13],[-57.88,48.97],[-58.22,49.39],[-57.7,49.46],[-57.38,50.69],[-55.9,51.63],[-55.41,51.56],[-56.09,51.37],[-55.73,51.08],[-56.85,49.54],[-56.15,50.15],[-55.49,50.01],[-56.13,49.43],[-55.14,49.55],[-55.38,49.04],[-53.78,49.4],[-53.49,49.22],[-54.1,48.81],[-53.76,48.5]],[[-53.76,48.5],[-54.09,48.43],[-54.14,48.36],[-53.76,48.5]]],[[[-85.48,65.79],[-84.92,65.21],[-84.44,65.46],[-81.76,64.5],[-81.99,63.99],[-80.17,63.77],[-81.08,63.45],[-83.07,64.19],[-85.27,63.12],[-85.72,63.72],[-87.19,63.59],[-86.19,64.1],[-86.1,65.53],[-85.48,65.79]]],[[[-95.9,66.95],[-95.22,66.97],[-95.71,67.73],[-95.47,68.06],[-93.55,68.59],[-93.67,68.97],[-94.63,68.76],[-94.3,69.3],[-93.36,69.37],[-96.53,70.13],[-95.79,70.54],[-96.61,70.79],[-96.5,71.28],[-94.61,71.86],[-95.22,71.94],[-93.71,71.76],[-92.97,71.34],[-93.03,70.85],[-91.51,70.17],[-92.92,69.67],[-90.31,69.45],[-91.45,69.35],[-90.44,68.87],[-90.27,68.24],[-89.31,69.25],[-88.05,68.82],[-87.79,68.33],[-88.37,67.96],[-87.51,67.11],[-86.52,67.35],[-85.66,68.73],[-84.53,69.02],[-85.47,69.27],[-85.57,69.86],[-82.26,69.64],[-83.23,69.54],[-81.33,69.18],[-82.06,68.87],[-81.27,68.63],[-82.64,68.5],[-81.24,67.47],[-81.5,67],[-83.4,66.35],[-83.92,66.88],[-84.27,66.72],[-84.37,66.97],[-84.92,67.06],[-84.64,66.98],[-85.23,66.88],[-84.6,66.94],[-83.69,66.19],[-86.78,66.53],[-85.9,66.17],[-87.4,65.32],[-91.43,65.95],[-86.93,65.14],[-88.11,64.14],[-90.12,64.13],[-89.81,63.94],[-90.28,64],[-90.21,63.61],[-92.48,63.81],[-90.63,63.06],[-92.42,62.83],[-91.89,62.6],[-93.62,61.94],[-93.24,61.78],[-93.98,61.46],[-94.82,59.64],[-94.23,58.78],[-94.36,58.22],[-94.14,58.76],[-93.15,58.74],[-92.42,57.34],[-92.88,56.91],[-90.82,57.26],[-85.71,55.63],[-85.12,55.34],[-85.42,54.99],[-82.31,55.15],[-82.3,53.02],[-81.55,52.44],[-81.88,52.19],[-80.44,51.46],[-81.02,51.03],[-80.12,51.3],[-79.33,50.72],[-79.75,51.18],[-79.32,51.66],[-78.85,51.17],[-79.04,51.77],[-78.51,52.46],[-79.05,54.18],[-79.76,54.65],[-77.75,55.3],[-76.53,56.32],[-76.86,57.72],[-78.57,58.64],[-77.77,59.71],[-77.31,59.56],[-77.43,59.91],[-76.76,60.16],[-77.59,60.06],[-77.41,60.54],[-77.83,60.64],[-77.51,60.84],[-78.19,60.79],[-77.47,61.54],[-78.16,62.28],[-77.51,62.56],[-74.57,62.1],[-73.68,62.48],[-72.01,61.68],[-72.3,61.57],[-71.58,61.61],[-71.89,61.43],[-71.39,61.14],[-69.52,61.07],[-69.62,60.07],[-70.95,60.06],[-69.6,59.83],[-69.76,59.32],[-69.23,59.23],[-70.15,58.78],[-69.82,58.59],[-68.36,58.78],[-68.34,58.13],[-69.37,57.77],[-68.4,58.04],[-68,58.58],[-68.13,58.07],[-67.72,58.46],[-67.71,57.92],[-66.39,58.85],[-66.06,58.32],[-65.99,58.9],[-65.32,59.04],[-65.56,59.49],[-64.98,59.38],[-65.53,59.72],[-64.47,60.28],[-64.83,59.99],[-64.17,60.02],[-63.72,59.51],[-64.06,59.38],[-63.36,59.2],[-64.04,59.02],[-62.85,58.69],[-63.59,58.3],[-62.56,58.48],[-63.34,57.98],[-62.45,58.18],[-62.67,57.93],[-61.88,57.63],[-62.55,57.5],[-61.36,57.09],[-61.67,56.62],[-62.57,56.79],[-60.67,55.59],[-60.33,55.78],[-60.68,54.99],[-59.78,55.33],[-59.43,55.14],[-59.94,54.75],[-59.16,55.24],[-59.39,54.98],[-57.35,54.58],[-60.13,53.53],[-60.86,53.79],[-60.1,53.5],[-60.42,53.27],[-57.79,54.07],[-58.18,54.24],[-57.38,54.15],[-57.34,53.44],[-56.46,53.78],[-55.81,53.34],[-56.17,53.03],[-55.76,52.61],[-56.5,52.59],[-55.65,52.44],[-56.2,52.44],[-55.7,52.08],[-56.95,51.42],[-58.63,51.28],[-60.01,50.25],[-66.47,50.26],[-67.38,49.33],[-69.06,48.77],[-71.3,46.74],[-68.21,48.64],[-65,49.22],[-64.22,48.9],[-64.55,48.88],[-64.25,48.49],[-66.84,47.99],[-64.8,47.81],[-65.37,47.09],[-64.8,47.08],[-64.5,46.24],[-62.46,45.61],[-61.92,45.89],[-60.96,45.31],[-64.2,44.58],[-65.48,43.46],[-66.17,43.86],[-65.84,44.58],[-66.19,44.42],[-64.49,45.34],[-64.16,44.98],[-63.36,45.36],[-64.94,45.33],[-64.28,45.8],[-64.75,46.09],[-64.78,45.61],[-67.21,45.18],[-67.8,45.7],[-67.79,47.07],[-69.23,47.47],[-70.88,45.24],[-74.99,44.99],[-76.8,43.63],[-78.72,43.63],[-79.18,43.47],[-78.99,42.82],[-82.7,41.68],[-83.17,42.05],[-82.13,43.59],[-82.54,45.36],[-84.13,46.53],[-88.37,48.31],[-91.42,48.04],[-94.61,48.72],[-95.08,49.36],[-95.15,49],[-122.76,49],[-123.21,49.13],[-122.85,49.44],[-123.24,49.34],[-123.16,49.7],[-123.96,49.51],[-123.53,49.7],[-123.83,50.16],[-123.98,49.8],[-124.77,49.99],[-124.35,50.5],[-125.08,50.32],[-124.81,50.92],[-125.71,50.43],[-126.27,50.63],[-125.62,50.75],[-125.63,51.1],[-126.13,50.68],[-126.56,50.84],[-126.18,50.95],[-127.18,50.93],[-127.03,50.82],[-127.54,51.01],[-126.66,51.19],[-127.79,51.17],[-126.62,51.68],[-127.88,51.67],[-127.17,52.31],[-126.67,51.98],[-126.73,52.37],[-127.19,52.38],[-127.02,52.85],[-128.39,52.29],[-128.13,52.88],[-128.97,53.55],[-127.87,53.24],[-128.81,53.62],[-128.6,54.03],[-129.27,53.38],[-130.05,53.89],[-129.47,54.24],[-130.48,54.36],[-129.96,54.32],[-130.37,54.65],[-129.91,54.61],[-130.17,54.85],[-129.47,55.47],[-130.11,55],[-130.16,55.09],[-129.94,55.28],[-130.1,55.56],[-130.13,55.72],[-130.02,55.91],[-131.82,56.6],[-133.43,58.46],[-135.47,59.8],[-137.48,58.91],[-139.07,60.35],[-141,60.31],[-141,69.64],[-134.31,68.68],[-134.55,69.09],[-132.89,69.65],[-129.4,70.12],[-133.49,68.83],[-132.92,68.69],[-133.35,68.83],[-127.52,70.22],[-128,70.59],[-125.43,69.31],[-124.82,69.71],[-125.2,70],[-124.44,70.15],[-124.5,69.73],[-124.04,69.7],[-124.45,69.37],[-121.68,69.79],[-114.07,68.48],[-115.54,67.92],[-115.1,67.8],[-110.08,68.01],[-108.02,67.29],[-108.62,67.15],[-107.25,66.35],[-107.75,66.92],[-107.08,66.82],[-107.89,68.08],[-106.43,68.15],[-106.47,68.34],[-105.74,68.42],[-105.64,68.63],[-106.54,68.51],[-106.54,68.29],[-107.89,68.27],[-107.6,68.17],[-108.82,68.27],[-106.23,68.94],[-105.49,68.73],[-105.54,68.41],[-104.61,68.24],[-104.5,68.03],[-102.25,67.73],[-98.35,67.8],[-98.62,68.07],[-97.51,67.6],[-97.12,67.79],[-98.71,68.37],[-95.98,68.25],[-96.46,67.48],[-95.33,67.03],[-95.9,66.95]],[[-95.9,66.95],[-96.46,67.06],[-95.63,66.68],[-95.9,66.95]],[[-93.52,63.84],[-92.51,63.82],[-93.78,64.19],[-93.52,63.84]],[[-70.78,48.38],[-69.83,48.17],[-71.05,48.45],[-70.78,48.38]]],[[[-114,72.8],[-114.6,72.6],[-113.03,73.01],[-111.22,72.72],[-111.66,72.28],[-109.78,72.43],[-110.76,72.97],[-109.66,72.92],[-108.62,72.55],[-107.83,71.6],[-107.25,71.9],[-108.29,73.15],[-106.76,73.29],[-105.33,72.75],[-104.36,71.57],[-104.59,71.07],[-101,70.17],[-100.87,69.79],[-103.48,69.69],[-103.02,69.49],[-103.19,69.11],[-102.31,69.5],[-101.75,69.18],[-102.89,68.8],[-105.14,68.9],[-106.6,69.5],[-109.1,68.71],[-113.27,68.45],[-113.52,69.18],[-116.53,69.41],[-117.44,69.99],[-111.49,70.34],[-117.56,70.6],[-118.42,70.99],[-115.06,71.52],[-118.11,71.37],[-117.7,71.67],[-119.13,71.77],[-117.35,72.92],[-114.56,73.38],[-114,72.8]]],[[[-73.35,68.33],[-74.82,69.08],[-76.66,68.7],[-75.59,69.22],[-77.2,69.65],[-76.98,69.94],[-77.63,69.74],[-77.68,70.19],[-79.01,70.68],[-79.59,70.4],[-78.79,69.89],[-81.76,70.12],[-80.95,69.71],[-82.1,70.11],[-83.01,70.3],[-81.71,69.93],[-81.74,69.87],[-82.02,69.87],[-82.14,69.78],[-83.07,70.01],[-85.82,70],[-86.55,70.23],[-86.37,70.53],[-87.92,70.24],[-89.55,71.09],[-87,70.99],[-89.83,71.33],[-90.05,71.95],[-88.41,73.52],[-85.07,73.8],[-86.73,72.72],[-86.24,72.42],[-86.42,72.01],[-84.83,71.27],[-86.82,70.99],[-84.8,70.92],[-84.63,71.67],[-86.05,72.01],[-84.16,72.02],[-85.69,72.89],[-83.95,72.75],[-85.45,73.12],[-83.63,72.98],[-85.19,73.23],[-81.55,73.72],[-80.25,72.73],[-81.38,72.24],[-80.52,72.5],[-80.97,71.88],[-79.67,72.13],[-80.17,72.32],[-79.8,72.5],[-79.01,72.27],[-79.2,71.96],[-77.79,71.79],[-78.87,72.23],[-77,72.13],[-78.56,72.44],[-77.61,72.75],[-75.19,72.49],[-74.95,72.25],[-76.35,71.89],[-74.12,71.98],[-75.39,71.68],[-74.63,71.66],[-75.08,71.18],[-73.75,71.78],[-74.24,71.2],[-73.62,71.58],[-73.38,71.39],[-73.9,71.06],[-73.05,71.27],[-73.38,70.98],[-72.54,71.66],[-71.12,71.26],[-72.57,70.61],[-70.6,71.05],[-71.8,70.43],[-71.16,70.53],[-71.54,70.02],[-69.9,70.88],[-70.5,70.48],[-68.31,70.56],[-70.47,69.84],[-67.79,70.26],[-67.13,69.73],[-70.03,69.54],[-66.8,69.34],[-69.02,69.35],[-68.08,69.22],[-69.03,68.97],[-68.18,69.15],[-67.71,69.02],[-68.56,68.96],[-67.77,68.78],[-69.4,68.86],[-68.04,68.68],[-68.9,68.6],[-68.47,68.61],[-68.71,68.57],[-67.5,68.54],[-67.61,68.38],[-66.71,68.44],[-67.88,68.27],[-67.23,68.36],[-67.01,68.32],[-67.6,68.16],[-67.01,68.29],[-66.77,68.24],[-66.95,68.01],[-66.18,68.02],[-66.73,67.87],[-66.36,67.82],[-65.91,68.16],[-66.01,67.63],[-64.72,67.99],[-65.2,67.65],[-64.51,67.81],[-63.9,67.31],[-64.8,67.36],[-63.96,67.27],[-64.69,67],[-63.11,67.33],[-63.77,66.81],[-62.1,67.05],[-61.26,66.63],[-62.9,66.33],[-61.95,66.02],[-62.97,66.15],[-62.32,65.81],[-63.72,65.68],[-63.32,65.59],[-63.55,64.89],[-65.51,65.74],[-64.36,66.35],[-65.92,65.95],[-65.47,66.39],[-66.07,66.12],[-67.05,66.64],[-67.74,66.57],[-67.28,66.28],[-67.99,66.51],[-67.19,65.91],[-68.85,66.19],[-64.66,64.03],[-64.99,63.82],[-64.53,63.25],[-65.3,63.81],[-64.63,62.9],[-65.25,62.99],[-65.19,62.56],[-66.64,63.37],[-66.55,62.99],[-67.91,63.76],[-67.69,63.37],[-69,63.75],[-65.99,62.24],[-66.07,61.87],[-71.4,63.05],[-72.15,63.45],[-71.23,63.6],[-72.32,63.68],[-73.38,64.27],[-73.3,64.66],[-74.06,64.33],[-74.64,64.9],[-74.99,64.8],[-74.69,64.37],[-75.82,64.61],[-76.67,64.18],[-78.18,64.57],[-77.42,65.46],[-75.77,65.22],[-75.37,64.71],[-75.19,65.1],[-75.95,65.32],[-73.5,65.47],[-74.47,66.15],[-72.26,67.25],[-73.35,68.33]],[[-73.35,68.33],[-73.21,68.38],[-73.32,68.39],[-73.35,68.33]]],[[[-99.8,73.89],[-96.96,73.74],[-98.45,72.87],[-96.52,72.71],[-96.3,72.42],[-96.87,72.04],[-96.49,71.91],[-98.27,71.9],[-98.04,71.53],[-98.73,71.27],[-102.74,72.72],[-102.14,73.09],[-100.41,72.74],[-100.03,72.93],[-100.58,73.17],[-99.77,73.21],[-101.62,73.49],[-100.43,73.41],[-101.12,73.73],[-99.8,73.89]]],[[[-92.64,74.1],[-90.19,73.9],[-92.1,72.74],[-94.32,72.76],[-93.46,72.46],[-94.06,71.98],[-95.21,71.99],[-94.75,72.15],[-95.67,72.81],[-95.67,73.72],[-92.64,74.1]]],[[[-120.15,74.27],[-117.42,74.23],[-115.32,73.48],[-119.14,72.63],[-120.25,72.26],[-120.54,71.52],[-122.78,71.09],[-126,71.97],[-123.77,73.76],[-124.77,74.34],[-120.15,74.27]]],[[[-94.36,75.59],[-93.49,75.26],[-93.47,74.7],[-96.62,74.99],[-94.36,75.59]]],[[[-98.42,76.67],[-97.51,76.19],[-97.94,75.74],[-97.28,75.4],[-98.17,75.33],[-97.58,75.14],[-100.15,74.99],[-100.78,75.35],[-98.95,75.71],[-102.88,75.62],[-101.18,75.78],[-101.91,76.08],[-101.39,76.25],[-102.17,76.24],[-101.89,76.44],[-99.89,75.89],[-99.44,75.97],[-100.15,76.13],[-99.41,76.16],[-100.98,76.5],[-98.42,76.67]]],[[[-108.65,76.81],[-108.08,76.28],[-108.4,76.05],[-107.63,75.99],[-108.02,75.78],[-106.34,76.05],[-105.39,75.64],[-106.01,75.05],[-112.75,74.4],[-114.45,74.67],[-110.91,75.23],[-117.68,75.25],[-115,75.69],[-117.25,75.6],[-114.82,75.88],[-116.73,75.92],[-114.66,76.16],[-115.93,76.29],[-114.9,76.52],[-112.45,76.18],[-111.25,75.52],[-108.9,75.48],[-110.06,75.89],[-109.31,76.11],[-110.39,76.39],[-108.65,76.81]]],[[[-95.66,77.06],[-93.18,76.74],[-93.55,76.39],[-91.41,76.69],[-89.29,76.3],[-91.61,76.26],[-88.95,75.43],[-81.54,75.81],[-79.57,75.45],[-80.44,75.04],[-79.33,74.89],[-81.81,74.46],[-83.51,74.9],[-83.47,74.58],[-84.29,74.5],[-88.5,74.5],[-88.55,74.91],[-91.54,74.65],[-92.49,75.21],[-92.11,75.86],[-93.08,76.36],[-95.38,76.23],[-94.8,76.32],[-96.96,76.73],[-95.66,77.06]]],[[[-116.35,77.54],[-115.39,77.31],[-116.28,77.18],[-115.9,76.69],[-117.1,76.3],[-118.06,76.41],[-117.84,76.82],[-118.97,76.51],[-118.57,76.34],[-119.08,76.08],[-119.65,76.3],[-119.48,75.97],[-119.87,75.86],[-123.04,76.08],[-119.15,77.33],[-116.35,77.54]]],[[[-96.77,78.68],[-94.89,78.1],[-97.1,77.8],[-97.78,78.03],[-96.87,78.13],[-98.41,78.5],[-96.77,78.68]]],[[[-103.59,79.33],[-99.95,78.73],[-98.95,78.06],[-99.91,77.78],[-104.47,78.27],[-105.05,78.49],[-103.32,78.73],[-105.63,79.16],[-103.59,79.33]]],[[[-92.73,81.31],[-88.78,80.13],[-87.68,80.41],[-88.07,80.12],[-86.96,79.9],[-87.46,79.53],[-84.9,79.27],[-87.62,78.65],[-88,78.81],[-87.72,79.08],[-88.16,78.99],[-87.91,78.55],[-88.8,78.61],[-88.82,78.15],[-89.98,78.61],[-89.45,78.16],[-92.06,78.21],[-92.99,78.47],[-91.64,78.55],[-94.29,78.99],[-90.36,79.25],[-95.09,79.27],[-95.78,79.43],[-94.28,79.76],[-95.85,79.65],[-96.8,80.09],[-94.38,79.98],[-94.75,80.08],[-94.08,80.18],[-96.68,80.34],[-93.79,80.53],[-95.53,80.82],[-93.09,81.16],[-94.27,81.35],[-92.73,81.31]]],[[[-70.11,83.11],[-66.3,82.93],[-68.64,82.63],[-64.73,82.9],[-61.08,82.32],[-64.36,81.73],[-69.29,81.72],[-66.61,81.51],[-70.21,81.17],[-64.44,81.48],[-69.43,80.38],[-70.83,80.56],[-70.15,80.19],[-72.42,80.21],[-70.5,80.08],[-71.46,79.9],[-71.18,79.78],[-78.05,79.35],[-74.44,79.06],[-78.89,79.06],[-74.72,78.71],[-76.69,78.51],[-75.06,78.31],[-76.91,78.2],[-75.58,78.11],[-75.92,77.96],[-78.26,78],[-77.72,77.61],[-78.69,77.32],[-81.93,77.68],[-81.17,77.34],[-82.17,77.29],[-81.83,77.16],[-77.78,76.79],[-81.05,76.13],[-80.77,76.42],[-82.73,76.82],[-82.13,76.44],[-89.68,76.57],[-86.74,77.17],[-88.07,77.82],[-84.48,77.29],[-84.61,77.39],[-83.46,77.35],[-83.84,77.46],[-82.32,78.07],[-83.9,77.49],[-84.78,77.52],[-84.43,77.72],[-84.95,77.6],[-85.35,77.73],[-85.05,77.83],[-85.4,77.82],[-84.33,77.9],[-85.68,77.93],[-84.13,78.17],[-84.97,78.2],[-84.64,78.59],[-85.49,78.1],[-87.54,78.14],[-86.86,78.73],[-82.34,78.57],[-83.25,78.83],[-81.48,79.05],[-84.75,79.03],[-83.36,79.05],[-86.49,79.76],[-85.26,79.92],[-86.51,80.3],[-79.9,79.65],[-83.2,80.32],[-78.04,80.57],[-79.96,80.61],[-76.48,80.87],[-78.93,80.88],[-76.75,81.44],[-80.92,80.66],[-85.07,80.51],[-86.74,80.6],[-82.36,81.18],[-87.59,80.63],[-89.47,80.91],[-84.73,81.28],[-89.82,81.01],[-90.35,81.17],[-87.24,81.49],[-91.96,81.66],[-88.08,82.1],[-84.6,81.89],[-86.88,82.2],[-85.05,82.48],[-79.23,81.82],[-82.73,82.4],[-80.58,82.55],[-81.47,82.82],[-78.5,82.68],[-80.43,82.89],[-79.79,82.96],[-75.89,82.59],[-76.23,82.44],[-75.4,82.61],[-77.38,82.99],[-72.63,82.69],[-73.65,82.93],[-70.11,83.11]]]]},"properties":{"name":"Canada"},"id":"CA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-24.37,14.81],[-24.53,14.92],[-24.38,15.05],[-24.37,14.81]]],[[[-23.45,14.98],[-23.68,14.94],[-23.77,15.25],[-23.45,14.98]]],[[[-22.71,16.04],[-22.96,16.09],[-22.8,16.24],[-22.71,16.04]]],[[[-24.03,16.59],[-24.32,16.48],[-24.43,16.64],[-24.03,16.59]]],[[[-25.28,16.91],[-25.33,17.1],[-24.97,17.11],[-25.28,16.91]]]]},"properties":{"name":"Cape Verde"},"id":"CV"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-81.1,19.31],[-81.4,19.29],[-81.25,19.35],[-81.1,19.31]]]]},"properties":{"name":"Cayman Islands"},"id":"KY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[19.06,8.58],[18.99,8.96],[20.37,9.11],[21.72,10.64],[22.87,10.92],[23.67,9.87],[23.52,8.71],[25.25,7.85],[27.46,5.02],[25.89,5.19],[22.9,4.82],[22.38,4.13],[20.59,4.41],[19.42,5.13],[18.54,4.34],[18.62,3.48],[16.66,3.53],[16.21,2.22],[14.73,4.62],[14.42,6.04],[15.5,7.53],[18.59,8.04],[19.06,8.58]]]]},"properties":{"name":"Central African Republic"},"id":"CF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[80.27,9.78],[80.82,9.26],[81.13,8.5],[81.36,8.49],[81.88,7.29],[81.66,6.44],[80.59,5.92],[80.05,6.24],[79.7,8.08],[80.05,9.59],[80.61,9.44],[79.93,9.74],[80.27,9.78]]]]},"properties":{"name":"Sri Lanka"},"id":"LK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[14.5,13],[14.07,13.08],[13.63,13.72],[13.47,14.46],[15.49,16.91],[16,20.35],[15.2,21.5],[15,23],[16,23.45],[24,19.5],[24,15.7],[22.94,15.56],[21.83,12.8],[22.47,12.62],[22.87,10.92],[21.72,10.64],[20.37,9.11],[18.99,8.96],[19.06,8.58],[18.59,8.04],[15.5,7.53],[15.2,8.49],[13.96,9.64],[15.68,9.99],[14.58,12.74],[14.5,13]]]]},"properties":{"name":"Chad"},"id":"TD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-68.4,-54.96],[-69.06,-55.06],[-68.21,-55.27],[-68.75,-55.27],[-68.16,-55.4],[-68.05,-55.71],[-68.38,-55.48],[-68.94,-55.46],[-68.78,-55.38],[-68.91,-55.34],[-68.8,-55.19],[-69.43,-55.16],[-69.17,-55.51],[-70.03,-55.16],[-68.4,-54.96]]],[[[-67.78,-54.92],[-67.05,-55.14],[-68.36,-54.94],[-67.78,-54.92]]],[[[-71.26,-54.08],[-71.12,-54.38],[-71.7,-54.16],[-71.26,-54.08]]],[[[-71.67,-53.94],[-71.85,-54.34],[-72.26,-53.94],[-71.67,-53.94]]],[[[-70.44,-53.86],[-70.37,-54.04],[-70.67,-53.93],[-70.52,-54.23],[-70.88,-54.05],[-70.53,-53.56],[-70.44,-53.86]]],[[[-72.91,-53.43],[-72.14,-53.8],[-72.87,-54.14],[-72.73,-53.84],[-73.59,-53.76],[-72.91,-53.43]]],[[[-74.36,-52.95],[-74.75,-52.76],[-73.09,-53.35],[-74.36,-52.95]]],[[[-70.92,-54.71],[-70.77,-54.68],[-70.87,-54.69],[-70.92,-54.71],[-72,-54.46],[-70.13,-54.55],[-70.88,-54.13],[-70.14,-54.43],[-70.06,-54.25],[-69.77,-54.56],[-69.86,-54.28],[-69.24,-54.45],[-69.38,-54.69],[-69.18,-54.58],[-69.16,-54.46],[-68.99,-54.43],[-70.04,-54.1],[-70.18,-53.81],[-69.36,-53.35],[-70.45,-53.37],[-70.1,-52.9],[-70.42,-52.77],[-68.62,-52.64],[-68.64,-54.79],[-70.92,-54.71]]],[[[-74.26,-51.25],[-74.32,-50.92],[-74.19,-51.2],[-74.26,-51.25]]],[[[-74.4,-50.86],[-74.41,-51.09],[-74.96,-50.97],[-74.4,-50.86]]],[[[-74.69,-50.89],[-74.95,-50.73],[-74.75,-50.7],[-74.69,-50.89]]],[[[-74.36,-50.49],[-74.19,-50.85],[-74.67,-50.48],[-74.36,-50.49]]],[[[-75.05,-50.17],[-75.46,-50.36],[-75.4,-50.04],[-75.05,-50.17]]],[[[-75.29,-49.1],[-75.66,-49.22],[-75.36,-48.99],[-75.29,-49.1]]],[[[-74.61,-48.46],[-74.41,-49.73],[-74.77,-50.06],[-74.65,-49.36],[-75.02,-49.9],[-75.47,-49.33],[-74.92,-49.34],[-75.05,-48.8],[-74.61,-48.7],[-75.03,-48.5],[-74.74,-48.12],[-74.61,-48.46]]],[[[-75.24,-48.27],[-75.23,-48.71],[-75.58,-48.09],[-75.24,-48.27]]],[[[-74.93,-48.16],[-75.04,-48.44],[-75.26,-48.07],[-74.93,-48.16]]],[[[-74.46,-45.78],[-74.39,-45.44],[-74.21,-45.64],[-74.46,-45.78]]],[[[-73.65,-45.76],[-73.78,-45.67],[-73.7,-45.44],[-73.65,-45.76]]],[[[-74.02,-45.43],[-73.82,-45.48],[-74.14,-45.58],[-74.02,-45.43]]],[[[-73.98,-45.27],[-73.78,-45.34],[-74.17,-45.25],[-73.98,-45.27]]],[[[-73.85,-45],[-73.73,-45.28],[-74.24,-45.16],[-73.85,-45]]],[[[-74.21,-44.78],[-74.41,-44.63],[-73.87,-44.69],[-74.21,-44.78]]],[[[-72.72,-44.55],[-72.98,-44.61],[-72.83,-44.69],[-73.22,-44.94],[-73.41,-44.82],[-73.21,-44.8],[-73.39,-44.79],[-73.46,-44.64],[-73.23,-44.42],[-72.72,-44.55]]],[[[-73.89,-41.82],[-73.37,-42.25],[-73.82,-42.51],[-73.49,-43.11],[-73.86,-43.4],[-74.41,-43.24],[-73.89,-41.82]]],[[[-69.48,-17.64],[-68.44,-19.43],[-68.76,-20.41],[-67.88,-22.83],[-67.18,-22.82],[-67.34,-24.02],[-68.57,-24.77],[-68.29,-26.92],[-69.66,-28.4],[-69.83,-30.19],[-70.53,-31.19],[-69.81,-34.24],[-70.57,-35.25],[-70.42,-36.14],[-71.19,-36.84],[-70.82,-38.57],[-71.7,-39.58],[-71.73,-42.1],[-72.13,-42.29],[-71.86,-44.37],[-71.11,-44.54],[-72.08,-44.77],[-71.3,-45.29],[-71.78,-45.65],[-71.67,-46.68],[-72.36,-47.47],[-72.56,-48.8],[-73.58,-49.54],[-73.17,-50.75],[-72.29,-50.65],[-72.4,-51.51],[-71.91,-52],[-68.44,-52.38],[-70.81,-52.73],[-71.28,-53.89],[-72.45,-53.4],[-71.8,-53.52],[-71.17,-52.81],[-72.55,-53.07],[-72.19,-53.18],[-72.65,-53.32],[-72.4,-53.54],[-73.22,-53.23],[-71.48,-52.63],[-72.8,-52.54],[-72.98,-53.07],[-73.45,-53.01],[-72.89,-52.52],[-73.69,-52.73],[-73.73,-52.03],[-73.33,-52.22],[-72.99,-52.07],[-72.86,-52.26],[-72.78,-52.06],[-72.94,-52.09],[-72.7,-51.98],[-72.9,-52.46],[-72.47,-51.79],[-73.24,-51.46],[-72.56,-51.78],[-73.28,-51.61],[-72.92,-51.86],[-73.24,-52.09],[-73.39,-51.66],[-73.28,-52.16],[-73.56,-52.05],[-73.64,-51.82],[-73.4,-52.02],[-73.46,-51.69],[-73.91,-51.62],[-73.89,-51.37],[-73.6,-51.62],[-73.71,-51.16],[-74.25,-50.94],[-73.53,-50.71],[-73.72,-50.56],[-73.57,-50.4],[-74.05,-50.83],[-74.29,-50.48],[-73.88,-50.54],[-74.69,-50.2],[-73.87,-50.29],[-74.33,-49.63],[-73.71,-49.76],[-74.11,-49.48],[-73.83,-49.03],[-74.37,-49.43],[-74.02,-48.41],[-74.65,-48.02],[-73.22,-48],[-73.72,-47.53],[-73.93,-47.85],[-74.74,-47.72],[-74.04,-47.62],[-74.53,-47.44],[-73.93,-47.04],[-74.27,-46.79],[-75.01,-46.75],[-74.94,-46.44],[-75.41,-46.93],[-75.72,-46.73],[-74.36,-45.79],[-74.14,-45.81],[-73.97,-46.09],[-74.08,-46.19],[-74.31,-46.25],[-74.49,-46.19],[-74.34,-46.27],[-74.05,-46.2],[-74,-46.29],[-73.85,-46.35],[-74.02,-46.22],[-73.88,-46.14],[-73.76,-46.24],[-73.77,-46.3],[-73.81,-46.39],[-74,-46.56],[-73.91,-46.6],[-73.84,-46.59],[-73.18,-45.67],[-73.59,-45.78],[-73.52,-45.46],[-72.83,-45.42],[-73.39,-44.98],[-73.14,-44.94],[-72.77,-44.75],[-72.61,-44.47],[-73.29,-44.14],[-72.54,-42.56],[-72.85,-42.28],[-72.42,-42.45],[-72.86,-41.91],[-72.31,-41.44],[-73.75,-41.75],[-73.49,-41.52],[-74,-40.97],[-73.22,-39.41],[-73.64,-37.21],[-73.19,-37.14],[-71.44,-32.64],[-71.52,-28.97],[-70.45,-25.36],[-70.62,-23.49],[-70.05,-21.43],[-70.41,-18.35],[-69.5,-17.51],[-69.48,-17.64]],[[-74.07,-46.01],[-74.16,-46.14],[-74.07,-46.1],[-74.07,-46.01]]]]},"properties":{"name":"Chile"},"id":"CL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[110.72,20.06],[111.03,19.64],[110.05,18.38],[108.69,18.51],[108.63,19.28],[109.26,19.9],[110.72,20.06]]],[[[123.38,53.53],[126.1,52.76],[127.53,49.79],[130.67,48.86],[130.99,47.69],[134.74,48.27],[133.12,45.13],[131.86,45.35],[130.95,44.84],[131.31,43.39],[130.41,42.72],[130.6,42.42],[129.91,43.01],[129.71,42.44],[128.06,42],[128.16,41.38],[126.91,41.8],[124.37,40.09],[121.15,38.72],[121.75,39.35],[121.23,39.54],[122.3,40.51],[121.18,40.92],[118.92,39.13],[117.74,39.1],[117.67,38.39],[118.84,38.15],[119.23,37.14],[120.74,37.84],[122.56,37.4],[122.5,36.89],[120.09,36.2],[119.18,34.88],[120.25,34.31],[120.84,32.64],[121.9,31.75],[119.63,32.26],[121.88,30.97],[120.15,30.19],[122.13,29.89],[121.45,29.51],[121.98,29.59],[121.41,29.16],[121.61,28.72],[121.14,28.84],[121.58,28.27],[120.59,28.08],[120.84,27.88],[120.13,26.64],[119.55,26.75],[119.94,26.35],[119.09,26.14],[119.71,25.99],[119.65,25.36],[119.31,25.61],[118.62,24.54],[117.79,24.46],[118.12,24.26],[116.52,23.42],[116.48,22.94],[114.22,22.55],[114.03,22.51],[113.48,23.05],[113.55,22.21],[113.53,22.19],[113.17,22.57],[113.39,22.18],[112.94,21.87],[110.4,21.38],[110.28,20.25],[109.92,20.23],[109.57,21.72],[109.14,21.4],[108.48,21.94],[107.99,21.54],[106.69,22.03],[106.71,22.86],[105.58,23.06],[105.35,23.33],[103.96,22.5],[102.48,22.77],[102.14,22.4],[101.57,22.21],[101.79,21.14],[101.15,21.57],[100.21,21.43],[99.96,22.05],[99.16,22.16],[99.57,22.94],[98.93,23.19],[98.89,24.16],[97.54,23.94],[97.55,24.74],[98.71,25.86],[98.78,26.64],[98.7,27.54],[97.81,28.34],[97.35,28.22],[96.4,28.35],[96.62,28.79],[96.08,29.47],[95.39,29.04],[94.65,29.33],[92.54,27.86],[91.66,27.76],[90.47,28.07],[89.59,28.14],[88.92,27.32],[88.83,28.01],[88.14,27.87],[86.01,27.88],[82.1,30.34],[81.03,30.2],[78.77,31.31],[78.4,32.55],[79.53,32.75],[78.08,35.45],[77.82,35.5],[76.17,35.82],[75.86,36.66],[74.82,37.02],[74.57,37.03],[74.92,37.24],[74.86,38.47],[73.82,38.61],[73.66,39.45],[74.86,40.52],[76.35,40.35],[76.87,41.01],[78.08,41.04],[80.23,42.2],[80.38,43.03],[80.82,43.16],[80.52,44.73],[79.87,44.9],[82.56,45.13],[82.32,45.57],[83.04,47.21],[85.53,47.06],[85.76,48.39],[87.35,49.09],[87.84,49.17],[88.65,48.18],[90.07,47.89],[91.02,46.6],[90.9,45.25],[95.42,44.29],[96.38,42.73],[100.84,42.68],[105.01,41.58],[107.47,42.47],[110.44,42.78],[111.96,43.69],[111.42,44.38],[111.98,45.09],[113.64,44.75],[117.42,46.58],[119.9,46.68],[118.54,47.99],[117.37,47.65],[115.59,47.92],[116.71,49.83],[117.87,49.52],[119.21,50.02],[120.78,52.11],[120.03,52.77],[120.86,53.28],[123.38,53.53]]]]},"properties":{"name":"China"},"id":"CN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[121.73,25.14],[121.84,24.48],[120.72,21.93],[120.11,23.62],[121.01,25.01],[121.73,25.14]]]]},"properties":{"name":"Taiwan"},"id":"TW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[105.7,-10.51],[105.63,-10.44],[105.74,-10.38],[105.7,-10.51]]]]},"properties":{"name":"Christmas Island"},"id":"CX"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[96.86,-12.2],[96.82,-12.18],[96.83,-12.13],[96.86,-12.2]]]]},"properties":{"name":"Cocos (Keeling) Islands"},"id":"CC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-71.56,12.45],[-71.32,11.85],[-71.98,11.66],[-72.49,11.12],[-73.38,9.17],[-72.78,9.08],[-72,7.02],[-70.12,6.98],[-69.25,6.08],[-67.45,6.19],[-67.86,4.56],[-67.29,3.4],[-67.83,2.83],[-67.19,2.39],[-66.87,1.22],[-67.42,2.14],[-67.91,1.75],[-69.85,1.71],[-69.84,1.07],[-69.12,0.65],[-70.04,0.59],[-69.38,-1.34],[-69.96,-4.24],[-70.72,-3.78],[-70.29,-2.51],[-71.7,-2.15],[-72.88,-2.51],[-73.56,-1.37],[-75.29,-0.12],[-77.38,0.38],[-78.59,1.24],[-78.81,1.44],[-78.57,2.43],[-77.74,2.6],[-77.03,3.92],[-77.43,4.03],[-77.34,6.57],[-77.89,7.23],[-77.22,7.94],[-77.37,8.67],[-76.76,7.92],[-76.93,8.57],[-75.63,9.45],[-75.27,10.8],[-74.86,11.13],[-74.39,10.74],[-74.16,11.33],[-73.28,11.3],[-71.56,12.45]]]]},"properties":{"name":"Colombia"},"id":"CO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[44.49,-12.09],[44.51,-12.38],[44.21,-12.16],[44.49,-12.09]]],[[[43.46,-11.94],[43.22,-11.76],[43.28,-11.38],[43.46,-11.94]]]]},"properties":{"name":"Comoros"},"id":"KM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[45.2,-12.85],[45.1,-12.99],[45.08,-12.66],[45.2,-12.85]]]]},"properties":{"name":"Mayotte"},"id":"YT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[12.78,-4.39],[12.03,-5.01],[11.14,-3.93],[11.93,-3.64],[11.57,-2.33],[12.48,-2.33],[12.65,-1.82],[13,-2.37],[13.76,-2.09],[14.11,-2.49],[14.43,-1.89],[14.52,-0.61],[13.85,-0.2],[14.49,0.91],[14.19,1.39],[13.19,1.22],[13.29,2.16],[16.07,1.65],[16.21,2.22],[16.66,3.53],[18.62,3.48],[17.71,-0.54],[16.2,-2.18],[15.89,-3.94],[14.66,-4.91],[14.4,-4.28],[13.41,-4.88],[13.09,-4.63],[12.78,-4.39]]]]},"properties":{"name":"Congo, Republic of the"},"id":"CG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[25.89,5.19],[27.46,5.02],[28.36,4.29],[29.64,4.64],[30.86,3.49],[30.73,2.45],[31.3,2.12],[29.96,0.83],[29.6,-1.39],[29.02,-2.74],[29.23,-3.75],[29.42,-4.45],[29.55,-6.3],[30.77,-8.19],[28.9,-8.48],[28.37,-9.26],[28.7,-10.65],[28.36,-11.55],[29.03,-12.38],[29.81,-12.16],[29.8,-13.45],[29.02,-13.4],[27.2,-11.57],[26.87,-11.97],[26,-11.9],[25.33,-11.19],[24.45,-11.46],[23.99,-10.87],[22.25,-11.21],[21.78,-7.28],[19.54,-7],[19.37,-8],[17.62,-8.1],[16.58,-5.9],[14,-5.85],[13.18,-5.86],[12.21,-5.77],[13.09,-4.66],[13.09,-4.63],[13.41,-4.88],[14.4,-4.28],[14.66,-4.91],[15.89,-3.94],[16.2,-2.18],[17.71,-0.54],[18.62,3.48],[18.54,4.34],[19.42,5.13],[20.59,4.41],[22.38,4.13],[22.9,4.82],[25.89,5.19]]]]},"properties":{"name":"Congo, Democratic Republic of the"},"id":"CD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-157.89,-21.94],[-157.96,-21.9],[-157.92,-21.88],[-157.89,-21.94]]],[[[-159.74,-21.25],[-159.83,-21.2],[-159.75,-21.19],[-159.74,-21.25]]],[[[-157.32,-20.19],[-157.33,-20.13],[-157.31,-20.15],[-157.32,-20.19]]]]},"properties":{"name":"Cook Islands"},"id":"CK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-85.09,11.01],[-83.65,10.92],[-82.56,9.56],[-82.93,9.47],[-82.9,8.03],[-84.74,9.97],[-85.24,10.2],[-85.14,9.59],[-85.66,9.91],[-85.69,11.08],[-85.09,11.01]]]]},"properties":{"name":"Costa Rica"},"id":"CR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[17.3,43.01],[17.65,42.89],[18.46,42.57],[18.5,42.45],[17.3,43.01]]],[[[16.85,43.27],[16.4,43.33],[16.75,43.36],[16.85,43.27]]],[[[14.46,44.91],[14.49,44.61],[14.29,44.91],[14.4,44.92],[14.32,45.17],[14.46,44.91]]],[[[14.76,44.94],[14.43,45.08],[14.54,45.24],[14.76,44.94]]],[[[16.57,46.48],[16.61,46.48],[17.67,45.83],[18.82,45.91],[19.42,45.23],[19.04,44.86],[15.79,45.17],[16.14,44.2],[17.58,42.94],[16.88,43.4],[15.99,43.5],[14.48,45.31],[14.29,45.32],[14.17,44.98],[13.9,44.77],[13.59,45.48],[15.17,45.43],[15.65,46.22],[16.57,46.48]]]]},"properties":{"name":"Croatia"},"id":"HR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-82.55,21.57],[-83.19,21.62],[-82.97,21.94],[-82.55,21.57]]],[[[-82,23.19],[-80.03,22.95],[-74.13,20.19],[-77.72,19.83],[-77.24,20.66],[-78.05,20.7],[-78.75,21.64],[-81.82,22.18],[-82.16,22.4],[-81.65,22.49],[-81.89,22.68],[-82.76,22.7],[-83.37,22.2],[-83.93,22.16],[-84.03,21.91],[-84.95,21.86],[-84.34,22.01],[-84.4,22.33],[-84.08,22.66],[-82,23.19]]]]},"properties":{"name":"Cuba"},"id":"CU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[33.65,35.35],[34.59,35.69],[33.03,34.56],[32.27,35.04],[33.65,35.35]]]]},"properties":{"name":"Cyprus"},"id":"CY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[14.7,48.58],[13.83,48.77],[12.09,50.32],[14.83,50.87],[16.34,50.66],[16.64,50.11],[17.72,50.32],[18.85,49.52],[16.95,48.62],[15.03,49.02],[14.7,48.58]]]]},"properties":{"name":"Czech Republic"},"id":"CZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[2.48,6.34],[1.64,6.22],[1.4,9.43],[0.78,10.38],[0.92,11],[2.4,11.9],[2.84,12.4],[3.6,11.69],[3.86,10.58],[2.79,9.04],[2.72,6.37],[2.48,6.34]]]]},"properties":{"name":"Benin"},"id":"BJ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[10.75,55.48],[10.5,55.03],[9.68,55.5],[10.75,55.48]]],[[[12.57,55.99],[12.07,54.97],[10.87,55.73],[12.57,55.99]]],[[[8.92,56.92],[8.77,56.69],[8.51,56.74],[8.92,56.92]]],[[[9.97,57.07],[10.31,56.98],[10.31,56.75],[9.87,56.65],[10.96,56.44],[9.55,55.71],[9.77,54.89],[9.45,54.83],[8.66,54.91],[8.62,55.43],[8.09,55.55],[8.17,56.65],[8.73,56.48],[8.68,56.62],[9.08,56.81],[9.15,56.7],[9.06,56.57],[9.27,56.63],[9.32,56.53],[9.18,56.92],[9.97,57.07]]],[[[10.43,57.59],[10.34,56.99],[10.01,57.09],[9.12,57.05],[8.67,56.95],[8.42,56.68],[8.59,56.69],[8.55,56.58],[8.24,56.71],[8.62,57.12],[9.39,57.15],[9.95,57.58],[10.65,57.74],[10.43,57.59]]]]},"properties":{"name":"Denmark"},"id":"DK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-61.36,15.2],[-61.45,15.63],[-61.25,15.46],[-61.36,15.2]]]]},"properties":{"name":"Dominica"},"id":"DM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-70.78,19.85],[-69.22,19.36],[-69.63,19.1],[-68.73,18.95],[-68.45,18.36],[-70.69,18.43],[-71.42,17.6],[-71.77,18.04],[-71.75,19.71],[-70.78,19.85]]]]},"properties":{"name":"Dominican Republic"},"id":"DO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-91.22,-0.01],[-90.81,-0.73],[-91.38,-1.03],[-91.08,-0.59],[-91.61,0],[-91.22,-0.01]]],[[[-78.59,1.24],[-77.38,0.38],[-75.29,-0.12],[-75.63,-0.11],[-75.22,-0.97],[-75.56,-1.53],[-78.34,-3.42],[-78.71,-4.58],[-79.05,-5.01],[-79.65,-4.43],[-80.47,-4.44],[-80.34,-3.38],[-79.76,-2.01],[-80.26,-2.74],[-80.89,-2.32],[-80.91,-1.03],[-80.26,-0.63],[-80.06,0.83],[-78.81,1.44],[-78.59,1.24]]]]},"properties":{"name":"Ecuador"},"id":"EC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-89.34,14.42],[-87.75,13.86],[-87.82,13.41],[-88.54,13.19],[-90.1,13.75],[-89.35,14.43],[-89.34,14.42]]]]},"properties":{"name":"El Salvador"},"id":"SV"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[10.03,2.17],[11.34,2.17],[11.35,1],[9.8,1],[9.36,1.17],[9.81,2.34],[10.03,2.17]]]]},"properties":{"name":"Equatorial Guinea"},"id":"GQ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[36.54,14.26],[37.29,14.45],[37.57,14.1],[37.91,14.88],[38.45,14.42],[40.23,14.44],[42.4,12.47],[41.79,11.01],[42.94,11],[42.85,10.22],[44.01,9.01],[47.99,8],[44.95,4.9],[43.69,4.89],[41.91,3.98],[40.78,4.29],[39.52,3.41],[35.94,4.62],[34.7,6.68],[32.99,7.92],[33.25,8.46],[34.12,8.58],[34.29,10.55],[34.86,10.73],[35.1,11.83],[36.14,12.71],[36.54,14.26]]]]},"properties":{"name":"Ethiopia"},"id":"ET"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[38.8,17.65],[39.72,15.08],[39.88,15.49],[41.17,14.63],[43.12,12.71],[42.4,12.47],[40.23,14.44],[38.45,14.42],[37.91,14.88],[37.57,14.1],[37.29,14.45],[36.54,14.26],[37,17.07],[38.6,17.99],[38.8,17.65]]]]},"properties":{"name":"Eritrea"},"id":"ER"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[22.99,58.6],[23.33,58.44],[21.99,57.92],[21.83,58.5],[22.99,58.6]]],[[[22.75,59],[23.05,58.84],[22.04,58.94],[22.75,59]]],[[[25.78,59.63],[28.02,59.48],[27.43,58.81],[27.82,57.87],[27.37,57.54],[25.29,58.08],[24.31,57.87],[24.56,58.33],[23.73,58.37],[23.46,59.21],[25.78,59.63]]]]},"properties":{"name":"Estonia"},"id":"EE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-7.05,62.07],[-7.2,62.02],[-7.44,62.14],[-7.05,62.07]]],[[[-6.71,61.94],[-7.23,62.17],[-7.21,62.28],[-6.71,61.94]]],[[[-6.66,62.09],[-7.06,62.31],[-6.6,62.2],[-6.66,62.09]]]]},"properties":{"name":"Faroe Islands"},"id":"FO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-59.21,-51.41],[-60.37,-52.16],[-60.98,-52.06],[-60.18,-51.76],[-60.64,-51.36],[-59.21,-51.41]]],[[[-58.7,-51.34],[-57.73,-51.69],[-59.72,-52.12],[-58.7,-51.34]]]]},"properties":{"name":"Falkland Islands (Islas Malvinas)"},"id":"FK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-37.5,-54.01],[-35.78,-54.77],[-38.03,-54.05],[-37.5,-54.01]]]]},"properties":{"name":"South Georgia South Sandwich Islands"},"id":"GS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[179.96,-16.2],[179.48,-16.7],[179.93,-16.46],[179.9,-16.77],[178.48,-16.78],[179.96,-16.2]]],[[[-179.97,-16.17],[-180,-16.15],[-179.94,-16.13],[-179.97,-16.17]]]]},"properties":{"name":"Fiji"},"id":"FJ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[28.17,69.91],[29.18,69.64],[28.96,69.05],[28.43,68.9],[28.82,68.84],[28.69,68.2],[30.03,67.69],[29.07,66.9],[30.13,65.72],[29.64,64.93],[30.58,64.22],[29.99,63.74],[31.59,62.91],[27.81,60.55],[22.91,59.8],[23.34,60.02],[23.09,60.35],[21.36,60.65],[21.67,61.55],[21.06,62.61],[21.5,63.21],[25.45,64.95],[25.31,65.51],[24.17,65.81],[23.66,66.31],[24.01,66.8],[23.43,67.47],[23.67,67.94],[21.81,68.57],[20.58,69.06],[21.32,69.33],[22.4,68.71],[24.93,68.58],[26.45,69.93],[28.17,69.91]]]]},"properties":{"name":"Finland"},"id":"FI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[20.08,60.35],[19.94,60.04],[19.65,60.26],[20.08,60.35]]]]},"properties":{"name":"Aland Islands"},"id":"AX"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[9.45,42.68],[9.18,41.36],[8.58,42.38],[9.35,43],[9.45,42.68]]],[[[2.54,51.09],[4.15,49.98],[4.83,50.17],[5.81,49.55],[6.36,49.46],[8.23,48.96],[7.59,47.58],[6.99,47.5],[5.97,46.21],[6.79,46.43],[7.04,45.93],[7.13,45.26],[6.62,45.11],[6.98,44.28],[7.66,44.17],[7.53,43.79],[7.44,43.76],[7.42,43.77],[7.39,43.73],[6.17,43.05],[3.96,43.54],[3.08,43.07],[3.18,42.44],[1.72,42.51],[1.78,42.57],[1.45,42.6],[-1.78,43.36],[-1.04,44.68],[-1.25,44.66],[-1.08,45.56],[-0.54,44.9],[-0.78,45.46],[-1.24,45.7],[-1.11,46.32],[-2.13,46.84],[-2.13,47.28],[-1.73,47.21],[-4.37,47.8],[-4.73,48.04],[-4.19,48.3],[-4.78,48.51],[-1.37,48.64],[-1.94,49.72],[0.42,49.45],[0.07,49.53],[1.46,50.12],[1.63,50.88],[2.54,51.09]]]]},"properties":{"name":"France"},"id":"FR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-53.49,5.57],[-52.29,4.94],[-52.04,4.33],[-51.85,4.65],[-51.68,4.03],[-52.91,2.2],[-54.6,2.33],[-54,3.45],[-54.48,4.75],[-54.17,5.35],[-53.94,5.74],[-53.49,5.57]]]]},"properties":{"name":"French Guiana"},"id":"GF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-149.21,-17.73],[-149.18,-17.87],[-149.63,-17.55],[-149.21,-17.73]]],[[[-151.4,-16.89],[-151.48,-16.9],[-151.48,-16.74],[-151.4,-16.89]]],[[[-138.96,-9.74],[-138.81,-9.74],[-139.17,-9.78],[-138.96,-9.74]]],[[[-140.03,-8.9],[-140.19,-8.95],[-140.25,-8.8],[-140.03,-8.9]]]]},"properties":{"name":"French Polynesia"},"id":"PF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[69,-48.8],[69.58,-49.3],[70.57,-49.25],[69.77,-49.39],[70.25,-49.69],[68.8,-49.72],[69,-48.8]]]]},"properties":{"name":"French Southern and Antarctic Lands"},"id":"TF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[42.87,11.59],[43.25,11.47],[42.94,11],[41.79,11.01],[42.4,12.47],[43.12,12.71],[43.41,12.06],[42.51,11.57],[42.87,11.59]]]]},"properties":{"name":"Djibouti"},"id":"DJ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[12.52,2.28],[13.29,2.16],[13.19,1.22],[14.19,1.39],[14.49,0.91],[13.85,-0.2],[14.52,-0.61],[14.43,-1.89],[14.11,-2.49],[13.76,-2.09],[13,-2.37],[12.65,-1.82],[12.48,-2.33],[11.57,-2.33],[11.93,-3.64],[11.14,-3.93],[9.62,-2.38],[8.71,-0.64],[9.3,-0.37],[9.35,0.36],[9.92,0.19],[9.3,0.53],[9.8,1],[11.35,1],[11.34,2.17],[12.52,2.28]]]]},"properties":{"name":"Gabon"},"id":"GA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[41.55,42.41],[40,43.38],[42.85,43.18],[43.91,42.58],[44.93,42.76],[46.45,41.9],[46.52,41.05],[45.02,41.3],[43.46,41.11],[42.83,41.58],[41.53,41.52],[41.55,42.41]]]]},"properties":{"name":"Georgia"},"id":"GE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-16.73,13.45],[-16.2,13.25],[-16.16,13.43],[-15.3,13.49],[-16.14,13.45],[-16.39,13.33],[-16.57,13.59],[-15.07,13.83],[-13.8,13.41],[-15.11,13.6],[-15.29,13.37],[-15.8,13.35],[-15.81,13.16],[-16.75,13.06],[-16.73,13.45]]]]},"properties":{"name":"Gambia, The"},"id":"GM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[34.33,31.26],[34.27,31.22],[34.22,31.32],[34.49,31.6],[34.33,31.26]]],[[[35.28,32.52],[35.55,32.39],[35.48,31.5],[34.88,31.39],[35.28,32.52]],[[35.25,31.79],[35.26,31.79],[35.25,31.81],[35.25,31.79]]]]},"properties":{"name":"Palestine"},"id":"PS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[10.98,54.38],[10.82,53.89],[12.53,54.47],[14.28,53.7],[14.83,50.87],[12.09,50.32],[13.83,48.77],[12.76,48.12],[13.02,47.47],[9.57,47.54],[7.7,47.54],[7.59,47.58],[8.23,48.96],[6.36,49.46],[6.13,50.13],[6.01,50.76],[5.96,51.81],[6.83,51.97],[7.07,52.39],[6.69,52.55],[7.21,53.24],[7.3,53.69],[8.5,53.35],[8.67,53.89],[9.83,53.54],[8.9,53.94],[8.6,54.33],[9.02,54.5],[8.28,54.75],[8.66,54.91],[9.45,54.83],[10.98,54.38]]]]},"properties":{"name":"Germany"},"id":"DE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[0.64,5.85],[0.66,5.75],[0.26,5.76],[-0.8,5.21],[-1.61,5.02],[-2.06,4.73],[-2.93,5.1],[-3.25,6.61],[-2.49,8.2],[-2.69,9.48],[-2.83,11],[-0.15,11.14],[0.73,8.32],[0.53,6.95],[1.2,6.1],[0.69,5.75],[0.63,5.95],[0.51,6.06],[0.41,6.08],[0.37,6.04],[0.26,6.1],[0.21,6.09],[0.36,6.02],[0.42,6.07],[0.49,6.04],[0.61,5.95],[0.64,5.85]]]]},"properties":{"name":"Ghana"},"id":"GH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-5.33,36.16],[-5.34,36.11],[-5.36,36.16],[-5.33,36.16]]]]},"properties":{"name":"Gibraltar"},"id":"GI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[175.59,-1.92],[175.55,-1.82],[175.59,-1.88],[175.59,-1.92]]],[[[175.04,-1.55],[175,-1.53],[175.05,-1.43],[175.04,-1.55]]],[[[173.62,0.13],[173.6,0.21],[173.63,0.22],[173.62,0.13]]],[[[173.02,1.01],[173.08,0.95],[172.98,0.82],[173.02,1.01]]],[[[173.01,1.71],[172.93,1.94],[173.03,1.82],[173.01,1.71]]],[[[172.87,3.06],[172.77,3],[172.75,3.02],[172.87,3.06]]]]},"properties":{"name":"Kiribati"},"id":"KI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[23.86,35.52],[26.29,35.13],[24.75,34.94],[23.52,35.29],[23.86,35.52]]],[[[23.46,38.85],[24.56,37.99],[22.83,38.83],[23.46,38.85]]],[[[26.29,41.71],[26.36,41.71],[26.63,41.35],[26.04,40.74],[23.74,40.75],[24.4,40.15],[23.35,40.25],[23.71,39.91],[22.59,40.48],[23.34,39.18],[22.94,39.36],[23.07,39.04],[22.52,38.86],[24.07,38.2],[24.03,37.65],[23.52,38.04],[22.99,37.88],[23.51,37.43],[22.73,37.57],[23.2,36.43],[22.63,36.8],[22.49,36.39],[22.15,37.02],[21.7,36.82],[21.11,37.85],[21.86,38.34],[23.23,38.15],[22.4,38.45],[21.15,38.3],[20.73,38.8],[21.15,39],[20.01,39.69],[20.98,40.86],[22.94,41.34],[25.29,41.24],[26.29,41.71]]]]},"properties":{"name":"Greece"},"id":"GR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-52.69,69.92],[-51.83,69.63],[-53.57,69.23],[-54.27,69.4],[-53.35,69.58],[-54.99,69.69],[-54.39,69.68],[-54.94,69.85],[-54.23,69.91],[-54.83,70.08],[-54.43,70.31],[-52.69,69.92]]],[[[-23.61,72.83],[-21.93,72.4],[-22.76,72.44],[-22.13,72.27],[-22.56,72.14],[-24.48,72.83],[-23.61,72.83]]],[[[-32.3,83.57],[-25.65,83.29],[-35.62,82.9],[-25.14,83.16],[-24.75,83],[-25.9,82.78],[-21.31,82.61],[-25.07,82.15],[-31.62,82.21],[-29.9,82.09],[-33.1,81.77],[-25.2,81.99],[-27.63,81.49],[-27.33,81.38],[-22.02,81.93],[-22.23,81.47],[-24.51,80.54],[-19.94,81.68],[-20.31,81.45],[-16.7,81.93],[-12.16,81.6],[-16.01,80.73],[-21.25,80.58],[-16.11,80.5],[-20.55,80.11],[-20.33,79.76],[-17.45,80.06],[-19.63,79.66],[-19.87,79.15],[-19.08,79.2],[-21.18,78.81],[-20.91,78.62],[-22.04,77.69],[-19.24,77.76],[-18.96,77.63],[-21.05,77.54],[-18.4,77.34],[-18.31,76.81],[-22.74,76.7],[-19.81,76.23],[-21.98,75.99],[-19.83,75.91],[-19.34,75.4],[-19.88,75.15],[-22.25,75.66],[-20.52,75.14],[-22.44,75.16],[-18.98,74.48],[-22.48,74.31],[-21.82,73.65],[-21.75,74.06],[-20.28,73.88],[-20.5,73.45],[-22.38,73.25],[-24.03,73.7],[-22.18,73.62],[-24.04,73.81],[-24.46,73.54],[-25.69,73.95],[-24.67,73.51],[-27.34,73.49],[-26.39,73.24],[-27.73,73.13],[-25.05,73.08],[-27.39,72.84],[-24.84,72.72],[-24.61,72.52],[-25.91,72.41],[-22.49,71.89],[-23.13,71.63],[-21.9,71.74],[-22.47,71.26],[-21.81,71.51],[-21.69,71.15],[-22.33,71.05],[-21.68,71.07],[-21.93,70.8],[-21.47,70.54],[-22.38,70.44],[-22.51,70.85],[-22.62,70.45],[-23.35,70.44],[-24.74,71.33],[-28.64,72.12],[-27.33,71.71],[-28.47,71.55],[-25.41,71.35],[-28.41,70.98],[-27.91,70.87],[-29.21,70.39],[-26.32,70.37],[-28.54,70.04],[-25.23,70.41],[-22.08,70.13],[-26.36,68.67],[-29.38,68.2],[-31.57,68.07],[-32.49,68.62],[-32.12,67.86],[-33.2,67.69],[-34.72,66.34],[-35.85,66.43],[-35.59,66.11],[-37.19,65.77],[-37.81,66.03],[-37.18,66.34],[-38.11,66.39],[-37.69,66.26],[-38.48,66.01],[-38.24,65.63],[-40.1,65.57],[-39.76,65.24],[-41.16,64.96],[-40.36,64.35],[-41.57,64.27],[-40.57,64.11],[-40.52,63.7],[-41.62,63.79],[-40.75,63.51],[-41.91,63.46],[-41.43,63.13],[-42.17,63.2],[-41.76,62.84],[-43.15,62.76],[-42.16,62.38],[-42.98,62.52],[-42.12,62.01],[-43.08,61.59],[-42.51,61.36],[-43.25,61.34],[-42.63,61.1],[-43.61,61.13],[-42.7,61.06],[-43.53,60.84],[-42.75,60.68],[-44.2,60.59],[-43.14,60.08],[-44.1,60.38],[-45.15,60.07],[-44.47,60.56],[-45.19,60.13],[-44.63,60.73],[-45.98,60.57],[-45.25,60.9],[-46.22,60.75],[-45.2,61.19],[-46.07,60.92],[-45.77,61.33],[-46.86,60.8],[-48.24,60.82],[-47.69,61],[-48.41,60.99],[-47.92,61.32],[-49.3,61.56],[-48.6,61.64],[-49.15,61.72],[-48.76,61.98],[-49.44,61.84],[-48.84,62.08],[-49.67,62],[-49.29,62.17],[-50.32,62.5],[-49.7,63.06],[-50.38,62.78],[-50.15,63.02],[-50.61,63.09],[-50.06,63.23],[-51.11,63.34],[-50.28,63.4],[-51.22,63.44],[-50.5,63.67],[-51.56,63.71],[-50.92,63.93],[-51.6,64.03],[-50.05,64.19],[-51.76,64.18],[-50.17,64.45],[-50.86,64.63],[-49.58,64.34],[-50,64.87],[-50.98,65.22],[-50.64,64.75],[-52.01,64.2],[-52.12,64.72],[-51.25,65.02],[-52.21,64.81],[-52.1,65.24],[-52.56,65.33],[-50.55,65.71],[-52.5,65.39],[-53.27,65.75],[-51.83,66.06],[-53.46,66.03],[-50,66.98],[-53.48,66.1],[-53.12,66.29],[-53.63,66.5],[-52.42,66.55],[-53.45,66.64],[-52.23,66.84],[-53.97,67.07],[-50.35,67.18],[-53.88,67.26],[-52.5,67.77],[-50.07,67.51],[-51.23,67.7],[-50.42,67.84],[-51.06,67.97],[-53.75,67.6],[-53.19,68.04],[-52.06,67.98],[-53.32,68.18],[-50.15,67.93],[-51.43,68.2],[-50.82,68.5],[-53.39,68.33],[-50.87,68.61],[-51.29,68.75],[-51.07,69.13],[-50.21,68.96],[-50.69,69.12],[-50.38,69.34],[-51.12,69.2],[-50.2,69.52],[-50.88,69.49],[-50.21,70.02],[-54.63,70.65],[-50.49,70.51],[-51.95,71.02],[-50.93,70.99],[-51.23,71.14],[-52.25,71.12],[-51.65,71.36],[-52.56,71.17],[-51.35,71.49],[-52.98,71.42],[-51.64,71.71],[-53.25,71.7],[-52.68,72],[-53.32,71.82],[-53.56,72.36],[-53.96,72.32],[-53.4,71.85],[-54.1,71.71],[-53.92,71.44],[-55.91,71.68],[-54.38,72.22],[-55.3,71.93],[-54.68,72.37],[-55.63,72.46],[-54.3,72.48],[-55.7,73.07],[-55.09,73.36],[-56.08,73.65],[-55.61,73.72],[-56.41,74.07],[-56.13,74.28],[-57.33,74.11],[-56.19,74.55],[-58.7,75.35],[-58.21,75.44],[-58.41,75.72],[-60.88,76.15],[-68.5,76.09],[-69.63,76.38],[-67.98,76.68],[-71.38,77.06],[-66.45,77.13],[-69.1,77.27],[-66.06,77.49],[-69.25,77.45],[-73.05,78.16],[-65.98,79.1],[-64.82,79.53],[-65.07,80.01],[-63.78,80.15],[-67.48,80.33],[-63.68,81.14],[-62.79,80.75],[-63.37,81.16],[-61.06,81.12],[-61.31,81.36],[-60.77,81.5],[-61.45,81.75],[-60.81,81.88],[-56.48,81.33],[-59.47,82],[-54.51,82.37],[-53.56,82.12],[-53.63,81.51],[-52.9,82.03],[-49.61,81.64],[-51.07,81.93],[-49.43,81.93],[-51.12,82.49],[-50.32,82.52],[-44.64,81.75],[-44.18,81.83],[-44.93,81.99],[-44.62,82.28],[-42.3,82.22],[-45.77,82.76],[-39.75,82.4],[-46.89,82.96],[-43.39,82.91],[-45.52,83.12],[-42.7,83.27],[-38.57,82.74],[-39.15,82.98],[-36.88,83.15],[-38.86,83.43],[-32.3,83.57]]]]},"properties":{"name":"Greenland"},"id":"GL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-61.75,12],[-61.61,12.23],[-61.63,12.05],[-61.75,12]]],[[[-61.43,12.45],[-61.5,12.44],[-61.43,12.53],[-61.43,12.45]]]]},"properties":{"name":"Grenada"},"id":"GD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-61.35,16.33],[-61.7,15.95],[-61.78,16.33],[-61.35,16.33]]]]},"properties":{"name":"Guadeloupe"},"id":"GP"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[144.71,13.23],[144.66,13.43],[144.88,13.65],[144.71,13.23]]]]},"properties":{"name":"Guam"},"id":"GU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-90.63,13.93],[-92.25,14.55],[-91.73,16.07],[-90.44,16.09],[-91.44,17.24],[-90.98,17.26],[-90.98,17.82],[-89.14,17.82],[-89.22,15.89],[-88.91,15.89],[-88.21,15.72],[-89.35,14.43],[-90.1,13.75],[-90.63,13.93]]]]},"properties":{"name":"Guatemala"},"id":"GT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-13.6,9.73],[-15.02,10.96],[-14.69,11.51],[-13.71,11.72],[-13.71,12.68],[-11.37,12.41],[-10.65,11.89],[-9.16,12.49],[-8.53,11.49],[-8.68,10.97],[-8.29,11.01],[-7.97,10.17],[-7.65,8.38],[-8.2,8.5],[-7.95,8.02],[-8.47,7.56],[-9.49,7.36],[-9.48,8.35],[-10.27,8.49],[-10.7,8.3],[-10.57,9.06],[-11.21,10],[-12.46,9.89],[-13.3,9.03],[-13.6,9.73]]]]},"properties":{"name":"Guinea"},"id":"GN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-59.79,8.34],[-58.47,7.35],[-58.65,6.43],[-58.31,6.89],[-57.2,6.15],[-57.25,5.49],[-58.05,4.01],[-56.47,1.94],[-58.81,1.19],[-59.64,1.73],[-59.99,2.69],[-59.57,3.9],[-60.15,4.52],[-60.1,5.22],[-60.73,5.2],[-61.39,5.94],[-61.13,6.71],[-60.29,7.06],[-60.72,7.54],[-59.83,8.24],[-59.99,8.54],[-59.79,8.34]]]]},"properties":{"name":"Guyana"},"id":"GY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-72.67,19.92],[-71.75,19.71],[-71.77,18.04],[-74.45,18.34],[-74.27,18.67],[-72.35,18.53],[-72.72,19.45],[-73.47,19.69],[-72.67,19.92]]]]},"properties":{"name":"Haiti"},"id":"HT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[73.77,-53.13],[73.47,-53.19],[73.23,-52.99],[73.77,-53.13]]]]},"properties":{"name":"Heard Island and McDonald Islands"},"id":"HM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[12.45,41.9],[12.45,41.91],[12.46,41.9],[12.45,41.9]]]]},"properties":{"name":"Holy See (Vatican City)"},"id":"VA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-85.84,16.01],[-84.26,15.83],[-83.13,14.99],[-83.24,14.98],[-84.91,14.81],[-87.3,12.99],[-87.82,13.41],[-87.75,13.86],[-89.34,14.42],[-89.35,14.43],[-88.21,15.72],[-85.84,16.01]]]]},"properties":{"name":"Honduras"},"id":"HN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[114.25,22.2],[114.12,22.28],[114.2,22.29],[114.25,22.2]]],[[[113.9,22.2],[113.83,22.23],[114.05,22.34],[113.9,22.2]]],[[[114.22,22.47],[114.03,22.51],[114.22,22.55],[114.22,22.47]]]]},"properties":{"name":"Hong Kong"},"id":"HK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[18.82,45.91],[17.67,45.83],[16.61,46.48],[16.11,46.87],[16.51,47.01],[16.45,47.7],[17.17,48.01],[17.25,48.02],[18.66,47.76],[20.66,48.56],[22.15,48.41],[22.89,47.95],[20.73,46.18],[20.26,46.11],[18.82,45.91]]]]},"properties":{"name":"Hungary"},"id":"HU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-15.07,66.14],[-14.34,65.78],[-14.56,65.49],[-13.61,65.51],[-14.03,65.19],[-13.5,65.07],[-14.93,64.26],[-18.71,63.39],[-21.05,63.95],[-22.69,63.81],[-21.51,64.65],[-24.06,64.89],[-21.84,65.03],[-22.56,65.17],[-21.7,65.45],[-24.54,65.5],[-23.23,65.74],[-23.87,65.87],[-23.21,65.84],[-23.82,66.01],[-23.47,66.2],[-22.42,65.85],[-22.94,66.47],[-21.4,66.03],[-21.78,65.77],[-21.08,65.16],[-20.18,66.13],[-19.45,65.73],[-18.78,66.19],[-18.07,65.64],[-18.3,66.17],[-16.59,66.09],[-16.53,66.51],[-14.71,66.37],[-15.07,66.14]]]]},"properties":{"name":"Iceland"},"id":"IS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[78.08,35.45],[79.53,32.75],[78.4,32.55],[78.77,31.31],[81.03,30.2],[80.06,28.84],[82.07,27.91],[83.29,27.34],[84.15,27.51],[85.86,26.57],[88.01,26.36],[88.14,27.87],[88.83,28.01],[88.92,27.32],[89.64,26.72],[92.07,26.86],[91.66,27.76],[92.54,27.86],[94.65,29.33],[95.39,29.04],[96.08,29.47],[96.62,28.79],[96.4,28.35],[97.35,28.22],[96.89,27.61],[97.14,27.09],[96.19,27.27],[95.14,26.61],[94.15,23.86],[93.34,24.08],[93.2,22.26],[92.6,21.98],[92.28,23.71],[91.61,22.94],[91.16,23.64],[92.41,25.03],[89.85,25.29],[89.74,26.16],[88.43,26.55],[88.11,25.84],[89.01,25.29],[88.04,24.68],[88.75,24.22],[89.06,22.12],[89.07,21.61],[88.71,21.57],[88.67,22.2],[88.25,21.55],[88.2,22.16],[87.91,22.42],[88.17,22.09],[86.96,21.38],[87.03,20.67],[86.42,19.98],[85.43,19.89],[82.36,17.1],[82.3,16.58],[80.28,15.7],[79.86,10.29],[79.32,10.28],[78.91,9.48],[79.45,9.15],[78.4,9.09],[77.54,8.07],[76.58,8.88],[73.45,16.06],[72.66,19.87],[72.93,20.77],[72.56,21.38],[73.13,21.75],[72.5,21.98],[72.92,22.27],[72.15,22.28],[72.11,21.2],[70.82,20.7],[68.94,22.29],[70.17,22.55],[70.51,23.1],[69.22,22.84],[68.43,23.43],[68.74,23.84],[68.2,23.77],[68.78,24.33],[71.11,24.42],[69.58,27.17],[70.37,28.02],[71.9,27.96],[74.69,31.05],[74.61,31.88],[75.38,32.21],[74.02,33.19],[74.3,33.98],[73.94,34.65],[76.87,34.66],[77.82,35.5],[78.08,35.45]]]]},"properties":{"name":"India"},"id":"IN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[120.03,-9.38],[120.72,-10.2],[118.93,-9.56],[120.03,-9.38]]],[[[125.16,-9.07],[125.13,-9.44],[124.44,-10.16],[123.49,-10.32],[124.05,-9.34],[124.34,-9.46],[124.45,-9.18],[124.95,-8.95],[125.16,-9.07]]],[[[116.55,-8.78],[115.84,-8.76],[116.39,-8.2],[116.55,-8.78]]],[[[124.58,-8.14],[125.14,-8.33],[124.35,-8.45],[124.58,-8.14]]],[[[118.31,-8.37],[119,-8.31],[119.18,-8.72],[116.75,-9.01],[117.12,-8.38],[117.97,-8.75],[118.28,-8.59],[117.74,-8.15],[118.31,-8.37]]],[[[122.98,-8.15],[122.83,-8.6],[121.77,-8.89],[119.8,-8.72],[120.52,-8.26],[122.29,-8.64],[122.98,-8.15]]],[[[115.5,-8.18],[115.13,-8.85],[114.45,-8.1],[115.5,-8.18]]],[[[126.72,-7.67],[125.77,-8.01],[125.97,-7.66],[126.72,-7.67]]],[[[138.97,-7.56],[138.44,-8.38],[137.64,-8.43],[138.15,-7.51],[138.97,-7.56]]],[[[131.74,-7.21],[131.11,-8],[131.24,-7.48],[131.74,-7.21]]],[[[113.99,-6.88],[113.5,-7.23],[112.69,-7.05],[113.99,-6.88]]],[[[106.16,-6.01],[108.31,-6.26],[108.73,-6.82],[110.39,-6.98],[110.92,-6.41],[112.56,-6.91],[112.85,-7.6],[114.45,-7.8],[114.37,-8.52],[114.62,-8.75],[108.16,-7.78],[105.24,-6.81],[106.16,-6.01]]],[[[134.58,-5.43],[134.73,-5.97],[134.3,-6.03],[134.58,-5.43]]],[[[123.21,-4.7],[122.65,-5.69],[122.9,-4.49],[123.21,-4.7]]],[[[126.99,-3.14],[127.24,-3.62],[126.7,-3.83],[126.02,-3.35],[126.99,-3.14]]],[[[129.81,-2.92],[130.58,-3.13],[130.83,-3.87],[128.17,-3.07],[127.91,-3.54],[128.17,-2.86],[129.81,-2.92]]],[[[107.83,-2.54],[108.27,-2.76],[108.07,-3.24],[107.61,-3.21],[107.83,-2.54]]],[[[133.59,-2.53],[133.5,-2.43],[133.61,-2.48],[133.59,-2.53]]],[[[134.57,-2.45],[134.52,-2.4],[134.57,-2.29],[134.57,-2.45]]],[[[134.37,-2.16],[134.33,-2.09],[134.39,-2],[134.37,-2.16]]],[[[130.19,-2.06],[129.72,-1.89],[130.35,-1.68],[130.19,-2.06]]],[[[125.01,-1.72],[125.32,-1.89],[124.33,-1.88],[125.01,-1.72]]],[[[136.29,-1.69],[136.9,-1.8],[135.42,-1.61],[136.29,-1.69]]],[[[106.09,-1.77],[106.72,-3.1],[105.13,-2.07],[105.57,-1.53],[106.09,-1.77]]],[[[127.88,-1.43],[128.15,-1.68],[127.38,-1.63],[127.88,-1.43]]],[[[133.11,-0.54],[134.11,-0.84],[134.16,-2.32],[135,-3.34],[137.86,-1.47],[141,-2.61],[141.01,-9.13],[139.99,-8.19],[140.15,-7.88],[138.91,-8.3],[139.1,-7.56],[138.66,-7.2],[139.22,-7.16],[138.56,-6.91],[139.19,-6.97],[138.06,-5.41],[134.22,-3.96],[133.64,-3.49],[133.83,-2.96],[132.9,-4.09],[132.82,-3.3],[131.96,-2.78],[133.24,-2.42],[133.68,-2.72],[133.94,-2.1],[132.3,-2.27],[130.96,-1.4],[132.27,-0.38],[133.11,-0.54]]],[[[130.88,-0.02],[131.26,-0.39],[130.21,-0.21],[130.88,-0.02]]],[[[97.53,1.42],[97.81,0.55],[97.11,1.39],[97.53,1.42]]],[[[125.14,1.42],[124.25,0.38],[120.24,0.35],[120.07,-0.61],[120.67,-1.4],[121.62,-0.8],[123.45,-0.84],[121.3,-1.8],[122.9,-4.4],[121.55,-4.75],[120.77,-2.61],[120.2,-2.96],[120.46,-5.62],[119.46,-5.56],[119.51,-3.53],[118.92,-3.57],[118.76,-2.77],[119.86,-0.84],[119.62,-0.01],[120.03,0.71],[120.95,1.34],[123.84,0.83],[124.97,1.69],[125.14,1.42]]],[[[127.89,1.8],[127.79,0.8],[128.73,1.56],[128.21,0.78],[128.91,0.2],[127.88,0.31],[128.4,-0.89],[127.67,-0.23],[127.39,1.05],[128.05,2.2],[127.89,1.8]]],[[[116.05,4.28],[117.59,4.17],[117.83,3.7],[117.03,3.59],[118.1,2.31],[117.87,1.88],[119.01,0.98],[117.89,1.12],[117.62,-0.78],[116.74,-1.02],[116.22,-1.78],[116.6,-2.23],[115.98,-3.59],[114.71,-4.18],[114.48,-3.5],[113.06,-2.99],[111.89,-3.57],[111.75,-2.74],[110.24,-2.98],[110.06,-1.33],[109.27,-0.86],[108.85,0.81],[109.65,2.07],[110.56,0.85],[111.83,1],[112.47,1.57],[114.56,1.43],[116.05,4.28]]],[[[95.74,5.59],[97.52,5.25],[100,2.6],[100.94,1.82],[101.06,2.29],[102.93,0.7],[102.54,0.17],[103.74,0.28],[103.36,-0.7],[104.38,-1.04],[104.88,-2.15],[104.53,-2.77],[104.86,-2.29],[105.61,-2.39],[106.06,-3.03],[105.73,-5.9],[105.27,-5.44],[105.14,-5.8],[104.54,-5.51],[104.56,-5.93],[101.63,-3.25],[100.29,-0.81],[99.14,0.26],[98.77,1.75],[95.53,4.68],[95.23,5.57],[95.74,5.59]]]]},"properties":{"name":"Indonesia"},"id":"ID"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[45,39.42],[46.18,38.84],[46.54,38.88],[47.98,39.72],[48.36,39.39],[48.02,38.84],[48.89,38.44],[49.1,37.64],[51.1,36.73],[53.94,36.8],[53.91,37.35],[57.21,38.28],[59.34,37.54],[60.33,36.66],[61.16,36.65],[61.28,35.61],[60.51,34.14],[60.94,33.52],[60.58,33.07],[60.84,31.5],[61.85,31.02],[60.87,29.86],[61.91,28.55],[62.78,28.27],[62.78,27.26],[63.34,27.12],[63.18,26.63],[61.86,26.23],[61.61,25.2],[57.32,25.77],[56.69,27.15],[54.79,26.49],[53.75,26.71],[51.43,27.94],[50.05,30.21],[49.55,30.01],[48.98,30.51],[48.55,29.96],[47.69,31],[47.86,31.8],[47.43,32.4],[46.11,32.97],[45.4,33.98],[45.8,34.91],[46.35,35.82],[45.41,35.99],[44.79,37.15],[44.03,39.38],[44.81,39.63],[45,39.42]]]]},"properties":{"name":"Iran"},"id":"IR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[45.8,34.91],[45.4,33.98],[46.11,32.97],[47.43,32.4],[47.86,31.8],[47.69,31],[48.55,29.96],[47.94,30.02],[47.93,30.02],[47.17,30.02],[46.55,29.1],[44.72,29.2],[42.08,31.11],[39.2,32.15],[38.79,33.38],[41,34.42],[41.29,36.36],[42.36,37.11],[44.79,37.15],[45.41,35.99],[46.35,35.82],[45.8,34.91]]]]},"properties":{"name":"Iraq"},"id":"IQ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-7.41,54.95],[-8.16,54.44],[-6.27,54.1],[-6.01,52.95],[-6.36,52.18],[-9.23,51.48],[-10.34,51.78],[-9.76,52.15],[-10.46,52.18],[-8.82,52.67],[-9.94,52.56],[-8.94,53.26],[-10.18,53.41],[-9.56,53.86],[-10.11,54.23],[-8.47,54.27],[-8.19,54.63],[-8.8,54.69],[-8.32,55.11],[-6.93,55.24],[-7.25,55.07],[-7.41,54.95]]]]},"properties":{"name":"Ireland"},"id":"IE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[35.26,31.79],[35.25,31.79],[35.25,31.81],[35.26,31.79]]],[[[35.62,33.25],[35.65,32.69],[35.55,32.39],[35.28,32.52],[34.88,31.39],[35.48,31.5],[34.98,29.55],[34.9,29.49],[34.27,31.22],[34.33,31.26],[34.49,31.6],[35.1,33.09],[35.62,33.25]]]]},"properties":{"name":"Israel"},"id":"IL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[15.53,38.14],[15.08,36.65],[12.42,37.8],[13.32,38.22],[15.53,38.14]]],[[[9.51,41.15],[9.57,39.15],[8.41,38.96],[8.19,40.91],[9.51,41.15]]],[[[12.13,47],[13.72,46.53],[13.38,46.3],[13.72,45.6],[12.28,45.47],[12.37,44.25],[13.62,43.55],[14.74,42.09],[16.14,41.91],[15.93,41.48],[18.51,40.14],[18.35,39.79],[16.91,40.45],[16.49,39.77],[17.17,38.96],[16.06,37.92],[15.63,38.01],[16.22,38.91],[15.67,40.03],[11.1,42.39],[10.11,44.01],[8.75,44.43],[7.53,43.79],[7.66,44.17],[6.98,44.28],[6.62,45.11],[7.13,45.26],[7.04,45.93],[7.86,45.92],[8.44,46.46],[9.04,45.84],[9.28,46.5],[10.13,46.23],[10.47,46.87],[12.13,47]],[[12.46,43.9],[12.51,43.99],[12.42,43.96],[12.46,43.9]],[[12.45,41.9],[12.46,41.9],[12.45,41.91],[12.45,41.9]]]]},"properties":{"name":"Italy"},"id":"IT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-4.79,5.17],[-7.53,4.35],[-7.42,5.84],[-8.61,6.51],[-8.47,7.56],[-7.95,8.02],[-8.2,8.5],[-7.65,8.38],[-7.97,10.17],[-6.99,10.15],[-6.24,10.74],[-6.11,10.2],[-5.52,10.44],[-4.7,9.7],[-3.63,9.95],[-2.69,9.48],[-2.49,8.2],[-3.25,6.61],[-2.93,5.1],[-4.79,5.17]]]]},"properties":{"name":"Cote d\'Ivoire"},"id":"CI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-77.13,17.88],[-78.34,18.36],[-76.95,18.39],[-76.22,17.9],[-77.13,17.88]]]]},"properties":{"name":"Jamaica"},"id":"JM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[131.21,33.6],[131.67,33.65],[131.99,32.83],[131.34,31.37],[130.67,31],[130.81,31.68],[130.64,31.18],[130.23,31.25],[130.16,32.01],[130.61,32.79],[130.21,33.17],[130.35,32.66],[129.75,32.56],[129.58,33.35],[130.69,33.94],[131.21,33.6]]],[[[134.22,34.34],[134.75,33.83],[134.19,33.24],[133.6,33.5],[132.8,32.74],[132.37,33.47],[132.02,33.34],[132.9,34.11],[134.22,34.34]]],[[[141.27,41.34],[142.07,39.55],[141.53,38.27],[140.95,38.15],[140.84,35.74],[140.33,35.13],[139.77,34.95],[139.97,35.66],[138.85,34.59],[138.74,35.12],[138.21,34.6],[137.04,34.56],[137.35,34.72],[136.85,35.08],[136.52,34.69],[136.9,34.27],[135.77,33.45],[135.06,33.88],[135.33,34.72],[132.37,34.36],[132.05,33.77],[130.89,33.92],[130.95,34.42],[133.09,35.58],[136.07,35.65],[136.79,37.36],[137.36,37.5],[136.86,37.09],[137.3,36.75],[138.58,37.4],[140.02,39.38],[139.85,40.6],[140.35,41.25],[141.15,40.86],[141.23,41.23],[140.76,41.17],[141.27,41.34]]],[[[142.05,45.4],[143.77,44.09],[144.78,43.91],[145.34,44.34],[145.26,43.31],[145.82,43.37],[143.99,42.91],[143.24,41.92],[141.79,42.61],[140.46,42.57],[140.28,42.25],[141.2,41.8],[140.07,41.42],[139.84,42.62],[140.47,43.37],[141.41,43.29],[141.58,45.23],[142.05,45.4]]]]},"properties":{"name":"Japan"},"id":"JP"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[69.19,55.34],[70.84,55.3],[71.19,54.1],[73.76,54.07],[73.44,53.44],[76.81,54.45],[76.52,53.99],[77.91,53.27],[80.08,50.76],[80.69,51.31],[81.47,50.74],[83.46,51],[85.26,49.59],[86.77,49.79],[87.35,49.09],[85.76,48.39],[85.53,47.06],[83.04,47.21],[82.32,45.57],[82.56,45.13],[79.87,44.9],[80.52,44.73],[80.82,43.16],[80.38,43.03],[80.23,42.2],[79.19,42.8],[74.29,43.22],[73.58,43.04],[73.52,42.41],[71.75,42.82],[70.97,42.25],[69.06,41.38],[68.46,40.6],[67.94,41.18],[66.72,41.17],[66.53,42],[66.03,42],[66.12,43],[64.93,43.74],[62.03,43.48],[58.57,45.57],[56,45],[56,41.33],[54.17,42.34],[53.01,42.14],[52.44,41.74],[52.74,42.71],[51.27,43.15],[50.24,44.58],[51.57,44.51],[50.95,44.86],[51.41,45.37],[53.23,45.34],[52.73,45.55],[53.19,46.71],[51.19,47.11],[49.22,46.35],[48.56,46.56],[49.03,46.78],[48.2,47.7],[47.38,47.69],[46.5,48.42],[47.52,50.44],[48.8,49.94],[48.7,50.59],[50.77,51.77],[53.43,51.49],[54.52,50.53],[54.65,51.04],[55.69,50.53],[56.51,51.08],[58.34,51.16],[59.54,50.48],[61.38,50.78],[61.69,51.27],[60,51.96],[61.06,52.34],[60.69,52.68],[61.1,52.98],[62.12,53],[61.18,53.31],[61.58,53.51],[60.91,53.62],[61.01,53.95],[65.22,54.32],[69.19,55.34]]]]},"properties":{"name":"Kazakhstan"},"id":"KZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[34.96,29.36],[34.98,29.55],[35.48,31.5],[35.55,32.39],[35.65,32.69],[36.84,32.31],[38.79,33.38],[39.2,32.15],[37.01,31.51],[38,30.5],[37.5,30],[36.07,29.19],[34.96,29.36]]]]},"properties":{"name":"Jordan"},"id":"JO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[35.94,4.62],[39.52,3.41],[40.78,4.29],[41.91,3.98],[40.99,2.83],[41,-0.87],[41.56,-1.67],[40.24,-2.66],[39.2,-4.67],[37.61,-3.5],[37.6,-3],[33.92,-1],[33.91,0.1],[35.01,1.9],[34,4.22],[34.39,4.61],[35.94,4.62]]]]},"properties":{"name":"Kenya"},"id":"KE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[130.64,42.41],[130.7,42.29],[129.7,41.65],[129.71,40.83],[127.51,39.72],[127.39,39.2],[128.36,38.63],[126.69,37.83],[125.59,38.03],[125.34,37.67],[124.66,38.12],[125.65,38.63],[125.14,38.8],[125.45,39.58],[124.62,39.59],[124.37,40.09],[126.91,41.8],[128.16,41.38],[128.06,42],[129.71,42.44],[129.91,43.01],[130.6,42.42],[130.64,42.41]]]]},"properties":{"name":"Korea, North"},"id":"KP"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[128.53,38.33],[129.43,37.06],[129.44,35.48],[126.56,34.3],[126.25,35.12],[126.87,36.05],[126.12,36.71],[126.99,36.91],[126.69,37.83],[128.36,38.63],[128.53,38.33]]]]},"properties":{"name":"Korea, South"},"id":"KR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[47.93,30.02],[47.94,30.02],[48.17,29.55],[47.71,29.38],[48.42,28.55],[46.55,29.1],[47.17,30.02],[47.93,30.02]]]]},"properties":{"name":"Kuwait"},"id":"KW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[80.23,42.2],[78.08,41.04],[76.87,41.01],[76.35,40.35],[74.86,40.52],[73.66,39.45],[69.31,39.54],[69.54,40.13],[70.98,40.24],[73.17,40.82],[71.69,41.56],[71.42,41.12],[70.19,41.53],[71.28,42.2],[70.97,42.25],[71.75,42.82],[73.52,42.41],[73.58,43.04],[74.29,43.22],[79.19,42.8],[80.23,42.2]]]]},"properties":{"name":"Kyrgyzstan"},"id":"KG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[107.55,14.71],[106,14.37],[106.06,13.93],[105.21,14.35],[105.64,15.66],[104.75,16.53],[104.72,17.5],[103.4,18.43],[102.68,17.82],[102.09,18.21],[100.92,17.57],[101.28,19.56],[100.5,19.53],[100.58,20.16],[100.09,20.35],[101.15,21.57],[101.79,21.14],[101.57,22.21],[102.14,22.4],[102.98,21.74],[103.17,20.85],[104.64,20.66],[104.38,20.44],[104.98,20],[103.88,19.29],[105.19,18.64],[106.69,16.46],[107.46,16.08],[107.18,15.78],[107.7,15.27],[107.55,14.71]]]]},"properties":{"name":"Laos"},"id":"LA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[35.62,33.25],[35.1,33.09],[35.97,34.65],[36.62,34.2],[35.62,33.25]]]]},"properties":{"name":"Lebanon"},"id":"LB"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[27.56,-30.4],[27.01,-29.63],[28.57,-28.61],[29.43,-29.28],[29.17,-29.91],[28.08,-30.65],[27.56,-30.4]]]]},"properties":{"name":"Lesotho"},"id":"LS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[21.07,56.44],[21.73,57.58],[22.61,57.76],[23.79,56.97],[24.41,57.26],[24.31,57.87],[25.29,58.08],[27.37,57.54],[27.86,57.3],[28.17,56.15],[26.61,55.67],[25,56.3],[21.05,56.08],[21.07,56.44]]]]},"properties":{"name":"Latvia"},"id":"LV"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-10.81,6.4],[-11.49,6.93],[-10.27,8.49],[-9.48,8.35],[-9.49,7.36],[-8.47,7.56],[-8.61,6.51],[-7.42,5.84],[-7.53,4.35],[-10.81,6.4]]]]},"properties":{"name":"Liberia"},"id":"LR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[9.95,27.82],[9.54,30.23],[10.21,30.73],[10.29,31.69],[11.57,32.44],[11.53,33.17],[15.17,32.4],[15.76,31.39],[19,30.27],[20.06,30.86],[20.08,32.18],[21.62,32.93],[25.15,31.65],[24.71,30.17],[25,22],[25,20],[24,20],[24,19.5],[16,23.45],[15,23],[14.23,22.61],[11.99,23.52],[11.56,24.3],[10.25,24.61],[9.4,26.15],[9.87,26.51],[9.95,27.82]]]]},"properties":{"name":"Libya"},"id":"LY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[9.53,47.27],[9.6,47.06],[9.47,47.06],[9.53,47.27]]]]},"properties":{"name":"Liechtenstein"},"id":"LI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[25,56.3],[26.61,55.67],[26.82,55.28],[25.79,54.87],[25.79,54.16],[23.5,53.95],[22.79,54.36],[22.84,54.9],[21.43,55.25],[21.26,55.25],[21.05,56.08],[25,56.3]]]]},"properties":{"name":"Lithuania"},"id":"LT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[6.03,50.18],[6.13,50.13],[6.36,49.46],[5.81,49.55],[6.03,50.18]]]]},"properties":{"name":"Luxembourg"},"id":"LU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[113.53,22.19],[113.55,22.21],[113.55,22.18],[113.53,22.19]]]]},"properties":{"name":"Macau"},"id":"MO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[49.36,-12.09],[50.43,-15.58],[50.17,-15.98],[49.63,-15.56],[49.79,-16.83],[47.13,-24.93],[45.21,-25.59],[44.02,-24.99],[43.24,-22.28],[44.48,-19.97],[43.94,-17.48],[44.46,-16.18],[46.48,-15.97],[46.34,-15.62],[47.22,-15.45],[47.45,-14.67],[47.43,-15.11],[48,-14.77],[47.91,-13.6],[48.74,-13.43],[48.73,-12.43],[49.36,-12.09]]]]},"properties":{"name":"Madagascar"},"id":"MG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[34.73,-12.1],[34.7,-12.08],[34.72,-12.03],[34.75,-12.04],[34.73,-12.1]]],[[[34.62,-12.04],[34.6,-12.01],[34.63,-12.01],[34.62,-12.04]]],[[[33.13,-9.49],[34.33,-9.73],[34.97,-11.57],[34.38,-12.16],[34.57,-13.34],[35.92,-14.89],[35.81,-16.02],[35.14,-16.55],[35.29,-17.13],[34.26,-15.9],[34.52,-14.57],[33.63,-14.54],[33.22,-14.01],[32.68,-13.61],[33.55,-12.36],[33.25,-10.89],[33.7,-10.56],[32.94,-9.41],[33.13,-9.49]]]]},"properties":{"name":"Malawi"},"id":"MW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[100.65,6.45],[101.14,5.63],[102.1,6.24],[103.41,4.86],[103.44,2.93],[104.28,1.37],[103.96,1.65],[103.51,1.27],[101.28,2.84],[100.13,6.42],[100.65,6.45]]],[[[116.79,6.58],[117.18,6.99],[117.74,6.39],[117.5,5.9],[118.01,6.06],[117.96,5.68],[119.28,5.34],[118.14,4.89],[118.55,4.35],[117.59,4.17],[116.05,4.28],[114.56,1.43],[112.47,1.57],[111.83,1],[110.56,0.85],[109.65,2.07],[111.38,1.34],[111,1.58],[111.44,2.69],[113.01,3.16],[114.1,4.59],[114.64,4.02],[115.02,4.9],[115.03,4.82],[115.34,4.31],[115.22,4.8],[115.15,4.9],[116.76,7.02],[116.79,6.58]]]]},"properties":{"name":"Malaysia"},"id":"MY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[73.18,-0.69],[73.16,-0.68],[73.17,-0.68],[73.18,-0.69]]],[[[73.2,-0.68],[73.19,-0.68],[73.2,-0.67],[73.2,-0.68]]],[[[73.13,-0.67],[73.13,-0.67],[73.12,-0.65],[73.13,-0.67]]],[[[73.23,-0.65],[73.23,-0.63],[73.24,-0.62],[73.23,-0.65]]],[[[73.12,-0.64],[73.09,-0.61],[73.09,-0.58],[73.12,-0.64]]],[[[73.25,-0.61],[73.24,-0.59],[73.25,-0.58],[73.25,-0.61]]]]},"properties":{"name":"Maldives"},"id":"MV"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-8.53,11.49],[-9.16,12.49],[-10.65,11.89],[-11.37,12.41],[-12.24,14.76],[-11.49,15.65],[-10.9,15.11],[-9.34,15.7],[-5.5,15.5],[-6.58,25],[-4.81,25],[1.8,20.31],[3.23,19.82],[3.33,18.98],[4.25,19.15],[4.25,18.65],[4.2,16.39],[3.52,15.36],[0.24,14.92],[-0.73,15.08],[-2.47,14.29],[-3.44,13.17],[-3.96,13.5],[-4.42,12.3],[-5.27,11.84],[-5.52,10.44],[-6.11,10.2],[-6.24,10.74],[-6.99,10.15],[-7.97,10.17],[-8.29,11.01],[-8.68,10.97],[-8.53,11.49]]]]},"properties":{"name":"Mali"},"id":"ML"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[14.56,35.82],[14.37,35.85],[14.33,35.98],[14.56,35.82]]],[[[14.27,36.01],[14.18,36.06],[14.34,36.03],[14.27,36.01]]]]},"properties":{"name":"Malta"},"id":"MT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-60.86,14.4],[-61.17,14.88],[-60.94,14.74],[-60.86,14.4]]]]},"properties":{"name":"Martinique"},"id":"MQ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-6.66,26.13],[-4.81,25],[-6.58,25],[-5.5,15.5],[-9.34,15.7],[-10.9,15.11],[-11.49,15.65],[-12.24,14.76],[-14.35,16.64],[-16.28,16.52],[-16.53,16.06],[-16.04,17.73],[-16.51,19.35],[-16.2,20.22],[-16.92,21.16],[-17.05,20.76],[-16.95,21.34],[-15.74,21.34],[-13,21.34],[-13.11,22.89],[-12,23.45],[-12,26],[-8.67,26],[-8.67,27.29],[-6.66,26.13]]]]},"properties":{"name":"Mauritania"},"id":"MR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[57.57,-20.51],[57.3,-20.45],[57.62,-19.99],[57.57,-20.51]]]]},"properties":{"name":"Mauritius"},"id":"MU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-113.05,31.97],[-111.05,31.33],[-106.4,31.75],[-103.38,29.02],[-102.31,29.89],[-101.41,29.77],[-99.51,27.57],[-99.1,26.43],[-97.14,25.97],[-97.89,22.6],[-95.91,18.83],[-94.48,18.15],[-92,18.73],[-91.48,18.44],[-90.45,19.98],[-90.33,21.03],[-87.03,21.59],[-86.77,21.15],[-87.74,19.67],[-87.41,19.58],[-87.85,18.19],[-88.04,18.87],[-88.3,18.48],[-88.38,18.48],[-89.14,17.82],[-90.98,17.82],[-90.98,17.26],[-91.44,17.24],[-90.44,16.09],[-91.73,16.07],[-92.25,14.55],[-92.77,15.17],[-93.93,16.09],[-94.37,16.29],[-94.06,16.04],[-94.72,16.2],[-94.58,16.32],[-94.79,16.26],[-94.86,16.43],[-96.48,15.64],[-97.79,15.97],[-104.98,19.34],[-105.68,20.39],[-105.24,20.57],[-105.54,20.79],[-105.19,21.44],[-105.82,22.66],[-108.04,25.07],[-109.11,25.53],[-108.83,25.8],[-109.39,25.76],[-109.1,26.28],[-110.53,27.37],[-110.51,27.87],[-112.16,28.97],[-113.09,31.23],[-115.03,31.97],[-114.55,30],[-111.56,26.72],[-110.66,24.34],[-109.41,23.47],[-110,22.89],[-112.09,24.76],[-112.4,26.27],[-114.99,27.72],[-113.98,27.7],[-114.31,27.87],[-114.06,28.53],[-115.69,29.77],[-117.12,32.54],[-114.72,32.72],[-113.05,31.97]]]]},"properties":{"name":"Mexico"},"id":"MX"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[7.44,43.76],[7.39,43.73],[7.42,43.77],[7.44,43.76]]]]},"properties":{"name":"Monaco"},"id":"MC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[91.02,46.6],[90.07,47.89],[88.65,48.18],[87.84,49.17],[92.32,50.81],[97.34,49.73],[98.29,50.29],[97.83,51],[98.93,52.14],[102.22,51.33],[102.33,50.57],[102.92,50.32],[106.66,50.34],[108.57,49.33],[110.79,49.15],[114.31,50.28],[116.71,49.83],[115.59,47.92],[117.37,47.65],[118.54,47.99],[119.9,46.68],[117.42,46.58],[113.64,44.75],[111.98,45.09],[111.42,44.38],[111.96,43.69],[110.44,42.78],[107.47,42.47],[105.01,41.58],[100.84,42.68],[96.38,42.73],[95.42,44.29],[90.9,45.25],[91.02,46.6]]]]},"properties":{"name":"Mongolia"},"id":"MN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[28.12,46.85],[26.63,48.26],[27.76,48.45],[29.14,47.99],[29.95,46.81],[30.12,46.39],[28.99,46.48],[28.21,45.45],[28.12,46.85]]]]},"properties":{"name":"Moldova"},"id":"MD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[18.46,42.57],[19.23,43.51],[20.35,42.89],[20.07,42.56],[19.65,42.62],[19.37,41.85],[18.5,42.45],[18.46,42.57]]]]},"properties":{"name":"Montenegro"},"id":"ME"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-62.17,16.67],[-62.24,16.71],[-62.2,16.81],[-62.17,16.67]]]]},"properties":{"name":"Montserrat"},"id":"MS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-9.05,32.73],[-6.81,34.05],[-5.92,35.79],[-5.4,35.92],[-4.42,35.15],[-2.99,35.42],[-2.21,35.09],[-1.75,34.75],[-1.18,32.11],[-3.82,31.7],[-3.63,30.97],[-8.67,28.71],[-8.67,27.67],[-13.17,27.67],[-10.14,29.43],[-9.64,30.17],[-9.81,31.45],[-9.05,32.73]]]]},"properties":{"name":"Morocco"},"id":"MA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[40.5,-11.03],[40.59,-15.48],[39.09,-16.99],[36.84,-17.88],[36.25,-18.89],[34.9,-19.86],[34.62,-19.62],[35.55,-22.23],[35.5,-24.11],[32.81,-25.61],[32.89,-26.85],[32.13,-26.84],[31.97,-25.96],[32.02,-24.46],[31.3,-22.41],[32.49,-21.34],[33.02,-19.94],[32.7,-18.94],[32.99,-17.27],[32.98,-16.71],[30.42,-16.01],[30.42,-15.63],[30.21,-14.98],[33.22,-14.01],[33.63,-14.54],[34.52,-14.57],[34.26,-15.9],[35.29,-17.13],[35.14,-16.55],[35.81,-16.02],[35.92,-14.89],[34.57,-13.34],[34.38,-12.16],[34.97,-11.57],[37.46,-11.73],[40.44,-10.48],[40.5,-11.03]],[[34.6,-12.01],[34.62,-12.04],[34.63,-12.01],[34.6,-12.01]],[[34.72,-12.03],[34.7,-12.08],[34.73,-12.1],[34.75,-12.04],[34.72,-12.03]]]]},"properties":{"name":"Mozambique"},"id":"MZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[56.04,24.94],[56.37,24.98],[57.16,23.94],[58.61,23.63],[59.81,22.23],[58.52,20.41],[57.83,20.22],[57.8,18.97],[56.81,18.75],[56.35,17.93],[55.44,17.83],[55.04,17.02],[53.11,16.64],[52,19],[55,20],[55.67,22],[55.2,22.7],[56.04,24.94]]],[[[56.37,26.38],[56.27,25.64],[56.18,25.65],[56.08,26.07],[56.37,26.38]]]]},"properties":{"name":"Oman"},"id":"OM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[23.28,-17.66],[23.48,-17.63],[24.97,-17.56],[25.26,-17.8],[23.62,-18.49],[23.3,-18],[20.99,-18.32],[20.99,-22],[20,-22.01],[20,-24.77],[20,-28.42],[18.18,-28.91],[17.4,-28.71],[17.06,-28.03],[16.49,-28.58],[15.29,-27.32],[14.51,-22.55],[11.8,-18.08],[11.75,-17.25],[13.16,-16.95],[13.99,-17.42],[18.45,-17.39],[20.85,-18.02],[23.28,-17.66]]]]},"properties":{"name":"Namibia"},"id":"NA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[166.93,-0.55],[166.93,-0.49],[166.96,-0.51],[166.93,-0.55]]]]},"properties":{"name":"Nauru"},"id":"NR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[82.07,27.91],[80.06,28.84],[81.03,30.2],[82.1,30.34],[86.01,27.88],[88.14,27.87],[88.01,26.36],[85.86,26.57],[84.15,27.51],[83.29,27.34],[82.07,27.91]]]]},"properties":{"name":"Nepal"},"id":"NP"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[3.76,51.35],[3.37,51.37],[4.24,51.35],[3.76,51.35]]],[[[5.76,52.42],[5.43,52.26],[5.14,52.38],[5.64,52.6],[5.86,52.54],[5.76,52.42]]],[[[5.42,52.64],[5.05,52.39],[5.04,52.63],[5.42,52.64]]],[[[6.87,53.42],[7.21,53.24],[6.69,52.55],[7.07,52.39],[6.83,51.97],[5.96,51.81],[6.01,50.76],[5.04,51.49],[4.25,51.38],[3.44,51.54],[4.29,51.45],[3.69,51.71],[4.17,51.69],[3.87,51.81],[4.58,52.46],[5.42,52.25],[5.77,52.41],[5.88,52.51],[5.86,52.61],[5.6,52.66],[5.6,52.76],[5.72,52.84],[5.37,52.88],[5.42,52.96],[5.36,53.07],[5.1,52.95],[5.3,52.71],[5.03,52.63],[5.03,52.38],[4.58,52.47],[4.73,52.96],[6.87,53.42]]]]},"properties":{"name":"Netherlands"},"id":"NL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-68.2,12.22],[-68.25,12.02],[-68.42,12.26],[-68.2,12.22]]],[[[-68.97,12.2],[-69.16,12.37],[-68.75,12.04],[-68.97,12.2]]]]},"properties":{"name":"Netherlands Antilles"},"id":"AN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-69.88,12.41],[-70.06,12.54],[-70.06,12.63],[-69.88,12.41]]]]},"properties":{"name":"Aruba"},"id":"AW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[164.32,-20.33],[167.01,-22.32],[165.26,-21.56],[163.99,-20.09],[164.32,-20.33]]]]},"properties":{"name":"New Caledonia"},"id":"NC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[167.42,-16.11],[167.77,-16.54],[167.18,-15.9],[167.42,-16.11]]],[[[166.8,-15.16],[167.06,-14.95],[167.24,-15.52],[166.76,-15.64],[166.59,-14.62],[166.8,-15.16]]]]},"properties":{"name":"Vanuatu"},"id":"VU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[172.86,-40.51],[173.11,-41.31],[174.32,-41],[174.29,-41.75],[172.76,-43.24],[173.09,-43.86],[171.29,-44.34],[170.78,-45.88],[169.01,-46.68],[166.48,-46.01],[168.37,-44.04],[170.79,-42.9],[172.11,-40.89],[172.86,-40.51]]],[[[173.04,-34.44],[173.27,-35.02],[174.32,-35.23],[174.85,-36.85],[175.58,-37.24],[175.35,-36.48],[175.84,-36.75],[175.99,-37.64],[177.16,-38.01],[178.57,-37.71],[177.91,-39.26],[177.05,-39.2],[176.83,-40.18],[175.32,-41.61],[174.59,-41.28],[175.16,-40.1],[173.75,-39.29],[174.59,-38.82],[174.97,-37.75],[174.55,-37.07],[174.89,-37.06],[174.19,-36.5],[174.51,-36.23],[173.91,-35.87],[174.08,-36.41],[173.4,-35.57],[173.66,-35.31],[173.09,-35.21],[172.72,-34.5],[173.04,-34.44]]]]},"properties":{"name":"New Zealand"},"id":"NZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-83.24,14.98],[-83.13,14.99],[-83.83,11.87],[-83.65,10.92],[-85.09,11.01],[-85.69,11.08],[-87.69,12.91],[-87.3,12.99],[-84.91,14.81],[-83.24,14.98]]]]},"properties":{"name":"Nicaragua"},"id":"NI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[4.25,18.65],[4.25,19.15],[5.81,19.45],[11.99,23.52],[14.23,22.61],[15,23],[15.2,21.5],[16,20.35],[15.49,16.91],[13.47,14.46],[13.63,13.72],[12.46,13.07],[10.72,13.39],[9.63,12.8],[7.82,13.35],[6.93,13],[5.87,13.75],[4.14,13.48],[3.6,11.69],[2.84,12.4],[2.4,11.9],[2.14,12.69],[0.99,13.05],[1.29,13.35],[0.6,13.7],[0.24,14.92],[3.52,15.36],[4.2,16.39],[4.25,18.65]]]]},"properties":{"name":"Niger"},"id":"NE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[5.87,13.75],[6.93,13],[7.82,13.35],[9.63,12.8],[10.72,13.39],[12.46,13.07],[13.63,13.72],[14.07,13.08],[14.65,11.58],[13.81,11.06],[11.86,7.08],[11.34,6.44],[10.62,7.07],[9.8,6.8],[8.59,4.81],[6.96,4.73],[7.01,4.37],[6.77,4.77],[6.85,4.35],[6.1,4.27],[5.45,4.92],[5.64,5.54],[5.26,5.44],[5.5,5.62],[4.53,6.3],[2.72,6.37],[2.79,9.04],[3.86,10.58],[3.6,11.69],[4.14,13.48],[5.87,13.75]]]]},"properties":{"name":"Nigeria"},"id":"NG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-169.89,-19.15],[-169.93,-19.02],[-169.82,-18.97],[-169.89,-19.15]]]]},"properties":{"name":"Niue"},"id":"NU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[167.96,-29.08],[167.91,-29.01],[168,-29.03],[167.96,-29.08]]]]},"properties":{"name":"Norfolk Island"},"id":"NF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[13.97,68.24],[14.14,68.24],[13.45,68.07],[13.97,68.24]]],[[[15.03,68.35],[14.2,68.15],[15.17,68.45],[15.03,68.35]]],[[[15.38,68.85],[15.06,68.57],[14.37,68.68],[15.38,68.85]]],[[[15.99,68.75],[15.74,68.53],[16.57,68.65],[14.99,68.25],[15.64,68.95],[15.99,68.75]]],[[[17.64,69.52],[18.07,69.43],[17.88,69.24],[18,69.19],[16.78,69.06],[17.64,69.52]]],[[[18.89,69.69],[18,69.59],[18.69,69.88],[18.89,69.69]]],[[[23.6,70.58],[23.23,70.28],[22.85,70.41],[23.6,70.58]]],[[[23.45,70.78],[22.78,70.52],[21.95,70.65],[23.45,70.78]]],[[[5.34,61.59],[4.94,61.68],[6.76,61.87],[5.15,61.89],[5.15,62.21],[6.36,62.06],[5.92,62.22],[6.31,62.37],[6.54,62.1],[6.39,62.37],[6.7,62.45],[6.87,62.42],[7,62.25],[6.94,62.11],[7.04,62.09],[7.42,62.23],[6.98,62.31],[6.92,62.36],[6.97,62.37],[6.78,62.48],[6.26,62.45],[6.65,62.5],[6.25,62.57],[8.15,62.69],[7.04,62.97],[8.55,62.65],[7.88,63.01],[8.53,62.84],[8.16,63.12],[9.65,63.62],[10.26,63.26],[10.05,63.41],[10.91,63.45],[11.49,64.02],[11.31,64.12],[10.57,63.8],[11.08,63.84],[10.94,63.74],[10.05,63.5],[9.79,63.66],[10.1,63.76],[9.54,63.76],[12.94,65.31],[12.25,65.23],[12.67,65.92],[13.18,65.85],[12.67,66.07],[14.15,66.32],[13.03,66.19],[13.54,66.3],[12.97,66.52],[13.73,66.6],[13.23,66.71],[13.99,66.78],[13.55,66.93],[15.74,67.17],[14.36,67.23],[15.9,67.56],[14.76,67.81],[15.97,68.25],[16.22,67.89],[16.5,67.79],[16.21,68],[16.52,67.95],[16.36,68.03],[16.72,68.07],[16.1,68.28],[16.81,68.13],[16.32,68.37],[17.35,68.17],[17.55,68.52],[16.46,68.51],[17.68,68.65],[17.24,68.75],[17.79,68.76],[17.43,68.91],[18.15,69.15],[18,69.28],[18.26,69.49],[19.44,69.23],[18.94,69.61],[19.76,69.81],[19.68,69.43],[20.3,69.97],[19.95,69.26],[21.31,70.02],[22.1,69.74],[21.8,70.03],[22.1,70.11],[21.3,70.25],[23.31,69.94],[24.73,70.62],[24.25,70.78],[24.59,70.96],[25.91,70.89],[25.07,70.5],[25.23,70.09],[26.57,70.94],[26.5,70.36],[27.03,70.47],[27.65,71.11],[28.55,70.97],[27.65,70.61],[28.3,70.71],[27.85,70.48],[28.34,70.51],[28.04,70.06],[29.04,70.87],[31.08,70.29],[28.61,70.11],[29.67,69.97],[29.49,69.66],[30.85,69.79],[28.96,69.05],[29.18,69.64],[28.17,69.91],[26.45,69.93],[24.93,68.58],[22.4,68.71],[21.32,69.33],[20.58,69.06],[20.1,69.04],[20.35,68.79],[19.94,68.34],[18.09,68.51],[17.88,67.95],[16.73,67.9],[15.47,66.28],[14.5,66.13],[14.49,65.31],[13.66,64.58],[14.12,64.47],[13.99,64.02],[12.14,63.58],[12.12,61.73],[12.86,61.36],[12.21,61],[12.49,60.11],[11.82,59.85],[11.43,58.99],[10.8,59.19],[10.53,59.88],[10.23,59.04],[9.54,59.11],[8.21,58.12],[6.6,58.07],[5.46,58.74],[6.62,59.05],[5.87,59.07],[6.47,59.56],[5.18,59.51],[7.11,60.49],[5.75,59.99],[5.73,60.39],[5.14,60.35],[5.7,60.69],[4.93,60.8],[6.59,61.15],[7.11,60.86],[7.57,61.48],[5.4,61.07],[4.95,61.26],[5.63,61.36],[4.95,61.41],[5.8,61.45],[5.34,61.59]],[[5.34,61.59],[5.35,61.59],[5.28,61.59],[5.34,61.59]]]]},"properties":{"name":"Norway"},"id":"NO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[145.28,14.16],[145.12,14.12],[145.24,14.19],[145.28,14.16]]],[[[145.62,14.91],[145.57,15.01],[145.63,15.08],[145.62,14.91]]],[[[145.74,15.13],[145.68,15.11],[145.82,15.27],[145.74,15.13]]],[[[145.74,18.04],[145.78,18.17],[145.82,18.16],[145.74,18.04]]],[[[145.68,18.72],[145.66,18.81],[145.71,18.77],[145.68,18.72]]]]},"properties":{"name":"Northern Mariana Islands"},"id":"MP"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[163.01,5.26],[162.9,5.31],[163.02,5.38],[163.01,5.26]]],[[[158.3,6.79],[158.12,6.93],[158.32,6.93],[158.3,6.79]]],[[[138.21,9.52],[138.06,9.42],[138.13,9.57],[138.21,9.52]]]]},"properties":{"name":"Micronesia, Federated States of"},"id":"FM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[168.77,7.3],[168.79,7.29],[168.67,7.33],[168.77,7.3]]],[[[168.57,7.4],[168.55,7.42],[168.56,7.47],[168.57,7.4]]],[[[168.97,7.57],[168.94,7.62],[168.97,7.6],[168.97,7.57]]]]},"properties":{"name":"Marshall Islands"},"id":"MH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[134.56,7.37],[134.49,7.44],[134.63,7.73],[134.56,7.37]]]]},"properties":{"name":"Palau"},"id":"PW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[74.82,37.02],[75.86,36.66],[76.17,35.82],[77.82,35.5],[76.87,34.66],[73.94,34.65],[74.3,33.98],[74.02,33.19],[75.38,32.21],[74.61,31.88],[74.69,31.05],[71.9,27.96],[70.37,28.02],[69.58,27.17],[71.11,24.42],[68.78,24.33],[68.2,23.77],[67.49,23.89],[66.36,25.61],[64.65,25.16],[61.61,25.2],[61.86,26.23],[63.18,26.63],[63.34,27.12],[62.78,27.26],[62.78,28.27],[61.91,28.55],[60.87,29.86],[62.48,29.41],[66.26,29.85],[66.72,31.21],[69.33,31.94],[69.51,33.03],[70.33,33.33],[69.91,34.04],[71.08,34.06],[71.65,35.42],[71.24,36.13],[72.56,36.82],[74.57,37.03],[74.82,37.02]]]]},"properties":{"name":"Pakistan"},"id":"PK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-79.46,9.57],[-77.37,8.67],[-77.22,7.94],[-77.89,7.23],[-78.43,8.05],[-78.14,8.4],[-77.78,8.15],[-78.98,9.14],[-80.47,8.21],[-79.99,7.52],[-80.43,7.24],[-81.74,8.16],[-82.9,8.03],[-82.93,9.47],[-82.56,9.56],[-82.24,9],[-81.2,8.78],[-79.46,9.57]]]]},"properties":{"name":"Panama"},"id":"PA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[152.24,-4.21],[152.1,-5.46],[150.47,-6.28],[148.32,-5.68],[149.88,-5.54],[150.09,-5.01],[150.16,-5.55],[150.92,-5.49],[151.68,-4.91],[151.51,-4.2],[152.24,-4.21]]],[[[141.89,-2.97],[144.51,-3.82],[145.74,-4.8],[145.77,-5.49],[147.48,-5.97],[147.87,-6.66],[146.96,-6.75],[147.18,-7.46],[148.14,-8.07],[148.6,-9.08],[149.31,-9.02],[149.22,-9.47],[150.01,-9.63],[149.91,-10.05],[150.88,-10.23],[150.21,-10.7],[147.95,-10.15],[146.09,-8.09],[144.52,-7.5],[144.21,-7.8],[143.66,-7.47],[143.96,-7.98],[143.36,-7.9],[143.61,-8.24],[142.14,-8.23],[143.11,-8.47],[143.33,-9.03],[141.01,-9.13],[141,-2.61],[141.89,-2.97]]]]},"properties":{"name":"Papua New Guinea"},"id":"PG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-54.33,-24.68],[-54.6,-25.57],[-54.7,-26.44],[-55.74,-27.44],[-58.6,-27.32],[-57.58,-25.55],[-57.76,-25.18],[-61.01,-23.81],[-62.64,-22.24],[-61.74,-19.65],[-59.1,-19.35],[-58.16,-20.17],[-57.99,-22.09],[-55.85,-22.29],[-55.41,-23.96],[-54.41,-23.92],[-54.33,-24.68]]]]},"properties":{"name":"Paraguay"},"id":"PY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-78.71,-4.58],[-78.34,-3.42],[-75.56,-1.53],[-75.22,-0.97],[-75.63,-0.11],[-75.29,-0.12],[-73.56,-1.37],[-72.88,-2.51],[-71.7,-2.15],[-70.29,-2.51],[-70.72,-3.78],[-69.96,-4.24],[-70.77,-4.15],[-72.85,-5.12],[-73.12,-6.45],[-74.01,-7.54],[-72.96,-8.98],[-73.21,-9.41],[-72.37,-9.49],[-72.14,-10],[-70.51,-9.43],[-70.63,-11.01],[-69.57,-10.95],[-68.67,-12.5],[-69.42,-15.62],[-68.82,-16.34],[-69.5,-17.51],[-70.41,-18.35],[-75.93,-14.66],[-78.99,-8.23],[-79.98,-6.76],[-81.17,-6.09],[-80.87,-5.65],[-81.29,-4.31],[-80.34,-3.38],[-80.47,-4.44],[-79.65,-4.43],[-79.05,-5.01],[-78.71,-4.58]]]]},"properties":{"name":"Peru"},"id":"PE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[126.05,9.23],[126.59,7.28],[126.19,6.27],[125.65,7.24],[125.41,5.56],[125.26,6.09],[124.19,6.21],[124.27,7.37],[123.68,7.81],[122.83,7.28],[122.62,7.77],[121.92,6.99],[122.22,7.96],[123.38,8.73],[123.82,8.48],[123.67,7.95],[124.73,8.49],[124.8,9],[125.51,9.01],[125.44,9.81],[126.05,9.23]]],[[[124.48,10.05],[124.37,9.63],[123.79,9.73],[124.48,10.05]]],[[[123.56,10.79],[123.01,9.03],[122.45,9.97],[122.95,10.89],[123.56,10.79]]],[[[124.02,11.12],[124.03,10.38],[123.31,9.41],[124.02,11.12]]],[[[119.51,11.34],[119.71,10.5],[117.19,8.33],[119.31,10.58],[119.22,10.96],[119.46,10.72],[119.51,11.34]]],[[[124.64,11.29],[125.03,11.2],[125.01,10.03],[124.29,11.54],[124.64,11.29]]],[[[122.23,11.8],[123.15,11.6],[123.13,11.17],[121.94,10.42],[121.85,11.76],[122.23,11.8]]],[[[124.46,12.52],[125.3,12.46],[125.76,11.01],[124.84,11.47],[124.46,12.52]]],[[[123.67,12.35],[124.08,11.72],[123.53,12.21],[123.16,11.91],[123.24,12.61],[123.67,12.35]]],[[[120.72,13.48],[121.5,13.15],[121.22,12.23],[120.3,13.44],[120.72,13.48]]],[[[121.26,18.57],[122.24,18.51],[122.53,17.1],[121.38,15.33],[121.73,14.17],[122.23,13.9],[122.71,14.34],[123.1,13.67],[123.34,14.09],[123.92,13.79],[123.53,13.58],[124.2,13.06],[124.08,12.54],[122.56,13.94],[122.61,13.16],[121.75,13.96],[120.66,13.77],[120.96,14.64],[120.09,14.79],[119.79,16.32],[120.42,16.16],[120.57,18.49],[121.26,18.57]]]]},"properties":{"name":"Philippines"},"id":"PH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-128.29,-24.41],[-128.34,-24.33],[-128.3,-24.33],[-128.29,-24.41]]]]},"properties":{"name":"Pitcairn Islands"},"id":"PN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[18.85,49.52],[17.72,50.32],[16.64,50.11],[16.34,50.66],[14.83,50.87],[14.28,53.7],[17.9,54.82],[19.8,54.44],[22.79,54.36],[23.5,53.95],[23.94,52.73],[23.17,52.28],[23.64,52.08],[23.6,51.53],[24.11,50.57],[22.56,49.08],[18.85,49.52]]]]},"properties":{"name":"Poland"},"id":"PL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-8.2,41.87],[-6.59,41.95],[-6.19,41.58],[-6.93,41.02],[-7.02,39.67],[-7.53,39.67],[-6.95,39.03],[-7.43,37.25],[-8.99,37.02],[-8.67,38.41],[-9.18,38.42],[-8.98,38.95],[-9.48,38.71],[-8.66,40.69],[-8.75,41.95],[-8.2,41.87]]]]},"properties":{"name":"Portugal"},"id":"PT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-14.52,12.68],[-13.71,12.68],[-13.71,11.72],[-14.69,11.51],[-15.02,10.96],[-15.51,11.34],[-15.03,11.59],[-15.56,11.72],[-15,11.97],[-15.96,11.73],[-15.7,12],[-16.25,11.93],[-16.11,12.33],[-16.72,12.32],[-14.52,12.68]]]]},"properties":{"name":"Guinea-Bissau"},"id":"GW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[124.45,-9.18],[124.34,-9.46],[124.05,-9.34],[124.45,-9.18]]],[[[127.25,-8.48],[125.13,-9.44],[125.16,-9.07],[124.95,-8.95],[127.25,-8.48]]]]},"properties":{"name":"Timor-Leste"},"id":"TL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-67,18.5],[-65.6,18.23],[-67.19,17.93],[-67,18.5]]]]},"properties":{"name":"Puerto Rico"},"id":"PR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[51.52,25.38],[51.22,24.62],[50.83,24.75],[51.04,26.05],[51.57,25.91],[51.52,25.38]]]]},"properties":{"name":"Qatar"},"id":"QA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[55.71,-21],[55.67,-21.37],[55.22,-21.03],[55.71,-21]]]]},"properties":{"name":"Reunion"},"id":"RE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[20.73,46.18],[22.89,47.95],[24.92,47.71],[26.63,48.26],[28.12,46.85],[28.21,45.45],[29.66,45.21],[29.55,44.82],[28.87,44.94],[28.58,43.75],[27.04,44.15],[24.18,43.68],[22.68,44.22],[22.48,44.71],[21.4,44.78],[21.51,45.15],[20.26,46.11],[20.73,46.18]]]]},"properties":{"name":"Romania"},"id":"RO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[143.66,49.31],[143.02,49.14],[142.53,48],[143.09,46.8],[143.49,46.81],[143.47,46.09],[142.71,46.74],[142.08,45.89],[141.85,48.75],[142.27,51.12],[141.64,52.32],[141.77,53.37],[142.8,53.7],[142.39,54.24],[142.7,54.42],[143.29,53.13],[143.22,51.52],[144.75,48.64],[143.66,49.31]],[[143.66,49.31],[143.25,49.38],[143.32,49.31],[143.66,49.31]]],[[[21.43,55.25],[22.84,54.9],[22.79,54.36],[19.8,54.44],[20.4,54.68],[19.87,54.64],[19.97,54.96],[20.94,55.29],[20.53,54.97],[21.09,54.89],[21.26,55.25],[21.43,55.25]]],[[[-179.63,68.91],[-175.46,67.71],[-174.83,67.38],[-175,66.67],[-174.46,66.3],[-173.76,66.45],[-174.65,67.06],[-173.67,67.13],[-171.73,66.96],[-169.69,66.07],[-170.64,65.61],[-171.54,65.83],[-171.12,65.48],[-172.8,65.68],[-172.13,65.09],[-173.2,64.79],[-172.36,64.46],[-173.19,64.25],[-173.41,64.62],[-175.45,64.78],[-176.08,65.47],[-178.56,65.52],[-178.91,65.99],[-178.52,66.4],[-179.7,66.18],[-179.32,65.54],[-180,65.07],[-180,68.98],[-179.63,68.91]]],[[[55.33,73.33],[56.59,73.14],[55.62,72.96],[56.26,72.96],[55.43,72.78],[55.95,72.67],[55.12,72.45],[55.58,72.2],[55.22,71.93],[57.64,70.73],[53.46,70.81],[54.24,71.13],[51.42,71.74],[53.22,72.65],[52.38,72.72],[53.38,72.88],[53.15,73.16],[55.33,73.33]]],[[[139.19,76.07],[140.48,75.64],[141.62,76.01],[141.36,76.18],[145.39,75.52],[143.95,75.03],[142.9,75.13],[142.5,75.36],[142.51,75.45],[143.04,75.67],[142.45,75.71],[142.16,75.38],[142.61,75.1],[143.71,74.94],[139.1,74.65],[136.86,75.35],[137.4,75.35],[136.96,75.6],[137.74,75.75],[137.45,75.95],[139.19,76.07]]],[[[68.27,76.96],[68.86,76.54],[61.29,75.33],[59.15,74.44],[58.18,74.57],[58.74,74.27],[57.26,74.08],[57.72,73.71],[56.56,73.88],[57.61,73.66],[56.72,73.67],[57.25,73.49],[56.76,73.25],[55.91,73.44],[54.22,73.32],[55.18,73.71],[53.63,73.76],[55.87,74.1],[55.07,74.26],[56.98,74.69],[55.83,74.8],[56.68,74.95],[55.8,75.15],[58,75.67],[68.27,76.96]]],[[[104.27,77.68],[106.29,77.36],[104.12,77.09],[107.5,76.92],[106.4,76.51],[111.1,76.76],[113.89,75.85],[113.51,75.53],[112.34,75.85],[113.72,75.41],[105.21,72.76],[110.91,73.7],[109.53,73.77],[110.2,74.02],[112.89,73.96],[113.5,73.33],[113.49,72.96],[113.1,72.85],[113.18,72.72],[113.53,72.63],[114.04,72.6],[113.36,72.69],[113.23,72.74],[113.15,72.83],[113.53,72.96],[113.55,73.24],[114.03,73.34],[113.48,73.5],[118.63,73.57],[118.99,73.49],[118.39,73.24],[119.82,72.94],[126.37,72.35],[127.22,71.39],[127.33,71.9],[126.72,72.39],[127.66,72.35],[131.13,70.73],[132.73,71.94],[133.68,71.43],[135.86,71.64],[137.85,71.11],[138.07,71.57],[139.93,71.48],[139.34,71.95],[140.2,72.2],[139.09,72.23],[141.02,72.59],[140.75,72.89],[146.85,72.35],[144.39,72.17],[146.93,72.31],[144.96,71.96],[145.32,71.66],[147.14,72.32],[149.19,72.22],[150.08,71.88],[148.82,71.67],[152.54,70.84],[159.05,70.87],[160.04,70.41],[159.73,69.83],[161,69.59],[161.41,68.98],[160.85,68.52],[161.58,68.91],[161.45,69.39],[164.01,69.77],[167.79,69.78],[168.28,69.24],[170.61,68.76],[171.03,69.04],[170.12,69.61],[170.47,70.13],[176.11,69.89],[180,68.98],[180,65.07],[178.52,64.59],[176.9,65.08],[176.3,65.05],[177.3,64.83],[174.44,64.69],[177.49,64.76],[179.56,62.62],[179.06,62.28],[176.98,62.87],[177.27,62.57],[172.71,61.43],[170.25,59.91],[169.21,60.62],[166.14,59.82],[166.35,60.49],[164.83,59.78],[163.64,60.05],[163.19,59.05],[161.94,58.07],[162.35,57.68],[163.21,57.84],[162.74,57.36],[163.35,56.2],[162.39,56.4],[161.71,55.5],[162.11,54.76],[160.01,54.14],[160.06,53.09],[158.43,53.02],[158.28,51.94],[156.67,50.88],[155.54,55.3],[155.95,56.67],[156.98,57.41],[156.75,57.73],[158.23,58.02],[161.91,60.42],[163.66,60.87],[164.13,62.28],[165.64,62.45],[163.26,62.54],[162.95,61.81],[163.29,61.66],[160.14,60.58],[160.39,61.03],[159.78,60.94],[159.83,61.26],[160.35,61.95],[157.49,61.8],[154.23,59.88],[154.11,59.46],[155.19,59.36],[154.74,59.13],[151.31,58.84],[151.07,59.11],[152.29,59.23],[149.6,59.77],[148.9,59.24],[142.16,59.07],[135.15,54.86],[136.82,54.65],[136.76,53.77],[137.74,54.32],[137.31,53.53],[138.55,53.99],[138.44,53.51],[138.64,54.3],[139.75,54.31],[141.42,53.29],[140.71,53.11],[141.51,52.21],[140.46,50.71],[140.7,50.09],[140.18,48.45],[135.13,43.5],[133.15,42.68],[131.81,43.33],[130.7,42.29],[130.64,42.41],[130.6,42.42],[130.41,42.72],[131.31,43.39],[130.95,44.84],[131.86,45.35],[133.12,45.13],[134.74,48.27],[130.99,47.69],[130.67,48.86],[127.53,49.79],[126.1,52.76],[123.38,53.53],[120.86,53.28],[120.03,52.77],[120.78,52.11],[119.21,50.02],[117.87,49.52],[116.71,49.83],[114.31,50.28],[110.79,49.15],[108.57,49.33],[106.66,50.34],[102.92,50.32],[102.33,50.57],[102.22,51.33],[98.93,52.14],[97.83,51],[98.29,50.29],[97.34,49.73],[92.32,50.81],[87.84,49.17],[87.35,49.09],[86.77,49.79],[85.26,49.59],[83.46,51],[81.47,50.74],[80.69,51.31],[80.08,50.76],[77.91,53.27],[76.52,53.99],[76.81,54.45],[73.44,53.44],[73.76,54.07],[71.19,54.1],[70.84,55.3],[69.19,55.34],[65.22,54.32],[61.01,53.95],[60.91,53.62],[61.58,53.51],[61.18,53.31],[62.12,53],[61.1,52.98],[60.69,52.68],[61.06,52.34],[60,51.96],[61.69,51.27],[61.38,50.78],[59.54,50.48],[58.34,51.16],[56.51,51.08],[55.69,50.53],[54.65,51.04],[54.52,50.53],[53.43,51.49],[50.77,51.77],[48.7,50.59],[48.8,49.94],[47.52,50.44],[46.5,48.42],[47.38,47.69],[48.2,47.7],[49.03,46.78],[48.56,46.56],[49.22,46.35],[48.71,45.83],[47.38,45.74],[46.68,44.52],[47.41,43.5],[47.7,43.87],[47.46,43.02],[48.58,41.84],[47.77,41.2],[46.57,41.87],[46.45,41.9],[44.93,42.76],[43.91,42.58],[42.85,43.18],[40,43.38],[36.58,45.18],[37.74,45.3],[37.94,46.03],[38.57,46.09],[37.73,46.67],[39.3,47.08],[38.24,47.11],[38.85,47.86],[39.8,47.86],[39.66,48.62],[40.08,48.87],[39.7,49.01],[40.14,49.6],[38.02,49.9],[37.46,50.44],[35.61,50.37],[35.37,51.04],[34.38,51.26],[34.1,51.65],[34.42,51.81],[33.42,52.36],[31.78,52.11],[31.27,53.02],[32.74,53.46],[30.78,54.79],[30.93,55.6],[28.17,56.15],[27.86,57.3],[27.37,57.54],[27.82,57.87],[27.43,58.81],[28.02,59.48],[30.25,59.98],[28.6,60.38],[28.69,60.74],[27.81,60.55],[31.59,62.91],[29.99,63.74],[30.58,64.22],[29.64,64.93],[30.13,65.72],[29.07,66.9],[30.03,67.69],[28.69,68.2],[28.82,68.84],[28.43,68.9],[28.96,69.05],[30.85,69.79],[33.09,69.75],[32.03,69.64],[33.52,69.42],[33.02,68.95],[33.72,69.33],[35.97,69.17],[40.99,67.72],[41.22,66.84],[38.61,66.05],[31.85,67.15],[34.85,65.9],[34.38,65.38],[34.79,64.55],[37.41,63.8],[37.98,64.32],[36.44,64.94],[37.03,65.21],[38.41,64.86],[38.05,64.64],[40.51,64.54],[39.75,65.55],[42.17,66.52],[44.17,65.87],[44.5,66.91],[43.75,67.32],[44.25,68.27],[43.31,68.68],[46.52,68.14],[46.71,67.81],[44.91,67.37],[46.39,66.74],[47.7,66.99],[47.99,67.65],[49.1,67.63],[48.59,67.93],[52.27,68.31],[52.73,68.47],[52.49,68.59],[52.65,68.65],[52.29,68.61],[53.78,68.97],[54.56,68.99],[53.59,68.9],[54.02,68.86],[53.95,68.4],[53.21,68.26],[54.79,68.16],[58.9,69],[59.43,68.75],[59.07,68.42],[59.84,68.37],[60.91,68.9],[60.14,69.57],[60.87,69.86],[64.15,69.54],[68.44,68.22],[69.22,68.96],[66.8,69.57],[67.34,70.75],[66.62,71.05],[68.47,71.82],[69.33,72.95],[71.56,72.91],[72.83,72.71],[72.88,72.28],[71.8,71.47],[72.84,70.87],[72.42,70.27],[72.55,68.98],[73.65,68.46],[71.41,66.97],[71.56,66.65],[68.97,66.8],[72,66.22],[74.74,67.69],[74.33,68.38],[74.64,68.77],[76.59,68.97],[77.32,68.52],[77.09,67.78],[79.04,67.57],[77.46,67.76],[78.17,68.26],[77.63,68.91],[73.75,69.17],[73.52,69.76],[74.31,70.67],[73.02,71.42],[74.96,72.11],[74.83,72.83],[75.72,72.56],[75.24,71.38],[76.92,71.07],[79.11,71],[76.1,71.93],[78.1,71.88],[77.37,72.1],[78.54,72.4],[83.26,71.72],[82.26,71.26],[82.08,70.57],[82.35,70.2],[82.16,70.58],[83.12,70.89],[82.64,70.17],[83.11,70.07],[83.75,70.46],[83.15,71.24],[83.63,71.62],[80.72,72.53],[80.82,72.97],[80.23,73.17],[80.51,73.57],[87.09,73.86],[85.78,73.46],[86.78,72.99],[85.85,73.48],[87.66,73.89],[85.95,74.28],[87.13,74.37],[85.79,74.63],[86.03,74.81],[86.91,74.61],[87.79,75.02],[86.99,75.15],[94.16,75.94],[92.87,75.95],[93.16,76.1],[99.28,76.21],[99.77,76.03],[99.09,75.55],[100.19,75.17],[99.17,75.57],[99.88,76.09],[98.81,76.49],[102.23,76.38],[100.85,76.88],[104.27,77.68]]],[[[102.97,79.33],[102.39,78.83],[103.95,79.13],[105.41,78.56],[99.34,78.02],[101.62,78.98],[100.99,79.06],[101.55,79.35],[102.97,79.33]]],[[[97.61,80.17],[98.03,80.07],[97.19,79.7],[100.02,79.82],[99.04,79.29],[99.94,78.95],[97.3,78.85],[92.85,79.55],[97.61,80.17]]]]},"properties":{"name":"Russia"},"id":"RU"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[29.95,-2.31],[29.85,-2.76],[29.02,-2.74],[29.6,-1.39],[30.48,-1.06],[30.89,-2.08],[30.57,-2.4],[29.95,-2.31]]]]},"properties":{"name":"Rwanda"},"id":"RW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-63.03,18.02],[-63.14,18.06],[-63.01,18.07],[-63.03,18.02]]]]},"properties":{"name":"Saint Barthelemy"},"id":"BL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-5.66,-15.99],[-5.79,-15.99],[-5.7,-15.9],[-5.66,-15.99]]]]},"properties":{"name":"Saint Helena"},"id":"SH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-62.55,17.09],[-62.62,17.11],[-62.6,17.2],[-62.55,17.09]]],[[[-62.7,17.34],[-62.63,17.22],[-62.86,17.37],[-62.7,17.34]]]]},"properties":{"name":"Saint Kitts and Nevis"},"id":"KN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-63.17,18.16],[-62.97,18.27],[-62.99,18.23],[-63.17,18.16]]]]},"properties":{"name":"Anguilla"},"id":"AI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-60.95,13.71],[-61.08,13.88],[-60.93,14.11],[-60.95,13.71]]]]},"properties":{"name":"Saint Lucia"},"id":"LC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-63.01,18.08],[-63.01,18.07],[-63.14,18.06],[-63.01,18.08]]]]},"properties":{"name":"Saint Martin"},"id":"MF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-56.15,46.76],[-56.24,46.76],[-56.17,46.81],[-56.15,46.76]]],[[[-56.27,46.99],[-56.37,46.78],[-56.39,47.12],[-56.27,46.99]]]]},"properties":{"name":"Saint Pierre and Miquelon"},"id":"PM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-61.17,13.13],[-61.28,13.21],[-61.18,13.38],[-61.17,13.13]]]]},"properties":{"name":"Saint Vincent and the Grenadines"},"id":"VC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[12.42,43.96],[12.51,43.99],[12.46,43.9],[12.42,43.96]]]]},"properties":{"name":"San Marino"},"id":"SM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[6.52,0.02],[6.47,0.26],[6.69,0.4],[6.52,0.02]]],[[[7.42,1.56],[7.33,1.61],[7.41,1.7],[7.42,1.56]]]]},"properties":{"name":"Sao Tome and Principe"},"id":"ST"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[44.72,29.2],[46.55,29.1],[48.42,28.55],[48.84,27.62],[50.16,26.66],[49.99,26.02],[50.83,24.75],[51.22,24.62],[51.58,24.26],[52.58,22.94],[55.2,22.7],[55.67,22],[55,20],[52,19],[48.77,18.27],[46.33,15.62],[46.33,16.67],[44.47,17.41],[43.31,17.46],[42.79,16.38],[40.76,19.76],[39.18,21.1],[38.45,23.78],[37.44,24.37],[35.16,28.06],[34.57,28.09],[34.96,29.36],[36.07,29.19],[37.5,30],[38,30.5],[37.01,31.51],[39.2,32.15],[42.08,31.11],[44.72,29.2]]]]},"properties":{"name":"Saudi Arabia"},"id":"SA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-17.15,14.61],[-17.54,14.76],[-16.53,16.06],[-16.28,16.52],[-14.35,16.64],[-12.24,14.76],[-11.37,12.41],[-13.71,12.68],[-14.52,12.68],[-16.72,12.32],[-15.39,12.83],[-16.76,12.56],[-16.75,13.06],[-15.81,13.16],[-15.8,13.35],[-15.29,13.37],[-15.11,13.6],[-13.8,13.41],[-15.07,13.83],[-16.57,13.59],[-16.36,14.17],[-16.78,14.01],[-17.15,14.61]]]]},"properties":{"name":"Senegal"},"id":"SN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[20.07,42.56],[20.35,42.89],[19.23,43.51],[19.62,44.05],[19.04,44.86],[19.42,45.23],[18.82,45.91],[20.26,46.11],[21.51,45.15],[21.4,44.78],[22.48,44.71],[22.68,44.22],[22.37,43.83],[23,43.19],[22.37,42.32],[20.59,41.88],[20.07,42.56]]]]},"properties":{"name":"Serbia"},"id":"RS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[55.54,-4.76],[55.38,-4.63],[55.46,-4.55],[55.54,-4.76]]]]},"properties":{"name":"Seychelles"},"id":"SC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-11.21,10],[-10.57,9.06],[-10.7,8.3],[-10.27,8.49],[-11.49,6.93],[-12.96,7.9],[-13.3,9.03],[-12.46,9.89],[-11.21,10]]]]},"properties":{"name":"Sierra Leone"},"id":"SL"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[103.99,1.38],[103.64,1.32],[103.71,1.43],[103.99,1.38]]]]},"properties":{"name":"Singapore"},"id":"SG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[17.25,48.02],[17.17,48.01],[16.95,48.62],[18.85,49.52],[22.56,49.08],[22.15,48.41],[20.66,48.56],[18.66,47.76],[17.25,48.02]]]]},"properties":{"name":"Slovakia"},"id":"SK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[105.58,23.06],[106.71,22.86],[106.69,22.03],[107.99,21.54],[106.64,21.02],[105.61,18.98],[108.83,15.42],[109.47,12.89],[109.27,11.89],[108,10.7],[107.27,10.38],[106.74,10.67],[106.42,10.31],[106.78,10.08],[106.29,10.25],[106.62,9.81],[106.12,10.24],[106.54,9.58],[105.82,10],[106.19,9.37],[105.02,8.59],[105.11,9.95],[104.45,10.42],[105.1,10.96],[106.2,10.77],[105.85,11.66],[107.55,12.35],[107.49,14.45],[107.55,14.71],[107.7,15.27],[107.18,15.78],[107.46,16.08],[106.69,16.46],[105.19,18.64],[103.88,19.29],[104.98,20],[104.38,20.44],[104.64,20.66],[103.17,20.85],[102.98,21.74],[102.14,22.4],[102.48,22.77],[103.96,22.5],[105.35,23.33],[105.58,23.06]]]]},"properties":{"name":"Vietnam"},"id":"VN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[13.72,46.53],[16.11,46.87],[16.61,46.48],[16.57,46.48],[15.65,46.22],[15.17,45.43],[13.59,45.48],[13.72,45.6],[13.38,46.3],[13.72,46.53]]]]},"properties":{"name":"Slovenia"},"id":"SI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[42.94,11],[43.25,11.47],[44.28,10.45],[44.9,10.42],[50.77,11.98],[51.28,11.84],[51.01,10.44],[51.41,10.45],[50.9,10.32],[50.84,9.43],[47.95,4.46],[43.49,0.65],[41.56,-1.67],[41,-0.87],[40.99,2.83],[41.91,3.98],[43.69,4.89],[44.95,4.9],[47.99,8],[44.01,9.01],[42.85,10.22],[42.94,11]]]]},"properties":{"name":"Somalia"},"id":"SO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[29.89,-22.19],[31.3,-22.41],[32.02,-24.46],[31.97,-25.96],[31.33,-25.75],[30.9,-26.31],[31.16,-27.2],[31.99,-27.32],[32.13,-26.84],[32.89,-26.85],[32.39,-28.54],[27.9,-33.04],[25.7,-34.03],[22.54,-34.01],[20,-34.82],[18.79,-34.09],[18.4,-34.3],[17.85,-32.83],[18.29,-32.62],[18.28,-31.89],[16.49,-28.58],[17.06,-28.03],[17.4,-28.71],[18.18,-28.91],[20,-28.42],[20,-24.77],[20.81,-25.88],[20.64,-26.83],[21.67,-26.86],[23.01,-25.3],[25.51,-25.68],[26.96,-23.75],[29.37,-22.19],[29.89,-22.19]],[[28.57,-28.61],[27.01,-29.63],[27.56,-30.4],[28.08,-30.65],[29.17,-29.91],[29.43,-29.28],[28.57,-28.61]]]]},"properties":{"name":"South Africa"},"id":"ZA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[32.99,-17.27],[32.7,-18.94],[33.02,-19.94],[32.49,-21.34],[31.3,-22.41],[29.89,-22.19],[29.37,-22.19],[28.02,-21.57],[27.71,-20.51],[26.17,-19.53],[25.26,-17.8],[27.04,-17.96],[28.93,-15.97],[30.42,-15.63],[30.42,-16.01],[32.98,-16.71],[32.99,-17.27]]]]},"properties":{"name":"Zimbabwe"},"id":"ZW"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-16.34,28.37],[-16.67,27.98],[-16.91,28.34],[-16.34,28.37]]],[[[3.25,39.73],[3.06,39.26],[2.36,39.56],[3.25,39.73]]],[[[-7.86,43.76],[-1.78,43.36],[1.45,42.6],[1.72,42.51],[3.18,42.44],[3.18,41.87],[0.96,41.03],[0.05,40.04],[-0.34,39.44],[0.21,38.73],[-0.72,37.61],[-2.13,36.73],[-4.4,36.72],[-5.33,36.16],[-5.36,36.16],[-6.04,36.18],[-6.36,36.86],[-7.43,37.25],[-6.95,39.03],[-7.53,39.67],[-7.02,39.67],[-6.93,41.02],[-6.19,41.58],[-6.59,41.95],[-8.2,41.87],[-8.75,41.95],[-9.21,43.15],[-7.86,43.76]]]]},"properties":{"name":"Spain"},"id":"ES"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-15.74,21.34],[-16.95,21.34],[-17.05,20.76],[-16.92,21.94],[-16.49,22.33],[-16.36,22.57],[-16.28,22.9],[-16.16,22.99],[-16.18,23.08],[-16.08,23.32],[-15.77,23.78],[-15.78,23.91],[-16.01,23.67],[-15.84,23.9],[-15.58,24.06],[-15.18,24.49],[-15.03,24.54],[-14.9,24.69],[-14.48,26.17],[-13.57,26.73],[-13.17,27.67],[-8.67,27.67],[-8.67,27.29],[-8.67,26],[-12,26],[-12,23.45],[-13.11,22.89],[-13,21.34],[-15.74,21.34]]]]},"properties":{"name":"Western Sahara"},"id":"EH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[31.45,22],[36.89,22],[37.43,18.86],[38.6,17.99],[37,17.07],[36.54,14.26],[36.14,12.71],[35.1,11.83],[34.86,10.73],[34.29,10.55],[34.12,8.58],[33.25,8.46],[32.99,7.92],[34.7,6.68],[35.94,4.62],[34.39,4.61],[34,4.22],[33.52,3.75],[30.86,3.49],[29.64,4.64],[28.36,4.29],[27.46,5.02],[25.25,7.85],[23.52,8.71],[23.67,9.87],[22.87,10.92],[22.47,12.62],[21.83,12.8],[22.94,15.56],[24,15.7],[24,19.5],[24,20],[25,20],[25,22],[31.45,22]]]]},"properties":{"name":"Sudan"},"id":"SD"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-55.13,5.82],[-54.03,5.82],[-54.17,5.35],[-54.48,4.75],[-54,3.45],[-54.6,2.33],[-55.97,2.53],[-55.9,1.89],[-56.47,1.94],[-58.05,4.01],[-57.25,5.49],[-56.97,6],[-55.13,5.82]]]]},"properties":{"name":"Suriname"},"id":"SR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[23.34,78.2],[23.06,78.02],[24.91,77.75],[22.64,77.25],[22.78,77.55],[20.86,77.46],[21.64,77.91],[20.9,78.11],[23.34,78.2]]],[[[21.5,78.57],[22.27,78.26],[20.12,78.47],[21.5,78.57]]],[[[16.82,79.87],[18.1,79.72],[17.64,79.37],[18.36,79.63],[18.92,79.16],[21.55,78.77],[18.97,78.46],[19.09,78.1],[16.61,76.57],[15.5,76.88],[16.52,77],[13.91,77.53],[16.22,77.43],[14.74,77.66],[17.01,77.93],[13.94,77.72],[13.59,78.05],[17.3,78.42],[16.33,78.45],[16.83,78.67],[15.46,78.45],[15.38,78.84],[13.01,78.2],[12.36,78.48],[13.2,78.54],[11.33,78.96],[12.51,78.91],[11.76,79.08],[12.11,79.3],[11.24,79.09],[10.68,79.54],[13.82,79.88],[12.45,79.57],[14.06,79.26],[13.89,79.54],[14.58,79.8],[16.45,78.9],[15.64,79.83],[16.82,79.87]]],[[[20.04,80.46],[22.23,79.98],[22.89,80.49],[23.36,80.43],[23.1,80.12],[24.84,80.35],[27.24,79.9],[23.51,79.18],[19.64,79.6],[22.31,79.8],[18.77,79.72],[17.78,80.13],[20.04,80.46]]]]},"properties":{"name":"Svalbard"},"id":"SJ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[30.9,-26.31],[31.33,-25.75],[31.97,-25.96],[32.13,-26.84],[31.99,-27.32],[31.16,-27.2],[30.9,-26.31]]]]},"properties":{"name":"Swaziland"},"id":"SZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[21.81,68.57],[23.67,67.94],[23.43,67.47],[24.01,66.8],[23.66,66.31],[24.17,65.81],[21.77,65.72],[22.2,65.55],[21.26,65.34],[21.62,65.14],[21.04,64.82],[21.58,64.44],[20.78,63.87],[18.21,62.78],[17.7,62.99],[18.05,62.6],[17.33,62.49],[17.65,62.23],[17.15,60.95],[19.08,59.76],[17.94,59.34],[17.59,59.81],[17.73,59.44],[16.02,59.49],[17.38,59.25],[18.65,59.32],[16.19,58.63],[16.94,58.48],[16.41,58.47],[16.82,58.2],[16.42,57.89],[16.69,57.47],[15.87,56.09],[14.7,56.16],[14.19,55.39],[12.98,55.4],[12.45,56.3],[12.89,56.64],[11.7,57.7],[11.8,58.32],[11.2,58.4],[11.11,59],[11.43,58.99],[11.82,59.85],[12.49,60.11],[12.21,61],[12.86,61.36],[12.12,61.73],[12.14,63.58],[13.99,64.02],[14.12,64.47],[13.66,64.58],[14.49,65.31],[14.5,66.13],[15.47,66.28],[16.73,67.9],[17.88,67.95],[18.09,68.51],[19.94,68.34],[20.35,68.79],[20.1,69.04],[20.58,69.06],[21.81,68.57]]]]},"properties":{"name":"Sweden"},"id":"SE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[7.7,47.54],[9.57,47.54],[9.53,47.27],[9.47,47.06],[9.6,47.06],[10.47,46.87],[10.13,46.23],[9.28,46.5],[9.04,45.84],[8.44,46.46],[7.86,45.92],[7.04,45.93],[6.79,46.43],[5.97,46.21],[6.99,47.5],[7.59,47.58],[7.7,47.54]]],[[[8.71,47.7],[8.68,47.69],[8.67,47.71],[8.71,47.7]]]]},"properties":{"name":"Switzerland"},"id":"CH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[42.36,37.11],[41.29,36.36],[41,34.42],[38.79,33.38],[36.84,32.31],[35.65,32.69],[35.62,33.25],[36.62,34.2],[35.97,34.65],[35.92,35.93],[36.69,36.24],[36.66,36.83],[42.36,37.11]]]]},"properties":{"name":"Syria"},"id":"SY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[74.92,37.24],[73.31,37.46],[71.68,36.68],[71.59,37.9],[70.97,38.47],[69.32,37.12],[67.78,37.19],[68.38,38.2],[67.44,39.48],[68.54,39.55],[69.01,40.09],[68.6,40.18],[70.42,41.05],[70.8,40.73],[70.38,40.38],[70.98,40.24],[69.54,40.13],[69.31,39.54],[73.66,39.45],[73.82,38.61],[74.86,38.47],[74.92,37.24]]]]},"properties":{"name":"Tajikistan"},"id":"TJ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[100.08,20.35],[100.09,20.35],[100.58,20.16],[100.5,19.53],[101.28,19.56],[100.92,17.57],[102.09,18.21],[102.68,17.82],[103.4,18.43],[104.72,17.5],[104.75,16.53],[105.64,15.66],[105.21,14.35],[103.18,14.33],[102.38,13.57],[102.92,11.64],[102.06,12.57],[100.85,12.68],[100.98,13.46],[100.07,13.42],[100.02,12.19],[99.15,10.37],[99.24,9.25],[99.85,9.3],[100.42,7.16],[102.1,6.24],[101.14,5.63],[100.65,6.45],[100.13,6.42],[98.66,8.38],[98.27,8.27],[98.74,10.35],[99.66,11.83],[99.17,13.73],[98.2,15.07],[98.93,16.39],[97.35,18.56],[97.77,18.57],[98.05,19.81],[100.08,20.35]]]]},"properties":{"name":"Thailand"},"id":"TH"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[1.4,9.43],[1.64,6.22],[1.2,6.1],[0.53,6.95],[0.73,8.32],[-0.15,11.14],[0.92,11],[0.78,10.38],[1.4,9.43]]]]},"properties":{"name":"Togo"},"id":"TG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-171.84,-9.21],[-171.86,-9.21],[-171.85,-9.17],[-171.84,-9.21]]]]},"properties":{"name":"Tokelau"},"id":"TK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-175.15,-21.18],[-175.36,-21.1],[-175.05,-21.14],[-175.15,-21.18]]]]},"properties":{"name":"Tonga"},"id":"TO"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-60.92,10.8],[-61.01,10.14],[-61.92,10.04],[-61.46,10.28],[-61.66,10.71],[-60.92,10.8]]],[[[-60.64,11.2],[-60.85,11.16],[-60.53,11.35],[-60.64,11.2]]]]},"properties":{"name":"Trinidad and Tobago"},"id":"TT"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[56.18,25.65],[56.27,25.64],[56.37,24.98],[56.04,24.94],[55.2,22.7],[52.58,22.94],[51.58,24.26],[54.12,24.14],[56.08,26.07],[56.18,25.65]]]]},"properties":{"name":"United Arab Emirates"},"id":"AE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[9.85,37.14],[10.38,36.72],[11.07,37.05],[10.46,36.12],[11.13,35.24],[10.01,34.17],[11.53,33.17],[11.57,32.44],[10.29,31.69],[10.21,30.73],[9.54,30.23],[9.06,32.1],[7.49,33.89],[8.25,34.64],[8.18,36.52],[8.62,36.94],[9.85,37.14]]]]},"properties":{"name":"Tunisia"},"id":"TN"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[35.1,41.96],[38.36,40.91],[40.15,40.92],[41.53,41.52],[42.83,41.58],[43.46,41.11],[43.66,40.11],[44.78,39.71],[44.81,39.63],[44.03,39.38],[44.79,37.15],[42.36,37.11],[36.66,36.83],[36.69,36.24],[35.92,35.93],[36.02,36.93],[32.81,36.03],[31.05,36.85],[29.68,36.12],[28.45,36.88],[27.38,36.68],[28.33,37.04],[27.25,36.97],[27.6,37.23],[27.19,37.35],[27.27,37.96],[26.28,38.26],[26.37,38.66],[27.16,38.44],[26.73,38.65],[26.95,39.55],[26.07,39.48],[26.71,40.38],[29.94,40.72],[29.17,41.23],[31.23,41.09],[33.33,42.02],[35.1,41.96]]],[[[27.39,42.01],[28.01,41.98],[29.04,41.06],[27.51,40.98],[26.18,40.05],[26.83,40.59],[26.04,40.74],[26.63,41.35],[26.36,41.71],[27.39,42.01]]]]},"properties":{"name":"Turkey"},"id":"TR"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[58.78,42.66],[60.01,42.22],[60.14,41.38],[61.87,41.13],[62.55,39.93],[64.38,38.95],[66.64,38],[66.54,37.37],[64.8,37.12],[64.5,36.28],[63.12,35.86],[62.72,35.25],[61.28,35.61],[61.16,36.65],[60.33,36.66],[59.34,37.54],[57.21,38.28],[53.91,37.35],[53.98,38.92],[53.16,39.18],[53.26,39.66],[53.73,39.52],[53.58,39.97],[53,39.76],[52.72,40.45],[52.92,41.08],[53.75,40.62],[54.73,41.1],[53.8,42.12],[52.95,41.97],[52.88,41.05],[52.44,41.74],[53.01,42.14],[54.17,42.34],[56,41.33],[57.04,41.26],[56.99,41.89],[58.78,42.66]]]]},"properties":{"name":"Turkmenistan"},"id":"TM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-71.66,21.82],[-71.66,21.74],[-71.85,21.85],[-71.66,21.82]]],[[[-71.88,21.85],[-72.03,21.94],[-71.91,21.94],[-71.88,21.85]]]]},"properties":{"name":"Turks and Caicos Islands"},"id":"TC"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[179.22,-8.55],[179.2,-8.46],[179.23,-8.5],[179.22,-8.55]]]]},"properties":{"name":"Tuvalu"},"id":"TV"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[34,4.22],[35.01,1.9],[33.91,0.1],[33.92,-1],[31.68,-1],[30.48,-1.06],[29.6,-1.39],[29.96,0.83],[31.3,2.12],[30.73,2.45],[30.86,3.49],[33.52,3.75],[34,4.22]]]]},"properties":{"name":"Uganda"},"id":"UG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[33.42,52.36],[34.42,51.81],[34.1,51.65],[34.38,51.26],[35.37,51.04],[35.61,50.37],[37.46,50.44],[38.02,49.9],[40.14,49.6],[39.7,49.01],[40.08,48.87],[39.66,48.62],[39.8,47.86],[38.85,47.86],[38.24,47.11],[35.91,46.65],[34.99,46.08],[35.34,46.32],[35.2,46.44],[35.21,46.39],[35.05,46.26],[34.7,46.18],[34.56,45.98],[33.67,46.22],[35.13,45.33],[35.34,45.33],[35.05,45.61],[34.76,46.02],[34.67,46.09],[34.83,46.07],[34.9,45.88],[35.05,45.65],[35.31,45.38],[35.48,45.29],[36.64,45.38],[33.96,44.38],[33.37,44.58],[33.54,45.11],[32.48,45.4],[33.61,46.15],[31.79,46.28],[32.06,46.4],[31.51,46.58],[32.36,46.46],[32.65,46.64],[32.02,46.63],[31.75,47.25],[31.91,46.65],[31.48,46.63],[31.59,46.8],[30.83,46.55],[30.25,45.88],[29.75,45.62],[29.63,45.82],[29.66,45.21],[28.21,45.45],[28.99,46.48],[30.12,46.39],[29.95,46.81],[29.14,47.99],[27.76,48.45],[26.63,48.26],[24.92,47.71],[22.89,47.95],[22.15,48.41],[22.56,49.08],[24.11,50.57],[23.6,51.53],[25.78,51.94],[30.55,51.25],[30.94,52.07],[31.78,52.11],[33.42,52.36]]]]},"properties":{"name":"Ukraine"},"id":"UA"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[20.82,40.91],[20.59,41.88],[22.37,42.32],[22.94,41.34],[20.98,40.86],[20.82,40.91]]]]},"properties":{"name":"Macedonia"},"id":"MK"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[25.32,31.5],[29.07,30.82],[31.03,31.6],[31.92,31.53],[32.14,31.07],[34.22,31.32],[34.27,31.22],[34.9,29.49],[34.25,27.73],[33.24,28.55],[32.57,30.01],[32.34,29.6],[35.81,23.92],[35.48,23.94],[35.67,22.97],[36.89,22],[31.45,22],[25,22],[24.71,30.17],[25.15,31.65],[25.32,31.5]]]]},"properties":{"name":"Egypt"},"id":"EG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-6.35,55.24],[-5.43,54.48],[-6.27,54.1],[-8.16,54.44],[-7.41,54.95],[-7.25,55.07],[-6.35,55.24]]],[[[-5.78,56.51],[-6.37,56.31],[-6.32,56.6],[-5.78,56.51]]],[[[-6.14,57.57],[-5.66,57.2],[-6.79,57.45],[-6.14,57.57]]],[[[-6.2,58.36],[-7.12,57.82],[-7.04,58.23],[-6.2,58.36]]],[[[-3.01,58.63],[-4.44,57.57],[-1.77,57.46],[-3.28,56.36],[-2.58,56.27],[-3.73,56.03],[-1.63,55.58],[-1.3,54.76],[-0.07,54.11],[0.12,53.56],[-0.72,53.7],[0.24,53.4],[0.000037000000134,52.88],[1.68,52.75],[1.59,52.08],[0.38,51.45],[1.41,51.18],[-5.68,50.04],[-4.23,51.19],[-3.03,51.21],[-2.38,51.76],[-3.35,51.38],[-5.25,51.73],[-4.13,52.33],[-4.13,52.91],[-4.76,52.79],[-4.2,53.21],[-2.7,53.35],[-3.11,53.55],[-2.81,54.22],[-3.63,54.51],[-3.04,54.98],[-4.95,54.65],[-5.17,55],[-4.61,55.49],[-4.92,55.7],[-4.88,55.94],[-4.48,55.92],[-4.83,56.11],[-5.3,55.85],[-5.03,56.23],[-5.78,55.3],[-5.12,56.82],[-6.24,56.71],[-5.4,57.11],[-5.82,57.82],[-5.1,57.85],[-5.46,58.08],[-5,58.62],[-3.01,58.63]]],[[[-2.79,58.95],[-3.19,58.91],[-3.35,59.11],[-2.79,58.95]]],[[[-1.3,60.49],[-1.27,59.85],[-1.69,60.28],[-1.3,60.49]]]]},"properties":{"name":"United Kingdom"},"id":"GB"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-2.59,49.42],[-2.67,49.43],[-2.5,49.51],[-2.59,49.42]]]]},"properties":{"name":"Guernsey"},"id":"GG"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-2.01,49.21],[-2.21,49.18],[-2.25,49.25],[-2.01,49.21]]]]},"properties":{"name":"Jersey"},"id":"JE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-4.78,54.06],[-4.35,54.41],[-4.39,54.19],[-4.78,54.06]]]]},"properties":{"name":"Isle of Man"},"id":"IM"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[31.68,-1],[33.92,-1],[37.6,-3],[37.61,-3.5],[39.2,-4.67],[38.78,-6.05],[39.55,-6.99],[39.39,-8.9],[40.44,-10.48],[37.46,-11.73],[34.97,-11.57],[34.33,-9.73],[33.13,-9.49],[32.94,-9.41],[30.77,-8.19],[29.55,-6.3],[29.42,-4.45],[30.83,-3.26],[30.57,-2.4],[30.89,-2.08],[30.48,-1.06],[31.68,-1]]]]},"properties":{"name":"Tanzania"},"id":"TZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-155.01,19.33],[-155.86,19.03],[-155.86,20.27],[-155.16,19.96],[-155.01,19.33]]],[[[-156.47,20.9],[-155.99,20.75],[-156.42,20.59],[-156.47,20.9]]],[[[-157.73,21.41],[-158.1,21.3],[-158.27,21.58],[-157.73,21.41]]],[[[-159.43,21.88],[-159.79,22.06],[-159.35,22.22],[-159.43,21.88]]],[[[-95.08,49.36],[-94.61,48.72],[-91.42,48.04],[-88.37,48.31],[-84.13,46.53],[-82.54,45.36],[-82.13,43.59],[-83.17,42.05],[-82.7,41.68],[-78.99,42.82],[-79.18,43.47],[-78.72,43.63],[-76.8,43.63],[-74.99,44.99],[-70.88,45.24],[-69.23,47.47],[-67.79,47.07],[-67.8,45.7],[-67.21,45.18],[-67.19,44.66],[-68.8,44.58],[-70.73,43.12],[-70.58,42.65],[-71.04,42.31],[-69.94,41.67],[-71.19,41.47],[-71.39,41.81],[-71.51,41.37],[-74,40.71],[-73.96,41.31],[-74.42,39.36],[-74.96,38.92],[-75.56,39.62],[-75.03,40.01],[-75.59,39.65],[-75.04,38.42],[-75.96,37.15],[-75.64,37.96],[-76.36,38.86],[-75.83,39.58],[-76.62,39.25],[-76.31,38.05],[-77.24,38.4],[-77.06,38.91],[-77.32,38.35],[-76.24,37.9],[-76.35,37.62],[-77.13,38.17],[-76.27,37.08],[-77.23,37.3],[-75.99,36.91],[-75.53,35.8],[-75.94,36.72],[-75.79,36.07],[-76.71,36.26],[-76.73,35.94],[-75.72,35.81],[-76.15,35.34],[-77.05,35.53],[-76.47,35.27],[-76.94,34.98],[-76.34,34.89],[-77.43,34.74],[-77.93,33.93],[-78.83,33.73],[-80.47,32.32],[-80.84,32.52],[-81.5,31.13],[-80.03,26.79],[-80.4,25.18],[-81.09,25.12],[-81.74,25.96],[-81.78,26.71],[-82.06,26.54],[-82.66,27.46],[-82.42,27.92],[-82.85,27.86],[-82.63,28.88],[-83.67,29.91],[-85.35,29.68],[-86.26,30.5],[-88.02,30.22],[-88.02,30.7],[-88.13,30.31],[-90.42,30.2],[-89.4,30.05],[-89.75,29.63],[-89.01,29.18],[-89.4,28.93],[-90.18,29.57],[-90.21,29.09],[-91.25,29.24],[-91.84,29.83],[-92.31,29.54],[-93.85,29.99],[-93.86,29.68],[-94.77,29.36],[-94.48,29.56],[-95.06,29.72],[-95.14,29.06],[-96.21,28.49],[-96.64,28.72],[-96.4,28.44],[-97.52,27.87],[-97.41,27.33],[-97.77,27.46],[-97.14,25.97],[-99.1,26.43],[-99.51,27.57],[-101.41,29.77],[-102.31,29.89],[-103.38,29.02],[-106.4,31.75],[-111.05,31.33],[-113.05,31.97],[-114.72,32.72],[-117.12,32.54],[-118.53,34.05],[-120.62,34.57],[-120.61,35.14],[-122.49,37.52],[-122.39,37.82],[-122.01,37.47],[-122.39,37.96],[-122.24,38.06],[-121.42,38.01],[-122.37,38.16],[-122.49,37.83],[-123,38.01],[-124.33,40.27],[-124.04,41.43],[-124.52,42.87],[-123.95,46.18],[-123.16,46.2],[-124,46.32],[-123.8,46.98],[-124.16,46.94],[-124.72,48.4],[-122.75,48.16],[-123.15,47.37],[-122.45,47.77],[-122.88,47.06],[-122.31,47.4],[-122.76,49],[-95.15,49],[-95.08,49.36]]],[[[-156.45,71.26],[-155.59,71.16],[-155.97,70.76],[-155.09,71.15],[-152.25,70.84],[-152.5,70.65],[-152.08,70.57],[-152.63,70.56],[-151.97,70.44],[-143.28,70.12],[-141,69.64],[-141,60.31],[-139.07,60.35],[-137.48,58.91],[-135.47,59.8],[-133.43,58.46],[-131.82,56.6],[-130.02,55.91],[-130.17,55.75],[-130.14,55.54],[-129.99,55.28],[-130.36,54.91],[-130.69,54.76],[-131.01,55],[-130.46,55.33],[-131.06,55.12],[-130.61,55.3],[-131.01,56.11],[-132.16,55.58],[-131.77,56.2],[-133.51,57.19],[-133.06,57.35],[-133.64,57.7],[-133,57.51],[-133.56,57.9],[-133.12,57.86],[-134.05,58.07],[-133.77,58.52],[-134.76,58.38],[-135.34,59.47],[-135.09,58.23],[-135.92,58.38],[-135.77,58.9],[-137.06,59.07],[-136.03,58.39],[-136.65,58.22],[-139.71,59.5],[-139.49,59.98],[-139.29,59.57],[-138.89,59.81],[-139.5,60.03],[-140.4,59.7],[-141.39,60.14],[-143.92,59.99],[-144.94,60.3],[-144.61,60.72],[-145.29,60.35],[-146.65,60.7],[-146.12,60.84],[-146.76,60.96],[-146.3,61.13],[-147.87,60.83],[-147.72,61.28],[-148.7,60.79],[-148.2,60.63],[-148.68,60.45],[-147.94,60.46],[-148.44,59.95],[-149.42,60.12],[-150.91,59.24],[-151.98,59.28],[-150.99,59.78],[-151.88,59.75],[-151.41,60.73],[-149.03,60.85],[-150.06,61.15],[-149.42,61.51],[-153.1,60.29],[-152.58,60.06],[-154.26,59.14],[-153.27,58.85],[-156.55,56.98],[-158.42,56.44],[-158.12,56.23],[-158.51,55.99],[-161.25,55.35],[-161.56,55.62],[-161.97,55.1],[-162.63,55.3],[-162.56,54.96],[-163.36,54.81],[-161.8,55.89],[-160.25,55.77],[-160.35,56.29],[-157.4,57.49],[-157.61,58.09],[-157.14,58.16],[-157.55,58.38],[-156.78,59.15],[-158.19,58.61],[-158.49,59],[-157.99,58.9],[-158.54,59.18],[-158.9,58.4],[-160.33,59.06],[-162.17,58.65],[-161.57,59.1],[-161.99,59.14],[-161.71,59.5],[-162.24,60.06],[-162.15,60.25],[-162.37,60.18],[-161.88,60.7],[-162.57,60.32],[-162.52,59.99],[-164.07,59.82],[-165.43,60.56],[-163.55,60.9],[-165.15,60.93],[-164.82,61.11],[-165.12,61.08],[-165.14,61.26],[-165.16,61.17],[-165.37,61.2],[-165.29,61.25],[-165.15,61.42],[-165.06,61.42],[-165,61.47],[-164.85,61.49],[-164.72,61.63],[-164.76,61.63],[-165.02,61.5],[-165.08,61.43],[-165.16,61.43],[-165.29,61.33],[-165.27,61.31],[-165.31,61.26],[-165.41,61.21],[-165.34,61.16],[-165.39,61.07],[-166.2,61.59],[-165.25,62.45],[-164.64,62.42],[-164.48,62.75],[-164.88,62.84],[-164.41,63.21],[-161.15,63.51],[-160.78,63.87],[-161.53,64.42],[-160.78,64.72],[-162.79,64.34],[-166.12,64.57],[-166.96,65.19],[-166.06,65.26],[-168.13,65.67],[-164.35,66.59],[-163.63,66.57],[-164.19,66.2],[-163.66,66.07],[-161,66.2],[-161.91,66.27],[-162.64,66.87],[-162.34,66.96],[-161.6,66.45],[-160.23,66.4],[-161.51,66.53],[-161.9,66.73],[-161.5,66.98],[-162.35,67.16],[-163.73,67.11],[-164.12,67.61],[-166.83,68.35],[-166.22,68.88],[-163.65,69.11],[-161.94,70.31],[-159.94,70.59],[-159.84,70.27],[-159.29,70.53],[-160.12,70.62],[-159.67,70.8],[-156.45,71.26]]]]},"properties":{"name":"United States"},"id":"US"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-64.76,17.77],[-64.56,17.75],[-64.9,17.68],[-64.76,17.77]]]]},"properties":{"name":"Virgin Islands"},"id":"VI"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-2.83,11],[-2.69,9.48],[-3.63,9.95],[-4.7,9.7],[-5.52,10.44],[-5.27,11.84],[-4.42,12.3],[-3.96,13.5],[-3.44,13.17],[-2.47,14.29],[-0.73,15.08],[0.24,14.92],[0.6,13.7],[1.29,13.35],[0.99,13.05],[2.14,12.69],[2.4,11.9],[0.92,11],[-0.15,11.14],[-2.83,11]]]]},"properties":{"name":"Burkina Faso"},"id":"BF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-57.81,-30.75],[-57.61,-30.18],[-56.81,-30.11],[-56.01,-31.08],[-55.58,-30.85],[-53.88,-31.97],[-53.09,-32.73],[-53.52,-33.15],[-53.37,-33.74],[-54.15,-34.67],[-56.32,-34.91],[-57.12,-34.46],[-57.84,-34.49],[-58.4,-33.93],[-58.36,-33.13],[-58.15,-33.1],[-58.05,-32.93],[-58.2,-32.45],[-57.81,-30.75]]]]},"properties":{"name":"Uruguay"},"id":"UY"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[64.38,38.95],[62.55,39.93],[61.87,41.13],[60.14,41.38],[60.01,42.22],[58.78,42.66],[56.99,41.89],[57.04,41.26],[56,41.33],[56,45],[58.57,45.57],[62.03,43.48],[64.93,43.74],[66.12,43],[66.03,42],[66.53,42],[66.72,41.17],[67.94,41.18],[68.46,40.6],[69.06,41.38],[70.97,42.25],[71.28,42.2],[70.19,41.53],[71.42,41.12],[71.69,41.56],[73.17,40.82],[70.98,40.24],[70.38,40.38],[70.8,40.73],[70.42,41.05],[68.6,40.18],[69.01,40.09],[68.54,39.55],[67.44,39.48],[68.38,38.2],[67.78,37.19],[66.54,37.37],[66.64,38],[64.38,38.95]]]]},"properties":{"name":"Uzbekistan"},"id":"UZ"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-69.77,11.7],[-68.42,11.18],[-68.16,10.5],[-66.24,10.64],[-65.08,10.06],[-63.7,10.49],[-64.26,10.66],[-61.88,10.73],[-62.92,10.53],[-62.62,10.12],[-63.02,10.1],[-60.85,9.44],[-61.6,8.55],[-59.99,8.54],[-59.83,8.24],[-60.72,7.54],[-60.29,7.06],[-61.13,6.71],[-61.39,5.94],[-60.73,5.2],[-60.99,4.52],[-62.75,4.03],[-62.88,3.56],[-64.8,4.28],[-64.05,2.48],[-63.39,2.15],[-65.52,0.65],[-66.87,1.22],[-67.19,2.39],[-67.83,2.83],[-67.29,3.4],[-67.86,4.56],[-67.45,6.19],[-69.25,6.08],[-70.12,6.98],[-72,7.02],[-72.78,9.08],[-73.38,9.17],[-72.49,11.12],[-71.98,11.66],[-71.32,11.85],[-71.97,11.56],[-71.58,10.71],[-72.13,9.81],[-71.62,9.04],[-71.06,9.34],[-71.5,10.96],[-69.8,11.43],[-70.24,11.63],[-70.03,12.2],[-69.77,11.7]]]]},"properties":{"name":"Venezuela"},"id":"VE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-178.04,-14.32],[-178.14,-14.32],[-178.19,-14.24],[-178.04,-14.32]]],[[[-176.16,-13.35],[-176.16,-13.21],[-176.12,-13.26],[-176.16,-13.35]]]]},"properties":{"name":"Wallis and Futuna"},"id":"WF"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[-171.43,-14.02],[-172.06,-13.87],[-171.82,-13.81],[-171.43,-14.02]]],[[[-172.29,-13.49],[-172.21,-13.81],[-172.78,-13.53],[-172.29,-13.49]]]]},"properties":{"name":"Samoa"},"id":"WS"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[52.23,15.67],[43.96,12.59],[43.25,13.21],[42.79,16.38],[43.31,17.46],[44.47,17.41],[46.33,16.67],[46.33,15.62],[48.77,18.27],[52,19],[53.11,16.64],[52.3,16.27],[52.23,15.67]]]]},"properties":{"name":"Yemen"},"id":"YE"},{"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[24.97,-17.56],[23.48,-17.63],[22,-16.17],[22,-13],[24.02,-13.01],[23.99,-10.87],[24.45,-11.46],[25.33,-11.19],[26,-11.9],[26.87,-11.97],[27.2,-11.57],[29.02,-13.4],[29.8,-13.45],[29.81,-12.16],[29.03,-12.38],[28.36,-11.55],[28.7,-10.65],[28.37,-9.26],[28.9,-8.48],[30.77,-8.19],[32.94,-9.41],[33.7,-10.56],[33.25,-10.89],[33.55,-12.36],[32.68,-13.61],[33.22,-14.01],[30.21,-14.98],[30.42,-15.63],[28.93,-15.97],[27.04,-17.96],[25.26,-17.8],[24.97,-17.56]]]]},"properties":{"name":"Zambia"},"id":"ZM"}]}'))},56823,e=>{"use strict";let t,r,n,i,a,s,o,l,u,c,h,d,A,p,f,m,g,y;e.s(["Globe",()=>Yr,"WebGLRendererConfig",()=>Yn,"World",()=>Yi,"genRandomNumbers",()=>Ys,"hexToRgb",()=>Ya],56823);var v,x,_,b,S,T,w,M,E,R,C,N,P,I,L,D,B,F,U,O,k,z,V,q,G,H,j,W=e.i(43476),X=e.i(71645);let Q={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Y={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},K="attached",Z="detached",J="srgb",$="srgb-linear",ee="linear",et="srgb",er="300 es",en={COMPUTE:"compute",RENDER:"render"},ei={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},ea={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};class es{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){let r=this._listeners;return void 0!==r&&void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){let r=this._listeners;if(void 0===r)return;let n=r[e];if(void 0!==n){let e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){let t=this._listeners;if(void 0===t)return;let r=t[e.type];if(void 0!==r){e.target=this;let t=r.slice(0);for(let r=0,n=t.length;r<n;r++)t[r].call(this,e);e.target=null}}}let eo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],el=1234567,eu=Math.PI/180,ec=180/Math.PI;function eh(){let e=0xffffffff*Math.random()|0,t=0xffffffff*Math.random()|0,r=0xffffffff*Math.random()|0,n=0xffffffff*Math.random()|0;return(eo[255&e]+eo[e>>8&255]+eo[e>>16&255]+eo[e>>24&255]+"-"+eo[255&t]+eo[t>>8&255]+"-"+eo[t>>16&15|64]+eo[t>>24&255]+"-"+eo[63&r|128]+eo[r>>8&255]+"-"+eo[r>>16&255]+eo[r>>24&255]+eo[255&n]+eo[n>>8&255]+eo[n>>16&255]+eo[n>>24&255]).toLowerCase()}function ed(e,t,r){return Math.max(t,Math.min(r,e))}function eA(e,t){return(e%t+t)%t}function ep(e,t,r){return(1-r)*e+r*t}function ef(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/0xffffffff;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/0x7fffffff,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw Error("Invalid component type.")}}function em(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(0xffffffff*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(0x7fffffff*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw Error("Invalid component type.")}}let eg={DEG2RAD:eu,RAD2DEG:ec,generateUUID:eh,clamp:ed,euclideanModulo:eA,mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},lerp:ep,damp:function(e,t,r,n){return ep(e,t,1-Math.exp(-r*n))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(eA(e,2*t)-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(el=e);let t=el+=0x6d2b79f5;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/0x100000000},degToRad:function(e){return e*eu},radToDeg:function(e){return e*ec},isPowerOfTwo:function(e){return(e&e-1)==0&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,n,i){let a=Math.cos,s=Math.sin,o=a(r/2),l=s(r/2),u=a((t+n)/2),c=s((t+n)/2),h=a((t-n)/2),d=s((t-n)/2),A=a((n-t)/2),p=s((n-t)/2);switch(i){case"XYX":e.set(o*c,l*h,l*d,o*u);break;case"YZY":e.set(l*d,o*c,l*h,o*u);break;case"ZXZ":e.set(l*h,l*d,o*c,o*u);break;case"XZX":e.set(o*c,l*p,l*A,o*u);break;case"YXY":e.set(l*A,o*c,l*p,o*u);break;case"ZYZ":e.set(l*p,l*A,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:em,denormalize:ef};class ey{get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=ed(this.x,e.x,t.x),this.y=ed(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=ed(this.x,e,t),this.y=ed(this.y,e,t),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(ed(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:Math.acos(ed(this.dot(e)/t,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*r-a*n+e.x,this.y=i*n+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}constructor(e=0,t=0){ey.prototype.isVector2=!0,this.x=e,this.y=t}}class ev{static slerpFlat(e,t,r,n,i,a,s){let o=r[n+0],l=r[n+1],u=r[n+2],c=r[n+3],h=i[a+0],d=i[a+1],A=i[a+2],p=i[a+3];if(0===s){e[t+0]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c;return}if(1===s){e[t+0]=h,e[t+1]=d,e[t+2]=A,e[t+3]=p;return}if(c!==p||o!==h||l!==d||u!==A){let e=1-s,t=o*h+l*d+u*A+c*p,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){let i=Math.sqrt(n),a=Math.atan2(i,t*r);e=Math.sin(e*a)/i,s=Math.sin(s*a)/i}let i=s*r;if(o=o*e+h*i,l=l*e+d*i,u=u*e+A*i,c=c*e+p*i,e===1-s){let e=1/Math.sqrt(o*o+l*l+u*u+c*c);o*=e,l*=e,u*=e,c*=e}}e[t]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,r,n,i,a){let s=r[n],o=r[n+1],l=r[n+2],u=r[n+3],c=i[a],h=i[a+1],d=i[a+2],A=i[a+3];return e[t]=s*A+u*c+o*d-l*h,e[t+1]=o*A+u*h+l*c-s*d,e[t+2]=l*A+u*d+s*h-o*c,e[t+3]=u*A-s*c-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=e._x,n=e._y,i=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(r/2),u=s(n/2),c=s(i/2),h=o(r/2),d=o(n/2),A=o(i/2);switch(a){case"XYZ":this._x=h*u*c+l*d*A,this._y=l*d*c-h*u*A,this._z=l*u*A+h*d*c,this._w=l*u*c-h*d*A;break;case"YXZ":this._x=h*u*c+l*d*A,this._y=l*d*c-h*u*A,this._z=l*u*A-h*d*c,this._w=l*u*c+h*d*A;break;case"ZXY":this._x=h*u*c-l*d*A,this._y=l*d*c+h*u*A,this._z=l*u*A+h*d*c,this._w=l*u*c-h*d*A;break;case"ZYX":this._x=h*u*c-l*d*A,this._y=l*d*c+h*u*A,this._z=l*u*A-h*d*c,this._w=l*u*c+h*d*A;break;case"YZX":this._x=h*u*c+l*d*A,this._y=l*d*c+h*u*A,this._z=l*u*A-h*d*c,this._w=l*u*c-h*d*A;break;case"XZY":this._x=h*u*c-l*d*A,this._y=l*d*c-h*u*A,this._z=l*u*A+h*d*c,this._w=l*u*c+h*d*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],i=t[8],a=t[1],s=t[5],o=t[9],l=t[2],u=t[6],c=t[10],h=r+s+c;if(h>0){let e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(u-o)*e,this._y=(i-l)*e,this._z=(a-n)*e}else if(r>s&&r>c){let e=2*Math.sqrt(1+r-s-c);this._w=(u-o)/e,this._x=.25*e,this._y=(n+a)/e,this._z=(i+l)/e}else if(s>c){let e=2*Math.sqrt(1+s-r-c);this._w=(i-l)/e,this._x=(n+a)/e,this._y=.25*e,this._z=(o+u)/e}else{let e=2*Math.sqrt(1+c-r-s);this._w=(a-n)/e,this._x=(i+l)/e,this._y=(o+u)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<1e-8?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=r,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ed(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(0===r)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,i=e._z,a=e._w,s=t._x,o=t._y,l=t._z,u=t._w;return this._x=r*u+a*s+n*l-i*o,this._y=n*u+a*o+i*s-r*l,this._z=i*u+a*l+r*o-n*s,this._w=a*u-r*s-n*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let r=this._x,n=this._y,i=this._z,a=this._w,s=a*e._w+r*e._x+n*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=r,this._y=n,this._z=i,this;let o=1-s*s;if(o<=Number.EPSILON){let e=1-t;return this._w=e*a+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}let l=Math.sqrt(o),u=Math.atan2(l,s),c=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=a*c+this._w*h,this._x=r*c+this._x*h,this._y=n*c+this._y*h,this._z=i*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),i=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}}class ex{set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(eb.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(eb.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=e.elements,a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,s=e.z,o=e.w,l=2*(a*n-s*r),u=2*(s*t-i*n),c=2*(i*r-a*t);return this.x=t+o*l+a*c-s*u,this.y=r+o*u+s*l-i*c,this.z=n+o*c+i*u-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=ed(this.x,e.x,t.x),this.y=ed(this.y,e.y,t.y),this.z=ed(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=ed(this.x,e,t),this.y=ed(this.y,e,t),this.z=ed(this.z,e,t),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(ed(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,i=e.z,a=t.x,s=t.y,o=t.z;return this.x=n*o-i*s,this.y=i*a-r*o,this.z=r*s-n*a,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return e_.copy(this).projectOnVector(e),this.sub(e_)}reflect(e){return this.sub(e_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:Math.acos(ed(this.dot(e)/t,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=2*Math.random()-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}constructor(e=0,t=0,r=0){ex.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}}let e_=new ex,eb=new ev;class eS{set(e,t,r,n,i,a,s,o,l){let u=this.elements;return u[0]=e,u[1]=n,u[2]=s,u[3]=t,u[4]=i,u[5]=o,u[6]=r,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,a=r[0],s=r[3],o=r[6],l=r[1],u=r[4],c=r[7],h=r[2],d=r[5],A=r[8],p=n[0],f=n[3],m=n[6],g=n[1],y=n[4],v=n[7],x=n[2],_=n[5],b=n[8];return i[0]=a*p+s*g+o*x,i[3]=a*f+s*y+o*_,i[6]=a*m+s*v+o*b,i[1]=l*p+u*g+c*x,i[4]=l*f+u*y+c*_,i[7]=l*m+u*v+c*b,i[2]=h*p+d*g+A*x,i[5]=h*f+d*y+A*_,i[8]=h*m+d*v+A*b,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8];return t*a*u-t*s*l-r*i*u+r*s*o+n*i*l-n*a*o}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=u*a-s*l,h=s*o-u*i,d=l*i-a*o,A=t*c+r*h+n*d;if(0===A)return this.set(0,0,0,0,0,0,0,0,0);let p=1/A;return e[0]=c*p,e[1]=(n*l-u*r)*p,e[2]=(s*r-n*a)*p,e[3]=h*p,e[4]=(u*t-n*o)*p,e[5]=(n*i-s*t)*p,e[6]=d*p,e[7]=(r*o-l*t)*p,e[8]=(a*t-r*i)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,a,s){let o=Math.cos(i),l=Math.sin(i);return this.set(r*o,r*l,-r*(o*a+l*s)+a+e,-n*l,n*o,-n*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(eT.makeScale(e,t)),this}rotate(e){return this.premultiply(eT.makeRotation(-e)),this}translate(e,t){return this.premultiply(eT.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}constructor(e,t,r,n,i,a,s,o,l){eS.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,n,i,a,s,o,l)}}let eT=new eS;function ew(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}let eM={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function eE(e,t){return new eM[e](t)}function eR(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function eC(){let e=eR("canvas");return e.style.display="block",e}let eN={};function eP(e){e in eN||(eN[e]=!0,console.warn(e))}let eI=new eS().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),eL=new eS().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715),eD=function(){let e={enabled:!0,workingColorSpace:$,spaces:{},convert:function(e,t,r){return!1!==this.enabled&&t!==r&&t&&r&&(this.spaces[t].transfer===et&&(e.r=eB(e.r),e.g=eB(e.g),e.b=eB(e.b)),this.spaces[t].primaries!==this.spaces[r].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[r].fromXYZ)),this.spaces[r].transfer===et&&(e.r=eF(e.r),e.g=eF(e.g),e.b=eF(e.b))),e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return""===e?ee:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,r){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[r].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,r){return eP("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,r)},toWorkingColorSpace:function(t,r){return eP("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,r)}},t=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],n=[.3127,.329];return e.define({[$]:{primaries:t,whitePoint:n,transfer:ee,toXYZ:eI,fromXYZ:eL,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:J},outputColorSpaceConfig:{drawingBufferColorSpace:J}},[J]:{primaries:t,whitePoint:n,transfer:et,toXYZ:eI,fromXYZ:eL,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:J}}}),e}();function eB(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function eF(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class eU{static getDataURL(e){let r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)r=e;else{void 0===t&&(t=eR("canvas")),t.width=e.width,t.height=e.height;let n=t.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),r=t}return r.toDataURL(n)}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let t=eR("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),i=n.data;for(let e=0;e<i.length;e++)i[e]=255*eB(i[e]/255);return r.putImageData(n,0,0),t}if(!e.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e;{let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*eB(t[e]/255)):t[e]=eB(t[e]);return{data:t,width:e.width,height:e.height}}}}let eO=0;class ek{getSize(e){let t=this.data;return"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,r=n.length;t<r;t++)n[t].isDataTexture?e.push(ez(n[t].image)):e.push(ez(n[t]))}else e=ez(n);r.url=e}return t||(e.images[this.uuid]=r),r}constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:eO++}),this.uuid=eh(),this.data=e,this.dataReady=!0,this.version=0}}function ez(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?eU.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let eV=0,eq=new ex;class eG extends es{get width(){return this.source.getSize(eq).x}get height(){return this.source.getSize(eq).y}get depth(){return this.source.getSize(eq).z}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(let t in e){let r=e[t];if(void 0===r){console.warn("THREE.Texture.setValues(): parameter '".concat(t,"' has value of undefined."));continue}let n=this[t];if(void 0===n){console.warn("THREE.Texture.setValues(): property '".concat(t,"' does not exist."));continue}n&&r&&n.isVector2&&r.isVector2||n&&r&&n.isVector3&&r.isVector3||n&&r&&n.isMatrix3&&r.isMatrix3?n.copy(r):this[t]=r}}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}constructor(e=eG.DEFAULT_IMAGE,t=eG.DEFAULT_MAPPING,r=1001,n=1001,i=1006,a=1008,s=1023,o=1009,l=eG.DEFAULT_ANISOTROPY,u=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:eV++}),this.uuid=eh(),this.name="",this.source=new ek(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new ey(0,0),this.repeat=new ey(1,1),this.center=new ey(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new eS,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!e&&!!e.depth&&e.depth>1,this.pmremVersion=0}}eG.DEFAULT_IMAGE=null,eG.DEFAULT_MAPPING=300,eG.DEFAULT_ANISOTROPY=1;class eH{get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i,a=e.elements,s=a[0],o=a[4],l=a[8],u=a[1],c=a[5],h=a[9],d=a[2],A=a[6],p=a[10];if(.01>Math.abs(o-u)&&.01>Math.abs(l-d)&&.01>Math.abs(h-A)){if(.1>Math.abs(o+u)&&.1>Math.abs(l+d)&&.1>Math.abs(h+A)&&.1>Math.abs(s+c+p-3))return this.set(1,0,0,0),this;t=Math.PI;let e=(s+1)/2,a=(c+1)/2,f=(p+1)/2,m=(o+u)/4,g=(l+d)/4,y=(h+A)/4;return e>a&&e>f?e<.01?(r=0,n=.707106781,i=.707106781):(n=m/(r=Math.sqrt(e)),i=g/r):a>f?a<.01?(r=.707106781,n=0,i=.707106781):(r=m/(n=Math.sqrt(a)),i=y/n):f<.01?(r=.707106781,n=.707106781,i=0):(r=g/(i=Math.sqrt(f)),n=y/i),this.set(r,n,i,t),this}let f=Math.sqrt((A-h)*(A-h)+(l-d)*(l-d)+(u-o)*(u-o));return .001>Math.abs(f)&&(f=1),this.x=(A-h)/f,this.y=(l-d)/f,this.z=(u-o)/f,this.w=Math.acos((s+c+p-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=ed(this.x,e.x,t.x),this.y=ed(this.y,e.y,t.y),this.z=ed(this.z,e.z,t.z),this.w=ed(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=ed(this.x,e,t),this.y=ed(this.y,e,t),this.z=ed(this.z,e,t),this.w=ed(this.w,e,t),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(ed(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}constructor(e=0,t=0,r=0,n=1){eH.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}}class ej extends es{_setTextureOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={minFilter:1006,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let e=0;e<this.textures.length;e++)this.textures[e].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,i=this.textures.length;n<i;n++)this.textures[n].image.width=e,this.textures[n].image.height=t,this.textures[n].image.depth=r,this.textures[n].isArrayTexture=this.textures[n].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;let r=Object.assign({},e.textures[t].image);this.textures[t].source=new ek(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}constructor(e=1,t=1,r={}){super(),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:1006,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},r),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=r.depth,this.scissor=new eH(0,0,e,t),this.scissorTest=!1,this.viewport=new eH(0,0,e,t);let n=new eG({width:e,height:t,depth:r.depth});this.textures=[];let i=r.count;for(let e=0;e<i;e++)this.textures[e]=n.clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;this._setTextureOptions(r),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}}class eW extends ej{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class eX extends eG{addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}}class eQ extends eW{constructor(e=1,t=1,r=1,n={}){super(e,t,n),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new eX(null,e,t,r),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}}class eY extends eG{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eK extends eW{constructor(e=1,t=1,r=1,n={}){super(e,t,n),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new eY(null,e,t,r),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}}class eZ{set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(e$.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(e$.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=e$.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);let r=e.geometry;if(void 0!==r){let n=r.getAttribute("position");if(!0===t&&void 0!==n&&!0!==e.isInstancedMesh)for(let t=0,r=n.count;t<r;t++)!0===e.isMesh?e.getVertexPosition(t,e$):e$.fromBufferAttribute(n,t),e$.applyMatrix4(e.matrixWorld),this.expandByPoint(e$);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),e0.copy(e.boundingBox)):(null===r.boundingBox&&r.computeBoundingBox(),e0.copy(r.boundingBox)),e0.applyMatrix4(e.matrixWorld),this.union(e0)}let n=e.children;for(let e=0,r=n.length;e<r;e++)this.expandByObject(n[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,e$),e$.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(e7),e8.subVectors(this.max,e7),e1.subVectors(e.a,e7),e2.subVectors(e.b,e7),e3.subVectors(e.c,e7),e4.subVectors(e2,e1),e5.subVectors(e3,e2),e6.subVectors(e1,e3);let t=[0,-e4.z,e4.y,0,-e5.z,e5.y,0,-e6.z,e6.y,e4.z,0,-e4.x,e5.z,0,-e5.x,e6.z,0,-e6.x,-e4.y,e4.x,0,-e5.y,e5.x,0,-e6.y,e6.x,0];return!!tt(t,e1,e2,e3,e8)&&!!tt(t=[1,0,0,0,1,0,0,0,1],e1,e2,e3,e8)&&(e9.crossVectors(e4,e5),tt(t=[e9.x,e9.y,e9.z],e1,e2,e3,e8))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,e$).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(e$).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(eJ[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),eJ[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),eJ[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),eJ[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),eJ[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),eJ[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),eJ[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),eJ[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(eJ)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}constructor(e=new ex(Infinity,Infinity,Infinity),t=new ex(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}}let eJ=[new ex,new ex,new ex,new ex,new ex,new ex,new ex,new ex],e$=new ex,e0=new eZ,e1=new ex,e2=new ex,e3=new ex,e4=new ex,e5=new ex,e6=new ex,e7=new ex,e8=new ex,e9=new ex,te=new ex;function tt(e,t,r,n,i){for(let a=0,s=e.length-3;a<=s;a+=3){te.fromArray(e,a);let s=i.x*Math.abs(te.x)+i.y*Math.abs(te.y)+i.z*Math.abs(te.z),o=t.dot(te),l=r.dot(te),u=n.dot(te);if(Math.max(-Math.max(o,l,u),Math.min(o,l,u))>s)return!1}return!0}let tr=new eZ,tn=new ex,ti=new ex;class ta{set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;void 0!==t?r.copy(t):tr.setFromPoints(e).getCenter(r);let n=0;for(let t=0,i=e.length;t<i;t++)n=Math.max(n,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;tn.subVectors(e,this.center);let t=tn.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),r=(e-this.radius)*.5;this.center.addScaledVector(tn,r/e),this.radius+=r}return this}union(e){return e.isEmpty()||(this.isEmpty()?this.copy(e):!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(ti.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(tn.copy(e.center).add(ti)),this.expandByPoint(tn.copy(e.center).sub(ti)))),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}constructor(e=new ex,t=-1){this.isSphere=!0,this.center=e,this.radius=t}}let ts=new ex,to=new ex,tl=new ex,tu=new ex,tc=new ex,th=new ex,td=new ex;class tA{set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ts)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=ts.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ts.copy(this.origin).addScaledVector(this.direction,t),ts.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){let i,a,s,o;to.copy(e).add(t).multiplyScalar(.5),tl.copy(t).sub(e).normalize(),tu.copy(this.origin).sub(to);let l=.5*e.distanceTo(t),u=-this.direction.dot(tl),c=tu.dot(this.direction),h=-tu.dot(tl),d=tu.lengthSq(),A=Math.abs(1-u*u);if(A>0)if(i=u*h-c,a=u*c-h,o=l*A,i>=0)if(a>=-o)if(a<=o){let e=1/A;i*=e,a*=e,s=i*(i+u*a+2*c)+a*(u*i+a+2*h)+d}else s=-(i=Math.max(0,-(u*(a=l)+c)))*i+a*(a+2*h)+d;else s=-(i=Math.max(0,-(u*(a=-l)+c)))*i+a*(a+2*h)+d;else a<=-o?(a=(i=Math.max(0,-(-u*l+c)))>0?-l:Math.min(Math.max(-l,-h),l),s=-i*i+a*(a+2*h)+d):a<=o?(i=0,s=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):(a=(i=Math.max(0,-(u*l+c)))>0?l:Math.min(Math.max(-l,-h),l),s=-i*i+a*(a+2*h)+d);else a=u>0?-l:l,s=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;return r&&r.copy(this.origin).addScaledVector(this.direction,i),n&&n.copy(to).addScaledVector(tl,a),s}intersectSphere(e,t){ts.subVectors(e.center,this.origin);let r=ts.dot(this.direction),n=ts.dot(ts)-r*r,i=e.radius*e.radius;if(n>i)return null;let a=Math.sqrt(i-n),s=r-a,o=r+a;return o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return!!(0===t||e.normal.dot(this.direction)*t<0)}intersectBox(e,t){let r,n,i,a,s,o,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return(l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),r>a||i>n||((i>r||isNaN(r))&&(r=i),(a<n||isNaN(n))&&(n=a),c>=0?(s=(e.min.z-h.z)*c,o=(e.max.z-h.z)*c):(s=(e.max.z-h.z)*c,o=(e.min.z-h.z)*c),r>o||s>n||((s>r||r!=r)&&(r=s),(o<n||n!=n)&&(n=o),n<0)))?null:this.at(r>=0?r:n,t)}intersectsBox(e){return null!==this.intersectBox(e,ts)}intersectTriangle(e,t,r,n,i){let a;tc.subVectors(t,e),th.subVectors(r,e),td.crossVectors(tc,th);let s=this.direction.dot(td);if(s>0){if(n)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}tu.subVectors(this.origin,e);let o=a*this.direction.dot(th.crossVectors(tu,th));if(o<0)return null;let l=a*this.direction.dot(tc.cross(tu));if(l<0||o+l>s)return null;let u=-a*tu.dot(td);return u<0?null:this.at(u/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}constructor(e=new ex,t=new ex(0,0,-1)){this.origin=e,this.direction=t}}class tp{set(e,t,r,n,i,a,s,o,l,u,c,h,d,A,p,f){let m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=n,m[1]=i,m[5]=a,m[9]=s,m[13]=o,m[2]=l,m[6]=u,m[10]=c,m[14]=h,m[3]=d,m[7]=A,m[11]=p,m[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new tp().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/tf.setFromMatrixColumn(e,0).length(),i=1/tf.setFromMatrixColumn(e,1).length(),a=1/tf.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,i=e.z,a=Math.cos(r),s=Math.sin(r),o=Math.cos(n),l=Math.sin(n),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){let e=a*u,r=a*c,n=s*u,i=s*c;t[0]=o*u,t[4]=-o*c,t[8]=l,t[1]=r+n*l,t[5]=e-i*l,t[9]=-s*o,t[2]=i-e*l,t[6]=n+r*l,t[10]=a*o}else if("YXZ"===e.order){let e=o*u,r=o*c,n=l*u,i=l*c;t[0]=e+i*s,t[4]=n*s-r,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-s,t[2]=r*s-n,t[6]=i+e*s,t[10]=a*o}else if("ZXY"===e.order){let e=o*u,r=o*c,n=l*u,i=l*c;t[0]=e-i*s,t[4]=-a*c,t[8]=n+r*s,t[1]=r+n*s,t[5]=a*u,t[9]=i-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){let e=a*u,r=a*c,n=s*u,i=s*c;t[0]=o*u,t[4]=n*l-r,t[8]=e*l+i,t[1]=o*c,t[5]=i*l+e,t[9]=r*l-n,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){let e=a*o,r=a*l,n=s*o,i=s*l;t[0]=o*u,t[4]=i-e*c,t[8]=n*c+r,t[1]=c,t[5]=a*u,t[9]=-s*u,t[2]=-l*u,t[6]=r*c+n,t[10]=e-i*c}else if("XZY"===e.order){let e=a*o,r=a*l,n=s*o,i=s*l;t[0]=o*u,t[4]=-c,t[8]=l*u,t[1]=e*c+i,t[5]=a*u,t[9]=r*c-n,t[2]=n*c-r,t[6]=s*u,t[10]=i*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(tg,e,ty)}lookAt(e,t,r){let n=this.elements;return t_.subVectors(e,t),0===t_.lengthSq()&&(t_.z=1),t_.normalize(),tv.crossVectors(r,t_),0===tv.lengthSq()&&(1===Math.abs(r.z)?t_.x+=1e-4:t_.z+=1e-4,t_.normalize(),tv.crossVectors(r,t_)),tv.normalize(),tx.crossVectors(t_,tv),n[0]=tv.x,n[4]=tx.x,n[8]=t_.x,n[1]=tv.y,n[5]=tx.y,n[9]=t_.y,n[2]=tv.z,n[6]=tx.z,n[10]=t_.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,a=r[0],s=r[4],o=r[8],l=r[12],u=r[1],c=r[5],h=r[9],d=r[13],A=r[2],p=r[6],f=r[10],m=r[14],g=r[3],y=r[7],v=r[11],x=r[15],_=n[0],b=n[4],S=n[8],T=n[12],w=n[1],M=n[5],E=n[9],R=n[13],C=n[2],N=n[6],P=n[10],I=n[14],L=n[3],D=n[7],B=n[11],F=n[15];return i[0]=a*_+s*w+o*C+l*L,i[4]=a*b+s*M+o*N+l*D,i[8]=a*S+s*E+o*P+l*B,i[12]=a*T+s*R+o*I+l*F,i[1]=u*_+c*w+h*C+d*L,i[5]=u*b+c*M+h*N+d*D,i[9]=u*S+c*E+h*P+d*B,i[13]=u*T+c*R+h*I+d*F,i[2]=A*_+p*w+f*C+m*L,i[6]=A*b+p*M+f*N+m*D,i[10]=A*S+p*E+f*P+m*B,i[14]=A*T+p*R+f*I+m*F,i[3]=g*_+y*w+v*C+x*L,i[7]=g*b+y*M+v*N+x*D,i[11]=g*S+y*E+v*P+x*B,i[15]=g*T+y*R+v*I+x*F,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],s=e[5],o=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14],A=e[3],p=e[7];return A*(i*o*c-n*l*c-i*s*h+r*l*h+n*s*d-r*o*d)+p*(t*o*d-t*l*h+i*a*h-n*a*d+n*l*u-i*o*u)+e[11]*(t*l*c-t*s*d-i*a*c+r*a*d+i*s*u-r*l*u)+e[15]*(-n*s*u-t*o*c+t*s*h+n*a*c-r*a*h+r*o*u)}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],A=e[12],p=e[13],f=e[14],m=e[15],g=c*f*l-p*h*l+p*o*d-s*f*d-c*o*m+s*h*m,y=A*h*l-u*f*l-A*o*d+a*f*d+u*o*m-a*h*m,v=u*p*l-A*c*l+A*s*d-a*p*d-u*s*m+a*c*m,x=A*c*o-u*p*o-A*s*h+a*p*h+u*s*f-a*c*f,_=t*g+r*y+n*v+i*x;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let b=1/_;return e[0]=g*b,e[1]=(p*h*i-c*f*i-p*n*d+r*f*d+c*n*m-r*h*m)*b,e[2]=(s*f*i-p*o*i+p*n*l-r*f*l-s*n*m+r*o*m)*b,e[3]=(c*o*i-s*h*i-c*n*l+r*h*l+s*n*d-r*o*d)*b,e[4]=y*b,e[5]=(u*f*i-A*h*i+A*n*d-t*f*d-u*n*m+t*h*m)*b,e[6]=(A*o*i-a*f*i-A*n*l+t*f*l+a*n*m-t*o*m)*b,e[7]=(a*h*i-u*o*i+u*n*l-t*h*l-a*n*d+t*o*d)*b,e[8]=v*b,e[9]=(A*c*i-u*p*i-A*r*d+t*p*d+u*r*m-t*c*m)*b,e[10]=(a*p*i-A*s*i+A*r*l-t*p*l-a*r*m+t*s*m)*b,e[11]=(u*s*i-a*c*i-u*r*l+t*c*l+a*r*d-t*s*d)*b,e[12]=x*b,e[13]=(u*p*n-A*c*n+A*r*h-t*p*h-u*r*f+t*c*f)*b,e[14]=(A*s*n-a*p*n-A*r*o+t*p*o+a*r*f-t*s*f)*b,e[15]=(a*c*n-u*s*n+u*r*o-t*c*o-a*r*h+t*s*h)*b,this}scale(e){let t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];return Math.sqrt(Math.max(t,e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),i=1-r,a=e.x,s=e.y,o=e.z,l=i*a,u=i*s;return this.set(l*a+r,l*s-n*o,l*o+n*s,0,l*s+n*o,u*s+r,u*o-n*a,0,l*o-n*s,u*o+n*a,i*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,i,a){return this.set(1,r,i,0,e,1,a,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,i=t._x,a=t._y,s=t._z,o=t._w,l=i+i,u=a+a,c=s+s,h=i*l,d=i*u,A=i*c,p=a*u,f=a*c,m=s*c,g=o*l,y=o*u,v=o*c,x=r.x,_=r.y,b=r.z;return n[0]=(1-(p+m))*x,n[1]=(d+v)*x,n[2]=(A-y)*x,n[3]=0,n[4]=(d-v)*_,n[5]=(1-(h+m))*_,n[6]=(f+g)*_,n[7]=0,n[8]=(A+y)*b,n[9]=(f-g)*b,n[10]=(1-(h+p))*b,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,i=tf.set(n[0],n[1],n[2]).length(),a=tf.set(n[4],n[5],n[6]).length(),s=tf.set(n[8],n[9],n[10]).length();0>this.determinant()&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],tm.copy(this);let o=1/i,l=1/a,u=1/s;return tm.elements[0]*=o,tm.elements[1]*=o,tm.elements[2]*=o,tm.elements[4]*=l,tm.elements[5]*=l,tm.elements[6]*=l,tm.elements[8]*=u,tm.elements[9]*=u,tm.elements[10]*=u,t.setFromRotationMatrix(tm),r.x=i,r.y=a,r.z=s,this}makePerspective(e,t,r,n,i,a){let s,o,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2e3,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=this.elements;if(u)s=i/(a-i),o=a*i/(a-i);else if(2e3===l)s=-(a+i)/(a-i),o=-2*a*i/(a-i);else if(2001===l)s=-a/(a-i),o=-a*i/(a-i);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return c[0]=2*i/(t-e),c[4]=0,c[8]=(t+e)/(t-e),c[12]=0,c[1]=0,c[5]=2*i/(r-n),c[9]=(r+n)/(r-n),c[13]=0,c[2]=0,c[6]=0,c[10]=s,c[14]=o,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,r,n,i,a){let s,o,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2e3,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=this.elements;if(u)s=1/(a-i),o=a/(a-i);else if(2e3===l)s=-2/(a-i),o=-(a+i)/(a-i);else if(2001===l)s=-1/(a-i),o=-i/(a-i);else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return c[0]=2/(t-e),c[4]=0,c[8]=0,c[12]=-(t+e)/(t-e),c[1]=0,c[5]=2/(r-n),c[9]=0,c[13]=-(r+n)/(r-n),c[2]=0,c[6]=0,c[10]=s,c[14]=o,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}constructor(e,t,r,n,i,a,s,o,l,u,c,h,d,A,p,f){tp.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,n,i,a,s,o,l,u,c,h,d,A,p,f)}}let tf=new ex,tm=new tp,tg=new ex(0,0,0),ty=new ex(1,1,1),tv=new ex,tx=new ex,t_=new ex,tb=new tp,tS=new ev;class tT{get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=e.elements,i=n[0],a=n[4],s=n[8],o=n[1],l=n[5],u=n[9],c=n[2],h=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(ed(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-ed(u,-1,1)),.9999999>Math.abs(u)?(this._y=Math.atan2(s,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(ed(h,-1,1)),.9999999>Math.abs(h)?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-ed(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(ed(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-ed(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return tb.makeRotationFromQuaternion(e),this.setFromRotationMatrix(tb,t,r)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return tS.setFromEuler(this),this.setFromQuaternion(tS,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}constructor(e=0,t=0,r=0,n=tT.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}}tT.DEFAULT_ORDER="XYZ";class tw{set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&1<<e)!=0}constructor(){this.mask=1}}let tM=0,tE=new ex,tR=new ev,tC=new tp,tN=new ex,tP=new ex,tI=new ex,tL=new ev,tD=new ex(1,0,0),tB=new ex(0,1,0),tF=new ex(0,0,1),tU={type:"added"},tO={type:"removed"},tk={type:"childadded",child:null},tz={type:"childremoved",child:null};class tV extends es{onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return tR.setFromAxisAngle(e,t),this.quaternion.multiply(tR),this}rotateOnWorldAxis(e,t){return tR.setFromAxisAngle(e,t),this.quaternion.premultiply(tR),this}rotateX(e){return this.rotateOnAxis(tD,e)}rotateY(e){return this.rotateOnAxis(tB,e)}rotateZ(e){return this.rotateOnAxis(tF,e)}translateOnAxis(e,t){return tE.copy(e).applyQuaternion(this.quaternion),this.position.add(tE.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(tD,e)}translateY(e){return this.translateOnAxis(tB,e)}translateZ(e){return this.translateOnAxis(tF,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(tC.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?tN.copy(e):tN.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),tP.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?tC.lookAt(tP,tN,this.up):tC.lookAt(tN,tP,this.up),this.quaternion.setFromRotationMatrix(tC),n&&(tC.extractRotation(n.matrixWorld),tR.setFromRotationMatrix(tC),this.quaternion.premultiply(tR.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(tU),tk.child=e,this.dispatchEvent(tk),tk.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return -1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(tO),tz.child=e,this.dispatchEvent(tz),tz.child=null),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),tC.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),tC.multiply(e.parent.matrixWorld)),e.applyMatrix4(tC),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(tU),tk.child=e,this.dispatchEvent(tk),tk.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&r.push(this);let n=this.children;for(let i=0,a=n.length;i<a;i++)n[i].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tP,e,tI),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tP,tL,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){let t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});let n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.geometryInfo=this._geometryInfo.map(e=>({...e,boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),n.instanceInfo=this._instanceInfo.map(e=>({...e})),n.availableInstanceIds=this._availableInstanceIds.slice(),n.availableGeometryIds=this._availableGeometryIds.slice(),n.nextIndexStart=this._nextIndexStart,n.nextVertexStart=this._nextVertexStart,n.geometryCount=this._geometryCount,n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.matricesTexture=this._matricesTexture.toJSON(e),n.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(n.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(n.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(n.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){let n=r[t];i(e.shapes,n)}else i(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(i(e.materials,this.material[r]));n.material=t}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){let r=this.animations[t];n.animations.push(i(e.animations,r))}}if(t){let t=a(e.geometries),n=a(e.materials),i=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),u=a(e.animations),c=a(e.nodes);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),s.length>0&&(r.images=s),o.length>0&&(r.shapes=o),l.length>0&&(r.skeletons=l),u.length>0&&(r.animations=u),c.length>0&&(r.nodes=c)}return r.object=n,r;function a(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}}clone(e){return new this.constructor().copy(this,e)}copy(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){let r=e.children[t];this.add(r.clone())}return this}constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tM++}),this.uuid=eh(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=tV.DEFAULT_UP.clone();let e=new ex,t=new tT,r=new ev,n=new ex(1,1,1);t._onChange(function(){r.setFromEuler(t,!1)}),r._onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new tp},normalMatrix:{value:new eS}}),this.matrix=new tp,this.matrixWorld=new tp,this.matrixAutoUpdate=tV.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=tV.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new tw,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}}tV.DEFAULT_UP=new ex(0,1,0),tV.DEFAULT_MATRIX_AUTO_UPDATE=!0,tV.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let tq=new ex,tG=new ex,tH=new ex,tj=new ex,tW=new ex,tX=new ex,tQ=new ex,tY=new ex,tK=new ex,tZ=new ex,tJ=new eH,t$=new eH,t0=new eH;class t1{static getNormal(e,t,r,n){n.subVectors(r,t),tq.subVectors(e,t),n.cross(tq);let i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){tq.subVectors(n,t),tG.subVectors(r,t),tH.subVectors(e,t);let a=tq.dot(tq),s=tq.dot(tG),o=tq.dot(tH),l=tG.dot(tG),u=tG.dot(tH),c=a*l-s*s;if(0===c)return i.set(0,0,0),null;let h=1/c,d=(l*o-s*u)*h,A=(a*u-s*o)*h;return i.set(1-d-A,A,d)}static containsPoint(e,t,r,n){return null!==this.getBarycoord(e,t,r,n,tj)&&tj.x>=0&&tj.y>=0&&tj.x+tj.y<=1}static getInterpolation(e,t,r,n,i,a,s,o){return null===this.getBarycoord(e,t,r,n,tj)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(i,tj.x),o.addScaledVector(a,tj.y),o.addScaledVector(s,tj.z),o)}static getInterpolatedAttribute(e,t,r,n,i,a){return tJ.setScalar(0),t$.setScalar(0),t0.setScalar(0),tJ.fromBufferAttribute(e,t),t$.fromBufferAttribute(e,r),t0.fromBufferAttribute(e,n),a.setScalar(0),a.addScaledVector(tJ,i.x),a.addScaledVector(t$,i.y),a.addScaledVector(t0,i.z),a}static isFrontFacing(e,t,r,n){return tq.subVectors(r,t),tG.subVectors(e,t),0>tq.cross(tG).dot(n)}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return tq.subVectors(this.c,this.b),tG.subVectors(this.a,this.b),.5*tq.cross(tG).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return t1.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return t1.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,n,i){return t1.getInterpolation(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return t1.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return t1.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r,n,i=this.a,a=this.b,s=this.c;tW.subVectors(a,i),tX.subVectors(s,i),tY.subVectors(e,i);let o=tW.dot(tY),l=tX.dot(tY);if(o<=0&&l<=0)return t.copy(i);tK.subVectors(e,a);let u=tW.dot(tK),c=tX.dot(tK);if(u>=0&&c<=u)return t.copy(a);let h=o*c-u*l;if(h<=0&&o>=0&&u<=0)return r=o/(o-u),t.copy(i).addScaledVector(tW,r);tZ.subVectors(e,s);let d=tW.dot(tZ),A=tX.dot(tZ);if(A>=0&&d<=A)return t.copy(s);let p=d*l-o*A;if(p<=0&&l>=0&&A<=0)return n=l/(l-A),t.copy(i).addScaledVector(tX,n);let f=u*A-d*c;if(f<=0&&c-u>=0&&d-A>=0)return tQ.subVectors(s,a),n=(c-u)/(c-u+(d-A)),t.copy(a).addScaledVector(tQ,n);let m=1/(f+p+h);return r=p*m,n=h*m,t.copy(i).addScaledVector(tW,r).addScaledVector(tX,n)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}constructor(e=new ex,t=new ex,r=new ex){this.a=e,this.b=t,this.c=r}}let t2={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32},t3={h:0,s:0,l:0},t4={h:0,s:0,l:0};function t5(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*6*(2/3-r):e}class t6{set(e,t,r){return void 0===t&&void 0===r?e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e):this.setRGB(e,t,r),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,eD.colorSpaceToWorking(this,t),this}setRGB(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eD.workingColorSpace;return this.r=e,this.g=t,this.b=r,eD.colorSpaceToWorking(this,n),this}setHSL(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eD.workingColorSpace;if(e=eA(e,1),t=ed(t,0,1),r=ed(r,0,1),0===t)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=t5(i,n,e+1/3),this.g=t5(i,n,e),this.b=t5(i,n,e-1/3)}return eD.colorSpaceToWorking(this,n),this}setStyle(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J;function n(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let i,a=t[1],s=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,r);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,r);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=t[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,r);if(6===i)return this.setHex(parseInt(n,16),r);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,r);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J,r=t2[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=eB(e.r),this.g=eB(e.g),this.b=eB(e.b),this}copyLinearToSRGB(e){return this.r=eF(e.r),this.g=eF(e.g),this.b=eF(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;return eD.workingToColorSpace(t7.copy(this),e),65536*Math.round(ed(255*t7.r,0,255))+256*Math.round(ed(255*t7.g,0,255))+Math.round(ed(255*t7.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eD.workingColorSpace;eD.workingToColorSpace(t7.copy(this),n);let i=t7.r,a=t7.g,s=t7.b,o=Math.max(i,a,s),l=Math.min(i,a,s),u=(l+o)/2;if(l===o)t=0,r=0;else{let e=o-l;switch(r=u<=.5?e/(o+l):e/(2-o-l),o){case i:t=(a-s)/e+6*(a<s);break;case a:t=(s-i)/e+2;break;case s:t=(i-a)/e+4}t/=6}return e.h=t,e.s=r,e.l=u,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eD.workingColorSpace;return eD.workingToColorSpace(t7.copy(this),t),e.r=t7.r,e.g=t7.g,e.b=t7.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;eD.workingToColorSpace(t7.copy(this),e);let t=t7.r,r=t7.g,n=t7.b;return e!==J?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(r.toFixed(3)," ").concat(n.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*r),",").concat(Math.round(255*n),")")}offsetHSL(e,t,r){return this.getHSL(t3),this.setHSL(t3.h+e,t3.s+t,t3.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(t3),e.getHSL(t4);let r=ep(t3.h,t4.h,t),n=ep(t3.s,t4.s,t),i=ep(t3.l,t4.l,t);return this.setHSL(r,n,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,r=this.g,n=this.b,i=e.elements;return this.r=i[0]*t+i[3]*r+i[6]*n,this.g=i[1]*t+i[4]*r+i[7]*n,this.b=i[2]*t+i[5]*r+i[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}}let t7=new t6;t6.NAMES=t2;let t8=0;class t9 extends es{get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let r=e[t];if(void 0===r){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}let n=this[t];if(void 0===n){console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."));continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let r={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function n(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(r.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(r.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(r.dispersion=this.dispersion),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapRotation&&(r.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),!0===this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=!0),204!==this.blendSrc&&(r.blendSrc=this.blendSrc),205!==this.blendDst&&(r.blendDst=this.blendDst),100!==this.blendEquation&&(r.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(r.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(r.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(r.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),!1===this.colorWrite&&(r.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(r.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(r.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(r.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(r.stencilFuncMask=this.stencilFuncMask),7680!==this.stencilFail&&(r.stencilFail=this.stencilFail),7680!==this.stencilZFail&&(r.stencilZFail=this.stencilZFail),7680!==this.stencilZPass&&(r.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(r.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=!0),!0===this.alphaToCoverage&&(r.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=!0),!0===this.forceSinglePass&&(r.forceSinglePass=!0),!0===this.wireframe&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){let t=n(e.textures),i=n(e.images);t.length>0&&(r.textures=t),i.length>0&&(r.images=i)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(null!==t){let e=t.length;r=Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:t8++}),this.uuid=eh(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new t6(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}}class re extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new t6(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new tT,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}}let rt=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),n=new Uint32Array(512),i=new Uint32Array(512);for(let e=0;e<256;++e){let t=e-127;t<-27?(n[e]=0,n[256|e]=32768,i[e]=24,i[256|e]=24):t<-14?(n[e]=1024>>-t-14,n[256|e]=1024>>-t-14|32768,i[e]=-t-1,i[256|e]=-t-1):t<=15?(n[e]=t+15<<10,n[256|e]=t+15<<10|32768,i[e]=13,i[256|e]=13):t<128?(n[e]=31744,n[256|e]=64512,i[e]=24,i[256|e]=24):(n[e]=31744,n[256|e]=64512,i[e]=13,i[256|e]=13)}let a=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,r=0;for(;(8388608&t)==0;)t<<=1,r-=8388608;t&=-8388609,r+=0x38800000,a[e]=t|r}for(let e=1024;e<2048;++e)a[e]=0x38000000+(e-1024<<13);for(let e=1;e<31;++e)s[e]=e<<23;s[31]=0x47800000,s[32]=0x80000000;for(let e=33;e<63;++e)s[e]=0x80000000+(e-32<<23);s[63]=0xc7800000;for(let e=1;e<64;++e)32!==e&&(o[e]=1024);return{floatView:t,uint32View:r,baseTable:n,shiftTable:i,mantissaTable:a,exponentTable:s,offsetTable:o}}();function rr(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=ed(e,-65504,65504),rt.floatView[0]=e;let t=rt.uint32View[0],r=t>>23&511;return rt.baseTable[r]+((8388607&t)>>rt.shiftTable[r])}function rn(e){let t=e>>10;return rt.uint32View[0]=rt.mantissaTable[rt.offsetTable[t]+(1023&e)]+rt.exponentTable[t],rt.floatView[0]}class ri{static toHalfFloat(e){return rr(e)}static fromHalfFloat(e){return rn(e)}}let ra=new ex,rs=new ey,ro=0;class rl{onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)rs.fromBufferAttribute(this,t),rs.applyMatrix3(e),this.setXY(t,rs.x,rs.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)ra.fromBufferAttribute(this,t),ra.applyMatrix3(e),this.setXYZ(t,ra.x,ra.y,ra.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)ra.fromBufferAttribute(this,t),ra.applyMatrix4(e),this.setXYZ(t,ra.x,ra.y,ra.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)ra.fromBufferAttribute(this,t),ra.applyNormalMatrix(e),this.setXYZ(t,ra.x,ra.y,ra.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)ra.fromBufferAttribute(this,t),ra.transformDirection(e),this.setXYZ(t,ra.x,ra.y,ra.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=ef(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=em(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ef(t,this.array)),t}setX(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ef(t,this.array)),t}setY(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ef(t,this.array)),t}setZ(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ef(t,this.array)),t}setW(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=em(t,this.array),r=em(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=em(t,this.array),r=em(r,this.array),n=em(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=em(t,this.array),r=em(r,this.array),n=em(n,this.array),i=em(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}constructor(e,t,r=!1){if(Array.isArray(e))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ro++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=35044,this.updateRanges=[],this.gpuType=1015,this.version=0}}class ru extends rl{constructor(e,t,r){super(new Int8Array(e),t,r)}}class rc extends rl{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class rh extends rl{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class rd extends rl{constructor(e,t,r){super(new Int16Array(e),t,r)}}class rA extends rl{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class rp extends rl{constructor(e,t,r){super(new Int32Array(e),t,r)}}class rf extends rl{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class rm extends rl{getX(e){let t=rn(this.array[e*this.itemSize]);return this.normalized&&(t=ef(t,this.array)),t}setX(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize]=rr(t),this}getY(e){let t=rn(this.array[e*this.itemSize+1]);return this.normalized&&(t=ef(t,this.array)),t}setY(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize+1]=rr(t),this}getZ(e){let t=rn(this.array[e*this.itemSize+2]);return this.normalized&&(t=ef(t,this.array)),t}setZ(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize+2]=rr(t),this}getW(e){let t=rn(this.array[e*this.itemSize+3]);return this.normalized&&(t=ef(t,this.array)),t}setW(e,t){return this.normalized&&(t=em(t,this.array)),this.array[e*this.itemSize+3]=rr(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=em(t,this.array),r=em(r,this.array)),this.array[e+0]=rr(t),this.array[e+1]=rr(r),this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=em(t,this.array),r=em(r,this.array),n=em(n,this.array)),this.array[e+0]=rr(t),this.array[e+1]=rr(r),this.array[e+2]=rr(n),this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=em(t,this.array),r=em(r,this.array),n=em(n,this.array),i=em(i,this.array)),this.array[e+0]=rr(t),this.array[e+1]=rr(r),this.array[e+2]=rr(n),this.array[e+3]=rr(i),this}constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}}class rg extends rl{constructor(e,t,r){super(new Float32Array(e),t,r)}}let ry=0,rv=new tp,rx=new tV,r_=new ex,rb=new eZ,rS=new eZ,rT=new ex;class rw extends es{getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ew(e)?rf:rA)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(void 0!==r){let t=new eS().getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}let n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return rv.makeRotationFromQuaternion(e),this.applyMatrix4(rv),this}rotateX(e){return rv.makeRotationX(e),this.applyMatrix4(rv),this}rotateY(e){return rv.makeRotationY(e),this.applyMatrix4(rv),this}rotateZ(e){return rv.makeRotationZ(e),this.applyMatrix4(rv),this}translate(e,t,r){return rv.makeTranslation(e,t,r),this.applyMatrix4(rv),this}scale(e,t,r){return rv.makeScale(e,t,r),this.applyMatrix4(rv),this}lookAt(e){return rx.lookAt(e),rx.updateMatrix(),this.applyMatrix4(rx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(r_).negate(),this.translate(r_.x,r_.y,r_.z),this}setFromPoints(e){let t=this.getAttribute("position");if(void 0===t){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}this.setAttribute("position",new rg(t,3))}else{let r=Math.min(e.length,t.count);for(let n=0;n<r;n++){let r=e[n];t.setXYZ(n,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new eZ);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ex(-1/0,-1/0,-1/0),new ex(Infinity,Infinity,Infinity));return}if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];rb.setFromBufferAttribute(r),this.morphTargetsRelative?(rT.addVectors(this.boundingBox.min,rb.min),this.boundingBox.expandByPoint(rT),rT.addVectors(this.boundingBox.max,rb.max),this.boundingBox.expandByPoint(rT)):(this.boundingBox.expandByPoint(rb.min),this.boundingBox.expandByPoint(rb.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ta);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ex,1/0);return}if(e){let r=this.boundingSphere.center;if(rb.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];rS.setFromBufferAttribute(r),this.morphTargetsRelative?(rT.addVectors(rb.min,rS.min),rb.expandByPoint(rT),rT.addVectors(rb.max,rS.max),rb.expandByPoint(rT)):(rb.expandByPoint(rS.min),rb.expandByPoint(rS.max))}rb.getCenter(r);let n=0;for(let t=0,i=e.count;t<i;t++)rT.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(rT));if(t)for(let i=0,a=t.length;i<a;i++){let a=t[i],s=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)rT.fromBufferAttribute(a,t),s&&(r_.fromBufferAttribute(e,t),rT.add(r_)),n=Math.max(n,r.distanceToSquared(rT))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let r=t.position,n=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new rl(new Float32Array(4*r.count),4));let a=this.getAttribute("tangent"),s=[],o=[];for(let e=0;e<r.count;e++)s[e]=new ex,o[e]=new ex;let l=new ex,u=new ex,c=new ex,h=new ey,d=new ey,A=new ey,p=new ex,f=new ex,m=this.groups;0===m.length&&(m=[{start:0,count:e.count}]);for(let t=0,n=m.length;t<n;++t){let n=m[t],a=n.start,g=n.count;for(let t=a,n=a+g;t<n;t+=3)!function(e,t,n){l.fromBufferAttribute(r,e),u.fromBufferAttribute(r,t),c.fromBufferAttribute(r,n),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),A.fromBufferAttribute(i,n),u.sub(l),c.sub(l),d.sub(h),A.sub(h);let a=1/(d.x*A.y-A.x*d.y);isFinite(a)&&(p.copy(u).multiplyScalar(A.y).addScaledVector(c,-d.y).multiplyScalar(a),f.copy(c).multiplyScalar(d.x).addScaledVector(u,-A.x).multiplyScalar(a),s[e].add(p),s[t].add(p),s[n].add(p),o[e].add(f),o[t].add(f),o[n].add(f))}(e.getX(t+0),e.getX(t+1),e.getX(t+2))}let g=new ex,y=new ex,v=new ex,x=new ex;function _(e){v.fromBufferAttribute(n,e),x.copy(v);let t=s[e];g.copy(t),g.sub(v.multiplyScalar(v.dot(t))).normalize(),y.crossVectors(x,t);let r=y.dot(o[e]);a.setXYZW(e,g.x,g.y,g.z,r<0?-1:1)}for(let t=0,r=m.length;t<r;++t){let r=m[t],n=r.start,i=r.count;for(let t=n,r=n+i;t<r;t+=3)_(e.getX(t+0)),_(e.getX(t+1)),_(e.getX(t+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new rl(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);let n=new ex,i=new ex,a=new ex,s=new ex,o=new ex,l=new ex,u=new ex,c=new ex;if(e)for(let h=0,d=e.count;h<d;h+=3){let d=e.getX(h+0),A=e.getX(h+1),p=e.getX(h+2);n.fromBufferAttribute(t,d),i.fromBufferAttribute(t,A),a.fromBufferAttribute(t,p),u.subVectors(a,i),c.subVectors(n,i),u.cross(c),s.fromBufferAttribute(r,d),o.fromBufferAttribute(r,A),l.fromBufferAttribute(r,p),s.add(u),o.add(u),l.add(u),r.setXYZ(d,s.x,s.y,s.z),r.setXYZ(A,o.x,o.y,o.z),r.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,s=t.count;e<s;e+=3)n.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),u.subVectors(a,i),c.subVectors(n,i),u.cross(c),r.setXYZ(e+0,u.x,u.y,u.z),r.setXYZ(e+1,u.x,u.y,u.z),r.setXYZ(e+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)rT.fromBufferAttribute(e,t),rT.normalize(),e.setXYZ(t,rT.x,rT.y,rT.z)}toNonIndexed(){function e(e,t){let r=e.array,n=e.itemSize,i=e.normalized,a=new r.constructor(t.length*n),s=0,o=0;for(let i=0,l=t.length;i<l;i++){s=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*n;for(let e=0;e<n;e++)a[o++]=r[s++]}return new rl(a,n,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new rw,r=this.index.array,n=this.attributes;for(let i in n){let a=e(n[i],r);t.setAttribute(i,a)}let i=this.morphAttributes;for(let n in i){let a=[],s=i[n];for(let t=0,n=s.length;t<n;t++){let n=e(s[t],r);a.push(n)}t.morphAttributes[n]=a}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let e=0,r=a.length;e<r;e++){let r=a[e];t.addGroup(r.start,r.count,r.materialIndex)}return t}toJSON(){let e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let t in r){let n=r[t];e.data.attributes[t]=n.toJSON(e.data)}let n={},i=!1;for(let t in this.morphAttributes){let r=this.morphAttributes[t],a=[];for(let t=0,n=r.length;t<n;t++){let n=r[t];a.push(n.toJSON(e.data))}a.length>0&&(n[t]=a,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let s=this.boundingSphere;return null!==s&&(e.data.boundingSphere=s.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;null!==r&&this.setIndex(r.clone());let n=e.attributes;for(let e in n){let r=n[e];this.setAttribute(e,r.clone(t))}let i=e.morphAttributes;for(let e in i){let r=[],n=i[e];for(let e=0,i=n.length;e<i;e++)r.push(n[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let e=0,t=a.length;e<t;e++){let t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}let s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());let o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ry++}),this.uuid=eh(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}}let rM=new tp,rE=new tA,rR=new ta,rC=new ex,rN=new ex,rP=new ex,rI=new ex,rL=new ex,rD=new ex,rB=new ex,rF=new ex;class rU extends tV{copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let r=this.geometry,n=r.attributes.position,i=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(n,e);let s=this.morphTargetInfluences;if(i&&s){rD.set(0,0,0);for(let r=0,n=i.length;r<n;r++){let n=s[r],o=i[r];0!==n&&(rL.fromBufferAttribute(o,e),a?rD.addScaledVector(rL,n):rD.addScaledVector(rL.sub(t),n))}t.add(rD)}return t}raycast(e,t){let r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n)null===r.boundingSphere&&r.computeBoundingSphere(),rR.copy(r.boundingSphere),rR.applyMatrix4(i),rE.copy(e.ray).recast(e.near),!1===rR.containsPoint(rE.origin)&&(null===rE.intersectSphere(rR,rC)||rE.origin.distanceToSquared(rC)>(e.far-e.near)**2)||(rM.copy(i).invert(),rE.copy(e.ray).applyMatrix4(rM),(null===r.boundingBox||!1!==rE.intersectsBox(r.boundingBox))&&this._computeIntersections(e,t,rE))}_computeIntersections(e,t,r){let n,i=this.geometry,a=this.material,s=i.index,o=i.attributes.position,l=i.attributes.uv,u=i.attributes.uv1,c=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==s)if(Array.isArray(a))for(let i=0,o=h.length;i<o;i++){let o=h[i],A=a[o.materialIndex],p=Math.max(o.start,d.start),f=Math.min(s.count,Math.min(o.start+o.count,d.start+d.count));for(let i=p;i<f;i+=3){let a=s.getX(i);(n=rO(this,A,e,r,l,u,c,a,s.getX(i+1),s.getX(i+2)))&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=o.materialIndex,t.push(n))}}else{let i=Math.max(0,d.start),o=Math.min(s.count,d.start+d.count);for(let h=i;h<o;h+=3){let i=s.getX(h);(n=rO(this,a,e,r,l,u,c,i,s.getX(h+1),s.getX(h+2)))&&(n.faceIndex=Math.floor(h/3),t.push(n))}}else if(void 0!==o)if(Array.isArray(a))for(let i=0,s=h.length;i<s;i++){let s=h[i],A=a[s.materialIndex],p=Math.max(s.start,d.start),f=Math.min(o.count,Math.min(s.start+s.count,d.start+d.count));for(let i=p;i<f;i+=3)(n=rO(this,A,e,r,l,u,c,i,i+1,i+2))&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=s.materialIndex,t.push(n))}else{let i=Math.max(0,d.start),s=Math.min(o.count,d.start+d.count);for(let o=i;o<s;o+=3)(n=rO(this,a,e,r,l,u,c,o,o+1,o+2))&&(n.faceIndex=Math.floor(o/3),t.push(n))}}constructor(e=new rw,t=new re){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}}function rO(e,t,r,n,i,a,s,o,l,u){e.getVertexPosition(o,rN),e.getVertexPosition(l,rP),e.getVertexPosition(u,rI);let c=function(e,t,r,n,i,a,s,o){if(null===(1===t.side?n.intersectTriangle(s,a,i,!0,o):n.intersectTriangle(i,a,s,0===t.side,o)))return null;rF.copy(o),rF.applyMatrix4(e.matrixWorld);let l=r.ray.origin.distanceTo(rF);return l<r.near||l>r.far?null:{distance:l,point:rF.clone(),object:e}}(e,t,r,n,rN,rP,rI,rB);if(c){let e=new ex;t1.getBarycoord(rB,rN,rP,rI,e),i&&(c.uv=t1.getInterpolatedAttribute(i,o,l,u,e,new ey)),a&&(c.uv1=t1.getInterpolatedAttribute(a,o,l,u,e,new ey)),s&&(c.normal=t1.getInterpolatedAttribute(s,o,l,u,e,new ex),c.normal.dot(n.direction)>0&&c.normal.multiplyScalar(-1));let t={a:o,b:l,c:u,normal:new ex,materialIndex:0};t1.getNormal(rN,rP,rI,t.normal),c.face=t,c.barycoord=e}return c}class rk extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rk(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}constructor(e=1,t=1,r=1,n=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};let s=this;n=Math.floor(n),i=Math.floor(i);let o=[],l=[],u=[],c=[],h=0,d=0;function A(e,t,r,n,i,a,A,p,f,m,g){let y=a/f,v=A/m,x=a/2,_=A/2,b=p/2,S=f+1,T=m+1,w=0,M=0,E=new ex;for(let a=0;a<T;a++){let s=a*v-_;for(let o=0;o<S;o++){let h=o*y-x;E[e]=h*n,E[t]=s*i,E[r]=b,l.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[r]=p>0?1:-1,u.push(E.x,E.y,E.z),c.push(o/f),c.push(1-a/m),w+=1}}for(let e=0;e<m;e++)for(let t=0;t<f;t++){let r=h+t+S*e,n=h+t+S*(e+1),i=h+(t+1)+S*(e+1),a=h+(t+1)+S*e;o.push(r,n,a),o.push(n,i,a),M+=6}s.addGroup(d,M,g),d+=M,h+=w}A("z","y","x",-1,-1,r,t,e,a=Math.floor(a),i,0),A("z","y","x",1,-1,r,t,-e,a,i,1),A("x","z","y",1,1,e,r,t,n,a,2),A("x","z","y",1,-1,e,r,-t,n,a,3),A("x","y","z",1,-1,e,t,r,n,i,4),A("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(o),this.setAttribute("position",new rg(l,3)),this.setAttribute("normal",new rg(u,3)),this.setAttribute("uv",new rg(c,2))}}function rz(e){let t={};for(let r in e)for(let n in t[r]={},e[r]){let i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[r][n]=null):t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}function rV(e){let t={};for(let r=0;r<e.length;r++){let n=rz(e[r]);for(let e in n)t[e]=n[e]}return t}function rq(e){let t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:eD.workingColorSpace}let rG={clone:rz,merge:rV};class rH extends t9{copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=rz(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);for(let r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){let n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let r={};for(let e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}}class rj extends tV{get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new tp,this.projectionMatrix=new tp,this.projectionMatrixInverse=new tp,this.coordinateSystem=2e3,this._reversedDepth=!1}}let rW=new ex,rX=new ey,rQ=new ey;class rY extends rj{copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*ec*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*eu*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ec*Math.atan(Math.tan(.5*eu*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){rW.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(rW.x,rW.y).multiplyScalar(-e/rW.z),rW.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(rW.x,rW.y).multiplyScalar(-e/rW.z)}getViewSize(e,t){return this.getViewBounds(e,rX,rQ),t.subVectors(rQ,rX)}setViewOffset(e,t,r,n,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*eu*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){let e=a.fullWidth,s=a.fullHeight;i+=a.offsetX*n/e,t-=a.offsetY*r/s,n*=a.width/e,r*=a.height/s}let s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}}class rK extends tV{updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[r,n,i,a,s,o]=t;for(let e of t)this.remove(e);if(2e3===e)r.up.set(0,1,0),r.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else if(2001===e)r.up.set(0,-1,0),r.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();let{renderTarget:r,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[i,a,s,o,l,u]=this.children,c=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),A=e.xr.enabled;e.xr.enabled=!1;let p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,n),e.render(t,i),e.setRenderTarget(r,1,n),e.render(t,a),e.setRenderTarget(r,2,n),e.render(t,s),e.setRenderTarget(r,3,n),e.render(t,o),e.setRenderTarget(r,4,n),e.render(t,l),r.texture.generateMipmaps=p,e.setRenderTarget(r,5,n),e.render(t,u),e.setRenderTarget(c,h,d),e.xr.enabled=A,r.texture.needsPMREMUpdate=!0}constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;let n=new rY(-90,1,e,t);n.layers=this.layers,this.add(n);let i=new rY(-90,1,e,t);i.layers=this.layers,this.add(i);let a=new rY(-90,1,e,t);a.layers=this.layers,this.add(a);let s=new rY(-90,1,e,t);s.layers=this.layers,this.add(s);let o=new rY(-90,1,e,t);o.layers=this.layers,this.add(o);let l=new rY(-90,1,e,t);l.layers=this.layers,this.add(l)}}class rZ extends eG{get images(){return this.image}set images(e){this.image=e}constructor(e=[],t=301,r,n,i,a,s,o,l,u){super(e,t,r,n,i,a,s,o,l,u),this.isCubeTexture=!0,this.flipY=!1}}class rJ extends eW{fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r=new rk(5,5,5),n=new rH({name:"CubemapFromEquirect",uniforms:rz({tEquirect:{value:null}}),vertexShader:"\n\n				varying vec3 vWorldDirection;\n\n				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n				}\n\n				void main() {\n\n					vWorldDirection = transformDirection( position, modelMatrix );\n\n					#include <begin_vertex>\n					#include <project_vertex>\n\n				}\n			",fragmentShader:"\n\n				uniform sampler2D tEquirect;\n\n				varying vec3 vWorldDirection;\n\n				#include <common>\n\n				void main() {\n\n					vec3 direction = normalize( vWorldDirection );\n\n					vec2 sampleUV = equirectUv( direction );\n\n					gl_FragColor = texture2D( tEquirect, sampleUV );\n\n				}\n			",side:1,blending:0});n.uniforms.tEquirect.value=t;let i=new rU(r,n),a=t.minFilter;return 1008===t.minFilter&&(t.minFilter=1006),new rK(1,10,this).update(e,i),t.minFilter=a,i.geometry.dispose(),i.material.dispose(),this}clear(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,r,n);e.setRenderTarget(i)}constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1};this.texture=new rZ([r,r,r,r,r,r]),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}}class r$ extends tV{constructor(){super(),this.isGroup=!0,this.type="Group"}}let r0={type:"move"};class r1{getHandSpace(){return null===this._hand&&(this._hand=new r$,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new r$,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ex,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ex),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new r$,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ex,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ex),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,a=null,s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){for(let n of(a=!0,e.hand.values())){let e=t.getJointPose(n,r),i=this._getHandJoint(l,n);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}let n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=n.position.distanceTo(i.position);l.inputState.pinching&&s>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,r))&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1);null!==s&&(null===(n=t.getPose(e.targetRaySpace,r))&&null!==i&&(n=i),null!==n&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,n.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(n.linearVelocity)):s.hasLinearVelocity=!1,n.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(n.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(r0)))}return null!==s&&(s.visible=null!==n),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let r=new r$;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}constructor(){this._targetRay=null,this._grip=null,this._hand=null}}class r2{clone(){return new r2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new t6(e),this.density=t}}class r3{clone(){return new r3(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new t6(e),this.near=t,this.far=r}}class r4 extends tV{copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new tT,this.environmentIntensity=1,this.environmentRotation=new tT,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class r5{onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=eh()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=eh()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRanges=[],this.version=0,this.uuid=eh()}}let r6=new ex;class r7{get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)r6.fromBufferAttribute(this,t),r6.applyMatrix4(e),this.setXYZ(t,r6.x,r6.y,r6.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)r6.fromBufferAttribute(this,t),r6.applyNormalMatrix(e),this.setXYZ(t,r6.x,r6.y,r6.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)r6.fromBufferAttribute(this,t),r6.transformDirection(e),this.setXYZ(t,r6.x,r6.y,r6.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=ef(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=em(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=em(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=em(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=em(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=em(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ef(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ef(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ef(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ef(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=em(t,this.array),r=em(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=em(t,this.array),r=em(r,this.array),n=em(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=em(t,this.array),r=em(r,this.array),n=em(n,this.array),i=em(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new r7(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new rl(new this.array.constructor(e),this.itemSize,this.normalized)}}toJSON(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}}class r8 extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new t6(0xffffff),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}}let r9=new ex,ne=new ex,nt=new ex,nr=new ey,nn=new ey,ni=new tp,na=new ex,ns=new ex,no=new ex,nl=new ey,nu=new ey,nc=new ey;class nh extends tV{raycast(e,t){let r,n;null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ne.setFromMatrixScale(this.matrixWorld),ni.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),nt.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ne.multiplyScalar(-nt.z);let i=this.material.rotation;0!==i&&(n=Math.cos(i),r=Math.sin(i));let a=this.center;nd(na.set(-.5,-.5,0),nt,a,ne,r,n),nd(ns.set(.5,-.5,0),nt,a,ne,r,n),nd(no.set(.5,.5,0),nt,a,ne,r,n),nl.set(0,0),nu.set(1,0),nc.set(1,1);let s=e.ray.intersectTriangle(na,ns,no,!1,r9);if(null===s&&(nd(ns.set(-.5,.5,0),nt,a,ne,r,n),nu.set(0,1),null===(s=e.ray.intersectTriangle(na,no,ns,!1,r9))))return;let o=e.ray.origin.distanceTo(r9);o<e.near||o>e.far||t.push({distance:o,point:r9.clone(),uv:t1.getInterpolation(r9,na,ns,no,nl,nu,nc,new ey),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}constructor(e=new r8){if(super(),this.isSprite=!0,this.type="Sprite",void 0===r){r=new rw;let e=new r5(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);r.setIndex([0,1,2,0,2,3]),r.setAttribute("position",new r7(e,3,0,!1)),r.setAttribute("uv",new r7(e,2,3,!1))}this.geometry=r,this.material=e,this.center=new ey(.5,.5),this.count=1}}function nd(e,t,r,n,i,a){nr.subVectors(e,r).addScalar(.5).multiply(n),void 0!==i?(nn.x=a*nr.x-i*nr.y,nn.y=i*nr.x+a*nr.y):nn.copy(nr),e.copy(t),e.x+=nn.x,e.y+=nn.y,e.applyMatrix4(ni)}let nA=new ex,np=new ex;class nf extends tV{copy(e){super.copy(e,!1);let t=e.levels;for(let e=0,r=t.length;e<r;e++){let r=t[e];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r=Math.abs(r);let i=this.levels;for(t=0;t<i.length&&!(r<i[t].distance);t++);return i.splice(t,0,{distance:r,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){let t=this.levels;for(let r=0;r<t.length;r++)if(t[r].distance===e){let e=t.splice(r,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n;r++){let n=t[r].distance;if(t[r].object.visible&&(n-=n*t[r].hysteresis),e<n)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){nA.setFromMatrixPosition(this.matrixWorld);let r=e.ray.origin.distanceTo(nA);this.getObjectForDistance(r).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){let r,n;nA.setFromMatrixPosition(e.matrixWorld),np.setFromMatrixPosition(this.matrixWorld);let i=nA.distanceTo(np)/e.zoom;for(r=1,t[0].object.visible=!0,n=t.length;r<n;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),i>=e)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<n;r++)t[r].object.visible=!1}}toJSON(e){let t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];let r=this.levels;for(let e=0,n=r.length;e<n;e++){let n=r[e];t.object.levels.push({object:n.object.uuid,distance:n.distance,hysteresis:n.hysteresis})}return t}constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}}let nm=new ex,ng=new eH,ny=new eH,nv=new ex,nx=new tp,n_=new ex,nb=new ta,nS=new tp,nT=new tA;class nw extends rU{computeBoundingBox(){let e=this.geometry;null===this.boundingBox&&(this.boundingBox=new eZ),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let e=0;e<t.count;e++)this.getVertexPosition(e,n_),this.boundingBox.expandByPoint(n_)}computeBoundingSphere(){let e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new ta),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let e=0;e<t.count;e++)this.getVertexPosition(e,n_),this.boundingSphere.expandByPoint(n_)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let r=this.material,n=this.matrixWorld;if(void 0!==r)null===this.boundingSphere&&this.computeBoundingSphere(),nb.copy(this.boundingSphere),nb.applyMatrix4(n),!1!==e.ray.intersectsSphere(nb)&&(nS.copy(n).invert(),nT.copy(e.ray).applyMatrix4(nS),(null===this.boundingBox||!1!==nT.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,nT))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new eH,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);let n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===K?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Z?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let r=this.skeleton,n=this.geometry;ng.fromBufferAttribute(n.attributes.skinIndex,e),ny.fromBufferAttribute(n.attributes.skinWeight,e),nm.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){let n=ny.getComponent(e);if(0!==n){let i=ng.getComponent(e);nx.multiplyMatrices(r.bones[i].matrixWorld,r.boneInverses[i]),t.addScaledVector(nv.copy(nm).applyMatrix4(nx),n)}}return t.applyMatrix4(this.bindMatrixInverse)}constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=K,this.bindMatrix=new tp,this.bindMatrixInverse=new tp,this.boundingBox=null,this.boundingSphere=null}}class nM extends tV{constructor(){super(),this.isBone=!0,this.type="Bone"}}class nE extends eG{constructor(e=null,t=1,r=1,n,i,a,s,o,l=1003,u=1003,c,h){super(null,a,s,o,l,u,n,i,c,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let nR=new tp,nC=new tp;class nN{init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new tp)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new tp;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,i=e.length;n<i;n++){let i=e[n]?e[n].matrixWorld:nC;nR.multiplyMatrices(i,t[n]),nR.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new nN(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length),t=new Float32Array((e=Math.max(e=4*Math.ceil(e/4),4))*e*4);t.set(this.boneMatrices);let r=new nE(t,e,e,1023,1015);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=e.bones[r],i=t[n];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),i=new nM),this.bones.push(i),this.boneInverses.push(new tp().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){let i=t[n];e.bones.push(i.uuid);let a=r[n];e.boneInverses.push(a.toArray())}return e}constructor(e=[],t=[]){this.uuid=eh(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}}class nP extends rl{copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}constructor(e,t,r,n=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}}let nI=new tp,nL=new tp,nD=[],nB=new eZ,nF=new tp,nU=new rU,nO=new ta;class nk extends rU{computeBoundingBox(){let e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new eZ),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,nI),nB.copy(e.boundingBox).applyMatrix4(nI),this.boundingBox.union(nB)}computeBoundingSphere(){let e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new ta),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,nI),nO.copy(e.boundingSphere).applyMatrix4(nI),this.boundingSphere.union(nO)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){let r=t.morphTargetInfluences,n=this.morphTexture.source.data.data,i=e*(r.length+1)+1;for(let e=0;e<r.length;e++)r[e]=n[i+e]}raycast(e,t){let r=this.matrixWorld,n=this.count;if((nU.geometry=this.geometry,nU.material=this.material,void 0!==nU.material)&&(null===this.boundingSphere&&this.computeBoundingSphere(),nO.copy(this.boundingSphere),nO.applyMatrix4(r),!1!==e.ray.intersectsSphere(nO)))for(let i=0;i<n;i++){this.getMatrixAt(i,nI),nL.multiplyMatrices(r,nI),nU.matrixWorld=nL,nU.raycast(e,nD);for(let e=0,r=nD.length;e<r;e++){let r=nD[e];r.instanceId=i,r.object=this,t.push(r)}nD.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new nP(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){let r=t.morphTargetInfluences,n=r.length+1;null===this.morphTexture&&(this.morphTexture=new nE(new Float32Array(n*this.count),n,this.count,1028,1015));let i=this.morphTexture.source.data.data,a=0;for(let e=0;e<r.length;e++)a+=r[e];let s=this.geometry.morphTargetsRelative?1:1-a,o=n*e;i[o]=s,i.set(r,o+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new nP(new Float32Array(16*r),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let e=0;e<r;e++)this.setMatrixAt(e,nF)}}let nz=new ex,nV=new ex,nq=new eS;class nG{set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=nz.subVectors(r,t).cross(nV.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let r=e.delta(nz),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(e.start).addScaledVector(r,i)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||nq.getNormalMatrix(e),n=this.coplanarPoint(nz).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}constructor(e=new ex(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}}let nH=new ta,nj=new ey(.5,.5),nW=new ex;class nX{set(e,t,r,n,i,a){let s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(r),s[3].copy(n),s[4].copy(i),s[5].copy(a),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.planes,i=e.elements,a=i[0],s=i[1],o=i[2],l=i[3],u=i[4],c=i[5],h=i[6],d=i[7],A=i[8],p=i[9],f=i[10],m=i[11],g=i[12],y=i[13],v=i[14],x=i[15];if(n[0].setComponents(l-a,d-u,m-A,x-g).normalize(),n[1].setComponents(l+a,d+u,m+A,x+g).normalize(),n[2].setComponents(l+s,d+c,m+p,x+y).normalize(),n[3].setComponents(l-s,d-c,m-p,x-y).normalize(),r)n[4].setComponents(o,h,f,v).normalize(),n[5].setComponents(l-o,d-h,m-f,x-v).normalize();else if(n[4].setComponents(l-o,d-h,m-f,x-v).normalize(),2e3===t)n[5].setComponents(l+o,d+h,m+f,x+v).normalize();else if(2001===t)n[5].setComponents(o,h,f,v).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),nH.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),nH.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(nH)}intersectsSprite(e){return nH.center.set(0,0,0),nH.radius=.7071067811865476+nj.distanceTo(e.center),nH.applyMatrix4(e.matrixWorld),this.intersectsSphere(nH)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(nW.x=n.normal.x>0?e.max.x:e.min.x,nW.y=n.normal.y>0?e.max.y:e.min.y,nW.z=n.normal.z>0?e.max.z:e.min.z,0>n.distanceToPoint(nW))return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}clone(){return new this.constructor().copy(this)}constructor(e=new nG,t=new nG,r=new nG,n=new nG,i=new nG,a=new nG){this.planes=[e,t,r,n,i,a]}}let nQ=new tp,nY=new nX;class nK{intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let r=0;r<t.cameras.length;r++){let n=t.cameras[r];if(nQ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),nY.setFromProjectionMatrix(nQ,n.coordinateSystem,n.reversedDepth),nY.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let r=0;r<t.cameras.length;r++){let n=t.cameras[r];if(nQ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),nY.setFromProjectionMatrix(nQ,n.coordinateSystem,n.reversedDepth),nY.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let r=0;r<t.cameras.length;r++){let n=t.cameras[r];if(nQ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),nY.setFromProjectionMatrix(nQ,n.coordinateSystem,n.reversedDepth),nY.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let r=0;r<t.cameras.length;r++){let n=t.cameras[r];if(nQ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),nY.setFromProjectionMatrix(nQ,n.coordinateSystem,n.reversedDepth),nY.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let r=0;r<t.cameras.length;r++){let n=t.cameras[r];if(nQ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),nY.setFromProjectionMatrix(nQ,n.coordinateSystem,n.reversedDepth),nY.containsPoint(e))return!0}return!1}clone(){return new nK}constructor(){this.coordinateSystem=2e3}}function nZ(e,t){return e-t}function nJ(e,t){return e.z-t.z}function n$(e,t){return t.z-e.z}let n0=new tp,n1=new t6(1,1,1),n2=new nX,n3=new nK,n4=new eZ,n5=new ta,n6=new ex,n7=new ex,n8=new ex,n9=new class{push(e,t,r,n){let i=this.pool,a=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});let s=i[this.index];a.push(s),this.index++,s.start=e,s.count=t,s.z=r,s.index=n}reset(){this.list.length=0,this.index=0}constructor(){this.index=0,this.pool=[],this.list=[]}},ie=new rU,it=[];function ir(e,t){if(e.constructor!==t.constructor){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++)t[n]=e[n]}else{let r=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,r))}}class ii extends rU{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount),t=new nE(new Float32Array((e=Math.max(e=4*Math.ceil(e/4),4))*e*4),e,e,1023,1015);this._matricesTexture=t}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount),t=new nE(new Uint32Array((e=Math.ceil(e))*e),e,e,1029,1014);this._indirectTexture=t}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount),t=new nE(new Float32Array((e=Math.ceil(e))*e*4).fill(1),e,e,1023,1015);t.colorSpace=eD.workingColorSpace,this._colorsTexture=t}_initializeGeometry(e){let t=this.geometry,r=this._maxVertexCount,n=this._maxIndexCount;if(!1===this._geometryInitialized){for(let n in e.attributes){let{array:i,itemSize:a,normalized:s}=e.getAttribute(n),o=new rl(new i.constructor(r*a),a,s);t.setAttribute(n,o)}if(null!==e.getIndex()){let e=r>65535?new Uint32Array(n):new Uint16Array(n);t.setIndex(new rl(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let r in t.attributes){if(!e.hasAttribute(r))throw Error('THREE.BatchedMesh: Added geometry missing "'.concat(r,'". All geometries must have consistent attributes.'));let n=e.getAttribute(r),i=t.getAttribute(r);if(n.itemSize!==i.itemSize||n.normalized!==i.normalized)throw Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){let t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new eZ);let e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let r=0,n=t.length;r<n;r++){if(!1===t[r].active)continue;let n=t[r].geometryIndex;this.getMatrixAt(r,n0),this.getBoundingBoxAt(n,n4).applyMatrix4(n0),e.union(n4)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ta);let e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let r=0,n=t.length;r<n;r++){if(!1===t[r].active)continue;let n=t[r].geometryIndex;this.getMatrixAt(r,n0),this.getBoundingSphereAt(n,n5).applyMatrix4(n0),e.union(n5)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw Error("THREE.BatchedMesh: Maximum item count reached.");let t={visible:!0,active:!0,geometryIndex:e},r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(nZ),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=t):(r=this._instanceInfo.length,this._instanceInfo.push(t));let n=this._matricesTexture;n0.identity().toArray(n.image.data,16*r),n.needsUpdate=!0;let i=this._colorsTexture;return i&&(n1.toArray(i.image.data,4*r),i.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._initializeGeometry(e),this._validateGeometry(e);let i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=-1===r?e.getAttribute("position").count:r;let s=e.getIndex();if(null!==s&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=-1===n?s.count:n),-1!==i.indexStart&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(nZ),a[t=this._availableGeometryIds.shift()]=i):(t=this._geometryCount,this._geometryCount++,a.push(i)),this.setGeometryAt(t,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,t}setGeometryAt(e,t){if(e>=this._geometryCount)throw Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let r=this.geometry,n=null!==r.getIndex(),i=r.getIndex(),a=t.getIndex(),s=this._geometryInfo[e];if(n&&a.count>s.reservedIndexCount||t.attributes.position.count>s.reservedVertexCount)throw Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let o=s.vertexStart,l=s.reservedVertexCount;for(let e in s.vertexCount=t.getAttribute("position").count,r.attributes){let n=t.getAttribute(e),i=r.getAttribute(e);!function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){let i=e.count;for(let a=0;a<i;a++)for(let i=0;i<n;i++)t.setComponent(a+r,i,e.getComponent(a,i))}else t.array.set(e.array,r*n);t.needsUpdate=!0}(n,i,o);let a=n.itemSize;for(let e=n.count;e<l;e++){let t=o+e;for(let e=0;e<a;e++)i.setComponent(t,e,0)}i.needsUpdate=!0,i.addUpdateRange(o*a,l*a)}if(n){let e=s.indexStart,r=s.reservedIndexCount;s.indexCount=t.getIndex().count;for(let t=0;t<a.count;t++)i.setX(e+t,o+a.getX(t));for(let t=a.count;t<r;t++)i.setX(e+t,o);i.needsUpdate=!0,i.addUpdateRange(e,s.reservedIndexCount)}return s.start=n?s.indexStart:s.vertexStart,s.count=n?s.indexCount:s.vertexCount,s.boundingBox=null,null!==t.boundingBox&&(s.boundingBox=t.boundingBox.clone()),s.boundingSphere=null,null!==t.boundingSphere&&(s.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;let r=this._instanceInfo;for(let t=0,n=r.length;t<n;t++)r[t].active&&r[t].geometryIndex===e&&this.deleteInstance(t);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0,r=this._geometryInfo,n=r.map((e,t)=>t).sort((e,t)=>r[e].vertexStart-r[t].vertexStart),i=this.geometry;for(let a=0,s=r.length;a<s;a++){let s=r[n[a]];if(!1!==s.active){if(null!==i.index){if(s.indexStart!==t){let{indexStart:r,vertexStart:n,reservedIndexCount:a}=s,o=i.index,l=o.array,u=e-n;for(let e=r;e<r+a;e++)l[e]=l[e]+u;o.array.copyWithin(t,r,r+a),o.addUpdateRange(t,a),s.indexStart=t}t+=s.reservedIndexCount}if(s.vertexStart!==e){let{vertexStart:t,reservedVertexCount:r}=s,n=i.attributes;for(let i in n){let a=n[i],{array:s,itemSize:o}=a;s.copyWithin(e*o,t*o,(t+r)*o),a.addUpdateRange(e*o,r*o)}s.vertexStart=e}e+=s.reservedVertexCount,s.start=i.index?s.indexStart:s.vertexStart,this._nextIndexStart=i.index?s.indexStart+s.reservedIndexCount:0,this._nextVertexStart=s.vertexStart+s.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;let r=this.geometry,n=this._geometryInfo[e];if(null===n.boundingBox){let e=new eZ,t=r.index,i=r.attributes.position;for(let r=n.start,a=n.start+n.count;r<a;r++){let n=r;t&&(n=t.getX(n)),e.expandByPoint(n6.fromBufferAttribute(i,n))}n.boundingBox=e}return t.copy(n.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;let r=this.geometry,n=this._geometryInfo[e];if(null===n.boundingSphere){let t=new ta;this.getBoundingBoxAt(e,n4),n4.getCenter(t.center);let i=r.index,a=r.attributes.position,s=0;for(let e=n.start,r=n.start+n.count;e<r;e++){let r=e;i&&(r=i.getX(r)),n6.fromBufferAttribute(a,r),s=Math.max(s,t.center.distanceToSquared(n6))}t.radius=Math.sqrt(s),n.boundingSphere=t}return t.copy(n.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);let r=this._matricesTexture,n=this._matricesTexture.image.data;return t.toArray(n,16*e),r.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.validateGeometryId(e);let r=this._geometryInfo[e];return t.vertexStart=r.vertexStart,t.vertexCount=r.vertexCount,t.reservedVertexCount=r.reservedVertexCount,t.indexStart=r.indexStart,t.indexCount=r.indexCount,t.reservedIndexCount=r.reservedIndexCount,t.start=r.start,t.count=r.count,t}setInstanceCount(e){let t=this._availableInstanceIds,r=this._instanceInfo;for(t.sort(nZ);t[t.length-1]===r.length-1;)r.pop(),t.pop();if(e<r.length)throw Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));let n=new Int32Array(e),i=new Int32Array(e);ir(this._multiDrawCounts,n),ir(this._multiDrawStarts,i),this._multiDrawCounts=n,this._multiDrawStarts=i,this._maxInstanceCount=e;let a=this._indirectTexture,s=this._matricesTexture,o=this._colorsTexture;a.dispose(),this._initIndirectTexture(),ir(a.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),ir(s.image.data,this._matricesTexture.image.data),o&&(o.dispose(),this._initColorsTexture(),ir(o.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){let r=[...this._geometryInfo].filter(e=>e.active);if(Math.max(...r.map(e=>e.vertexStart+e.reservedVertexCount))>e)throw Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(t,". Cannot shrink further."));if(this.geometry.index&&Math.max(...r.map(e=>e.indexStart+e.reservedIndexCount))>t)throw Error("BatchedMesh: Geometry index values are being used outside the range ".concat(t,". Cannot shrink further."));let n=this.geometry;n.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new rw,this._initializeGeometry(n));let i=this.geometry;for(let e in n.index&&ir(n.index.array,i.index.array),n.attributes)ir(n.attributes[e].array,i.attributes[e].array)}raycast(e,t){let r=this._instanceInfo,n=this._geometryInfo,i=this.matrixWorld,a=this.geometry;ie.material=this.material,ie.geometry.index=a.index,ie.geometry.attributes=a.attributes,null===ie.geometry.boundingBox&&(ie.geometry.boundingBox=new eZ),null===ie.geometry.boundingSphere&&(ie.geometry.boundingSphere=new ta);for(let a=0,s=r.length;a<s;a++){if(!r[a].visible||!r[a].active)continue;let s=r[a].geometryIndex,o=n[s];ie.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(a,ie.matrixWorld).premultiply(i),this.getBoundingBoxAt(s,ie.geometry.boundingBox),this.getBoundingSphereAt(s,ie.geometry.boundingSphere),ie.raycast(e,it);for(let e=0,r=it.length;e<r;e++){let r=it[e];r.object=this,r.batchId=a,t.push(r)}it.length=0}ie.material=null,ie.geometry.index=null,ie.geometry.attributes={},ie.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(e=>({...e,boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(e=>({...e})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,r,n,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let a=n.getIndex(),s=null===a?1:a.array.BYTES_PER_ELEMENT,o=this._instanceInfo,l=this._multiDrawStarts,u=this._multiDrawCounts,c=this._geometryInfo,h=this.perObjectFrustumCulled,d=this._indirectTexture,A=d.image.data,p=r.isArrayCamera?n3:n2;h&&!r.isArrayCamera&&(n0.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),n2.setFromProjectionMatrix(n0,r.coordinateSystem,r.reversedDepth));let f=0;if(this.sortObjects){n0.copy(this.matrixWorld).invert(),n6.setFromMatrixPosition(r.matrixWorld).applyMatrix4(n0),n7.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(n0);for(let e=0,t=o.length;e<t;e++)if(o[e].visible&&o[e].active){let t=o[e].geometryIndex;this.getMatrixAt(e,n0),this.getBoundingSphereAt(t,n5).applyMatrix4(n0);let n=!1;if(h&&(n=!p.intersectsSphere(n5,r)),!n){let r=c[t],n=n8.subVectors(n5.center,n6).dot(n7);n9.push(r.start,r.count,n,e)}}let e=n9.list,t=this.customSort;null===t?e.sort(i.transparent?n$:nJ):t.call(this,e,r);for(let t=0,r=e.length;t<r;t++){let r=e[t];l[f]=r.start*s,u[f]=r.count,A[f]=r.index,f++}n9.reset()}else for(let e=0,t=o.length;e<t;e++)if(o[e].visible&&o[e].active){let t=o[e].geometryIndex,n=!1;if(h&&(this.getMatrixAt(e,n0),this.getBoundingSphereAt(t,n5).applyMatrix4(n0),n=!p.intersectsSphere(n5,r)),!n){let r=c[t];l[f]=r.start*s,u[f]=r.count,A[f]=e,f++}}d.needsUpdate=!0,this._multiDrawCount=f,this._visibilityChanged=!1}onBeforeShadow(e,t,r,n,i,a){this.onBeforeRender(e,null,n,i,a)}constructor(e,t,r=2*t,n){super(new rw,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}}class ia extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new t6(0xffffff),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}}let is=new ex,io=new ex,il=new tp,iu=new tA,ic=new ta,ih=new ex,id=new ex;class iA extends tV{copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)is.fromBufferAttribute(t,e-1),io.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=is.distanceTo(io);e.setAttribute("lineDistance",new rg(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),ic.copy(r.boundingSphere),ic.applyMatrix4(n),ic.radius+=i,!1===e.ray.intersectsSphere(ic))return;il.copy(n).invert(),iu.copy(e.ray).applyMatrix4(il);let s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=this.isLineSegments?2:1,u=r.index,c=r.attributes.position;if(null!==u){let r=Math.max(0,a.start),n=Math.min(u.count,a.start+a.count);for(let i=r,a=n-1;i<a;i+=l){let r=ip(this,e,iu,o,u.getX(i),u.getX(i+1),i);r&&t.push(r)}if(this.isLineLoop){let i=ip(this,e,iu,o,u.getX(n-1),u.getX(r),n-1);i&&t.push(i)}}else{let r=Math.max(0,a.start),n=Math.min(c.count,a.start+a.count);for(let i=r,a=n-1;i<a;i+=l){let r=ip(this,e,iu,o,i,i+1,i);r&&t.push(r)}if(this.isLineLoop){let i=ip(this,e,iu,o,n-1,r,n-1);i&&t.push(i)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}constructor(e=new rw,t=new ia){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}}function ip(e,t,r,n,i,a,s){let o=e.geometry.attributes.position;if(is.fromBufferAttribute(o,i),io.fromBufferAttribute(o,a),r.distanceSqToSegment(is,io,ih,id)>n)return;ih.applyMatrix4(e.matrixWorld);let l=t.ray.origin.distanceTo(ih);if(!(l<t.near)&&!(l>t.far))return{distance:l,point:id.clone().applyMatrix4(e.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:e}}let im=new ex,ig=new ex;class iy extends iA{computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)im.fromBufferAttribute(t,e),ig.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+im.distanceTo(ig);e.setAttribute("lineDistance",new rg(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}}class iv extends iA{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class ix extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new t6(0xffffff),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}}let i_=new tp,ib=new tA,iS=new ta,iT=new ex;class iw extends tV{copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Points.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),iS.copy(r.boundingSphere),iS.applyMatrix4(n),iS.radius+=i,!1===e.ray.intersectsSphere(iS))return;i_.copy(n).invert(),ib.copy(e.ray).applyMatrix4(i_);let s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=r.index,u=r.attributes.position;if(null!==l){let r=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);for(let a=r;a<i;a++){let r=l.getX(a);iT.fromBufferAttribute(u,r),iM(iT,r,o,n,e,t,this)}}else{let r=Math.max(0,a.start),i=Math.min(u.count,a.start+a.count);for(let a=r;a<i;a++)iT.fromBufferAttribute(u,a),iM(iT,a,o,n,e,t,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}constructor(e=new rw,t=new ix){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}}function iM(e,t,r,n,i,a,s){let o=ib.distanceSqToPoint(e);if(o<r){let r=new ex;ib.closestPointToPoint(e,r),r.applyMatrix4(n);let l=i.ray.origin.distanceTo(r);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:r,index:t,face:null,faceIndex:null,barycoord:null,object:s})}}class iE extends eG{clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),super.dispose()}constructor(e,t,r,n,i=1006,a=1006,s,o,l){super(e,t,r,n,i,a,s,o,l),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;let u=this;"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(function t(){u.needsUpdate=!0,u._requestVideoFrameCallbackId=e.requestVideoFrameCallback(t)}))}}class iR extends iE{update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}constructor(e,t,r,n,i,a,s,o){super({},e,t,r,n,i,a,s,o),this.isVideoFrameTexture=!0}}class iC extends eG{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=1003,this.minFilter=1003,this.generateMipmaps=!1,this.needsUpdate=!0}}class iN extends eG{constructor(e,t,r,n,i,a,s,o,l,u,c,h){super(null,a,s,o,l,u,n,i,c,h),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class iP extends iN{addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}constructor(e,t,r,n,i,a){super(e,t,r,i,a),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=1001,this.layerUpdates=new Set}}class iI extends iN{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,301),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class iL extends eG{constructor(e,t,r,n,i,a,s,o,l){super(e,t,r,n,i,a,s,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class iD extends eG{copy(e){return super.copy(e),this.source=new ek(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}constructor(e,t,r=1014,n,i,a,s=1003,o=1003,l,u=1026,c=1){if(1026!==u&&1027!==u)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:c},n,i,a,s,o,u,r,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}}class iB extends eG{copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}}class iF extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iF(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}constructor(e=1,t=1,r=4,n=8,i=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:r,radialSegments:n,heightSegments:i},t=Math.max(0,t),r=Math.max(1,Math.floor(r)),n=Math.max(3,Math.floor(n));let a=[],s=[],o=[],l=[],u=t/2,c=Math.PI/2*e,h=t,d=2*c+h,A=2*r+(i=Math.max(1,Math.floor(i))),p=n+1,f=new ex,m=new ex;for(let g=0;g<=A;g++){let y=0,v=0,x=0,_=0;if(g<=r){let t=g/r,n=t*Math.PI/2;v=-u-e*Math.cos(n),x=e*Math.sin(n),_=-e*Math.cos(n),y=t*c}else if(g<=r+i){let n=(g-r)/i;v=-u+n*t,x=e,_=0,y=c+n*h}else{let t=(g-r-i)/r,n=t*Math.PI/2;v=u+e*Math.sin(n),x=e*Math.cos(n),_=e*Math.sin(n),y=c+h+t*c}let b=Math.max(0,Math.min(1,y/d)),S=0;0===g?S=.5/n:g===A&&(S=-.5/n);for(let e=0;e<=n;e++){let t=e/n,r=t*Math.PI*2,i=Math.sin(r),a=Math.cos(r);m.x=-x*a,m.y=v,m.z=x*i,s.push(m.x,m.y,m.z),f.set(-x*a,_,x*i),f.normalize(),o.push(f.x,f.y,f.z),l.push(t+S,b)}if(g>0){let e=(g-1)*p;for(let t=0;t<n;t++){let r=e+t,n=e+t+1,i=g*p+t,s=g*p+t+1;a.push(r,n,i),a.push(n,s,i)}}}this.setIndex(a),this.setAttribute("position",new rg(s,3)),this.setAttribute("normal",new rg(o,3)),this.setAttribute("uv",new rg(l,2))}}class iU extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iU(e.radius,e.segments,e.thetaStart,e.thetaLength)}constructor(e=1,t=32,r=0,n=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},t=Math.max(3,t);let i=[],a=[],s=[],o=[],l=new ex,u=new ey;a.push(0,0,0),s.push(0,0,1),o.push(.5,.5);for(let i=0,c=3;i<=t;i++,c+=3){let h=r+i/t*n;l.x=e*Math.cos(h),l.y=e*Math.sin(h),a.push(l.x,l.y,l.z),s.push(0,0,1),u.x=(a[c]/e+1)/2,u.y=(a[c+1]/e+1)/2,o.push(u.x,u.y)}for(let e=1;e<=t;e++)i.push(e,e+1,0);this.setIndex(i),this.setAttribute("position",new rg(a,3)),this.setAttribute("normal",new rg(s,3)),this.setAttribute("uv",new rg(o,2))}}class iO extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iO(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}constructor(e=1,t=1,r=1,n=32,i=1,a=!1,s=0,o=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:s,thetaLength:o};let l=this;n=Math.floor(n),i=Math.floor(i);let u=[],c=[],h=[],d=[],A=0,p=[],f=r/2,m=0;function g(r){let i=A,a=new ey,p=new ex,g=0,y=!0===r?e:t,v=!0===r?1:-1;for(let e=1;e<=n;e++)c.push(0,f*v,0),h.push(0,v,0),d.push(.5,.5),A++;let x=A;for(let e=0;e<=n;e++){let t=e/n*o+s,r=Math.cos(t),i=Math.sin(t);p.x=y*i,p.y=f*v,p.z=y*r,c.push(p.x,p.y,p.z),h.push(0,v,0),a.x=.5*r+.5,a.y=.5*i*v+.5,d.push(a.x,a.y),A++}for(let e=0;e<n;e++){let t=i+e,n=x+e;!0===r?u.push(n,n+1,t):u.push(n+1,n,t),g+=3}l.addGroup(m,g,!0===r?1:2),m+=g}(function(){let a=new ex,g=new ex,y=0,v=(t-e)/r;for(let l=0;l<=i;l++){let u=[],m=l/i,y=m*(t-e)+e;for(let e=0;e<=n;e++){let t=e/n,i=t*o+s,l=Math.sin(i),p=Math.cos(i);g.x=y*l,g.y=-m*r+f,g.z=y*p,c.push(g.x,g.y,g.z),a.set(l,v,p).normalize(),h.push(a.x,a.y,a.z),d.push(t,1-m),u.push(A++)}p.push(u)}for(let r=0;r<n;r++)for(let n=0;n<i;n++){let a=p[n][r],s=p[n+1][r],o=p[n+1][r+1],l=p[n][r+1];(e>0||0!==n)&&(u.push(a,s,l),y+=3),(t>0||n!==i-1)&&(u.push(s,o,l),y+=3)}l.addGroup(m,y,0),m+=y})(),!1===a&&(e>0&&g(!0),t>0&&g(!1)),this.setIndex(u),this.setAttribute("position",new rg(c,3)),this.setAttribute("normal",new rg(h,3)),this.setAttribute("uv",new rg(d,2))}}class ik extends iO{static fromJSON(e){return new ik(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}constructor(e=1,t=1,r=32,n=1,i=!1,a=0,s=2*Math.PI){super(0,e,t,r,n,i,a,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:s}}}class iz extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iz(e.vertices,e.indices,e.radius,e.details)}constructor(e=[],t=[],r=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n};let i=[],a=[];function s(e){i.push(e.x,e.y,e.z)}function o(t,r){let n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function l(e,t,r,n){n<0&&1===e.x&&(a[t]=e.x-1),0===r.x&&0===r.z&&(a[t]=n/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}(function(e){let r=new ex,n=new ex,i=new ex;for(let a=0;a<t.length;a+=3)o(t[a+0],r),o(t[a+1],n),o(t[a+2],i),function(e,t,r,n){let i=n+1,a=[];for(let n=0;n<=i;n++){a[n]=[];let s=e.clone().lerp(r,n/i),o=t.clone().lerp(r,n/i),l=i-n;for(let e=0;e<=l;e++)0===e&&n===i?a[n][e]=s:a[n][e]=s.clone().lerp(o,e/l)}for(let e=0;e<i;e++)for(let t=0;t<2*(i-e)-1;t++){let r=Math.floor(t/2);t%2==0?(s(a[e][r+1]),s(a[e+1][r]),s(a[e][r])):(s(a[e][r+1]),s(a[e+1][r+1]),s(a[e+1][r]))}}(r,n,i,e)})(n),function(e){let t=new ex;for(let r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){let e=new ex;for(let r=0;r<i.length;r+=3){var t;e.x=i[r+0],e.y=i[r+1],e.z=i[r+2];let n=u(e)/2/Math.PI+.5,s=Math.atan2(-(t=e).y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5;a.push(n,1-s)}(function(){let e=new ex,t=new ex,r=new ex,n=new ex,s=new ey,o=new ey,c=new ey;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),r.set(i[h+6],i[h+7],i[h+8]),s.set(a[d+0],a[d+1]),o.set(a[d+2],a[d+3]),c.set(a[d+4],a[d+5]),n.copy(e).add(t).add(r).divideScalar(3);let A=u(n);l(s,d+0,e,A),l(o,d+2,t,A),l(c,d+4,r,A)}})(),function(){for(let e=0;e<a.length;e+=6){let t=a[e+0],r=a[e+2],n=a[e+4],i=Math.max(t,r,n),s=Math.min(t,r,n);i>.9&&s<.1&&(t<.2&&(a[e+0]+=1),r<.2&&(a[e+2]+=1),n<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new rg(i,3)),this.setAttribute("normal",new rg(i.slice(),3)),this.setAttribute("uv",new rg(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}}class iV extends iz{static fromJSON(e){return new iV(e.radius,e.detail)}constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,n=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}}let iq=new ex,iG=new ex,iH=new ex,ij=new t1;class iW extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){let r=Math.cos(eu*t),n=e.getIndex(),i=e.getAttribute("position"),a=n?n.count:i.count,s=[0,0,0],o=["a","b","c"],l=[,,,],u={},c=[];for(let e=0;e<a;e+=3){n?(s[0]=n.getX(e),s[1]=n.getX(e+1),s[2]=n.getX(e+2)):(s[0]=e,s[1]=e+1,s[2]=e+2);let{a:t,b:a,c:h}=ij;if(t.fromBufferAttribute(i,s[0]),a.fromBufferAttribute(i,s[1]),h.fromBufferAttribute(i,s[2]),ij.getNormal(iH),l[0]="".concat(Math.round(1e4*t.x),",").concat(Math.round(1e4*t.y),",").concat(Math.round(1e4*t.z)),l[1]="".concat(Math.round(1e4*a.x),",").concat(Math.round(1e4*a.y),",").concat(Math.round(1e4*a.z)),l[2]="".concat(Math.round(1e4*h.x),",").concat(Math.round(1e4*h.y),",").concat(Math.round(1e4*h.z)),l[0]!==l[1]&&l[1]!==l[2]&&l[2]!==l[0])for(let e=0;e<3;e++){let t=(e+1)%3,n=l[e],i=l[t],a=ij[o[e]],h=ij[o[t]],d="".concat(n,"_").concat(i),A="".concat(i,"_").concat(n);A in u&&u[A]?(iH.dot(u[A].normal)<=r&&(c.push(a.x,a.y,a.z),c.push(h.x,h.y,h.z)),u[A]=null):d in u||(u[d]={index0:s[e],index1:s[t],normal:iH.clone()})}}for(let e in u)if(u[e]){let{index0:t,index1:r}=u[e];iq.fromBufferAttribute(i,t),iG.fromBufferAttribute(i,r),c.push(iq.x,iq.y,iq.z),c.push(iG.x,iG.y,iG.z)}this.setAttribute("position",new rg(c,3))}}}class iX{getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)t.push(i+=(r=this.getPoint(a/e)).distanceTo(n)),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getLengths(),i=0,a=n.length;t=r||e*n[a-1];let s=0,o=a-1,l;for(;s<=o;)if((l=n[i=Math.floor(s+(o-s)/2)]-t)<0)s=i+1;else if(l>0)o=i-1;else{o=i;break}if(n[i=o]===t)return i/(a-1);let u=n[i],c=n[i+1];return(i+(t-u)/(c-u))/(a-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let i=this.getPoint(r),a=this.getPoint(n),s=t||(i.isVector2?new ey:new ex);return s.copy(a).sub(i).normalize(),s}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new ex,n=[],i=[],a=[],s=new ex,o=new tp;for(let t=0;t<=e;t++){let r=t/e;n[t]=this.getTangentAt(r,new ex)}i[0]=new ex,a[0]=new ex;let l=Number.MAX_VALUE,u=Math.abs(n[0].x),c=Math.abs(n[0].y),h=Math.abs(n[0].z);u<=l&&(l=u,r.set(1,0,0)),c<=l&&(l=c,r.set(0,1,0)),h<=l&&r.set(0,0,1),s.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],s),a[0].crossVectors(n[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),a[t]=a[t-1].clone(),s.crossVectors(n[t-1],n[t]),s.length()>Number.EPSILON){s.normalize();let e=Math.acos(ed(n[t-1].dot(n[t]),-1,1));i[t].applyMatrix4(o.makeRotationAxis(s,e))}a[t].crossVectors(n[t],i[t])}if(!0===t){let t=Math.acos(ed(i[0].dot(i[e]),-1,1));t/=e,n[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let r=1;r<=e;r++)i[r].applyMatrix4(o.makeRotationAxis(n[r],t*r)),a[r].crossVectors(n[r],i[r])}return{tangents:n,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}}class iQ extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,i=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(n=i?0:r),!0!==this.aClockwise||i||(n===r?n=-r:n-=r);let a=this.aStartAngle+e*n,s=this.aX+this.xRadius*Math.cos(a),o=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=s-this.aX,n=o-this.aY;s=r*e-n*t+this.aX,o=r*t+n*e+this.aY}return t.set(s,o)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}constructor(e=0,t=0,r=1,n=1,i=0,a=2*Math.PI,s=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=s,this.aRotation=o}}class iY extends iQ{constructor(e,t,r,n,i,a){super(e,t,r,r,n,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function iK(){let e=0,t=0,r=0,n=0;function i(i,a,s,o){e=i,t=s,r=-3*i+3*a-2*s-o,n=2*i-2*a+s+o}return{initCatmullRom:function(e,t,r,n,a){i(t,r,a*(r-e),a*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,a,s,o){let l=(t-e)/a-(r-e)/(a+s)+(r-t)/s,u=(r-t)/s-(n-t)/(s+o)+(n-r)/o;i(t,r,l*=s,u*=s)},calc:function(i){let a=i*i;return e+t*i+r*a+a*i*n}}}let iZ=new ex,iJ=new iK,i$=new iK,i0=new iK;class i1 extends iX{getPoint(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ex,i=this.points,a=i.length,s=(a-!this.closed)*e,o=Math.floor(s),l=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/a)+1)*a:0===l&&o===a-1&&(o=a-2,l=1),this.closed||o>0?t=i[(o-1)%a]:(iZ.subVectors(i[0],i[1]).add(i[0]),t=iZ);let u=i[o%a],c=i[(o+1)%a];if(this.closed||o+2<a?r=i[(o+2)%a]:(iZ.subVectors(i[a-1],i[a-2]).add(i[a-1]),r=iZ),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,n=Math.pow(t.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(c),e),a=Math.pow(c.distanceToSquared(r),e);i<1e-4&&(i=1),n<1e-4&&(n=i),a<1e-4&&(a=i),iJ.initNonuniformCatmullRom(t.x,u.x,c.x,r.x,n,i,a),i$.initNonuniformCatmullRom(t.y,u.y,c.y,r.y,n,i,a),i0.initNonuniformCatmullRom(t.z,u.z,c.z,r.z,n,i,a)}else"catmullrom"===this.curveType&&(iJ.initCatmullRom(t.x,u.x,c.x,r.x,this.tension),i$.initCatmullRom(t.y,u.y,c.y,r.y,this.tension),i0.initCatmullRom(t.z,u.z,c.z,r.z,this.tension));return n.set(iJ.calc(l),i$.calc(l),i0.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new ex().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}constructor(e=[],t=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}}function i2(e,t,r,n,i){let a=(n-t)*.5,s=(i-r)*.5,o=e*e;return e*o*(2*r-2*n+a+s)+(-3*r+3*n-2*a-s)*o+a*e+r}function i3(e,t,r,n){return function(e,t){let r=1-e;return r*r*t}(e,t)+2*(1-e)*e*r+e*e*n}function i4(e,t,r,n,i){return function(e,t){let r=1-e;return r*r*r*t}(e,t)+function(e,t){let r=1-e;return 3*r*r*e*t}(e,r)+3*(1-e)*e*e*n+e*e*e*i}class i5 extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,r=this.v0,n=this.v1,i=this.v2,a=this.v3;return t.set(i4(e,r.x,n.x,i.x,a.x),i4(e,r.y,n.y,i.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}constructor(e=new ey,t=new ey,r=new ey,n=new ey){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}}class i6 extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ex,r=this.v0,n=this.v1,i=this.v2,a=this.v3;return t.set(i4(e,r.x,n.x,i.x,a.x),i4(e,r.y,n.y,i.y,a.y),i4(e,r.z,n.z,i.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}constructor(e=new ex,t=new ex,r=new ex,n=new ex){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}}class i7 extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey;return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new ey,t=new ey){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}}class i8 extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ex;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ex;return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new ex,t=new ex){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}}class i9 extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,r=this.v0,n=this.v1,i=this.v2;return t.set(i3(e,r.x,n.x,i.x),i3(e,r.y,n.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new ey,t=new ey,r=new ey){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}}class ae extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ex,r=this.v0,n=this.v1,i=this.v2;return t.set(i3(e,r.x,n.x,i.x),i3(e,r.y,n.y,i.y),i3(e,r.z,n.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new ex,t=new ex,r=new ex){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}}class at extends iX{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,r=this.points,n=(r.length-1)*e,i=Math.floor(n),a=n-i,s=r[0===i?i:i-1],o=r[i],l=r[i>r.length-2?r.length-1:i+1],u=r[i>r.length-3?r.length-1:i+2];return t.set(i2(a,s.x,o.x,l.x,u.x),i2(a,s.y,o.y,l.y,u.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new ey().fromArray(r))}return this}constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}}var ar=Object.freeze({__proto__:null,ArcCurve:iY,CatmullRomCurve3:i1,CubicBezierCurve:i5,CubicBezierCurve3:i6,EllipseCurve:iQ,LineCurve:i7,LineCurve3:i8,QuadraticBezierCurve:i9,QuadraticBezierCurve3:ae,SplineCurve:at});class an extends iX{add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let r=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new ar[r](t,e))}return this}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),i=0;for(;i<n.length;){if(n[i]>=r){let e=n[i]-r,a=this.curves[i],s=a.getLength(),o=0===s?0:1-e/s;return a.getPointAt(o,t)}i++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)e.push(t+=this.curves[r].getLength());return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,r=[];for(let n=0,i=this.curves;n<i.length;n++){let a=i[n],s=a.isEllipseCurve?2*t:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,o=a.getPoints(s);for(let t=0;t<o.length;t++){let n=o[t];e&&e.equals(n)||(r.push(n),e=n)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(new ar[r.type]().fromJSON(r))}return this}constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}}class ai extends an{setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new i7(this.currentPoint.clone(),new ey(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let i=new i9(this.currentPoint.clone(),new ey(e,t),new ey(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,a){let s=new i5(this.currentPoint.clone(),new ey(e,t),new ey(r,n),new ey(i,a));return this.curves.push(s),this.currentPoint.set(i,a),this}splineThru(e){let t=new at([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,a){let s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,r,n,i,a),this}absarc(e,t,r,n,i,a){return this.absellipse(e,t,r,r,n,i,a),this}ellipse(e,t,r,n,i,a,s,o){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,r,n,i,a,s,o),this}absellipse(e,t,r,n,i,a,s,o){let l=new iQ(e,t,r,n,i,a,s,o);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}constructor(e){super(),this.type="Path",this.currentPoint=new ey,e&&this.setFromPoints(e)}}class aa extends ai{getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(new ai().fromJSON(r))}return this}constructor(e){super(e),this.uuid=eh(),this.type="Shape",this.holes=[]}}function as(e,t,r,n,i){let a;if(i===function(e,t,r,n){let i=0;for(let a=t,s=r-n;a<r;a+=n)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}(e,t,r,n)>0)for(let i=t;i<r;i+=n)a=av(i/n|0,e[i],e[i+1],a);else for(let i=r-n;i>=t;i-=n)a=av(i/n|0,e[i],e[i+1],a);return a&&aA(a,a.next)&&(ax(a),a=a.next),a}function ao(e,t){if(!e)return e;t||(t=e);let r=e,n;do if(n=!1,!r.steiner&&(aA(r,r.next)||0===ad(r.prev,r,r.next))){if(ax(r),(r=t=r.prev)===r.next)break;n=!0}else r=r.next;while(n||r!==t)return t}function al(e,t){let r=e.x-t.x;return 0===r&&0==(r=e.y-t.y)&&(r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function au(e,t,r,n,i){return(e=((e=((e=((e=((e=(e-r)*i|0)|e<<8)&0xff00ff)|e<<4)&0xf0f0f0f)|e<<2)&0x33333333)|e<<1)&0x55555555)|(t=((t=((t=((t=((t=(t-n)*i|0)|t<<8)&0xff00ff)|t<<4)&0xf0f0f0f)|t<<2)&0x33333333)|t<<1)&0x55555555)<<1}function ac(e,t,r,n,i,a,s,o){return(i-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(n-o)>=(r-s)*(t-o)&&(r-s)*(a-o)>=(i-s)*(n-o)}function ah(e,t,r,n,i,a,s,o){return(e!==s||t!==o)&&ac(e,t,r,n,i,a,s,o)}function ad(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function aA(e,t){return e.x===t.x&&e.y===t.y}function ap(e,t,r,n){let i=am(ad(e,t,r)),a=am(ad(e,t,n)),s=am(ad(r,n,e)),o=am(ad(r,n,t));return!!(i!==a&&s!==o||0===i&&af(e,r,t)||0===a&&af(e,n,t)||0===s&&af(r,e,n)||0===o&&af(r,t,n))}function af(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function am(e){return e>0?1:e<0?-1:0}function ag(e,t){return 0>ad(e.prev,e,e.next)?ad(e,t,e.next)>=0&&ad(e,e.prev,t)>=0:0>ad(e,t,e.prev)||0>ad(e,e.next,t)}function ay(e,t){let r=a_(e.i,e.x,e.y),n=a_(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function av(e,t,r,n){let i=a_(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ax(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function a_(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ab{static triangulate(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return function(e,t){let r,n,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,s=t&&t.length,o=s?t[0]*a:e.length,l=as(e,0,o,a,!0),u=[];if(!l||l.next===l.prev)return u;if(s&&(l=function(e,t,r,n){let i=[];for(let r=0,a=t.length;r<a;r++){let s=t[r]*n,o=r<a-1?t[r+1]*n:e.length,l=as(e,s,o,n,!1);l===l.next&&(l.steiner=!0),i.push(function(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e)return r}(l))}i.sort(al);for(let e=0;e<i.length;e++)r=function(e,t){let r=function(e,t){let r,n=t,i=e.x,a=e.y,s=-1/0;if(aA(e,n))return n;do{if(aA(e,n.next))return n.next;if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){let e=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>s&&(s=e,r=n.x<n.next.x?n:n.next,e===i))return r}n=n.next}while(n!==t)if(!r)return null;let o=r,l=r.x,u=r.y,c=1/0;n=r;do{if(i>=n.x&&n.x>=l&&i!==n.x&&ac(a<u?i:s,a,l,u,a<u?s:i,a,n.x,n.y)){var h,d;let t=Math.abs(a-n.y)/(i-n.x);ag(n,e)&&(t<c||t===c&&(n.x>r.x||n.x===r.x&&(h=r,d=n,0>ad(h.prev,h,d.prev)&&0>ad(d.next,h,h.next))))&&(r=n,c=t)}n=n.next}while(n!==o)return r}(e,t);if(!r)return t;let n=ay(r,e);return ao(n,n.next),ao(r,r.next)}(i[e],r);return r}(e,t,l,a)),e.length>80*a){r=1/0,n=1/0;let t=-1/0,s=-1/0;for(let i=a;i<o;i+=a){let a=e[i],o=e[i+1];a<r&&(r=a),o<n&&(n=o),a>t&&(t=a),o>s&&(s=o)}i=0!==(i=Math.max(t-r,s-n))?32767/i:0}return function e(t,r,n,i,a,s,o){if(!t)return;!o&&s&&function(e,t,r,n){let i=e;do 0===i.z&&(i.z=au(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e)i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r=1;do{let n,i=e;e=null;let a=null;for(t=0;i;){t++;let s=i,o=0;for(let e=0;e<r&&(o++,s=s.nextZ);e++);let l=r;for(;o>0||l>0&&s;)0!==o&&(0===l||!s||i.z<=s.z)?(n=i,i=i.nextZ,o--):(n=s,s=s.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=s}a.nextZ=null,r*=2}while(t>1)}(i)}(t,i,a,s);let l=t;for(;t.prev!==t.next;){let u=t.prev,c=t.next;if(s?function(e,t,r,n){let i=e.prev,a=e.next;if(ad(i,e,a)>=0)return!1;let s=i.x,o=e.x,l=a.x,u=i.y,c=e.y,h=a.y,d=Math.min(s,o,l),A=Math.min(u,c,h),p=Math.max(s,o,l),f=Math.max(u,c,h),m=au(d,A,t,r,n),g=au(p,f,t,r,n),y=e.prevZ,v=e.nextZ;for(;y&&y.z>=m&&v&&v.z<=g;){if(y.x>=d&&y.x<=p&&y.y>=A&&y.y<=f&&y!==i&&y!==a&&ah(s,u,o,c,l,h,y.x,y.y)&&ad(y.prev,y,y.next)>=0||(y=y.prevZ,v.x>=d&&v.x<=p&&v.y>=A&&v.y<=f&&v!==i&&v!==a&&ah(s,u,o,c,l,h,v.x,v.y)&&ad(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;y&&y.z>=m;){if(y.x>=d&&y.x<=p&&y.y>=A&&y.y<=f&&y!==i&&y!==a&&ah(s,u,o,c,l,h,y.x,y.y)&&ad(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=g;){if(v.x>=d&&v.x<=p&&v.y>=A&&v.y<=f&&v!==i&&v!==a&&ah(s,u,o,c,l,h,v.x,v.y)&&ad(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}(t,i,a,s):function(e){let t=e.prev,r=e.next;if(ad(t,e,r)>=0)return!1;let n=t.x,i=e.x,a=r.x,s=t.y,o=e.y,l=r.y,u=Math.min(n,i,a),c=Math.min(s,o,l),h=Math.max(n,i,a),d=Math.max(s,o,l),A=r.next;for(;A!==t;){if(A.x>=u&&A.x<=h&&A.y>=c&&A.y<=d&&ah(n,s,i,o,a,l,A.x,A.y)&&ad(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}(t)){r.push(u.i,t.i,c.i),ax(t),t=c.next,l=c.next;continue}if((t=c)===l){o?1===o?e(t=function(e,t){let r=e;do{let n=r.prev,i=r.next.next;!aA(n,i)&&ap(n,r,r.next,i)&&ag(n,i)&&ag(i,n)&&(t.push(n.i,r.i,i.i),ax(r),ax(r.next),r=e=i),r=r.next}while(r!==e)return ao(r)}(ao(t),r),r,n,i,a,s,2):2===o&&function(t,r,n,i,a,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){var l,u;if(o.i!==t.i&&(l=o,u=t,l.next.i!==u.i&&l.prev.i!==u.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&ap(r,r.next,e,t))return!0;r=r.next}while(r!==e)return!1}(l,u)&&(ag(l,u)&&ag(u,l)&&function(e,t){let r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e)return n}(l,u)&&(ad(l.prev,l,u.prev)||ad(l,u.prev,u))||aA(l,u)&&ad(l.prev,l,l.next)>0&&ad(u.prev,u,u.next)>0))){let l=ay(o,t);o=ao(o,o.next),l=ao(l,l.next),e(o,r,n,i,a,s,0),e(l,r,n,i,a,s,0);return}t=t.next}o=o.next}while(o!==t)}(t,r,n,i,a,s):e(ao(t),r,n,i,a,s,1);break}}}(l,u,a,r,n,i,0),u}(e,t,r)}}class aS{static area(e){let t=e.length,r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return .5*r}static isClockWise(e){return 0>aS.area(e)}static triangulateShape(e,t){let r=[],n=[],i=[];aT(e),aw(r,e);let a=e.length;t.forEach(aT);for(let e=0;e<t.length;e++)n.push(a),a+=t[e].length,aw(r,t[e]);let s=ab.triangulate(r,n);for(let e=0;e<s.length;e+=3)i.push(s.slice(e,e+3));return i}}function aT(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function aw(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}class aM extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return function(e,t,r){if(r.shapes=[],Array.isArray(e))for(let t=0,n=e.length;t<n;t++){let n=e[t];r.shapes.push(n.uuid)}else r.shapes.push(e.uuid);return r.options=Object.assign({},t),void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){let r=[];for(let n=0,i=e.shapes.length;n<i;n++){let i=t[e.shapes[n]];r.push(i)}let n=e.options.extrudePath;return void 0!==n&&(e.options.extrudePath=new ar[n.type]().fromJSON(n)),new aM(r,e.options)}constructor(e=new aa([new ey(.5,.5),new ey(-.5,.5),new ey(-.5,-.5),new ey(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],i=[];for(let a=0,s=e.length;a<s;a++)!function(e){let a,s,o,l,u,c=[],h=void 0!==t.curveSegments?t.curveSegments:12,d=void 0!==t.steps?t.steps:1,A=void 0!==t.depth?t.depth:1,p=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,m=void 0!==t.bevelSize?t.bevelSize:f-.1,g=void 0!==t.bevelOffset?t.bevelOffset:0,y=void 0!==t.bevelSegments?t.bevelSegments:3,v=t.extrudePath,x=void 0!==t.UVGenerator?t.UVGenerator:aE,_,b=!1;v&&(_=v.getSpacedPoints(d),b=!0,p=!1,a=v.computeFrenetFrames(d,!1),s=new ex,o=new ex,l=new ex),p||(y=0,f=0,m=0,g=0);let S=e.extractPoints(h),T=S.shape,w=S.holes;if(!aS.isClockWise(T)){T=T.reverse();for(let e=0,t=w.length;e<t;e++){let t=w[e];aS.isClockWise(t)&&(w[e]=t.reverse())}}function M(e){let t=1e-10*1e-10,r=e[0];for(let n=1;n<=e.length;n++){let i=n%e.length,a=e[i],s=a.x-r.x,o=a.y-r.y,l=s*s+o*o,u=Math.max(Math.abs(a.x),Math.abs(a.y),Math.abs(r.x),Math.abs(r.y));if(l<=t*u*u){e.splice(i,1),n--;continue}r=a}}M(T),w.forEach(M);let E=w.length,R=T;for(let e=0;e<E;e++){let t=w[e];T=T.concat(t)}function C(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,r)}let N=T.length;function P(e,t,r){let n,i,a,s=e.x-t.x,o=e.y-t.y,l=r.x-e.x,u=r.y-e.y,c=s*s+o*o;if(Math.abs(s*u-o*l)>Number.EPSILON){let h=Math.sqrt(c),d=Math.sqrt(l*l+u*u),A=t.x-o/h,p=t.y+s/h,f=((r.x-u/d-A)*u-(r.y+l/d-p)*l)/(s*u-o*l),m=(n=A+s*f-e.x)*n+(i=p+o*f-e.y)*i;if(m<=2)return new ey(n,i);a=Math.sqrt(m/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(u)&&(e=!0),e?(n=-o,i=s,a=Math.sqrt(c)):(n=s,i=o,a=Math.sqrt(c/2))}return new ey(n/a,i/a)}let I=[];for(let e=0,t=R.length,r=t-1,n=e+1;e<t;e++,r++,n++)r===t&&(r=0),n===t&&(n=0),I[e]=P(R[e],R[r],R[n]);let L=[],D,B=I.concat();for(let e=0;e<E;e++){let t=w[e];D=[];for(let e=0,r=t.length,n=r-1,i=e+1;e<r;e++,n++,i++)n===r&&(n=0),i===r&&(i=0),D[e]=P(t[e],t[n],t[i]);L.push(D),B=B.concat(D)}if(0===y)u=aS.triangulateShape(R,w);else{let e=[],t=[];for(let r=0;r<y;r++){let n=r/y,i=f*Math.cos(n*Math.PI/2),a=m*Math.sin(n*Math.PI/2)+g;for(let t=0,r=R.length;t<r;t++){let r=C(R[t],I[t],a);k(r.x,r.y,-i),0===n&&e.push(r)}for(let e=0;e<E;e++){let r=w[e];D=L[e];let s=[];for(let e=0,t=r.length;e<t;e++){let t=C(r[e],D[e],a);k(t.x,t.y,-i),0===n&&s.push(t)}0===n&&t.push(s)}}u=aS.triangulateShape(e,t)}let F=u.length,U=m+g;for(let e=0;e<N;e++){let t=p?C(T[e],B[e],U):T[e];b?(o.copy(a.normals[0]).multiplyScalar(t.x),s.copy(a.binormals[0]).multiplyScalar(t.y),l.copy(_[0]).add(o).add(s),k(l.x,l.y,l.z)):k(t.x,t.y,0)}for(let e=1;e<=d;e++)for(let t=0;t<N;t++){let r=p?C(T[t],B[t],U):T[t];b?(o.copy(a.normals[e]).multiplyScalar(r.x),s.copy(a.binormals[e]).multiplyScalar(r.y),l.copy(_[e]).add(o).add(s),k(l.x,l.y,l.z)):k(r.x,r.y,A/d*e)}for(let e=y-1;e>=0;e--){let t=e/y,r=f*Math.cos(t*Math.PI/2),n=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=R.length;e<t;e++){let t=C(R[e],I[e],n);k(t.x,t.y,A+r)}for(let e=0,t=w.length;e<t;e++){let t=w[e];D=L[e];for(let e=0,i=t.length;e<i;e++){let i=C(t[e],D[e],n);b?k(i.x,i.y+_[d-1].y,_[d-1].x+r):k(i.x,i.y,A+r)}}}function O(e,t){let i=e.length;for(;--i>=0;){let a=i,s=i-1;s<0&&(s=e.length-1);for(let e=0,i=d+2*y;e<i;e++){let i=N*e,o=N*(e+1);!function(e,t,i,a){V(e),V(t),V(a),V(t),V(i),V(a);let s=n.length/3,o=x.generateSideWallUV(r,n,s-6,s-3,s-2,s-1);q(o[0]),q(o[1]),q(o[3]),q(o[1]),q(o[2]),q(o[3])}(t+a+i,t+s+i,t+s+o,t+a+o)}}}function k(e,t,r){c.push(e),c.push(t),c.push(r)}function z(e,t,i){V(e),V(t),V(i);let a=n.length/3,s=x.generateTopUV(r,n,a-3,a-2,a-1);q(s[0]),q(s[1]),q(s[2])}function V(e){n.push(c[3*e+0]),n.push(c[3*e+1]),n.push(c[3*e+2])}function q(e){i.push(e.x),i.push(e.y)}(function(){let e=n.length/3;if(p){let e=0*N;for(let t=0;t<F;t++){let r=u[t];z(r[2]+e,r[1]+e,r[0]+e)}e=N*(d+2*y);for(let t=0;t<F;t++){let r=u[t];z(r[0]+e,r[1]+e,r[2]+e)}}else{for(let e=0;e<F;e++){let t=u[e];z(t[2],t[1],t[0])}for(let e=0;e<F;e++){let t=u[e];z(t[0]+N*d,t[1]+N*d,t[2]+N*d)}}r.addGroup(e,n.length/3-e,0)})(),function(){let e=n.length/3,t=0;O(R,0),t+=R.length;for(let e=0,r=w.length;e<r;e++){let r=w[e];O(r,t),t+=r.length}r.addGroup(e,n.length/3-e,1)}()}(e[a]);this.setAttribute("position",new rg(n,3)),this.setAttribute("uv",new rg(i,2)),this.computeVertexNormals()}}let aE={generateTopUV:function(e,t,r,n,i){let a=t[3*r],s=t[3*r+1],o=t[3*n],l=t[3*n+1],u=t[3*i],c=t[3*i+1];return[new ey(a,s),new ey(o,l),new ey(u,c)]},generateSideWallUV:function(e,t,r,n,i,a){let s=t[3*r],o=t[3*r+1],l=t[3*r+2],u=t[3*n],c=t[3*n+1],h=t[3*n+2],d=t[3*i],A=t[3*i+1],p=t[3*i+2],f=t[3*a],m=t[3*a+1],g=t[3*a+2];return Math.abs(o-c)<Math.abs(s-u)?[new ey(s,1-l),new ey(u,1-h),new ey(d,1-p),new ey(f,1-g)]:[new ey(o,1-l),new ey(c,1-h),new ey(A,1-p),new ey(m,1-g)]}};class aR extends iz{static fromJSON(e){return new aR(e.radius,e.detail)}constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}}class aC extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aC(e.points,e.segments,e.phiStart,e.phiLength)}constructor(e=[new ey(0,-.5),new ey(.5,0),new ey(0,.5)],t=12,r=0,n=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t),n=ed(n,0,2*Math.PI);let i=[],a=[],s=[],o=[],l=[],u=1/t,c=new ex,h=new ey,d=new ex,A=new ex,p=new ex,f=0,m=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:f=e[t+1].x-e[t].x,d.x=+(m=e[t+1].y-e[t].y),d.y=-f,d.z=0*m,p.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:f=e[t+1].x-e[t].x,d.x=+(m=e[t+1].y-e[t].y),d.y=-f,d.z=0*m,A.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),o.push(d.x,d.y,d.z),p.copy(A)}for(let i=0;i<=t;i++){let d=r+i*u*n,A=Math.sin(d),p=Math.cos(d);for(let r=0;r<=e.length-1;r++){c.x=e[r].x*A,c.y=e[r].y,c.z=e[r].x*p,a.push(c.x,c.y,c.z),h.x=i/t,h.y=r/(e.length-1),s.push(h.x,h.y);let n=o[3*r+0]*A,u=o[3*r+1],d=o[3*r+0]*p;l.push(n,u,d)}}for(let r=0;r<t;r++)for(let t=0;t<e.length-1;t++){let n=t+r*e.length,a=n+e.length,s=n+e.length+1,o=n+1;i.push(n,a,o),i.push(s,o,a)}this.setIndex(i),this.setAttribute("position",new rg(a,3)),this.setAttribute("uv",new rg(s,2)),this.setAttribute("normal",new rg(l,3))}}class aN extends iz{static fromJSON(e){return new aN(e.radius,e.detail)}constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}}class aP extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aP(e.width,e.height,e.widthSegments,e.heightSegments)}constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let i=e/2,a=t/2,s=Math.floor(r),o=Math.floor(n),l=s+1,u=o+1,c=e/s,h=t/o,d=[],A=[],p=[],f=[];for(let e=0;e<u;e++){let t=e*h-a;for(let r=0;r<l;r++){let n=r*c-i;A.push(n,-t,0),p.push(0,0,1),f.push(r/s),f.push(1-e/o)}}for(let e=0;e<o;e++)for(let t=0;t<s;t++){let r=t+l*e,n=t+l*(e+1),i=t+1+l*(e+1),a=t+1+l*e;d.push(r,n,a),d.push(n,i,a)}this.setIndex(d),this.setAttribute("position",new rg(A,3)),this.setAttribute("normal",new rg(p,3)),this.setAttribute("uv",new rg(f,2))}}class aI extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aI(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}constructor(e=.5,t=1,r=32,n=1,i=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},r=Math.max(3,r);let s=[],o=[],l=[],u=[],c=e,h=(t-e)/(n=Math.max(1,n)),d=new ex,A=new ey;for(let e=0;e<=n;e++){for(let e=0;e<=r;e++){let n=i+e/r*a;d.x=c*Math.cos(n),d.y=c*Math.sin(n),o.push(d.x,d.y,d.z),l.push(0,0,1),A.x=(d.x/t+1)/2,A.y=(d.y/t+1)/2,u.push(A.x,A.y)}c+=h}for(let e=0;e<n;e++){let t=e*(r+1);for(let e=0;e<r;e++){let n=e+t,i=n+r+1,a=n+r+2,o=n+1;s.push(n,i,o),s.push(i,a,o)}}this.setIndex(s),this.setAttribute("position",new rg(o,3)),this.setAttribute("normal",new rg(l,3)),this.setAttribute("uv",new rg(u,2))}}class aL extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,n=e.length;r<n;r++){let n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){let r=[];for(let n=0,i=e.shapes.length;n<i;n++){let i=t[e.shapes[n]];r.push(i)}return new aL(r,e.curveSegments)}constructor(e=new aa([new ey(0,.5),new ey(-.5,-.5),new ey(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],n=[],i=[],a=[],s=0,o=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(s,o,t),s+=o,o=0;function l(e){let s=n.length/3,l=e.extractPoints(t),u=l.shape,c=l.holes;!1===aS.isClockWise(u)&&(u=u.reverse());for(let e=0,t=c.length;e<t;e++){let t=c[e];!0===aS.isClockWise(t)&&(c[e]=t.reverse())}let h=aS.triangulateShape(u,c);for(let e=0,t=c.length;e<t;e++){let t=c[e];u=u.concat(t)}for(let e=0,t=u.length;e<t;e++){let t=u[e];n.push(t.x,t.y,0),i.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=h.length;e<t;e++){let t=h[e],n=t[0]+s,i=t[1]+s,a=t[2]+s;r.push(n,i,a),o+=3}}this.setIndex(r),this.setAttribute("position",new rg(n,3)),this.setAttribute("normal",new rg(i,3)),this.setAttribute("uv",new rg(a,2))}}class aD extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aD(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}constructor(e=1,t=32,r=16,n=0,i=2*Math.PI,a=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:s},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(a+s,Math.PI),l=0,u=[],c=new ex,h=new ex,d=[],A=[],p=[],f=[];for(let d=0;d<=r;d++){let m=[],g=d/r,y=0;0===d&&0===a?y=.5/t:d===r&&o===Math.PI&&(y=-.5/t);for(let r=0;r<=t;r++){let o=r/t;c.x=-e*Math.cos(n+o*i)*Math.sin(a+g*s),c.y=e*Math.cos(a+g*s),c.z=e*Math.sin(n+o*i)*Math.sin(a+g*s),A.push(c.x,c.y,c.z),h.copy(c).normalize(),p.push(h.x,h.y,h.z),f.push(o+y,1-g),m.push(l++)}u.push(m)}for(let e=0;e<r;e++)for(let n=0;n<t;n++){let t=u[e][n+1],i=u[e][n],s=u[e+1][n],l=u[e+1][n+1];(0!==e||a>0)&&d.push(t,i,l),(e!==r-1||o<Math.PI)&&d.push(i,s,l)}this.setIndex(d),this.setAttribute("position",new rg(A,3)),this.setAttribute("normal",new rg(p,3)),this.setAttribute("uv",new rg(f,2))}}class aB extends iz{static fromJSON(e){return new aB(e.radius,e.detail)}constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}}class aF extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aF(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}constructor(e=1,t=.4,r=12,n=48,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},r=Math.floor(r),n=Math.floor(n);let a=[],s=[],o=[],l=[],u=new ex,c=new ex,h=new ex;for(let a=0;a<=r;a++)for(let d=0;d<=n;d++){let A=d/n*i,p=a/r*Math.PI*2;c.x=(e+t*Math.cos(p))*Math.cos(A),c.y=(e+t*Math.cos(p))*Math.sin(A),c.z=t*Math.sin(p),s.push(c.x,c.y,c.z),u.x=e*Math.cos(A),u.y=e*Math.sin(A),h.subVectors(c,u).normalize(),o.push(h.x,h.y,h.z),l.push(d/n),l.push(a/r)}for(let e=1;e<=r;e++)for(let t=1;t<=n;t++){let r=(n+1)*e+t-1,i=(n+1)*(e-1)+t-1,s=(n+1)*(e-1)+t,o=(n+1)*e+t;a.push(r,i,o),a.push(i,s,o)}this.setIndex(a),this.setAttribute("position",new rg(s,3)),this.setAttribute("normal",new rg(o,3)),this.setAttribute("uv",new rg(l,2))}}class aU extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aU(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}constructor(e=1,t=.4,r=64,n=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a},r=Math.floor(r),n=Math.floor(n);let s=[],o=[],l=[],u=[],c=new ex,h=new ex,d=new ex,A=new ex,p=new ex,f=new ex,m=new ex;for(let s=0;s<=r;++s){let y=s/r*i*Math.PI*2;g(y,i,a,e,d),g(y+.01,i,a,e,A),f.subVectors(A,d),m.addVectors(A,d),p.crossVectors(f,m),m.crossVectors(p,f),p.normalize(),m.normalize();for(let e=0;e<=n;++e){let i=e/n*Math.PI*2,a=-t*Math.cos(i),A=t*Math.sin(i);c.x=d.x+(a*m.x+A*p.x),c.y=d.y+(a*m.y+A*p.y),c.z=d.z+(a*m.z+A*p.z),o.push(c.x,c.y,c.z),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(s/r),u.push(e/n)}}for(let e=1;e<=r;e++)for(let t=1;t<=n;t++){let r=(n+1)*(e-1)+(t-1),i=(n+1)*e+(t-1),a=(n+1)*e+t,o=(n+1)*(e-1)+t;s.push(r,i,o),s.push(i,a,o)}function g(e,t,r,n,i){let a=Math.cos(e),s=Math.sin(e),o=r/t*e,l=Math.cos(o);i.x=n*(2+l)*.5*a,i.y=n*(2+l)*s*.5,i.z=n*Math.sin(o)*.5}this.setIndex(s),this.setAttribute("position",new rg(o,3)),this.setAttribute("normal",new rg(l,3)),this.setAttribute("uv",new rg(u,2))}}class aO extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new aO(new ar[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}constructor(e=new ae(new ex(-1,-1,0),new ex(-1,1,0),new ex(1,1,0)),t=64,r=1,n=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i};let a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;let s=new ex,o=new ex,l=new ey,u=new ex,c=[],h=[],d=[],A=[];function p(i){u=e.getPointAt(i/t,u);let l=a.normals[i],d=a.binormals[i];for(let e=0;e<=n;e++){let t=e/n*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);o.x=a*l.x+i*d.x,o.y=a*l.y+i*d.y,o.z=a*l.z+i*d.z,o.normalize(),h.push(o.x,o.y,o.z),s.x=u.x+r*o.x,s.y=u.y+r*o.y,s.z=u.z+r*o.z,c.push(s.x,s.y,s.z)}}(function(){for(let e=0;e<t;e++)p(e);p(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let r=0;r<=n;r++)l.x=e/t,l.y=r/n,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=n;t++){let r=(n+1)*(e-1)+(t-1),i=(n+1)*e+(t-1),a=(n+1)*e+t,s=(n+1)*(e-1)+t;A.push(r,i,s),A.push(i,a,s)}}()})(),this.setIndex(A),this.setAttribute("position",new rg(c,3)),this.setAttribute("normal",new rg(h,3)),this.setAttribute("uv",new rg(d,2))}}class ak extends rw{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){let t=[],r=new Set,n=new ex,i=new ex;if(null!==e.index){let a=e.attributes.position,s=e.index,o=e.groups;0===o.length&&(o=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){let l=o[e],u=l.start,c=l.count;for(let e=u,o=u+c;e<o;e+=3)for(let o=0;o<3;o++){let l=s.getX(e+o),u=s.getX(e+(o+1)%3);n.fromBufferAttribute(a,l),i.fromBufferAttribute(a,u),!0===az(n,i,r)&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}}else{let a=e.attributes.position;for(let e=0,s=a.count/3;e<s;e++)for(let s=0;s<3;s++){let o=3*e+s,l=3*e+(s+1)%3;n.fromBufferAttribute(a,o),i.fromBufferAttribute(a,l),!0===az(n,i,r)&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new rg(t,3))}}}function az(e,t,r){let n="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==r.has(n)&&!0!==r.has(i)&&(r.add(n),r.add(i),!0)}var aV=Object.freeze({__proto__:null,BoxGeometry:rk,CapsuleGeometry:iF,CircleGeometry:iU,ConeGeometry:ik,CylinderGeometry:iO,DodecahedronGeometry:iV,EdgesGeometry:iW,ExtrudeGeometry:aM,IcosahedronGeometry:aR,LatheGeometry:aC,OctahedronGeometry:aN,PlaneGeometry:aP,PolyhedronGeometry:iz,RingGeometry:aI,ShapeGeometry:aL,SphereGeometry:aD,TetrahedronGeometry:aB,TorusGeometry:aF,TorusKnotGeometry:aU,TubeGeometry:aO,WireframeGeometry:ak});class aq extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new t6(0),this.transparent=!0,this.fog=!0,this.setValues(e)}}class aG extends rH{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class aH extends t9{copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new t6(0xffffff),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new t6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ey(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new tT,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}}class aj extends aH{get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ey(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ed(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new t6(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new t6(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new t6(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}}class aW extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new t6(0xffffff),this.specular=new t6(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new t6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ey(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new tT,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}}class aX extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new t6(0xffffff),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new t6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ey(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}}class aQ extends t9{copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ey(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}}class aY extends t9{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new t6(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new t6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ey(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new tT,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}}class aK extends t9{copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}}class aZ extends t9{copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}}class aJ extends t9{copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new t6(0xffffff),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ey(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}}class a$ extends ia{copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}}function a0(e,t){return e&&e.constructor!==t?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function a1(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function a2(e){let t=e.length,r=Array(t);for(let e=0;e!==t;++e)r[e]=e;return r.sort(function(t,r){return e[t]-e[r]}),r}function a3(e,t,r){let n=e.length,i=new e.constructor(n);for(let a=0,s=0;s!==n;++a){let n=r[a]*t;for(let r=0;r!==t;++r)i[s++]=e[n+r]}return i}function a4(e,t,r,n){let i=1,a=e[0];for(;void 0!==a&&void 0===a[n];)a=e[i++];if(void 0===a)return;let s=a[n];if(void 0!==s)if(Array.isArray(s))do void 0!==(s=a[n])&&(t.push(a.time),r.push(...s)),a=e[i++];while(void 0!==a)else if(void 0!==s.toArray)do void 0!==(s=a[n])&&(t.push(a.time),s.toArray(r,r.length)),a=e[i++];while(void 0!==a)else do void 0!==(s=a[n])&&(t.push(a.time),r.push(s)),a=e[i++];while(void 0!==a)}class a5{static convertArray(e,t){return a0(e,t)}static isTypedArray(e){return a1(e)}static getKeyframeOrder(e){return a2(e)}static sortedArray(e,t,r){return a3(e,t,r)}static flattenJSON(e,t,r,n){a4(e,t,r,n)}static subclip(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;return function(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=e.clone();a.name=t;let s=[];for(let e=0;e<a.tracks.length;++e){let t=a.tracks[e],o=t.getValueSize(),l=[],u=[];for(let e=0;e<t.times.length;++e){let a=t.times[e]*i;if(!(a<r)&&!(a>=n)){l.push(t.times[e]);for(let r=0;r<o;++r)u.push(t.values[e*o+r])}}0!==l.length&&(t.times=a0(l,t.times.constructor),t.values=a0(u,t.values.constructor),s.push(t))}a.tracks=s;let o=1/0;for(let e=0;e<a.tracks.length;++e)o>a.tracks[e].times[0]&&(o=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*o);return a.resetDuration(),a}(e,t,r,n,i)}static makeClipAdditive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;n<=0&&(n=30);let i=r.tracks.length,a=t/n;for(let t=0;t<i;++t){let n,i=r.tracks[t],s=i.ValueTypeName;if("bool"===s||"string"===s)continue;let o=e.tracks.find(function(e){return e.name===i.name&&e.ValueTypeName===s});if(void 0===o)continue;let l=0,u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=u/3);let c=0,h=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=h/3);let d=i.times.length-1;if(a<=i.times[0]){let e=l,t=u-l;n=i.values.slice(e,t)}else if(a>=i.times[d]){let e=d*u+l,t=e+u-l;n=i.values.slice(e,t)}else{let e=i.createInterpolant(),t=l,r=u-l;e.evaluate(a),n=e.resultBuffer.slice(t,r)}"quaternion"===s&&new ev().fromArray(n).normalize().conjugate().toArray(n);let A=o.times.length;for(let e=0;e<A;++e){let t=e*h+c;if("quaternion"===s)ev.multiplyQuaternionsFlat(o.values,t,n,0,o.values,t);else{let e=h-2*c;for(let r=0;r<e;++r)o.values[t+r]-=n[r]}}}return e.blendMode=2501,e}(e,t,r,n)}}class a6{evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];r:{n:{let a;i:{a:if(!(e<n)){for(let a=r+2;;){if(void 0===n){if(e<i)break a;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(i=n,e<(n=t[++r]))break n}a=t.length;break i}if(!(e>=i)){let s=t[1];e<s&&(r=2,i=s);for(let a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(r===a)break;if(n=i,e>=(i=t[--r-1]))break n}a=r,r=0;break i}break r}for(;r<a;){let n=r+a>>>1;e<t[n]?a=n:r=n+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let e=0;e!==n;++e)t[e]=r[i+e];return t}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}}class a7 extends a6{intervalChanged_(e,t,r){let n=this.parameterPositions,i=e-2,a=e+1,s=n[i],o=n[a];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:i=e,s=2*t-r;break;case 2402:i=n.length-2,s=t+n[i]-n[i+1];break;default:i=e,s=r}if(void 0===o)switch(this.getSettings_().endingEnd){case 2401:a=e,o=2*r-t;break;case 2402:a=1,o=r+n[1]-n[0];break;default:a=e-1,o=t}let l=(r-t)*.5,u=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-r),this._offsetPrev=i*u,this._offsetNext=a*u}interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,A=(r-t)/(n-t),p=A*A,f=p*A,m=-h*f+2*h*p-h*A,g=(1+h)*f+(-1.5-2*h)*p+(-.5+h)*A+1,y=(-1-d)*f+(1.5+d)*p+.5*A,v=d*f-d*p;for(let e=0;e!==s;++e)i[e]=m*a[u+e]+g*a[l+e]+y*a[o+e]+v*a[c+e];return i}constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}}class a8 extends a6{interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,u=(r-t)/(n-t),c=1-u;for(let e=0;e!==s;++e)i[e]=a[l+e]*c+a[o+e]*u;return i}constructor(e,t,r,n){super(e,t,r,n)}}class a9 extends a6{interpolate_(e){return this.copySampleValue_(e-1)}constructor(e,t,r,n){super(e,t,r,n)}}class se{static toJSON(e){let t,r=e.constructor;if(r.toJSON!==this.toJSON)t=r.toJSON(e);else{t={name:e.name,times:a0(e.times,Array),values:a0(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new a9(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new a8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new a7(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,i=0,a=n-1;for(;i!==n&&r[i]<e;)++i;for(;-1!==a&&r[a]>t;)--a;if(++a,0!==i||a!==n){i>=a&&(i=(a=Math.max(a,1))-1);let e=this.getValueSize();this.times=r.slice(i,a),this.values=this.values.slice(i*e,a*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==i;t++){let n=r[t];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,n),e=!1;break}if(null!==a&&a>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,n,a),e=!1;break}a=n}if(void 0!==n&&a1(n))for(let t=0,r=n.length;t!==r;++t){let r=n[t];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,r),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),n=2302===this.getInterpolation(),i=e.length-1,a=1;for(let s=1;s<i;++s){let i=!1,o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0]))if(n)i=!0;else{let e=s*r,n=e-r,a=e+r;for(let s=0;s!==r;++s){let r=t[e+s];if(r!==t[n+s]||r!==t[a+s]){i=!0;break}}}if(i){if(s!==a){e[a]=e[s];let n=s*r,i=a*r;for(let e=0;e!==r;++e)t[i+e]=t[n+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*r,n=a*r,s=0;s!==r;++s)t[n+s]=t[e+s];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*r)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),r=new this.constructor(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}constructor(e,t,r,n){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=a0(t,this.TimeBufferType),this.values=a0(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}}se.prototype.ValueTypeName="",se.prototype.TimeBufferType=Float32Array,se.prototype.ValueBufferType=Float32Array,se.prototype.DefaultInterpolation=2301;class st extends se{constructor(e,t,r){super(e,t,r)}}st.prototype.ValueTypeName="bool",st.prototype.ValueBufferType=Array,st.prototype.DefaultInterpolation=2300,st.prototype.InterpolantFactoryMethodLinear=void 0,st.prototype.InterpolantFactoryMethodSmooth=void 0;class sr extends se{constructor(e,t,r,n){super(e,t,r,n)}}sr.prototype.ValueTypeName="color";class sn extends se{constructor(e,t,r,n){super(e,t,r,n)}}sn.prototype.ValueTypeName="number";class si extends a6{interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(r-t)/(n-t),l=e*s;for(let e=l+s;l!==e;l+=4)ev.slerpFlat(i,0,a,l-s,a,l,o);return i}constructor(e,t,r,n){super(e,t,r,n)}}class sa extends se{InterpolantFactoryMethodLinear(e){return new si(this.times,this.values,this.getValueSize(),e)}constructor(e,t,r,n){super(e,t,r,n)}}sa.prototype.ValueTypeName="quaternion",sa.prototype.InterpolantFactoryMethodSmooth=void 0;class ss extends se{constructor(e,t,r){super(e,t,r)}}ss.prototype.ValueTypeName="string",ss.prototype.ValueBufferType=Array,ss.prototype.DefaultInterpolation=2300,ss.prototype.InterpolantFactoryMethodLinear=void 0,ss.prototype.InterpolantFactoryMethodSmooth=void 0;class so extends se{constructor(e,t,r,n){super(e,t,r,n)}}so.prototype.ValueTypeName="vector";class sl{static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,i=r.length;e!==i;++e)t.push((function(e){if(void 0===e.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return sn;case"vector":case"vector2":case"vector3":case"vector4":return so;case"color":return sr;case"quaternion":return sa;case"bool":case"boolean":return st;case"string":return ss}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],r=[];a4(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)})(r[e]).scale(n));let i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i.userData=JSON.parse(e.userData||"{}"),i}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let e=0,n=r.length;e!==n;++e)t.push(se.toJSON(r[e]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let i=t.length,a=[];for(let e=0;e<i;e++){let s=[],o=[];s.push((e+i-1)%i,e,(e+1)%i),o.push(0,1,0);let l=a2(s);s=a3(s,1,l),o=a3(o,1,l),n||0!==s[0]||(s.push(i),o.push(o[0])),a.push(new sn(".morphTargetInfluences["+t[e].name+"]",s,o).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations);for(let e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,r=e.length;t<r;t++){let r=e[t],a=r.name.match(i);if(a&&a.length>1){let e=a[1],t=n[e];t||(n[e]=t=[]),t.push(r)}}let a=[];for(let e in n)a.push(this.CreateFromMorphTargetSequence(e,n[e],t,r));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(e,t,r,n,i){if(0!==r.length){let a=[],s=[];a4(r,a,s,n),0!==a.length&&i.push(new e(t,a,s))}},n=[],i=e.name||"default",a=e.fps||30,s=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let e=0;e<l.length;e++){let i=l[e].keys;if(i&&0!==i.length)if(i[0].morphTargets){let e,t={};for(e=0;e<i.length;e++)if(i[e].morphTargets)for(let r=0;r<i[e].morphTargets.length;r++)t[i[e].morphTargets[r]]=-1;for(let r in t){let t=[],a=[];for(let n=0;n!==i[e].morphTargets.length;++n){let n=i[e];t.push(n.time),a.push(+(n.morphTarget===r))}n.push(new sn(".morphTargetInfluence["+r+"]",t,a))}o=t.length*a}else{let a=".bones["+t[e].name+"]";r(so,a+".position",i,"pos",n),r(sa,a+".quaternion",i,"rot",n),r(so,a+".scale",i,"scl",n)}}return 0===n.length?null:new this(i,o,n,s)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let e=this.tracks[r];t=Math.max(t,e.times[e.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());let t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}constructor(e="",t=-1,r=[],n=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=eh(),this.userData={},this.duration<0&&this.resetDuration()}}let su={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class sc{constructor(e,t,r){let n,i=this,a=!1,s=0,o=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.abortController=new AbortController,this.itemStart=function(e){o++,!1===a&&void 0!==i.onStart&&i.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==i.onProgress&&i.onProgress(e,s,o),s===o&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return -1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){let r=l[t],n=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}let sh=new sc;class sd{load(){}loadAsync(e,t){let r=this;return new Promise(function(n,i){r.load(e,n,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}constructor(e){this.manager=void 0!==e?e:sh,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}}sd.DEFAULT_MATERIAL_NAME="__DEFAULT";let sA={};class sp extends Error{constructor(e,t){super(e),this.response=t}}class sf extends sd{load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=su.get("file:".concat(e));if(void 0!==i)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(void 0!==sA[e])return void sA[e].push({onLoad:t,onProgress:r,onError:n});sA[e]=[],sA[e].push({onLoad:t,onProgress:r,onError:n});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),s=this.mimeType,o=this.responseType;fetch(a).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;let r=sA[e],n=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),a=i?parseInt(i):0,s=0!==a,o=0;return new Response(new ReadableStream({start(e){!function t(){n.read().then(n=>{let{done:i,value:l}=n;if(i)e.close();else{let n=new ProgressEvent("progress",{lengthComputable:s,loaded:o+=l.byteLength,total:a});for(let e=0,t=r.length;e<t;e++){let t=r[e];t.onProgress&&t.onProgress(n)}e.enqueue(l),t()}},t=>{e.error(t)})}()}}))}throw new sp('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>new DOMParser().parseFromString(e,s));case"json":return e.json();default:if(""===s)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(s),r=new TextDecoder(t&&t[1]?t[1].toLowerCase():void 0);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{su.add("file:".concat(e),t);let r=sA[e];delete sA[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onLoad&&n.onLoad(t)}}).catch(t=>{let r=sA[e];if(void 0===r)throw this.manager.itemError(e),t;delete sA[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onError&&n.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}}class sm extends sd{load(e,t,r,n){let i=this,a=new sf(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=[];for(let r=0;r<e.length;r++){let n=sl.parse(e[r]);t.push(n)}return t}constructor(e){super(e)}}class sg extends sd{load(e,t,r,n){let i=this,a=[],s=new iN,o=new sf(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials);let l=0;if(Array.isArray(e))for(let u=0,c=e.length;u<c;++u)!function(u){o.load(e[u],function(e){let r=i.parse(e,!0);a[u]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(l+=1)&&(1===r.mipmapCount&&(s.minFilter=1006),s.image=a,s.format=r.format,s.needsUpdate=!0,t&&t(s))},r,n)}(u);else o.load(e,function(e){let r=i.parse(e,!0);if(r.isCubemap){let e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)a[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),a[t].format=r.format,a[t].width=r.width,a[t].height=r.height}s.image=a}else s.image.width=r.width,s.image.height=r.height,s.mipmaps=r.mipmaps;1===r.mipmapCount&&(s.minFilter=1006),s.format=r.format,s.needsUpdate=!0,t&&t(s)},r,n);return s}constructor(e){super(e)}}let sy=new WeakMap;class sv extends sd{load(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=su.get("image:".concat(e));if(void 0!==a){if(!0===a.complete)i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0);else{let e=sy.get(a);void 0===e&&(e=[],sy.set(a,e)),e.push({onLoad:t,onError:n})}return a}let s=eR("img");function o(){u(),t&&t(this);let r=sy.get(this)||[];for(let e=0;e<r.length;e++){let t=r[e];t.onLoad&&t.onLoad(this)}sy.delete(this),i.manager.itemEnd(e)}function l(t){u(),n&&n(t),su.remove("image:".concat(e));let r=sy.get(this)||[];for(let e=0;e<r.length;e++){let n=r[e];n.onError&&n.onError(t)}sy.delete(this),i.manager.itemError(e),i.manager.itemEnd(e)}function u(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),su.add("image:".concat(e),s),i.manager.itemStart(e),s.src=e,s}constructor(e){super(e)}}class sx extends sd{load(e,t,r,n){let i=new rZ;i.colorSpace=J;let a=new sv(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let s=0;for(let r=0;r<e.length;++r)!function(r){a.load(e[r],function(e){i.images[r]=e,6==++s&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}(r);return i}constructor(e){super(e)}}class s_ extends sd{load(e,t,r,n){let i=this,a=new nE,s=new sf(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,function(e){let r;try{r=i.parse(e)}catch(e){if(void 0===n)return void console.error(e);n(e)}void 0!==r.image?a.image=r.image:void 0!==r.data&&(a.image.width=r.width,a.image.height=r.height,a.image.data=r.data),a.wrapS=void 0!==r.wrapS?r.wrapS:1001,a.wrapT=void 0!==r.wrapT?r.wrapT:1001,a.magFilter=void 0!==r.magFilter?r.magFilter:1006,a.minFilter=void 0!==r.minFilter?r.minFilter:1006,a.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.colorSpace&&(a.colorSpace=r.colorSpace),void 0!==r.flipY&&(a.flipY=r.flipY),void 0!==r.format&&(a.format=r.format),void 0!==r.type&&(a.type=r.type),void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps,a.minFilter=1008),1===r.mipmapCount&&(a.minFilter=1006),void 0!==r.generateMipmaps&&(a.generateMipmaps=r.generateMipmaps),a.needsUpdate=!0,t&&t(a,r)},r,n),a}constructor(e){super(e)}}class sb extends sd{load(e,t,r,n){let i=new eG,a=new sv(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i}constructor(e){super(e)}}class sS extends tV{dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new t6(e),this.intensity=t}}class sT extends sS{copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(tV.DEFAULT_UP),this.updateMatrix(),this.groundColor=new t6(t)}}let sw=new tp,sM=new ex,sE=new ex;class sR{getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;sM.setFromMatrixPosition(e.matrixWorld),t.position.copy(sM),sE.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(sE),t.updateMatrixWorld(),sw.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sw,t.coordinateSystem,t.reversedDepth),t.reversedDepth?r.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(sw)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ey(512,512),this.mapType=1009,this.map=null,this.mapPass=null,this.matrix=new tp,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new nX,this._frameExtents=new ey(1,1),this._viewportCount=1,this._viewports=[new eH(0,0,1,1)]}}class sC extends sR{updateMatrices(e){let t=this.camera,r=2*ec*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}constructor(){super(new rY(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}}class sN extends sS{get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}constructor(e,t,r=0,n=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(tV.DEFAULT_UP),this.updateMatrix(),this.target=new tV,this.distance=r,this.angle=n,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new sC}}let sP=new tp,sI=new ex,sL=new ex;class sD extends sR{updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),sI.setFromMatrixPosition(e.matrixWorld),r.position.copy(sI),sL.copy(r.position),sL.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(sL),r.updateMatrixWorld(),n.makeTranslation(-sI.x,-sI.y,-sI.z),sP.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sP,r.coordinateSystem,r.reversedDepth)}constructor(){super(new rY(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ey(4,2),this._viewportCount=6,this._viewports=[new eH(2,1,1,1),new eH(0,1,1,1),new eH(3,1,1,1),new eH(1,1,1,1),new eH(3,0,1,1),new eH(1,0,1,1)],this._cubeDirections=[new ex(1,0,0),new ex(-1,0,0),new ex(0,0,1),new ex(0,0,-1),new ex(0,1,0),new ex(0,-1,0)],this._cubeUps=[new ex(0,1,0),new ex(0,1,0),new ex(0,1,0),new ex(0,1,0),new ex(0,0,1),new ex(0,0,-1)]}}class sB extends sS{get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}constructor(e,t,r=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new sD}}class sF extends rj{copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,a=r+e,s=n+t,o=n-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,s,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}constructor(e=-1,t=1,r=1,n=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=a,this.updateProjectionMatrix()}}class sU extends sR{constructor(){super(new sF(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class sO extends sS{dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(tV.DEFAULT_UP),this.updateMatrix(),this.target=new tV,this.shadow=new sU}}class sk extends sS{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class sz extends sS{get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}constructor(e,t,r=10,n=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=n}}class sV{set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*n),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],r*n*1.092548),t.addScaledVector(a[5],n*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],r*i*1.092548),t.addScaledVector(a[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){let r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*n),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*r),t.addScaledVector(a[4],.858086*r*n),t.addScaledVector(a[5],.858086*n*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*r*i),t.addScaledVector(a[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+3*n);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+3*n);return e}static getBasisAt(e,t){let r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ex)}}class sq extends sS{copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}constructor(e=new sV,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}}class sG extends sd{load(e,t,r,n){let i=this,a=new sf(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}let n=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&void 0!==n.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.sheen&&(n.sheen=e.sheen),void 0!==e.sheenColor&&(n.sheenColor=new t6().setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(n.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==n.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==n.specular&&n.specular.setHex(e.specular),void 0!==e.specularIntensity&&(n.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==n.specularColor&&n.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearcoat&&(n.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(n.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(n.dispersion=e.dispersion),void 0!==e.iridescence&&(n.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(n.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(n.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(n.transmission=e.transmission),void 0!==e.thickness&&(n.thickness=e.thickness),void 0!==e.attenuationDistance&&(n.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==n.attenuationColor&&n.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(n.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(n.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.shadowSide&&(n.shadowSide=e.shadowSide),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(n.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(n.depthFunc=e.depthFunc),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(n.blendSrc=e.blendSrc),void 0!==e.blendDst&&(n.blendDst=e.blendDst),void 0!==e.blendEquation&&(n.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(n.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(n.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(n.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==n.blendColor&&n.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(n.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(n.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(n.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(n.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(n.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(n.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(n.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(n.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(n.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),void 0!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.alphaToCoverage&&(n.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(n.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(n.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.toneMapped&&(n.toneMapped=e.toneMapped),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),void 0!==e.uniforms)for(let t in e.uniforms){let i=e.uniforms[t];switch(n.uniforms[t]={},i.type){case"t":n.uniforms[t].value=r(i.value);break;case"c":n.uniforms[t].value=new t6().setHex(i.value);break;case"v2":n.uniforms[t].value=new ey().fromArray(i.value);break;case"v3":n.uniforms[t].value=new ex().fromArray(i.value);break;case"v4":n.uniforms[t].value=new eH().fromArray(i.value);break;case"m3":n.uniforms[t].value=new eS().fromArray(i.value);break;case"m4":n.uniforms[t].value=new tp().fromArray(i.value);break;default:n.uniforms[t].value=i.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(n.glslVersion=e.glslVersion),void 0!==e.extensions)for(let t in e.extensions)n.extensions[t]=e.extensions[t];if(void 0!==e.lights&&(n.lights=e.lights),void 0!==e.clipping&&(n.clipping=e.clipping),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.matcap&&(n.matcap=r(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),n.normalScale=new ey().fromArray(t)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.specularIntensityMap&&(n.specularIntensityMap=r(e.specularIntensityMap)),void 0!==e.specularColorMap&&(n.specularColorMap=r(e.specularColorMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.envMapRotation&&n.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(n.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(n.clearcoatNormalScale=new ey().fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(n.iridescenceMap=r(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(n.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(n.transmissionMap=r(e.transmissionMap)),void 0!==e.thicknessMap&&(n.thicknessMap=r(e.thicknessMap)),void 0!==e.anisotropyMap&&(n.anisotropyMap=r(e.anisotropyMap)),void 0!==e.sheenColorMap&&(n.sheenColorMap=r(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(n.sheenRoughnessMap=r(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return sG.createMaterialFromType(e)}static createMaterialFromType(e){return new({ShadowMaterial:aq,SpriteMaterial:r8,RawShaderMaterial:aG,ShaderMaterial:rH,PointsMaterial:ix,MeshPhysicalMaterial:aj,MeshStandardMaterial:aH,MeshPhongMaterial:aW,MeshToonMaterial:aX,MeshNormalMaterial:aQ,MeshLambertMaterial:aY,MeshDepthMaterial:aK,MeshDistanceMaterial:aZ,MeshBasicMaterial:re,MeshMatcapMaterial:aJ,LineDashedMaterial:a$,LineBasicMaterial:ia,Material:t9})[e]}constructor(e){super(e),this.textures={}}}class sH{static extractUrlBase(e){let t=e.lastIndexOf("/");return -1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e))?e:t+e}}class sj extends rw{copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}}class sW extends sd{load(e,t,r,n){let i=this,a=new sf(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t={},r={};function n(e,n){if(void 0!==t[n])return t[n];let i=e.interleavedBuffers[n],a=function(e,t){if(void 0!==r[t])return r[t];let n=new Uint32Array(e.arrayBuffers[t]).buffer;return r[t]=n,n}(e,i.buffer),s=new r5(eE(i.type,a),i.stride);return s.uuid=i.uuid,t[n]=s,s}let i=e.isInstancedBufferGeometry?new sj:new rw,a=e.data.index;if(void 0!==a){let e=eE(a.type,a.array);i.setIndex(new rl(e,1))}let s=e.data.attributes;for(let t in s){let r,a=s[t];if(a.isInterleavedBufferAttribute)r=new r7(n(e.data,a.data),a.itemSize,a.offset,a.normalized);else{let e=eE(a.type,a.array);r=new(a.isInstancedBufferAttribute?nP:rl)(e,a.itemSize,a.normalized)}void 0!==a.name&&(r.name=a.name),void 0!==a.usage&&r.setUsage(a.usage),i.setAttribute(t,r)}let o=e.data.morphAttributes;if(o)for(let t in o){let r=o[t],a=[];for(let t=0,i=r.length;t<i;t++){let i,s=r[t];i=s.isInterleavedBufferAttribute?new r7(n(e.data,s.data),s.itemSize,s.offset,s.normalized):new rl(eE(s.type,s.array),s.itemSize,s.normalized),void 0!==s.name&&(i.name=s.name),a.push(i)}i.morphAttributes[t]=a}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);let l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){let t=l[e];i.addGroup(t.start,t.count,t.materialIndex)}let u=e.data.boundingSphere;return void 0!==u&&(i.boundingSphere=new ta().fromJSON(u)),e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}constructor(e){super(e)}}class sX extends sd{load(e,t,r,n){let i=this,a=""===this.path?sH.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;let s=new sf(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(r){let a=null;try{a=JSON.parse(r)}catch(t){void 0!==n&&n(t),console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message);return}let s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase()){void 0!==n&&n(Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}i.parse(a,t)},r,n)}async loadAsync(e,t){let r=""===this.path?sH.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;let n=new sf(this.manager);n.setPath(this.path),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials);let i=JSON.parse(await n.loadAsync(e,t)),a=i.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(i)}parse(e,t){let r=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),a=this.parseImages(e.images,function(){void 0!==t&&t(l)}),s=this.parseTextures(e.textures,a),o=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,i,o,s,r),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),this.bindLightTargets(l),void 0!==t){let e=!1;for(let t in a)if(a[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){let t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,a),o=this.parseObject(e.object,n,s,a,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),this.bindLightTargets(o),o}parseShapes(e){let t={};if(void 0!==e)for(let r=0,n=e.length;r<n;r++){let n=new aa().fromJSON(e[r]);t[n.uuid]=n}return t}parseSkeletons(e,t){let r={},n={};if(t.traverse(function(e){e.isBone&&(n[e.uuid]=e)}),void 0!==e)for(let t=0,i=e.length;t<i;t++){let i=new nN().fromJSON(e[t],n);r[i.uuid]=i}return r}parseGeometries(e,t){let r={};if(void 0!==e){let n=new sW;for(let i=0,a=e.length;i<a;i++){let a,s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":a=n.parse(s);break;default:s.type in aV?a=aV[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.userData&&(a.userData=s.userData),r[s.uuid]=a}}return r}parseMaterials(e,t){let r={},n={};if(void 0!==e){let i=new sG;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){let a=e[t];void 0===r[a.uuid]&&(r[a.uuid]=i.parse(a)),n[a.uuid]=r[a.uuid]}}return n}parseAnimations(e){let t={};if(void 0!==e)for(let r=0;r<e.length;r++){let n=e[r],i=sl.parse(n);t[i.uuid]=i}return t}parseImages(e,t){let r,n=this,i={};function a(e){if("string"==typeof e){var t;return t=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e,n.manager.itemStart(t),r.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t),n.manager.itemEnd(t)})}return e.data?{data:eE(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){(r=new sv(new sc(t))).setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){let r=e[t],n=r.url;if(Array.isArray(n)){let e=[];for(let t=0,r=n.length;t<r;t++){let r=a(n[t]);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new nE(r.data,r.width,r.height)))}i[r.uuid]=new ek(e)}else{let e=a(r.url);i[r.uuid]=new ek(e)}}}return i}async parseImagesAsync(e){let t,r=this,n={};async function i(e){if("string"==typeof e){let n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:r.resourcePath+e;return await t.loadAsync(n)}return e.data?{data:eE(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){(t=new sv(this.manager)).setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){let r=e[t],a=r.url;if(Array.isArray(a)){let e=[];for(let t=0,r=a.length;t<r;t++){let r=a[t],n=await i(r);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new nE(n.data,n.width,n.height)))}n[r.uuid]=new ek(e)}else{let e=await i(r.url);n[r.uuid]=new ek(e)}}}return n}parseTextures(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}let n={};if(void 0!==e)for(let i=0,a=e.length;i<a;i++){let a,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);let o=t[s.image],l=o.data;Array.isArray(l)?(a=new rZ,6===l.length&&(a.needsUpdate=!0)):(a=l&&l.data?new nE:new eG,l&&(a.needsUpdate=!0)),a.source=o,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=r(s.mapping,sQ)),void 0!==s.channel&&(a.channel=s.channel),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=r(s.wrap[0],sY),a.wrapT=r(s.wrap[1],sY)),void 0!==s.format&&(a.format=s.format),void 0!==s.internalFormat&&(a.internalFormat=s.internalFormat),void 0!==s.type&&(a.type=s.type),void 0!==s.colorSpace&&(a.colorSpace=s.colorSpace),void 0!==s.minFilter&&(a.minFilter=r(s.minFilter,sK)),void 0!==s.magFilter&&(a.magFilter=r(s.magFilter,sK)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.generateMipmaps&&(a.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(a.compareFunction=s.compareFunction),void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n}parseObject(e,t,r,n,i){let a,s,o;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){let t=[];for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===r[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(r[i])}return t}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}function c(e){return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),n[e]}switch(e.type){case"Scene":a=new r4,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new t6(e.background):a.background=c(e.background)),void 0!==e.environment&&(a.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new r3(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new r2(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&a.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(a.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new rY(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new sF(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new sk(e.color,e.intensity);break;case"DirectionalLight":(a=new sO(e.color,e.intensity)).target=e.target||"";break;case"PointLight":a=new sB(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new sz(e.color,e.intensity,e.width,e.height);break;case"SpotLight":(a=new sN(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay)).target=e.target||"";break;case"HemisphereLight":a=new sT(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new sq().fromJSON(e);break;case"SkinnedMesh":a=new nw(s=l(e.geometry),o=u(e.material)),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":a=new rU(s=l(e.geometry),o=u(e.material));break;case"InstancedMesh":s=l(e.geometry),o=u(e.material);let h=e.count,d=e.instanceMatrix,A=e.instanceColor;(a=new nk(s,o,h)).instanceMatrix=new nP(new Float32Array(d.array),16),void 0!==A&&(a.instanceColor=new nP(new Float32Array(A.array),A.itemSize));break;case"BatchedMesh":s=l(e.geometry),o=u(e.material),(a=new ii(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,o)).geometry=s,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(e=>{let t=null,r=null;return void 0!==e.boundingBox&&(t=new eZ().fromJSON(e.boundingBox)),void 0!==e.boundingSphere&&(r=new ta().fromJSON(e.boundingSphere)),{...e,boundingBox:t,boundingSphere:r}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=c(e.matricesTexture.uuid),a._indirectTexture=c(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(a._colorsTexture=c(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(a.boundingSphere=new ta().fromJSON(e.boundingSphere)),void 0!==e.boundingBox&&(a.boundingBox=new eZ().fromJSON(e.boundingBox));break;case"LOD":a=new nf;break;case"Line":a=new iA(l(e.geometry),u(e.material));break;case"LineLoop":a=new iv(l(e.geometry),u(e.material));break;case"LineSegments":a=new iy(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":a=new iw(l(e.geometry),u(e.material));break;case"Sprite":a=new nh(u(e.material));break;case"Group":a=new r$;break;case"Bone":a=new nM;break;default:a=new tV}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(a.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children){let s=e.children;for(let e=0;e<s.length;e++)a.add(this.parseObject(s[e],t,r,n,i))}if(void 0!==e.animations){let t=e.animations;for(let e=0;e<t.length;e++){let r=t[e];a.animations.push(i[r])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);let t=e.levels;for(let e=0;e<t.length;e++){let r=t[e],n=a.getObjectByProperty("uuid",r.object);void 0!==n&&a.addLevel(n,r.distance,r.hysteresis)}}return a}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){let r=t[e.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(r,e.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){let r=t.target,n=e.getObjectByProperty("uuid",r);void 0!==n?t.target=n:t.target=new tV}})}constructor(e){super(e)}}let sQ={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306},sY={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},sK={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008},sZ=new WeakMap;class sJ extends sd{setOptions(e){return this.options=e,this}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=su.get("image-bitmap:".concat(e));if(void 0!==a)return(i.manager.itemStart(e),a.then)?void a.then(r=>{if(!0!==sZ.has(a))return t&&t(r),i.manager.itemEnd(e),r;n&&n(sZ.get(a)),i.manager.itemError(e),i.manager.itemEnd(e)}):(setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a);let s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,s.signal="function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;let o=fetch(e,s).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(r){return su.add("image-bitmap:".concat(e),r),t&&t(r),i.manager.itemEnd(e),r}).catch(function(t){n&&n(t),sZ.set(o,t),su.remove("image-bitmap:".concat(e)),i.manager.itemError(e),i.manager.itemEnd(e)});su.add("image-bitmap:".concat(e),o),i.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}}class s${static getContext(){return void 0===n&&(n=new(window.AudioContext||window.webkitAudioContext)),n}static setContext(e){n=e}}class s0 extends sd{load(e,t,r,n){let i=this,a=new sf(this.manager);function s(t){n?n(t):console.error(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(e){try{let r=e.slice(0);s$.getContext().decodeAudioData(r,function(e){t(e)}).catch(s)}catch(e){s(e)}},r,n)}constructor(e){super(e)}}let s1=new tp,s2=new tp,s3=new tp;class s4{update(e){let t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){let r,n;t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,s3.copy(e.projectionMatrix);let i=t.eyeSep/2,a=i*t.near/t.focus,s=t.near*Math.tan(eu*t.fov*.5)/t.zoom;s2.elements[12]=-i,s1.elements[12]=i,r=-s*t.aspect+a,n=s*t.aspect+a,s3.elements[0]=2*t.near/(n-r),s3.elements[8]=(n+r)/(n-r),this.cameraL.projectionMatrix.copy(s3),r=-s*t.aspect-a,n=s*t.aspect-a,s3.elements[0]=2*t.near/(n-r),s3.elements[8]=(n+r)/(n-r),this.cameraR.projectionMatrix.copy(s3)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(s2),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(s1)}constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new rY,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new rY,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}}class s5 extends rY{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class s6{start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}}let s7=new ex,s8=new ev,s9=new ex,oe=new ex,ot=new ex;class or extends tV{getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(s7,s8,s9),oe.set(0,0,-1).applyQuaternion(s8),ot.set(0,1,0).applyQuaternion(s8),t.positionX){let e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(s7.x,e),t.positionY.linearRampToValueAtTime(s7.y,e),t.positionZ.linearRampToValueAtTime(s7.z,e),t.forwardX.linearRampToValueAtTime(oe.x,e),t.forwardY.linearRampToValueAtTime(oe.y,e),t.forwardZ.linearRampToValueAtTime(oe.z,e),t.upX.linearRampToValueAtTime(ot.x,e),t.upY.linearRampToValueAtTime(ot.y,e),t.upZ.linearRampToValueAtTime(ot.z,e)}else t.setPosition(s7.x,s7.y,s7.z),t.setOrientation(oe.x,oe.y,oe.z,ot.x,ot.y,ot.z)}constructor(){super(),this.type="AudioListener",this.context=s$.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new s6}}class on extends tV{getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this)}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this)}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this)}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this)}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return(super.copy(e,t),"buffer"!==e.sourceType)?console.warn("THREE.Audio: Audio source type cannot be copied."):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice()),this}clone(e){return new this.constructor(this.listener).copy(this,e)}constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}}let oi=new ex,oa=new ev,os=new ex,oo=new ex;class ol extends on{connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(oi,oa,os),oo.set(0,0,1).applyQuaternion(oa);let t=this.panner;if(t.positionX){let e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(oi.x,e),t.positionY.linearRampToValueAtTime(oi.y,e),t.positionZ.linearRampToValueAtTime(oi.z,e),t.orientationX.linearRampToValueAtTime(oo.x,e),t.orientationY.linearRampToValueAtTime(oo.y,e),t.orientationZ.linearRampToValueAtTime(oo.z,e)}else t.setPosition(oi.x,oi.y,oi.z),t.setOrientation(oo.x,oo.y,oo.z)}constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}}class ou{getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}}class oc{accumulate(e,t){let r=this.buffer,n=this.valueSize,i=e*n+n,a=this.cumulativeWeight;if(0===a){for(let e=0;e!==n;++e)r[i+e]=r[e];a=t}else{a+=t;let e=t/a;this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){let e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(r[e]!==r[e+t]){s.setValue(r,n);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let e=r;e!==n;++e)t[e]=t[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let n=0;n!==i;++n)e[t+n]=e[r+n]}_slerp(e,t,r,n){ev.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){let a=this._workIndex*i;ev.multiplyQuaternionsFlat(e,a,e,t,e,r),ev.slerpFlat(e,t,e,t,e,a,n)}_lerp(e,t,r,n,i){let a=1-n;for(let s=0;s!==i;++s){let i=t+s;e[i]=e[i]*a+e[r+s]*n}}_lerpAdditive(e,t,r,n,i){for(let a=0;a!==i;++a){let i=t+a;e[i]=e[i]+e[r+a]*n}}constructor(e,t,r){let n,i,a;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}}let oh="\\[\\]\\.:\\/",od=RegExp("["+oh+"]","g"),oA="[^"+oh+"]",op="[^"+oh.replace("\\.","")+"]",of=/((?:WC+[\/:])*)/.source.replace("WC",oA),om=/(WCOD+)?/.source.replace("WCOD",op),og=RegExp("^"+of+om+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",oA)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",oA)+"$"),oy=["material","materials","bones","map"];class ov{static create(e,t,r){return e&&e.isAnimationObjectGroup?new ov.Composite(e,t,r):new ov(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(od,"")}static parseTrackName(e){let t=og.exec(e);if(null===t)throw Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){let e=r.nodeName.substring(n+1);-1!==oy.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){let r=function(e){for(let n=0;n<e.length;n++){let i=e[n];if(i.name===t||i.uuid===t)return i;let a=r(i.children);if(a)return a}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=ov.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}let a=e[n];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+t.nodeName+"."+n+" but it wasn't found.",e);let s=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?s=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}constructor(e,t,r){this.path=t,this.parsedPath=r||ov.parseTrackName(t),this.node=ov.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ov.Composite=class{getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}constructor(e,t,r){let n=r||ov.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}},ov.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ov.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ov.prototype.GetterByBindingType=[ov.prototype._getValue_direct,ov.prototype._getValue_array,ov.prototype._getValue_arrayElement,ov.prototype._getValue_toArray],ov.prototype.SetterByBindingTypeAndVersioning=[[ov.prototype._setValue_direct,ov.prototype._setValue_direct_setNeedsUpdate,ov.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ov.prototype._setValue_array,ov.prototype._setValue_array_setNeedsUpdate,ov.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ov.prototype._setValue_arrayElement,ov.prototype._setValue_arrayElement_setNeedsUpdate,ov.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ov.prototype._setValue_fromArray,ov.prototype._setValue_fromArray_setNeedsUpdate,ov.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class ox{add(){let e=this._objects,t=this._indicesByUUID,r=this._paths,n=this._parsedPaths,i=this._bindings,a=i.length,s,o=e.length,l=this.nCachedObjects_;for(let u=0,c=arguments.length;u!==c;++u){let c=arguments[u],h=c.uuid,d=t[h];if(void 0===d){d=o++,t[h]=d,e.push(c);for(let e=0;e!==a;++e)i[e].push(new ov(c,r[e],n[e]))}else if(d<l){s=e[d];let o=--l,u=e[o];t[u.uuid]=d,e[d]=u,t[h]=o,e[o]=c;for(let e=0;e!==a;++e){let t=i[e],a=t[o],s=t[d];t[d]=a,void 0===s&&(s=new ov(c,r[e],n[e])),t[o]=s}}else e[d]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){let e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_;for(let a=0,s=arguments.length;a!==s;++a){let s=arguments[a],o=s.uuid,l=t[o];if(void 0!==l&&l>=i){let a=i++,u=e[a];t[u.uuid]=l,e[l]=u,t[o]=a,e[a]=s;for(let e=0;e!==n;++e){let t=r[e],n=t[a],i=t[l];t[l]=n,t[a]=i}}}this.nCachedObjects_=i}uncache(){let e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_,a=e.length;for(let s=0,o=arguments.length;s!==o;++s){let o=arguments[s],l=o.uuid,u=t[l];if(void 0!==u)if(delete t[l],u<i){let s=--i,o=e[s],l=--a,c=e[l];t[o.uuid]=u,e[u]=o,t[c.uuid]=s,e[s]=c,e.pop();for(let e=0;e!==n;++e){let t=r[e],n=t[s],i=t[l];t[u]=n,t[s]=i,t.pop()}}else{let i=--a,s=e[i];i>0&&(t[s.uuid]=u),e[u]=s,e.pop();for(let e=0;e!==n;++e){let t=r[e];t[u]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){let r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];let a=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,u=this.nCachedObjects_,c=Array(l);n=i.length,r[e]=n,a.push(e),s.push(t),i.push(c);for(let r=u,n=o.length;r!==n;++r){let n=o[r];c[r]=new ov(n,e,t)}return c}unsubscribe_(e){let t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){let n=this._paths,i=this._parsedPaths,a=this._bindings,s=a.length-1,o=a[s];t[e[s]]=r,a[r]=o,a.pop(),i[r]=i[s],i.pop(),n[r]=n[s],n.pop()}}constructor(){this.isAnimationObjectGroup=!0,this.uuid=eh(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}}class o_{play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.fadeOut(t),this.fadeIn(t),!0===r){let r=this._clip.duration,n=e._clip.duration;e.warp(1,n/r,t),this.warp(r/n,1,t)}return this}crossFadeTo(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let n=this._mixer,i=n.time,a=this.timeScale,s=this._timeScaleInterpolant;null===s&&(s=n._lendControlInterpolant(),this._timeScaleInterpolant=s);let o=s.parameterPositions,l=s.sampleValues;return o[0]=i,o[1]=i+r,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled)return void this._updateWeight(e);let i=this._startTime;if(null!==i){let n=(e-i)*r;n<0||0===r?t=0:(this._startTime=null,t=r*n)}t*=this._updateTimeScale(e);let a=this._updateTime(t),s=this._updateWeight(e);if(s>0){let e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(a),t[r].accumulateAdditive(s);else for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(a),t[r].accumulate(n,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(null!==r){let n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;null!==r&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,n=this.time+e,i=this._loopCount,a=2202===r;if(0===e)return -1===i?n:a&&(1&i)==1?t-n:n;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));s:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break s}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n>=t||n<0){let r=Math.floor(n/t);n-=t*r,i+=Math.abs(r);let s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(a&&(1&i)==1)return t-n}return n}_setEndings(e,t,r){let n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(e?n.endingStart=this.zeroSlopeAtStart?2401:2400:n.endingStart=2402,t?n.endingEnd=this.zeroSlopeAtEnd?2401:2400:n.endingEnd=2402)}_scheduleFading(e,t,r){let n=this._mixer,i=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);let s=a.parameterPositions,o=a.sampleValues;return s[0]=i,o[0]=t,s[1]=i+e,o[1]=r,this}constructor(e,t,r=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;let i=t.tracks,a=i.length,s=Array(a),o={endingStart:2400,endingEnd:2400};for(let e=0;e!==a;++e){let t=i[e].createInterpolant(null);s[e]=t,t.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}}let ob=new Float32Array(1);class oS extends es{_bindAction(e,t){let r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,a=e._propertyBindings,s=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,u=l[o];void 0===u&&(u={},l[o]=u);for(let e=0;e!==i;++e){let i=n[e],l=i.name,c=u[l];if(void 0!==c)++c.referenceCount,a[e]=c;else{if(void 0!==(c=a[e])){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,o,l));continue}let n=t&&t._propertyBindings[e].binding.parsedPath;c=new oc(ov.create(r,l,n),i.ValueTypeName,i.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,o,l),a[e]=c}s[e].resultBuffer=c.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){let n=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{let t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;let i=e._clip.uuid,a=this._actionsByClip,s=a[i],o=s.knownActions,l=o[o.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,o[u]=l,o.pop(),e._byClipCacheIndex=null;let c=s.actionByRoot,h=(e._localRoot||this._root).uuid;delete c[h],0===o.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){let n=this._bindingsByRootAndName,i=this._bindings,a=n[t];void 0===a&&(a={},n[t]=a),a[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,s=a[n],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[i],0===Object.keys(s).length&&delete a[n]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new a8(new Float32Array(2),new Float32Array(2),1,ob)).__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){let n=t||this._root,i=n.uuid,a="string"==typeof e?sl.findByName(n,e):e,s=null!==a?a.uuid:e,o=this._actionsByClip[s],l=null;if(void 0===r&&(r=null!==a?a.blendMode:2500),void 0!==o){let e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===r)return e;l=o.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;let u=new o_(this,a,t,r);return this._bindAction(u,l),this._addInactiveAction(u,s,i),u}existingAction(e,t){let r=t||this._root,n=r.uuid,i="string"==typeof e?sl.findByName(r,e):e,a=i?i.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[n]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let s=0;s!==r;++s)t[s]._update(n,e,i,a);let s=this._bindings,o=this._nActiveBindings;for(let e=0;e!==o;++e)s[e].apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){let e=i.knownActions;for(let r=0,n=e.length;r!==n;++r){let n=e[r];this._deactivateAction(n);let i=n._cacheIndex,a=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let e in r){let n=r[e].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}let n=this._bindingsByRootAndName[t];if(void 0!==n)for(let e in n){let t=n[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){let r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}}class oT extends ej{constructor(e=1,t=1,r=1,n={}){super(e,t,n),this.isRenderTarget3D=!0,this.depth=r,this.texture=new eY(null,e,t,r),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}}class ow{clone(){return new ow(void 0===this.value.clone?this.value:this.value.clone())}constructor(e){this.value=e}}let oM=0;class oE extends es{add(e){return this.uniforms.push(e),this}remove(e){let t=this.uniforms.indexOf(e);return -1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;let t=e.uniforms;this.uniforms.length=0;for(let e=0,r=t.length;e<r;e++){let r=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0;e<r.length;e++)this.uniforms.push(r[e].clone())}return this}clone(){return new this.constructor().copy(this)}constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:oM++}),this.name="",this.usage=35044,this.uniforms=[]}}class oR extends r5{copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}}class oC{set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}constructor(e,t,r,n,i,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=n,this.count=i,this.normalized=a,this.version=0}}let oN=new tp;class oP{set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return oN.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(oN),this}intersectObject(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return oL(e,this,r,t),r.sort(oI),r}intersectObjects(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let n=0,i=e.length;n<i;n++)oL(e[n],this,r,t);return r.sort(oI),r}constructor(e,t,r=0,n=1/0){this.ray=new tA(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new tw,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}}function oI(e,t){return e.distance-t.distance}function oL(e,t,r,n){let i=!0;if(e.layers.test(t.layers)&&!1===e.raycast(t,r)&&(i=!1),!0===i&&!0===n){let n=e.children;for(let e=0,i=n.length;e<i;e++)oL(n[e],t,r,!0)}}class oD{connect(e){this._document=e,void 0!==e.hidden&&(this._pageVisibilityHandler=oB.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){null!==this._pageVisibilityHandler&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return null!==this._pageVisibilityHandler&&!0===this._document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==e?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}}function oB(){!1===this._document.hidden&&this.reset()}class oF{set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=ed(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ed(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}constructor(e=1,t=0,r=0){this.radius=e,this.phi=t,this.theta=r}}class oU{set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}constructor(e=1,t=0,r=0){this.radius=e,this.theta=t,this.y=r}}class oO{identity(){return this.set(1,0,0,1),this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<4;r++)this.elements[r]=e[r+t];return this}set(e,t,r,n){let i=this.elements;return i[0]=e,i[2]=t,i[1]=r,i[3]=n,this}constructor(e,t,r,n){oO.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,r,n)}}let ok=new ey;class oz{set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=ok.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ok).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}constructor(e=new ey(Infinity,Infinity),t=new ey(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}}let oV=new ex,oq=new ex,oG=new ex,oH=new ex,oj=new ex,oW=new ex,oX=new ex;class oQ{set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){oV.subVectors(e,this.start),oq.subVectors(this.end,this.start);let r=oq.dot(oq),n=oq.dot(oV)/r;return t&&(n=ed(n,0,1)),n}closestPointToPoint(e,t,r){let n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}distanceSqToLine3(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oW,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oX,a=1e-8*1e-8,s=this.start,o=e.start,l=this.end,u=e.end;oG.subVectors(l,s),oH.subVectors(u,o),oj.subVectors(s,o);let c=oG.dot(oG),h=oH.dot(oH),d=oH.dot(oj);if(c<=a&&h<=a)return n.copy(s),i.copy(o),n.sub(i),n.dot(n);if(c<=a)t=0,r=ed(r=d/h,0,1);else{let e=oG.dot(oj);if(h<=a)r=0,t=ed(-e/c,0,1);else{let n=oG.dot(oH),i=c*h-n*n;t=0!==i?ed((n*d-e*h)/i,0,1):0,(r=(n*t+d)/h)<0?(r=0,t=ed(-e/c,0,1)):r>1&&(r=1,t=ed((n-e)/c,0,1))}}return n.copy(s).add(oG.multiplyScalar(t)),i.copy(o).add(oH.multiplyScalar(r)),n.sub(i),n.dot(n)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}constructor(e=new ex,t=new ex){this.start=e,this.end=t}}let oY=new ex;class oK extends tV{dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),oY.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(oY),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new rw,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1;e<32;e++,t++){let r=e/32*Math.PI*2,i=t/32*Math.PI*2;n.push(Math.cos(r),Math.sin(r),1,Math.cos(i),Math.sin(i),1)}r.setAttribute("position",new rg(n,3));let i=new ia({fog:!1,toneMapped:!1});this.cone=new iy(r,i),this.add(this.cone),this.update()}}let oZ=new ex,oJ=new tp,o$=new tp;class o0 extends iy{updateMatrixWorld(e){let t=this.bones,r=this.geometry,n=r.getAttribute("position");o$.copy(this.root.matrixWorld).invert();for(let e=0,r=0;e<t.length;e++){let i=t[e];i.parent&&i.parent.isBone&&(oJ.multiplyMatrices(o$,i.matrixWorld),oZ.setFromMatrixPosition(oJ),n.setXYZ(r,oZ.x,oZ.y,oZ.z),oJ.multiplyMatrices(o$,i.parent.matrixWorld),oZ.setFromMatrixPosition(oJ),n.setXYZ(r+1,oZ.x,oZ.y,oZ.z),r+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){let r=this.geometry.getAttribute("color");for(let n=0;n<r.count;n+=2)r.setXYZ(n,e.r,e.g,e.b),r.setXYZ(n+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e){let t=function e(t){let r=[];!0===t.isBone&&r.push(t);for(let n=0;n<t.children.length;n++)r.push(...e(t.children[n]));return r}(e),r=new rw,n=[],i=[];for(let e=0;e<t.length;e++){let r=t[e];r.parent&&r.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(0,0,0),i.push(0,0,0))}r.setAttribute("position",new rg(n,3)),r.setAttribute("color",new rg(i,3)),super(r,new ia({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;let a=new t6(255),s=new t6(65280);this.setColors(a,s)}}class o1 extends rU{dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}constructor(e,t,r){super(new aD(t,4,2),new re({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}}let o2=new ex,o3=new t6,o4=new t6;class o5 extends tV{dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{let t=e.geometry.getAttribute("color");o3.copy(this.light.color),o4.copy(this.light.groundColor);for(let e=0,r=t.count;e<r;e++){let n=e<r/2?o3:o4;t.setXYZ(e,n.r,n.g,n.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(o2.setFromMatrixPosition(this.light.matrixWorld).negate())}constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";let n=new aN(t);n.rotateY(.5*Math.PI),this.material=new re({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);let i=new Float32Array(3*n.getAttribute("position").count);n.setAttribute("color",new rl(i,3)),this.add(new rU(n,this.material)),this.update()}}class o6 extends iy{dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e=10,t=10,r=4473924,n=8947848){r=new t6(r),n=new t6(n);let i=t/2,a=e/t,s=e/2,o=[],l=[];for(let e=0,u=0,c=-s;e<=t;e++,c+=a){o.push(-s,0,c,s,0,c),o.push(c,0,-s,c,0,s);let t=e===i?r:n;t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3}let u=new rw;u.setAttribute("position",new rg(o,3)),u.setAttribute("color",new rg(l,3)),super(u,new ia({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class o7 extends iy{dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e=10,t=16,r=8,n=64,i=4473924,a=8947848){i=new t6(i),a=new t6(a);let s=[],o=[];if(t>1)for(let r=0;r<t;r++){let n=r/t*(2*Math.PI),l=Math.sin(n)*e,u=Math.cos(n)*e;s.push(0,0,0),s.push(l,0,u);let c=1&r?i:a;o.push(c.r,c.g,c.b),o.push(c.r,c.g,c.b)}for(let t=0;t<r;t++){let l=1&t?i:a,u=e-e/r*t;for(let e=0;e<n;e++){let t=e/n*(2*Math.PI),r=Math.sin(t)*u,i=Math.cos(t)*u;s.push(r,0,i),o.push(l.r,l.g,l.b),r=Math.sin(t=(e+1)/n*(2*Math.PI))*u,i=Math.cos(t)*u,s.push(r,0,i),o.push(l.r,l.g,l.b)}}let l=new rw;l.setAttribute("position",new rg(s,3)),l.setAttribute("color",new rg(o,3)),super(l,new ia({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}let o8=new ex,o9=new ex,le=new ex;class lt extends tV{dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),o8.setFromMatrixPosition(this.light.matrixWorld),o9.setFromMatrixPosition(this.light.target.matrixWorld),le.subVectors(o9,o8),this.lightPlane.lookAt(o9),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(o9),this.targetLine.scale.z=le.length()}constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",void 0===t&&(t=1);let n=new rw;n.setAttribute("position",new rg([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let i=new ia({fog:!1,toneMapped:!1});this.lightPlane=new iA(n,i),this.add(this.lightPlane),(n=new rw).setAttribute("position",new rg([0,0,0,0,0,1],3)),this.targetLine=new iA(n,i),this.add(this.targetLine),this.update()}}let lr=new ex,ln=new rj;class li extends iy{setColors(e,t,r,n,i){let a=this.geometry.getAttribute("color");return a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,n.r,n.g,n.b),a.setXYZ(39,n.r,n.g,n.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0,this}update(){let e,t,r=this.geometry,n=this.pointMap;if(ln.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),!0===this.camera.reversedDepth)e=1,t=0;else if(2e3===this.camera.coordinateSystem)e=-1,t=1;else if(2001===this.camera.coordinateSystem)e=0,t=1;else throw Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);la("c",n,r,ln,0,0,e),la("t",n,r,ln,0,0,t),la("n1",n,r,ln,-1,-1,e),la("n2",n,r,ln,1,-1,e),la("n3",n,r,ln,-1,1,e),la("n4",n,r,ln,1,1,e),la("f1",n,r,ln,-1,-1,t),la("f2",n,r,ln,1,-1,t),la("f3",n,r,ln,-1,1,t),la("f4",n,r,ln,1,1,t),la("u1",n,r,ln,.7,1.1,e),la("u2",n,r,ln,-.7,1.1,e),la("u3",n,r,ln,0,2,e),la("cf1",n,r,ln,-1,0,t),la("cf2",n,r,ln,1,0,t),la("cf3",n,r,ln,0,-1,t),la("cf4",n,r,ln,0,1,t),la("cn1",n,r,ln,-1,0,e),la("cn2",n,r,ln,1,0,e),la("cn3",n,r,ln,0,-1,e),la("cn4",n,r,ln,0,1,e),r.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e){let t=new rw,r=new ia({color:0xffffff,vertexColors:!0,toneMapped:!1}),n=[],i=[],a={};function s(e,t){o(e),o(t)}function o(e){n.push(0,0,0),i.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(n.length/3-1)}s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4"),t.setAttribute("position",new rg(n,3)),t.setAttribute("color",new rg(i,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new t6(0xffaa00),u=new t6(0xff0000),c=new t6(43775),h=new t6(0xffffff),d=new t6(3355443);this.setColors(l,u,c,h,d)}}function la(e,t,r,n,i,a,s){lr.set(i,a,s).unproject(n);let o=t[e];if(void 0!==o){let e=r.getAttribute("position");for(let t=0,r=o.length;t<r;t++)e.setXYZ(o[t],lr.x,lr.y,lr.z)}}let ls=new eZ;class lo extends iy{update(){if(void 0!==this.object&&ls.setFromObject(this.object),ls.isEmpty())return;let e=ls.min,t=ls.max,r=this.geometry.attributes.position,n=r.array;n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=e.x,n[4]=t.y,n[5]=t.z,n[6]=e.x,n[7]=e.y,n[8]=t.z,n[9]=t.x,n[10]=e.y,n[11]=t.z,n[12]=t.x,n[13]=t.y,n[14]=e.z,n[15]=e.x,n[16]=t.y,n[17]=e.z,n[18]=e.x,n[19]=e.y,n[20]=e.z,n[21]=t.x,n[22]=e.y,n[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e,t=0xffff00){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new rw;i.setIndex(new rl(r,1)),i.setAttribute("position",new rl(n,3)),super(i,new ia({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}}class ll extends iy{updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e,t=0xffff00){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new rw;n.setIndex(new rl(r,1)),n.setAttribute("position",new rg([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(n,new ia({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}}class lu extends iA{updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}constructor(e,t=1,r=0xffff00){let n=new rw;n.setAttribute("position",new rg([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere(),super(n,new ia({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;let i=new rw;i.setAttribute("position",new rg([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new rU(i,new re({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}}let lc=new ex;class lh extends tV{setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{lc.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(lc,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}constructor(e=new ex(0,0,1),t=new ex(0,0,0),r=1,n=0xffff00,s=.2*r,o=.2*s){super(),this.type="ArrowHelper",void 0===i&&((i=new rw).setAttribute("position",new rg([0,0,0,0,1,0],3)),(a=new ik(.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new iA(i,new ia({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new rU(a,new re({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}}class ld extends iy{setColors(e,t,r){let n=new t6,i=this.geometry.attributes.color.array;return n.set(e),n.toArray(i,0),n.toArray(i,3),n.set(t),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e=1){let t=new rw;t.setAttribute("position",new rg([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],3)),t.setAttribute("color",new rg([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(t,new ia({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}}class lA{moveTo(e,t){return this.currentPath=new ai,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this}bezierCurveTo(e,t,r,n,i,a){return this.currentPath.bezierCurveTo(e,t,r,n,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){let t,r,n,i,a,s=aS.isClockWise,o=this.subPaths;if(0===o.length)return[];let l=[];if(1===o.length)return r=o[0],(n=new aa).curves=r.curves,l.push(n),l;let u=!s(o[0].getPoints());u=e?!u:u;let c=[],h=[],d=[],A=0;h[0]=void 0,d[A]=[];for(let n=0,a=o.length;n<a;n++)t=s(i=(r=o[n]).getPoints()),(t=e?!t:t)?(!u&&h[A]&&A++,h[A]={s:new aa,p:i},h[A].s.curves=r.curves,u&&A++,d[A]=[]):d[A].push({h:r,p:i[0]});if(!h[0])return function(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r],i=new aa;i.curves=n.curves,t.push(i)}return t}(o);if(h.length>1){let e=!1,t=0;for(let e=0,t=h.length;e<t;e++)c[e]=[];for(let r=0,n=h.length;r<n;r++){let n=d[r];for(let i=0;i<n.length;i++){let a=n[i],s=!0;for(let n=0;n<h.length;n++)(function(e,t){let r=t.length,n=!1;for(let i=r-1,a=0;a<r;i=a++){let r=t[i],s=t[a],o=s.x-r.x,l=s.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[a],o=-o,s=t[i],l=-l),e.y<r.y||e.y>s.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{let t=l*(e.x-r.x)-o*(e.y-r.y);if(0===t)return!0;if(t<0)continue;n=!n}}else{if(e.y!==r.y)continue;if(s.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=s.x)return!0}}return n})(a.p,h[n].p)&&(r!==n&&t++,s?(s=!1,c[n].push(a)):e=!0);s&&c[r].push(a)}}t>0&&!1===e&&(d=c)}for(let e=0,t=h.length;e<t;e++){n=h[e].s,l.push(n),a=d[e];for(let e=0,t=a.length;e<t;e++)n.holes.push(a[e].h)}return l}constructor(){this.type="ShapePath",this.color=new t6,this.subPaths=[],this.currentPath=null}}class lp extends es{connect(e){if(void 0===e)return void console.warn("THREE.Controls: connect() now requires an element.");null!==this.domElement&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}}function lf(e,t,r,n){let i=function(e){switch(e){case 1009:case 1010:return{byteLength:1,components:1};case 1012:case 1011:case 1016:return{byteLength:2,components:1};case 1017:case 1018:return{byteLength:2,components:4};case 1014:case 1013:case 1015:return{byteLength:4,components:1};case 35902:case 35899:return{byteLength:4,components:3}}throw Error("Unknown texture type ".concat(e,"."))}(n);switch(r){case 1021:return e*t;case 1028:case 1029:return e*t/i.components*i.byteLength;case 1030:case 1031:return e*t*2/i.components*i.byteLength;case 1022:return e*t*3/i.components*i.byteLength;case 1023:case 1033:return e*t*4/i.components*i.byteLength;case 33776:case 33777:case 36196:case 37492:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case 33778:case 33779:case 37496:case 37808:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case 35841:case 35843:return Math.max(e,16)*Math.max(t,8)/4;case 35840:case 35842:return Math.max(e,8)*Math.max(t,8)/2;case 37809:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case 37810:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case 37811:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case 37812:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case 37813:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case 37814:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case 37815:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case 37816:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case 37817:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case 37818:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case 37819:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case 37820:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case 37821:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case 36492:case 36494:case 36495:case 36285:case 36286:return Math.ceil(e/4)*Math.ceil(t/4)*16;case 36283:case 36284:return Math.ceil(e/4)*Math.ceil(t/4)*8}throw Error("Unable to determine texture byte length for ".concat(r," format."))}class lm{static contain(e,t){let r=e.image&&e.image.width?e.image.width/e.image.height:1;return r>t?(e.repeat.x=1,e.repeat.y=r/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/r,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}static cover(e,t){let r=e.image&&e.image.width?e.image.width/e.image.height:1;return r>t?(e.repeat.x=t/r,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=r/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}static fill(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}static getByteLength(e,t,r,n){return lf(e,t,r,n)}}function lg(){let e=null,t=!1,r=null,n=null;function i(t,a){r(t,a),n=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function ly(e){let t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);let n=t.get(r);n&&(e.deleteBuffer(n.buffer),t.delete(r))},update:function(r,n){if(r.isInterleavedBufferAttribute&&(r=r.data),r.isGLBufferAttribute){let e=t.get(r);(!e||e.version<r.version)&&t.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version});return}let i=t.get(r);if(void 0===i)t.set(r,function(t,r){let n,i=t.array,a=t.usage,s=i.byteLength,o=e.createBuffer();if(e.bindBuffer(r,o),e.bufferData(r,i,a),t.onUploadCallback(),i instanceof Float32Array)n=e.FLOAT;else if("undefined"!=typeof Float16Array&&i instanceof Float16Array)n=e.HALF_FLOAT;else if(i instanceof Uint16Array)n=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)n=e.SHORT;else if(i instanceof Uint32Array)n=e.UNSIGNED_INT;else if(i instanceof Int32Array)n=e.INT;else if(i instanceof Int8Array)n=e.BYTE;else if(i instanceof Uint8Array)n=e.UNSIGNED_BYTE;else if(i instanceof Uint8ClampedArray)n=e.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);return{buffer:o,type:n,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:s}}(r,n));else if(i.version<r.version){if(i.size!==r.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,r,n){let i=r.array,a=r.updateRanges;if(e.bindBuffer(n,t),0===a.length)e.bufferSubData(n,0,i);else{a.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<a.length;e++){let r=a[t],n=a[e];n.start<=r.start+r.count+1?r.count=Math.max(r.count,n.start+n.count-r.start):a[++t]=n}a.length=t+1;for(let t=0,r=a.length;t<r;t++){let r=a[t];e.bufferSubData(n,r.start*i.BYTES_PER_ELEMENT,i,r.start,r.count)}r.clearUpdateRanges()}r.onUploadCallback()}(i.buffer,r,n),i.version=r.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"180"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="180"),e.s(["PMREMGenerator",()=>lq,"ShaderChunk",()=>lv,"ShaderLib",()=>l_,"UniformsLib",()=>lx,"WebGLRenderer",()=>cR,"WebGLUtils",()=>c_],8560);let lv={alphahash_fragment:"#ifdef USE_ALPHAHASH\n	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n	const float ALPHA_HASH_SCALE = 0.05;\n	float hash2D( vec2 value ) {\n		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n	}\n	float hash3D( vec3 value ) {\n		return hash2D( vec2( hash2D( value.xy ), value.z ) );\n	}\n	float getAlphaHashThreshold( vec3 position ) {\n		float maxDeriv = max(\n			length( dFdx( position.xyz ) ),\n			length( dFdy( position.xyz ) )\n		);\n		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n		vec2 pixScales = vec2(\n			exp2( floor( log2( pixScale ) ) ),\n			exp2( ceil( log2( pixScale ) ) )\n		);\n		vec2 alpha = vec2(\n			hash3D( floor( pixScales.x * position.xyz ) ),\n			hash3D( floor( pixScales.y * position.xyz ) )\n		);\n		float lerpFactor = fract( log2( pixScale ) );\n		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n		float a = min( lerpFactor, 1.0 - lerpFactor );\n		vec3 cases = vec3(\n			x * x / ( 2.0 * a * ( 1.0 - a ) ),\n			( x - 0.5 * a ) / ( 1.0 - a ),\n			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n		);\n		float threshold = ( x < ( 1.0 - a ) )\n			? ( ( x < a ) ? cases.x : cases.y )\n			: cases.z;\n		return clamp( threshold , 1.0e-6, 1.0 );\n	}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n	#ifdef ALPHA_TO_COVERAGE\n	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n	if ( diffuseColor.a == 0.0 ) discard;\n	#else\n	if ( diffuseColor.a < alphaTest ) discard;\n	#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n	uniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_CLEARCOAT ) \n		clearcoatSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_SHEEN ) \n		sheenSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n	#if ! defined( GL_ANGLE_multi_draw )\n	#define gl_DrawID _gl_DrawID\n	uniform int _gl_DrawID;\n	#endif\n	uniform highp sampler2D batchingTexture;\n	uniform highp usampler2D batchingIdTexture;\n	mat4 getBatchingMatrix( const in float i ) {\n		int size = textureSize( batchingTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n	float getIndirectIndex( const in int i ) {\n		int size = textureSize( batchingIdTexture, 0 ).x;\n		int x = i % size;\n		int y = i / size;\n		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n	}\n#endif\n#ifdef USE_BATCHING_COLOR\n	uniform sampler2D batchingColorTexture;\n	vec3 getBatchingColor( const in float i ) {\n		int size = textureSize( batchingColorTexture, 0 ).x;\n		int j = int( i );\n		int x = j % size;\n		int y = j / size;\n		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n	}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n	vPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( specularColor, 1.0, dotVH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n	const mat3 XYZ_TO_REC709 = mat3(\n		 3.2404542, -0.9692660,  0.0556434,\n		-1.5371385,  1.8760108, -0.2040259,\n		-0.4985314,  0.0415560,  1.0572252\n	);\n	vec3 Fresnel0ToIor( vec3 fresnel0 ) {\n		vec3 sqrtF0 = sqrt( fresnel0 );\n		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n	}\n	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n	}\n	float IorToFresnel0( float transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n	}\n	vec3 evalSensitivity( float OPD, vec3 shift ) {\n		float phase = 2.0 * PI * OPD * 1.0e-9;\n		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n		xyz /= 1.0685e-7;\n		vec3 rgb = XYZ_TO_REC709 * xyz;\n		return rgb;\n	}\n	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n		vec3 I;\n		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n		float cosTheta2Sq = 1.0 - sinTheta2Sq;\n		if ( cosTheta2Sq < 0.0 ) {\n			return vec3( 1.0 );\n		}\n		float cosTheta2 = sqrt( cosTheta2Sq );\n		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n		float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n		float T121 = 1.0 - R12;\n		float phi12 = 0.0;\n		if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n		float phi21 = PI - phi12;\n		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n		vec3 phi23 = vec3( 0.0 );\n		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n		vec3 phi = vec3( phi21 ) + phi23;\n		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n		vec3 r123 = sqrt( R123 );\n		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n		vec3 C0 = R12 + Rs;\n		I = C0;\n		vec3 Cm = Rs - T121;\n		for ( int m = 1; m <= 2; ++ m ) {\n			Cm *= r123;\n			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n			I += Cm * Sm;\n		}\n		return max( I, vec3( 0.0 ) );\n	}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vBumpMapUv );\n		vec2 dSTdy = dFdy( vBumpMapUv );\n		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#ifdef ALPHA_TO_COVERAGE\n		float distanceToPlane, distanceGradient;\n		float clipOpacity = 1.0;\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n			distanceGradient = fwidth( distanceToPlane ) / 2.0;\n			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			if ( clipOpacity == 0.0 ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			float unionClipOpacity = 1.0;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n				distanceGradient = fwidth( distanceToPlane ) / 2.0;\n				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			}\n			#pragma unroll_loop_end\n			clipOpacity *= 1.0 - unionClipOpacity;\n		#endif\n		diffuseColor.a *= clipOpacity;\n		if ( diffuseColor.a == 0.0 ) discard;\n	#else\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			bool clipped = true;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n			}\n			#pragma unroll_loop_end\n			if ( clipped ) discard;\n		#endif\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n	diffuseColor *= vColor;\n#elif defined( USE_COLOR )\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR )\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n	vColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n	vColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n	varying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n		uv.x *= CUBEUV_TEXEL_WIDTH;\n		uv.y *= CUBEUV_TEXEL_HEIGHT;\n		#ifdef texture2DGradEXT\n			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n		#else\n			return texture2D( envMap, uv ).rgb;\n		#endif\n	}\n	#define cubeUV_r0 1.0\n	#define cubeUV_m0 - 2.0\n	#define cubeUV_r1 0.8\n	#define cubeUV_m1 - 1.0\n	#define cubeUV_r4 0.4\n	#define cubeUV_m4 2.0\n	#define cubeUV_r5 0.305\n	#define cubeUV_m5 3.0\n	#define cubeUV_r6 0.21\n	#define cubeUV_m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= cubeUV_r1 ) {\n			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n		} else if ( roughness >= cubeUV_r4 ) {\n			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n		} else if ( roughness >= cubeUV_r5 ) {\n			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n		} else if ( roughness >= cubeUV_r6 ) {\n			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n	vec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n	mat3 bm = mat3( batchingMatrix );\n	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n	transformedNormal = bm * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = bm * transformedTangent;\n	#endif\n#endif\n#ifdef USE_INSTANCING\n	mat3 im = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n	transformedNormal = im * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = im * transformedTangent;\n	#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n		emissiveColor = sRGBTransferEOTF( emissiveColor );\n	#endif\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n	return value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform mat3 envMapRotation;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n	vec3 getIBLIrradiance( const in vec3 normal ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n			return PI * envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 reflectVec = reflect( - viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n			return envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	#ifdef USE_ANISOTROPY\n		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n			#ifdef ENVMAP_TYPE_CUBE_UV\n				vec3 bentNormal = cross( bitangent, viewDir );\n				bentNormal = normalize( cross( bentNormal, bitangent ) );\n				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n				return getIBLRadiance( viewDir, bentNormal, roughness );\n			#else\n				return vec3( 0.0 );\n			#endif\n		}\n	#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	vFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float vFogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return vec3( texture2D( gradientMap, coord ).r );\n	#else\n		vec2 fw = fwidth( coord ) * 0.5;\n		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n	#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n	vec3 diffuseColor;\n	float specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Lambert\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n	uniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	return irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if ( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n	return smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n		light.color = directionalLight.color;\n		light.direction = directionalLight.direction;\n		light.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = pointLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		light.color = pointLight.color;\n		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n		light.visible = ( light.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = spotLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float angleCos = dot( light.direction, spotLight.direction );\n		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n		if ( spotAttenuation > 0.0 ) {\n			float lightDistance = length( lVector );\n			light.color = spotLight.color * spotAttenuation;\n			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n			light.visible = ( light.color != vec3( 0.0 ) );\n		} else {\n			light.color = vec3( 0.0 );\n			light.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n		float dotNL = dot( normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n	material.ior = ior;\n	#ifdef USE_SPECULAR\n		float specularIntensityFactor = specularIntensity;\n		vec3 specularColorFactor = specularColor;\n		#ifdef USE_SPECULAR_COLORMAP\n			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n		#endif\n		#ifdef USE_SPECULAR_INTENSITYMAP\n			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n		#endif\n		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n	#else\n		float specularIntensityFactor = 1.0;\n		vec3 specularColorFactor = vec3( 1.0 );\n		material.specularF90 = 1.0;\n	#endif\n	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n	material.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	material.clearcoatF0 = vec3( 0.04 );\n	material.clearcoatF90 = 1.0;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n	material.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	material.iridescence = iridescence;\n	material.iridescenceIOR = iridescenceIOR;\n	#ifdef USE_IRIDESCENCEMAP\n		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n	#endif\n	#ifdef USE_IRIDESCENCE_THICKNESSMAP\n		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n	#else\n		material.iridescenceThickness = iridescenceThicknessMaximum;\n	#endif\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheenColor;\n	#ifdef USE_SHEEN_COLORMAP\n		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n	#endif\n	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	#ifdef USE_ANISOTROPYMAP\n		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n	#else\n		vec2 anisotropyV = anisotropyVector;\n	#endif\n	material.anisotropy = length( anisotropyV );\n	if( material.anisotropy == 0.0 ) {\n		anisotropyV = vec2( 1.0, 0.0 );\n	} else {\n		anisotropyV /= material.anisotropy;\n		material.anisotropy = saturate( material.anisotropy );\n	}\n	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	float dispersion;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometryNormal;\n		vec3 viewDir = geometryViewDir;\n		vec3 position = geometryPosition;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n	geometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n	float dotNVi = saturate( dot( normal, geometryViewDir ) );\n	if ( material.iridescenceThickness == 0.0 ) {\n		material.iridescence = 0.0;\n	} else {\n		material.iridescence = saturate( material.iridescence );\n	}\n	if ( material.iridescence > 0.0 ) {\n		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n	}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointLightInfo( pointLight, geometryPosition, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	vec4 spotColor;\n	vec3 spotLightCoord;\n	bool inSpotLightMap;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotLightInfo( spotLight, geometryPosition, directLight );\n		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n		#else\n		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#endif\n		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n		#endif\n		#undef SPOT_LIGHT_MAP_INDEX\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalLightInfo( directionalLight, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#if defined( USE_LIGHT_PROBES )\n		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getIBLIrradiance( geometryNormal );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	#ifdef USE_ANISOTROPY\n		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n	#else\n		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n	#endif\n	#ifdef USE_CLEARCOAT\n		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n	vFragDepth = 1.0 + gl_Position.w;\n	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 sampledDiffuseColor = texture2D( map, vMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n	#endif\n	diffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	#if defined( USE_POINTS_UV )\n		vec2 uv = vUv;\n	#else\n		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n	#endif\n#endif\n#ifdef USE_MAP\n	diffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n	varying vec2 vUv;\n#else\n	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n		uniform mat3 uvTransform;\n	#endif\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n	float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n	}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n	vColor *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		#if defined( USE_COLOR_ALPHA )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n		#elif defined( USE_COLOR )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n		#endif\n	}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	#ifndef USE_INSTANCING_MORPH\n		uniform float morphTargetBaseInfluence;\n		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	#endif\n	uniform sampler2DArray morphTargetsTexture;\n	uniform ivec2 morphTargetsTextureSize;\n	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n		int y = texelIndex / morphTargetsTextureSize.x;\n		int x = texelIndex - y * morphTargetsTextureSize.x;\n		ivec3 morphUV = ivec3( x, y, morphTargetIndex );\n		return texelFetch( morphTargetsTexture, morphUV, 0 );\n	}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal *= faceDirection;\n	#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n	#ifdef USE_TANGENT\n		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn = getTangentFrame( - vViewPosition, normal,\n		#if defined( USE_NORMALMAP )\n			vNormalMapUv\n		#elif defined( USE_CLEARCOAT_NORMALMAP )\n			vClearcoatNormalMapUv\n		#else\n			vUv\n		#endif\n		);\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn[0] *= faceDirection;\n		tbn[1] *= faceDirection;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	#ifdef USE_TANGENT\n		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn2[0] *= faceDirection;\n		tbn2[1] *= faceDirection;\n	#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	normal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( uv.st );\n		vec2 st1 = dFdy( uv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n		return mat3( T * scale, B * scale, N );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	clearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n	uniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n	if( v <= 0.0 )\n		return vec4( 0., 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec4( 1., 1., 1., 1. );\n	float vuf;\n	float af = modf( v * PackFactors.a, vuf );\n	float bf = modf( vuf * ShiftRight8, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n	if( v <= 0.0 )\n		return vec3( 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec3( 1., 1., 1. );\n	float vuf;\n	float bf = modf( v * PackFactors.b, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n	if( v <= 0.0 )\n		return vec2( 0., 0. );\n	if( v >= 1.0 )\n		return vec2( 1., 1. );\n	float vuf;\n	float gf = modf( v * 256., vuf );\n	return vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n	return dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n	mvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n		#ifdef USE_REVERSED_DEPTH_BUFFER\n			return step( depth, compare );\n		#else\n			return step( compare, depth );\n		#endif\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		#ifdef USE_REVERSED_DEPTH_BUFFER\n			float hard_shadow = step( distribution.x, compare );\n		#else\n			float hard_shadow = step( compare, distribution.x );\n		#endif\n		if ( hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		float shadow = 1.0;\n		vec3 lightToPosition = shadowCoord.xyz;\n		\n		float lightToPositionLength = length( lightToPosition );\n		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;\n			vec3 bd3D = normalize( lightToPosition );\n			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n				shadow = (\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n				) * ( 1.0 / 9.0 );\n			#else\n				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n			#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	vec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n		shadowWorldPosition = worldPosition;\n		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n		#endif\n		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	uniform highp sampler2D boneTexture;\n	mat4 getBoneMatrix( const in float i ) {\n		int size = textureSize( boneTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n	vec3( 1.6605, - 0.1246, - 0.0182 ),\n	vec3( - 0.5876, 1.1329, - 0.1006 ),\n	vec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n	vec3( 0.6274, 0.0691, 0.0164 ),\n	vec3( 0.3293, 0.9195, 0.0880 ),\n	vec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n	vec3 x2 = x * x;\n	vec3 x4 = x2 * x2;\n	return + 15.5 * x4 * x2\n		- 40.14 * x4 * x\n		+ 31.96 * x4\n		- 6.868 * x2 * x\n		+ 0.4298 * x2\n		+ 0.1191 * x\n		- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n	const mat3 AgXInsetMatrix = mat3(\n		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n	);\n	const mat3 AgXOutsetMatrix = mat3(\n		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n	);\n	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;\n	color *= toneMappingExposure;\n	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n	color = AgXInsetMatrix * color;\n	color = max( color, 1e-10 );	color = log2( color );\n	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n	color = clamp( color, 0.0, 1.0 );\n	color = agxDefaultContrastApprox( color );\n	color = AgXOutsetMatrix * color;\n	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n	color = clamp( color, 0.0, 1.0 );\n	return color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n	const float StartCompression = 0.8 - 0.04;\n	const float Desaturation = 0.15;\n	color *= toneMappingExposure;\n	float x = min( color.r, min( color.g, color.b ) );\n	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n	color -= offset;\n	float peak = max( color.r, max( color.g, color.b ) );\n	if ( peak < StartCompression ) return color;\n	float d = 1. - StartCompression;\n	float newPeak = 1. - d * d / ( peak + d - StartCompression );\n	color *= newPeak / peak;\n	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n	return mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n	material.transmission = transmission;\n	material.transmissionAlpha = 1.0;\n	material.thickness = thickness;\n	material.attenuationDistance = attenuationDistance;\n	material.attenuationColor = attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n	#endif\n	vec3 pos = vWorldPosition;\n	vec3 v = normalize( cameraPosition - pos );\n	vec3 n = inverseTransformDirection( normal, viewMatrix );\n	vec4 transmitted = getIBLVolumeRefraction(\n		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n		material.attenuationColor, material.attenuationDistance );\n	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec4 transmittedLight;\n		vec3 transmittance;\n		#ifdef USE_DISPERSION\n			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n			for ( int i = 0; i < 3; i ++ ) {\n				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n				vec3 refractedRayExit = position + transmissionRay;\n				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n				vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n				refractionCoords += 1.0;\n				refractionCoords /= 2.0;\n				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n				transmittedLight[ i ] = transmissionSample[ i ];\n				transmittedLight.a += transmissionSample.a;\n				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n			}\n			transmittedLight.a /= 3.0;\n		#else\n			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n			vec3 refractedRayExit = position + transmissionRay;\n			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n			vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n			refractionCoords += 1.0;\n			refractionCoords /= 2.0;\n			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		#endif\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	uniform mat3 mapTransform;\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform mat3 alphaMapTransform;\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	uniform mat3 lightMapTransform;\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	uniform mat3 aoMapTransform;\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	uniform mat3 bumpMapTransform;\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	uniform mat3 normalMapTransform;\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	uniform mat3 displacementMapTransform;\n	varying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	uniform mat3 emissiveMapTransform;\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	uniform mat3 metalnessMapTransform;\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	uniform mat3 roughnessMapTransform;\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	uniform mat3 anisotropyMapTransform;\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	uniform mat3 clearcoatMapTransform;\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform mat3 clearcoatNormalMapTransform;\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform mat3 clearcoatRoughnessMapTransform;\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	uniform mat3 sheenColorMapTransform;\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	uniform mat3 sheenRoughnessMapTransform;\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	uniform mat3 iridescenceMapTransform;\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform mat3 iridescenceThicknessMapTransform;\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	uniform mat3 specularMapTransform;\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	uniform mat3 specularColorMapTransform;\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	uniform mat3 specularIntensityMapTransform;\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	vUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_BATCHING\n		worldPosition = batchingMatrix * worldPosition;\n	#endif\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n	uniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n	uniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n	#else\n		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n	gl_FragColor = texColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <logdepthbuf_fragment>\n	#ifdef USE_REVERSED_DEPTH_BUFFER\n		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n	#else\n		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n	#endif\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#elif DEPTH_PACKING == 3202\n		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n	#elif DEPTH_PACKING == 3203\n		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n	#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinbase_vertex>\n		#include <skinnormal_vertex>\n		#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_lambert_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n	#else\n		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n	#ifdef OPAQUE\n		gl_FragColor.a = 1.0;\n	#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n	varying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n	vWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define IOR\n	#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n	uniform float ior;\n#endif\n#ifdef USE_SPECULAR\n	uniform float specularIntensity;\n	uniform vec3 specularColor;\n	#ifdef USE_SPECULAR_COLORMAP\n		uniform sampler2D specularColorMap;\n	#endif\n	#ifdef USE_SPECULAR_INTENSITYMAP\n		uniform sampler2D specularIntensityMap;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n	uniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	uniform float iridescence;\n	uniform float iridescenceIOR;\n	uniform float iridescenceThicknessMinimum;\n	uniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheenColor;\n	uniform float sheenRoughness;\n	#ifdef USE_SHEEN_COLORMAP\n		uniform sampler2D sheenColorMap;\n	#endif\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		uniform sampler2D sheenRoughnessMap;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	uniform vec2 anisotropyVector;\n	#ifdef USE_ANISOTROPYMAP\n		uniform sampler2D anisotropyMap;\n	#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n	#include <transmission_fragment>\n	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n	#ifdef USE_SHEEN\n		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n	#endif\n	#ifdef USE_CLEARCOAT\n		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n	#endif\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n	varying vec2 vUv;\n	uniform mat3 uvTransform;\n#endif\nvoid main() {\n	#ifdef USE_POINTS_UV\n		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	#endif\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix[ 3 ];\n	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}"},lx={common:{diffuse:{value:new t6(0xffffff)},opacity:{value:1},map:{value:null},mapTransform:{value:new eS},alphaMap:{value:null},alphaMapTransform:{value:new eS},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new eS}},envmap:{envMap:{value:null},envMapRotation:{value:new eS},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new eS}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new eS}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new eS},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new eS},normalScale:{value:new ey(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new eS},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new eS}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new eS}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new eS}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new t6(0xffffff)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new t6(0xffffff)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new eS},alphaTest:{value:0},uvTransform:{value:new eS}},sprite:{diffuse:{value:new t6(0xffffff)},opacity:{value:1},center:{value:new ey(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new eS},alphaMap:{value:null},alphaMapTransform:{value:new eS},alphaTest:{value:0}}},l_={basic:{uniforms:rV([lx.common,lx.specularmap,lx.envmap,lx.aomap,lx.lightmap,lx.fog]),vertexShader:lv.meshbasic_vert,fragmentShader:lv.meshbasic_frag},lambert:{uniforms:rV([lx.common,lx.specularmap,lx.envmap,lx.aomap,lx.lightmap,lx.emissivemap,lx.bumpmap,lx.normalmap,lx.displacementmap,lx.fog,lx.lights,{emissive:{value:new t6(0)}}]),vertexShader:lv.meshlambert_vert,fragmentShader:lv.meshlambert_frag},phong:{uniforms:rV([lx.common,lx.specularmap,lx.envmap,lx.aomap,lx.lightmap,lx.emissivemap,lx.bumpmap,lx.normalmap,lx.displacementmap,lx.fog,lx.lights,{emissive:{value:new t6(0)},specular:{value:new t6(1118481)},shininess:{value:30}}]),vertexShader:lv.meshphong_vert,fragmentShader:lv.meshphong_frag},standard:{uniforms:rV([lx.common,lx.envmap,lx.aomap,lx.lightmap,lx.emissivemap,lx.bumpmap,lx.normalmap,lx.displacementmap,lx.roughnessmap,lx.metalnessmap,lx.fog,lx.lights,{emissive:{value:new t6(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:lv.meshphysical_vert,fragmentShader:lv.meshphysical_frag},toon:{uniforms:rV([lx.common,lx.aomap,lx.lightmap,lx.emissivemap,lx.bumpmap,lx.normalmap,lx.displacementmap,lx.gradientmap,lx.fog,lx.lights,{emissive:{value:new t6(0)}}]),vertexShader:lv.meshtoon_vert,fragmentShader:lv.meshtoon_frag},matcap:{uniforms:rV([lx.common,lx.bumpmap,lx.normalmap,lx.displacementmap,lx.fog,{matcap:{value:null}}]),vertexShader:lv.meshmatcap_vert,fragmentShader:lv.meshmatcap_frag},points:{uniforms:rV([lx.points,lx.fog]),vertexShader:lv.points_vert,fragmentShader:lv.points_frag},dashed:{uniforms:rV([lx.common,lx.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:lv.linedashed_vert,fragmentShader:lv.linedashed_frag},depth:{uniforms:rV([lx.common,lx.displacementmap]),vertexShader:lv.depth_vert,fragmentShader:lv.depth_frag},normal:{uniforms:rV([lx.common,lx.bumpmap,lx.normalmap,lx.displacementmap,{opacity:{value:1}}]),vertexShader:lv.meshnormal_vert,fragmentShader:lv.meshnormal_frag},sprite:{uniforms:rV([lx.sprite,lx.fog]),vertexShader:lv.sprite_vert,fragmentShader:lv.sprite_frag},background:{uniforms:{uvTransform:{value:new eS},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:lv.background_vert,fragmentShader:lv.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new eS}},vertexShader:lv.backgroundCube_vert,fragmentShader:lv.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:lv.cube_vert,fragmentShader:lv.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:lv.equirect_vert,fragmentShader:lv.equirect_frag},distanceRGBA:{uniforms:rV([lx.common,lx.displacementmap,{referencePosition:{value:new ex},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:lv.distanceRGBA_vert,fragmentShader:lv.distanceRGBA_frag},shadow:{uniforms:rV([lx.lights,lx.fog,{color:{value:new t6(0)},opacity:{value:1}}]),vertexShader:lv.shadow_vert,fragmentShader:lv.shadow_frag}};l_.physical={uniforms:rV([l_.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new eS},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new eS},clearcoatNormalScale:{value:new ey(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new eS},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new eS},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new eS},sheen:{value:0},sheenColor:{value:new t6(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new eS},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new eS},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new eS},transmissionSamplerSize:{value:new ey},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new eS},attenuationDistance:{value:0},attenuationColor:{value:new t6(0)},specularColor:{value:new t6(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new eS},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new eS},anisotropyVector:{value:new ey},anisotropyMap:{value:null},anisotropyMapTransform:{value:new eS}}]),vertexShader:lv.meshphysical_vert,fragmentShader:lv.meshphysical_frag};let lb={r:0,b:0,g:0},lS=new tT,lT=new tp;function lw(e,t,r,n,i,a,s){let o,l,u=new t6(0),c=+(!0!==a),h=null,d=0,A=null;function p(e){let n=!0===e.isScene?e.background:null;return n&&n.isTexture&&(n=(e.backgroundBlurriness>0?r:t).get(n)),n}function f(t,r){t.getRGB(lb,rq(e)),n.buffers.color.setClear(lb.r,lb.g,lb.b,r,s)}return{getClearColor:function(){return u},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;u.set(e),f(u,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){f(u,c=e)},render:function(t){let r=!1,i=p(t);null===i?f(u,c):i&&i.isColor&&(f(i,1),r=!0);let a=e.xr.getEnvironmentBlendMode();"additive"===a?n.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===a&&n.buffers.color.setClear(0,0,0,0,s),(e.autoClear||r)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,r){let n=p(r);n&&(n.isCubeTexture||306===n.mapping)?(void 0===l&&((l=new rU(new rk(1,1,1),new rH({name:"BackgroundCubeMaterial",uniforms:rz(l_.backgroundCube.uniforms),vertexShader:l_.backgroundCube.vertexShader,fragmentShader:l_.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),lS.copy(r.backgroundRotation),lS.x*=-1,lS.y*=-1,lS.z*=-1,n.isCubeTexture&&!1===n.isRenderTargetTexture&&(lS.y*=-1,lS.z*=-1),l.material.uniforms.envMap.value=n,l.material.uniforms.flipEnvMap.value=n.isCubeTexture&&!1===n.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=r.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=r.backgroundIntensity,l.material.uniforms.backgroundRotation.value.setFromMatrix4(lT.makeRotationFromEuler(lS)),l.material.toneMapped=eD.getTransfer(n.colorSpace)!==et,(h!==n||d!==n.version||A!==e.toneMapping)&&(l.material.needsUpdate=!0,h=n,d=n.version,A=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null)):n&&n.isTexture&&(void 0===o&&((o=new rU(new aP(2,2),new rH({name:"BackgroundMaterial",uniforms:rz(l_.background.uniforms),vertexShader:l_.background.vertexShader,fragmentShader:l_.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(o)),o.material.uniforms.t2D.value=n,o.material.uniforms.backgroundIntensity.value=r.backgroundIntensity,o.material.toneMapped=eD.getTransfer(n.colorSpace)!==et,!0===n.matrixAutoUpdate&&n.updateMatrix(),o.material.uniforms.uvTransform.value.copy(n.matrix),(h!==n||d!==n.version||A!==e.toneMapping)&&(o.material.needsUpdate=!0,h=n,d=n.version,A=e.toneMapping),o.layers.enableAll(),t.unshift(o,o.geometry,o.material,0,0,null))},dispose:function(){void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0),void 0!==o&&(o.geometry.dispose(),o.material.dispose(),o=void 0)}}}function lM(e,t){let r=e.getParameter(e.MAX_VERTEX_ATTRIBS),n={},i=u(null),a=i,s=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function u(e){let t=[],n=[],i=[];for(let e=0;e<r;e++)t[e]=0,n[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function c(){let e=a.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function h(e){d(e,0)}function d(t,r){let n=a.newAttributes,i=a.enabledAttributes,s=a.attributeDivisors;n[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),s[t]!==r&&(e.vertexAttribDivisor(t,r),s[t]=r)}function A(){let t=a.newAttributes,r=a.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function p(t,r,n,i,a,s,o){!0===o?e.vertexAttribIPointer(t,r,n,a,s):e.vertexAttribPointer(t,r,n,i,a,s)}function f(){m(),s=!0,a!==i&&o((a=i).object)}function m(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(r,i,l,f,m){let g=!1,y=function(t,r,i){let a=!0===i.wireframe,s=n[t.id];void 0===s&&(s={},n[t.id]=s);let o=s[r.id];void 0===o&&(o={},s[r.id]=o);let l=o[a];return void 0===l&&(l=u(e.createVertexArray()),o[a]=l),l}(f,l,i);a!==y&&o((a=y).object),(g=function(e,t,r,n){let i=a.attributes,s=t.attributes,o=0,l=r.getAttributes();for(let t in l)if(l[t].location>=0){let r=i[t],n=s[t];if(void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor)),void 0===r||r.attribute!==n||n&&r.data!==n.data)return!0;o++}return a.attributesNum!==o||a.index!==n}(r,f,l,m))&&function(e,t,r,n){let i={},s=t.attributes,o=0,l=r.getAttributes();for(let t in l)if(l[t].location>=0){let r=s[t];void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor));let n={};n.attribute=r,r&&r.data&&(n.data=r.data),i[t]=n,o++}a.attributes=i,a.attributesNum=o,a.index=n}(r,f,l,m),null!==m&&t.update(m,e.ELEMENT_ARRAY_BUFFER),(g||s)&&(s=!1,function(r,n,i,a){c();let s=a.attributes,o=i.getAttributes(),l=n.defaultAttributeValues;for(let n in o){let i=o[n];if(i.location>=0){let o=s[n];if(void 0===o&&("instanceMatrix"===n&&r.instanceMatrix&&(o=r.instanceMatrix),"instanceColor"===n&&r.instanceColor&&(o=r.instanceColor)),void 0!==o){let n=o.normalized,s=o.itemSize,l=t.get(o);if(void 0===l)continue;let u=l.buffer,c=l.type,A=l.bytesPerElement,f=c===e.INT||c===e.UNSIGNED_INT||1013===o.gpuType;if(o.isInterleavedBufferAttribute){let t=o.data,l=t.stride,m=o.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)d(i.location+e,t.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<i.locationSize;e++)p(i.location+e,s/i.locationSize,c,n,l*A,(m+s/i.locationSize*e)*A,f)}else{if(o.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)d(i.location+e,o.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<i.locationSize;e++)p(i.location+e,s/i.locationSize,c,n,s*A,s/i.locationSize*e*A,f)}}else if(void 0!==l){let t=l[n];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}A()}(r,i,l,f),null!==m&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(m).buffer))},reset:f,resetDefaultState:m,dispose:function(){for(let e in f(),n){let t=n[e];for(let e in t){let r=t[e];for(let e in r)l(r[e].object),delete r[e];delete t[e]}delete n[e]}},releaseStatesOfGeometry:function(e){if(void 0===n[e.id])return;let t=n[e.id];for(let e in t){let r=t[e];for(let e in r)l(r[e].object),delete r[e];delete t[e]}delete n[e.id]},releaseStatesOfProgram:function(e){for(let t in n){let r=n[t];if(void 0===r[e.id])continue;let i=r[e.id];for(let e in i)l(i[e].object),delete i[e];delete r[e.id]}},initAttributes:c,enableAttribute:h,disableUnusedAttributes:A}}function lE(e,t,r){let n;function i(t,i,a){0!==a&&(e.drawArraysInstanced(n,t,i,a),r.update(i,n,a))}this.setMode=function(e){n=e},this.render=function(t,i){e.drawArrays(n,t,i),r.update(i,n,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,e,0,i,0,a);let s=0;for(let e=0;e<a;e++)s+=i[e];r.update(s,n,1)},this.renderMultiDrawInstances=function(e,a,s,o){if(0===s)return;let l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],a[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(n,e,0,a,0,o,0,s);let t=0;for(let e=0;e<s;e++)t+=a[e]*o[e];r.update(t,n,1)}}}function lR(e,t,r,n){let i;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==r.precision?r.precision:"highp",o=a(s);o!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);let l=!0===r.logarithmicDepthBuffer,u=!0===r.reversedDepthBuffer&&t.has("EXT_clip_control"),c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),A=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),f=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){let r=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,textureFormatReadable:function(t){return 1023===t||n.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(r){let i=1016===r&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return 1009===r||n.convert(r)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)||1015===r||!!i},precision:s,logarithmicDepthBuffer:l,reversedDepthBuffer:u,maxTextures:c,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:A,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:h>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function lC(e){let t=this,r=null,n=0,i=!1,a=!1,s=new nG,o=new eS,l={value:null,needsUpdate:!1};function u(e,r,n,i){let a=null!==e?e.length:0,u=null;if(0!==a){if(u=l.value,!0!==i||null===u){let t=n+4*a,i=r.matrixWorldInverse;o.getNormalMatrix(i),(null===u||u.length<t)&&(u=new Float32Array(t));for(let t=0,r=n;t!==a;++t,r+=4)s.copy(e[t]).applyMatrix4(i,o),s.normal.toArray(u,r),u[r+3]=s.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let r=0!==e.length||t||0!==n||i;return i=t,n=e.length,r},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){r=u(e,t,0)},this.setState=function(s,o,c){let h=s.clippingPlanes,d=s.clipIntersection,A=s.clipShadows,p=e.get(s);if(i&&null!==h&&0!==h.length&&(!a||A)){let e=a?0:n,t=4*e,i=p.clippingState||null;l.value=i,i=u(h,o,t,c);for(let e=0;e!==t;++e)i[e]=r[e];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}else a?u(null):(l.value!==r&&(l.value=r,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0)}}function lN(e){let t=new WeakMap;function r(e,t){return 303===t?e.mapping=301:304===t&&(e.mapping=302),e}function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){let a=i.mapping;if(303===a||304===a)if(t.has(i))return r(t.get(i).texture,i.mapping);else{let a=i.image;if(!a||!(a.height>0))return null;{let s=new rJ(a.height);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",n),r(s.texture,i.mapping)}}}return i},dispose:function(){t=new WeakMap}}}let lP=[.125,.215,.35,.446,.526,.582],lI=new sF,lL=new t6,lD=null,lB=0,lF=0,lU=!1,lO=(1+Math.sqrt(5))/2,lk=1/lO,lz=[new ex(-lO,lk,0),new ex(lO,lk,0),new ex(-lk,0,lO),new ex(lk,0,lO),new ex(0,lO,-lk),new ex(0,lO,lk),new ex(-1,1,-1),new ex(1,1,-1),new ex(-1,1,1),new ex(1,1,1)],lV=new ex;class lq{fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{size:a=256,position:s=lV}=i;lD=this._renderer.getRenderTarget(),lB=this._renderer.getActiveCubeFace(),lF=this._renderer.getActiveMipmapLevel(),lU=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);let o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,r,n,o,s),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=lW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=lj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(lD,lB,lF),this._renderer.xr.enabled=lU,e.scissorTest=!1,lH(e,0,0,e.width,e.height)}_fromTexture(e,t){301===e.mapping||302===e.mapping?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),lD=this._renderer.getRenderTarget(),lB=this._renderer.getActiveCubeFace(),lF=this._renderer.getActiveMipmapLevel(),lU=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,colorSpace:$,depthBuffer:!1},n=lG(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=lG(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],r=[],n=[],i=e,a=e-4+1+lP.length;for(let s=0;s<a;s++){let a=Math.pow(2,i);r.push(a);let o=1/a;s>e-4?o=lP[s-e+4-1]:0===s&&(o=0),n.push(o);let l=1/(a-2),u=-l,c=1+l,h=[u,u,c,u,c,c,u,u,c,c,u,c],d=new Float32Array(108),A=new Float32Array(72),p=new Float32Array(36);for(let e=0;e<6;e++){let t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];d.set(n,18*e),A.set(h,12*e);let i=[e,e,e,e,e,e];p.set(i,6*e)}let f=new rw;f.setAttribute("position",new rl(d,3)),f.setAttribute("uv",new rl(A,2)),f.setAttribute("faceIndex",new rl(p,1)),t.push(f),i>4&&i--}return{lodPlanes:t,sizeLods:r,sigmas:n}}(n)),this._blurMaterial=function(e,t,r){let n=new Float32Array(20),i=new ex(0,1,0);return new rH({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:lX(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform int samples;\n			uniform float weights[ n ];\n			uniform bool latitudinal;\n			uniform float dTheta;\n			uniform float mipInt;\n			uniform vec3 poleAxis;\n\n			#define ENVMAP_TYPE_CUBE_UV\n			#include <cube_uv_reflection_fragment>\n\n			vec3 getSample( float theta, vec3 axis ) {\n\n				float cosTheta = cos( theta );\n				// Rodrigues' axis-angle rotation\n				vec3 sampleDirection = vOutputDirection * cosTheta\n					+ cross( axis, vOutputDirection ) * sin( theta )\n					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n				return bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n			}\n\n			void main() {\n\n				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n				}\n\n				axis = normalize( axis );\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n				for ( int i = 1; i < n; i++ ) {\n\n					if ( i >= samples ) {\n\n						break;\n\n					}\n\n					float theta = dTheta * float( i );\n					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n				}\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}(n,e,t)}return n}_compileMaterial(e){let t=new rU(this._lodPlanes[0],e);this._renderer.compile(t,lI)}_sceneToCubeUV(e,t,r,n,i){let a=new rY(90,1,t,r),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,u=l.autoClear,c=l.toneMapping;l.getClearColor(lL),l.toneMapping=0,l.autoClear=!1,l.state.buffers.depth.getReversed()&&(l.setRenderTarget(n),l.clearDepth(),l.setRenderTarget(null));let h=new re({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),d=new rU(new rk,h),A=!1,p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,A=!0):(h.color.copy(lL),A=!0);for(let t=0;t<6;t++){let r=t%3;0===r?(a.up.set(0,s[t],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+o[t],i.y,i.z)):1===r?(a.up.set(0,0,s[t]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+o[t],i.z)):(a.up.set(0,s[t],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+o[t]));let u=this._cubeSize;lH(n,r*u,t>2?u:0,u,u),l.setRenderTarget(n),A&&l.render(d,a),l.render(e,a)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=c,l.autoClear=u,e.background=p}_textureToCubeUV(e,t){let r=this._renderer,n=301===e.mapping||302===e.mapping;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=lW()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=lj());let i=n?this._cubemapMaterial:this._equirectMaterial,a=new rU(this._lodPlanes[0],i);i.uniforms.envMap.value=e;let s=this._cubeSize;lH(t,0,0,3*s,2*s),r.setRenderTarget(t),r.render(a,lI)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;let n=this._lodPlanes.length;for(let t=1;t<n;t++){let r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=lz[(n-t-1)%lz.length];this._blur(e,t-1,t,r,i)}t.autoClear=r}_blur(e,t,r,n,i){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,n,"latitudinal",i),this._halfBlur(a,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,a,s){let o=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");let u=new rU(this._lodPlanes[n],l),c=l.uniforms,h=this._sizeLods[r]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,A=i/d,p=isFinite(i)?1+Math.floor(3*A):20;p>20&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(20));let f=[],m=0;for(let e=0;e<20;++e){let t=e/A,r=Math.exp(-t*t/2);f.push(r),0===e?m+=r:e<p&&(m+=2*r)}for(let e=0;e<f.length;e++)f[e]=f[e]/m;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=f,c.latitudinal.value="latitudinal"===a,s&&(c.poleAxis.value=s);let{_lodMax:g}=this;c.dTheta.value=d,c.mipInt.value=g-r;let y=this._sizeLods[n],v=4*(this._cubeSize-y);lH(t,3*y*(n>g-4?n-g+4:0),v,3*y,2*y),o.setRenderTarget(t),o.render(u,lI)}constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}}function lG(e,t,r){let n=new eW(e,t,r);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function lH(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function lj(){return new rH({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lX(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n\n			#include <common>\n\n			void main() {\n\n				vec3 outputDirection = normalize( vOutputDirection );\n				vec2 uv = equirectUv( outputDirection );\n\n				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}function lW(){return new rH({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lX(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			uniform float flipEnvMap;\n\n			varying vec3 vOutputDirection;\n\n			uniform samplerCube envMap;\n\n			void main() {\n\n				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}function lX(){return"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	"}function lQ(e){let t=new WeakMap,r=null;function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){let a=i.mapping,s=303===a||304===a,o=301===a||302===a;if(s||o){let a=t.get(i),l=void 0!==a?a.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===r&&(r=new lq(e)),(a=s?r.fromEquirectangular(i,a):r.fromCubemap(i,a)).texture.pmremVersion=i.pmremVersion,t.set(i,a),a.texture;{if(void 0!==a)return a.texture;let l=i.image;return s&&l&&l.height>0||o&&l&&function(e){let t=0;for(let r=0;r<6;r++)void 0!==e[r]&&t++;return 6===t}(l)?(null===r&&(r=new lq(e)),(a=s?r.fromEquirectangular(i):r.fromCubemap(i)).texture.pmremVersion=i.pmremVersion,t.set(i,a),i.addEventListener("dispose",n),a.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function lY(e){let t={};function r(r){let n;if(void 0!==t[r])return t[r];switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(e){return null!==r(e)},init:function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},get:function(e){let t=r(e);return null===t&&eP("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function lK(e,t,r,n){let i={},a=new WeakMap;function s(e){let o=e.target;for(let e in null!==o.index&&t.remove(o.index),o.attributes)t.remove(o.attributes[e]);o.removeEventListener("dispose",s),delete i[o.id];let l=a.get(o);l&&(t.remove(l),a.delete(o)),n.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,r.memory.geometries--}function o(e){let r=[],n=e.index,i=e.attributes.position,s=0;if(null!==n){let e=n.array;s=n.version;for(let t=0,n=e.length;t<n;t+=3){let n=e[t+0],i=e[t+1],a=e[t+2];r.push(n,i,i,a,a,n)}}else{if(void 0===i)return;let e=i.array;s=i.version;for(let t=0,n=e.length/3-1;t<n;t+=3){let e=t+0,n=t+1,i=t+2;r.push(e,n,n,i,i,e)}}let o=new(ew(r)?rf:rA)(r,1);o.version=s;let l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,r.memory.geometries++),t},update:function(r){let n=r.attributes;for(let r in n)t.update(n[r],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){let t=a.get(e);if(t){let r=e.index;null!==r&&t.version<r.version&&o(e)}else o(e);return a.get(e)}}}function lZ(e,t,r){let n,i,a;function s(t,s,o){0!==o&&(e.drawElementsInstanced(n,s,i,t*a,o),r.update(s,n,o))}this.setMode=function(e){n=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,s){e.drawElements(n,s,i,t*a),r.update(s,n,1)},this.renderInstances=s,this.renderMultiDraw=function(e,a,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,a,0,i,e,0,s);let o=0;for(let e=0;e<s;e++)o+=a[e];r.update(o,n,1)},this.renderMultiDrawInstances=function(e,o,l,u){if(0===l)return;let c=t.get("WEBGL_multi_draw");if(null===c)for(let t=0;t<e.length;t++)s(e[t]/a,o[t],u[t]);else{c.multiDrawElementsInstancedWEBGL(n,o,0,i,e,0,u,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e]*u[e];r.update(t,n,1)}}}function lJ(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,n,i){switch(t.calls++,n){case e.TRIANGLES:t.triangles+=r/3*i;break;case e.LINES:t.lines+=r/2*i;break;case e.LINE_STRIP:t.lines+=i*(r-1);break;case e.LINE_LOOP:t.lines+=i*r;break;case e.POINTS:t.points+=i*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function l$(e,t,r){let n=new WeakMap,i=new eH;return{update:function(a,s,o){let l=a.morphTargetInfluences,u=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,c=void 0!==u?u.length:0,h=n.get(s);if(void 0===h||h.count!==c){void 0!==h&&h.texture.dispose();let e=void 0!==s.morphAttributes.position,r=void 0!==s.morphAttributes.normal,a=void 0!==s.morphAttributes.color,o=s.morphAttributes.position||[],l=s.morphAttributes.normal||[],u=s.morphAttributes.color||[],d=0;!0===e&&(d=1),!0===r&&(d=2),!0===a&&(d=3);let A=s.attributes.position.count*d,p=1;A>t.maxTextureSize&&(p=Math.ceil(A/t.maxTextureSize),A=t.maxTextureSize);let f=new Float32Array(A*p*4*c),m=new eX(f,A,p,c);m.type=1015,m.needsUpdate=!0;let g=4*d;for(let t=0;t<c;t++){let n=o[t],s=l[t],c=u[t],h=A*p*4*t;for(let t=0;t<n.count;t++){let o=t*g;!0===e&&(i.fromBufferAttribute(n,t),f[h+o+0]=i.x,f[h+o+1]=i.y,f[h+o+2]=i.z,f[h+o+3]=0),!0===r&&(i.fromBufferAttribute(s,t),f[h+o+4]=i.x,f[h+o+5]=i.y,f[h+o+6]=i.z,f[h+o+7]=0),!0===a&&(i.fromBufferAttribute(c,t),f[h+o+8]=i.x,f[h+o+9]=i.y,f[h+o+10]=i.z,f[h+o+11]=4===c.itemSize?i.w:1)}}h={count:c,texture:m,size:new ey(A,p)},n.set(s,h),s.addEventListener("dispose",function e(){m.dispose(),n.delete(s),s.removeEventListener("dispose",e)})}if(!0===a.isInstancedMesh&&null!==a.morphTexture)o.getUniforms().setValue(e,"morphTexture",a.morphTexture,r);else{let t=0;for(let e=0;e<l.length;e++)t+=l[e];let r=s.morphTargetsRelative?1:1-t;o.getUniforms().setValue(e,"morphTargetBaseInfluence",r),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",h.texture,r),o.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function l0(e,t,r,n){let i=new WeakMap;function a(e){let t=e.target;t.removeEventListener("dispose",a),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(s){let o=n.render.frame,l=s.geometry,u=t.get(s,l);if(i.get(u)!==o&&(t.update(u),i.set(u,o)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",a)&&s.addEventListener("dispose",a),i.get(s)!==o&&(r.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&r.update(s.instanceColor,e.ARRAY_BUFFER),i.set(s,o))),s.isSkinnedMesh){let e=s.skeleton;i.get(e)!==o&&(e.update(),i.set(e,o))}return u},dispose:function(){i=new WeakMap}}}let l1=new eG,l2=new iD(1,1),l3=new eX,l4=new eY,l5=new rZ,l6=[],l7=[],l8=new Float32Array(16),l9=new Float32Array(9),ue=new Float32Array(4);function ut(e,t,r){let n=e[0];if(n<=0||n>0)return e;let i=t*r,a=l6[i];if(void 0===a&&(a=new Float32Array(i),l6[i]=a),0!==t){n.toArray(a,0);for(let n=1,i=0;n!==t;++n)i+=r,e[n].toArray(a,i)}return a}function ur(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function un(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function ui(e,t){let r=l7[t];void 0===r&&(r=new Int32Array(t),l7[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function ua(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function us(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ur(r,t))return;e.uniform2fv(this.addr,t),un(r,t)}}function uo(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(ur(r,t))return;e.uniform3fv(this.addr,t),un(r,t)}}function ul(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ur(r,t))return;e.uniform4fv(this.addr,t),un(r,t)}}function uu(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(ur(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),un(r,t)}else{if(ur(r,n))return;ue.set(n),e.uniformMatrix2fv(this.addr,!1,ue),un(r,n)}}function uc(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(ur(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),un(r,t)}else{if(ur(r,n))return;l9.set(n),e.uniformMatrix3fv(this.addr,!1,l9),un(r,n)}}function uh(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(ur(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),un(r,t)}else{if(ur(r,n))return;l8.set(n),e.uniformMatrix4fv(this.addr,!1,l8),un(r,n)}}function ud(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function uA(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ur(r,t))return;e.uniform2iv(this.addr,t),un(r,t)}}function up(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(ur(r,t))return;e.uniform3iv(this.addr,t),un(r,t)}}function uf(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ur(r,t))return;e.uniform4iv(this.addr,t),un(r,t)}}function um(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function ug(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ur(r,t))return;e.uniform2uiv(this.addr,t),un(r,t)}}function uy(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(ur(r,t))return;e.uniform3uiv(this.addr,t),un(r,t)}}function uv(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ur(r,t))return;e.uniform4uiv(this.addr,t),un(r,t)}}function ux(e,t,r){let n,i=this.cache,a=r.allocateTextureUnit();i[0]!==a&&(e.uniform1i(this.addr,a),i[0]=a),this.type===e.SAMPLER_2D_SHADOW?(l2.compareFunction=515,n=l2):n=l1,r.setTexture2D(t||n,a)}function u_(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||l4,i)}function ub(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||l5,i)}function uS(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||l3,i)}function uT(e,t){e.uniform1fv(this.addr,t)}function uw(e,t){let r=ut(t,this.size,2);e.uniform2fv(this.addr,r)}function uM(e,t){let r=ut(t,this.size,3);e.uniform3fv(this.addr,r)}function uE(e,t){let r=ut(t,this.size,4);e.uniform4fv(this.addr,r)}function uR(e,t){let r=ut(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function uC(e,t){let r=ut(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function uN(e,t){let r=ut(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function uP(e,t){e.uniform1iv(this.addr,t)}function uI(e,t){e.uniform2iv(this.addr,t)}function uL(e,t){e.uniform3iv(this.addr,t)}function uD(e,t){e.uniform4iv(this.addr,t)}function uB(e,t){e.uniform1uiv(this.addr,t)}function uF(e,t){e.uniform2uiv(this.addr,t)}function uU(e,t){e.uniform3uiv(this.addr,t)}function uO(e,t){e.uniform4uiv(this.addr,t)}function uk(e,t,r){let n=this.cache,i=t.length,a=ui(r,i);ur(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let e=0;e!==i;++e)r.setTexture2D(t[e]||l1,a[e])}function uz(e,t,r){let n=this.cache,i=t.length,a=ui(r,i);ur(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let e=0;e!==i;++e)r.setTexture3D(t[e]||l4,a[e])}function uV(e,t,r){let n=this.cache,i=t.length,a=ui(r,i);ur(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let e=0;e!==i;++e)r.setTextureCube(t[e]||l5,a[e])}function uq(e,t,r){let n=this.cache,i=t.length,a=ui(r,i);ur(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let e=0;e!==i;++e)r.setTexture2DArray(t[e]||l3,a[e])}class uG{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return ua;case 35664:return us;case 35665:return uo;case 35666:return ul;case 35674:return uu;case 35675:return uc;case 35676:return uh;case 5124:case 35670:return ud;case 35667:case 35671:return uA;case 35668:case 35672:return up;case 35669:case 35673:return uf;case 5125:return um;case 36294:return ug;case 36295:return uy;case 36296:return uv;case 35678:case 36198:case 36298:case 36306:case 35682:return ux;case 35679:case 36299:case 36307:return u_;case 35680:case 36300:case 36308:case 36293:return ub;case 36289:case 36303:case 36311:case 36292:return uS}}(t.type)}}class uH{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return uT;case 35664:return uw;case 35665:return uM;case 35666:return uE;case 35674:return uR;case 35675:return uC;case 35676:return uN;case 5124:case 35670:return uP;case 35667:case 35671:return uI;case 35668:case 35672:return uL;case 35669:case 35673:return uD;case 5125:return uB;case 36294:return uF;case 36295:return uU;case 36296:return uO;case 35678:case 36198:case 36298:case 36306:case 35682:return uk;case 35679:case 36299:case 36307:return uz;case 35680:case 36300:case 36308:case 36293:return uV;case 36289:case 36303:case 36311:case 36292:return uq}}(t.type)}}class uj{setValue(e,t,r){let n=this.seq;for(let i=0,a=n.length;i!==a;++i){let a=n[i];a.setValue(e,t[a.id],r)}}constructor(e){this.id=e,this.seq=[],this.map={}}}let uW=/(\w+)(\])?(\[|\.)?/g;function uX(e,t){e.seq.push(t),e.map[t.id]=t}class uQ{setValue(e,t,r,n){let i=this.map[t];void 0!==i&&i.setValue(e,r,n)}setOptional(e,t,r){let n=t[r];void 0!==n&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let i=0,a=t.length;i!==a;++i){let a=t[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}}static seqWithValue(e,t){let r=[];for(let n=0,i=e.length;n!==i;++n){let i=e[n];i.id in t&&r.push(i)}return r}constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){let r=e.getActiveUniform(t,n),i=e.getUniformLocation(t,r.name);!function(e,t,r){let n=e.name,i=n.length;for(uW.lastIndex=0;;){let a=uW.exec(n),s=uW.lastIndex,o=a[1],l="]"===a[2],u=a[3];if(l&&(o|=0),void 0===u||"["===u&&s+2===i){uX(r,void 0===u?new uG(o,e,t):new uH(o,e,t));break}{let e=r.map[o];void 0===e&&uX(r,e=new uj(o)),r=e}}}(r,i,this)}}}function uY(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}let uK=0,uZ=new eS;function uJ(e,t,r){let n=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(n&&""===i)return"";let a=/ERROR: 0:(\d+)/.exec(i);if(!a)return i;{let n=parseInt(a[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){let r=e.split("\n"),n=[],i=Math.max(t-6,0),a=Math.min(t+6,r.length);for(let e=i;e<a;e++){let i=e+1;n.push("".concat(i===t?">":" "," ").concat(i,": ").concat(r[e]))}return n.join("\n")}(e.getShaderSource(t),n)}}let u$=new ex;function u0(e){return""!==e}function u1(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function u2(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}let u3=/^[ \t]*#include +<([\w\d./]+)>/gm;function u4(e){return e.replace(u3,u6)}let u5=new Map;function u6(e,t){let r=lv[t];if(void 0===r){let e=u5.get(t);if(void 0!==e)r=lv[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e);else throw Error("Can not resolve #include <"+t+">")}return u4(r)}let u7=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function u8(e){return e.replace(u7,u9)}function u9(e,t,r,n){let i="";for(let e=parseInt(t);e<parseInt(r);e++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function ce(e){let t="precision ".concat(e.precision," float;\n	precision ").concat(e.precision," int;\n	precision ").concat(e.precision," sampler2D;\n	precision ").concat(e.precision," samplerCube;\n	precision ").concat(e.precision," sampler3D;\n	precision ").concat(e.precision," sampler2DArray;\n	precision ").concat(e.precision," sampler2DShadow;\n	precision ").concat(e.precision," samplerCubeShadow;\n	precision ").concat(e.precision," sampler2DArrayShadow;\n	precision ").concat(e.precision," isampler2D;\n	precision ").concat(e.precision," isampler3D;\n	precision ").concat(e.precision," isamplerCube;\n	precision ").concat(e.precision," isampler2DArray;\n	precision ").concat(e.precision," usampler2D;\n	precision ").concat(e.precision," usampler3D;\n	precision ").concat(e.precision," usamplerCube;\n	precision ").concat(e.precision," usampler2DArray;\n	");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function ct(e,t,r,n){let i,a,s,o,l,u,c=e.getContext(),h=r.defines,d=r.vertexShader,A=r.fragmentShader,p=(l="SHADOWMAP_TYPE_BASIC",1===r.shadowMapType?l="SHADOWMAP_TYPE_PCF":2===r.shadowMapType?l="SHADOWMAP_TYPE_PCF_SOFT":3===r.shadowMapType&&(l="SHADOWMAP_TYPE_VSM"),l),f=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),m=(u="ENVMAP_MODE_REFLECTION",r.envMap&&302===r.envMapMode&&(u="ENVMAP_MODE_REFRACTION"),u),g=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(r),y=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let r=Math.log2(t)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:1/t,maxMip:r}}(r),v=[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(u0).join("\n"),x=function(e){let t=[];for(let r in e){let n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(h),_=c.createProgram(),b=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?((i=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x].filter(u0).join("\n")).length>0&&(i+="\n"),(a=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x].filter(u0).join("\n")).length>0&&(a+="\n")):(i=[ce(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+m:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+p:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",r.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(u0).join("\n"),a=[ce(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+f:"",r.envMap?"#define "+m:"",r.envMap?"#define "+g:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+p:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",r.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?lv.tonemapping_pars_fragment:"",0!==r.toneMapping?function(e,t){let r;switch(t){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="Cineon";break;case 4:r="ACESFilmic";break;case 6:r="AgX";break;case 7:r="Neutral";break;case 5:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",lv.colorspace_pars_fragment,function(e,t){let r=function(e){eD._getMatrix(uZ,eD.workingColorSpace,e);let t="mat3( ".concat(uZ.elements.map(e=>e.toFixed(4))," )");switch(eD.getTransfer(e)){case ee:return[t,"LinearTransferOETF"];case et:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return["vec4 ".concat(e,"( vec4 value ) {"),"	return ".concat(r[1],"( vec4( value.rgb * ").concat(r[0],", value.a ) );"),"}"].join("\n")}("linearToOutputTexel",r.outputColorSpace),function(){eD.getLuminanceCoefficients(u$);let e=u$.x.toFixed(4),t=u$.y.toFixed(4),r=u$.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","	const vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(r," );"),"	return dot( weights, rgb );\n}"].join("\n")}(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(u0).join("\n")),d=u2(d=u1(d=u4(d),r),r),A=u2(A=u1(A=u4(A),r),r),d=u8(d),A=u8(A),!0!==r.isRawShaderMaterial&&(b="#version 300 es\n",i=[v,"#define attribute in\n#define varying out\n#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",r.glslVersion===er?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===er?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);let S=b+i+d,T=b+a+A,w=uY(c,c.VERTEX_SHADER,S),M=uY(c,c.FRAGMENT_SHADER,T);function E(t){if(e.debug.checkShaderErrors){let r=c.getProgramInfoLog(_)||"",n=c.getShaderInfoLog(w)||"",s=c.getShaderInfoLog(M)||"",o=r.trim(),l=n.trim(),u=s.trim(),h=!0,d=!0;if(!1===c.getProgramParameter(_,c.LINK_STATUS))if(h=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(c,_,w,M);else{let e=uJ(c,w,"vertex"),r=uJ(c,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+c.getError()+" - VALIDATE_STATUS "+c.getProgramParameter(_,c.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+o+"\n"+e+"\n"+r)}else""!==o?console.warn("THREE.WebGLProgram: Program Info Log:",o):(""===l||""===u)&&(d=!1);d&&(t.diagnostics={runnable:h,programLog:o,vertexShader:{log:l,prefix:i},fragmentShader:{log:u,prefix:a}})}c.deleteShader(w),c.deleteShader(M),s=new uQ(c,_),o=function(e,t){let r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){let n=e.getActiveAttrib(t,i),a=n.name,s=1;n.type===e.FLOAT_MAT2&&(s=2),n.type===e.FLOAT_MAT3&&(s=3),n.type===e.FLOAT_MAT4&&(s=4),r[a]={type:n.type,location:e.getAttribLocation(t,a),locationSize:s}}return r}(c,_)}c.attachShader(_,w),c.attachShader(_,M),void 0!==r.index0AttributeName?c.bindAttribLocation(_,0,r.index0AttributeName):!0===r.morphTargets&&c.bindAttribLocation(_,0,"position"),c.linkProgram(_),this.getUniforms=function(){return void 0===s&&E(this),s},this.getAttributes=function(){return void 0===o&&E(this),o};let R=!1===r.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===R&&(R=c.getProgramParameter(_,37297)),R},this.destroy=function(){n.releaseStatesOfProgram(this),c.deleteProgram(_),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=uK++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=w,this.fragmentShader=M,this}let cr=0;class cn{update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return!1===a.has(n)&&(a.add(n),n.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){for(let t of this.materialCache.get(e))t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return void 0===r&&(r=new ci(e),t.set(e,r)),r}constructor(){this.shaderCache=new Map,this.materialCache=new Map}}class ci{constructor(e){this.id=cr++,this.code=e,this.usedTimes=0}}function ca(e,t,r,n,i,a,s){let o=new tw,l=new cn,u=new Set,c=[],h=i.logarithmicDepthBuffer,d=i.vertexTextures,A=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function f(e){return(u.add(e),0===e)?"uv":"uv".concat(e)}return{getParameters:function(a,o,c,m,g){let y,v,x,_,b=m.fog,S=g.geometry,T=a.isMeshStandardMaterial?m.environment:null,w=(a.isMeshStandardMaterial?r:t).get(a.envMap||T),M=w&&306===w.mapping?w.image.height:null,E=p[a.type];null!==a.precision&&(A=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",A,"instead.");let R=S.morphAttributes.position||S.morphAttributes.normal||S.morphAttributes.color,C=void 0!==R?R.length:0,N=0;if(void 0!==S.morphAttributes.position&&(N=1),void 0!==S.morphAttributes.normal&&(N=2),void 0!==S.morphAttributes.color&&(N=3),E){let e=l_[E];y=e.vertexShader,v=e.fragmentShader}else y=a.vertexShader,v=a.fragmentShader,l.update(a),x=l.getVertexShaderID(a),_=l.getFragmentShaderID(a);let P=e.getRenderTarget(),I=e.state.buffers.depth.getReversed(),L=!0===g.isInstancedMesh,D=!0===g.isBatchedMesh,B=!!a.map,F=!!a.matcap,U=!!w,O=!!a.aoMap,k=!!a.lightMap,z=!!a.bumpMap,V=!!a.normalMap,q=!!a.displacementMap,G=!!a.emissiveMap,H=!!a.metalnessMap,j=!!a.roughnessMap,W=a.anisotropy>0,X=a.clearcoat>0,Q=a.dispersion>0,Y=a.iridescence>0,K=a.sheen>0,Z=a.transmission>0,J=W&&!!a.anisotropyMap,ee=X&&!!a.clearcoatMap,er=X&&!!a.clearcoatNormalMap,en=X&&!!a.clearcoatRoughnessMap,ei=Y&&!!a.iridescenceMap,ea=Y&&!!a.iridescenceThicknessMap,es=K&&!!a.sheenColorMap,eo=K&&!!a.sheenRoughnessMap,el=!!a.specularMap,eu=!!a.specularColorMap,ec=!!a.specularIntensityMap,eh=Z&&!!a.transmissionMap,ed=Z&&!!a.thicknessMap,eA=!!a.gradientMap,ep=!!a.alphaMap,ef=a.alphaTest>0,em=!!a.alphaHash,eg=!!a.extensions,ey=0;a.toneMapped&&(null===P||!0===P.isXRRenderTarget)&&(ey=e.toneMapping);let ev={shaderID:E,shaderType:a.type,shaderName:a.name,vertexShader:y,fragmentShader:v,defines:a.defines,customVertexShaderID:x,customFragmentShaderID:_,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:A,batching:D,batchingColor:D&&null!==g._colorsTexture,instancing:L,instancingColor:L&&null!==g.instanceColor,instancingMorph:L&&null!==g.morphTexture,supportsVertexTextures:d,outputColorSpace:null===P?e.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:$,alphaToCoverage:!!a.alphaToCoverage,map:B,matcap:F,envMap:U,envMapMode:U&&w.mapping,envMapCubeUVHeight:M,aoMap:O,lightMap:k,bumpMap:z,normalMap:V,displacementMap:d&&q,emissiveMap:G,normalMapObjectSpace:V&&1===a.normalMapType,normalMapTangentSpace:V&&0===a.normalMapType,metalnessMap:H,roughnessMap:j,anisotropy:W,anisotropyMap:J,clearcoat:X,clearcoatMap:ee,clearcoatNormalMap:er,clearcoatRoughnessMap:en,dispersion:Q,iridescence:Y,iridescenceMap:ei,iridescenceThicknessMap:ea,sheen:K,sheenColorMap:es,sheenRoughnessMap:eo,specularMap:el,specularColorMap:eu,specularIntensityMap:ec,transmission:Z,transmissionMap:eh,thicknessMap:ed,gradientMap:eA,opaque:!1===a.transparent&&1===a.blending&&!1===a.alphaToCoverage,alphaMap:ep,alphaTest:ef,alphaHash:em,combine:a.combine,mapUv:B&&f(a.map.channel),aoMapUv:O&&f(a.aoMap.channel),lightMapUv:k&&f(a.lightMap.channel),bumpMapUv:z&&f(a.bumpMap.channel),normalMapUv:V&&f(a.normalMap.channel),displacementMapUv:q&&f(a.displacementMap.channel),emissiveMapUv:G&&f(a.emissiveMap.channel),metalnessMapUv:H&&f(a.metalnessMap.channel),roughnessMapUv:j&&f(a.roughnessMap.channel),anisotropyMapUv:J&&f(a.anisotropyMap.channel),clearcoatMapUv:ee&&f(a.clearcoatMap.channel),clearcoatNormalMapUv:er&&f(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:en&&f(a.clearcoatRoughnessMap.channel),iridescenceMapUv:ei&&f(a.iridescenceMap.channel),iridescenceThicknessMapUv:ea&&f(a.iridescenceThicknessMap.channel),sheenColorMapUv:es&&f(a.sheenColorMap.channel),sheenRoughnessMapUv:eo&&f(a.sheenRoughnessMap.channel),specularMapUv:el&&f(a.specularMap.channel),specularColorMapUv:eu&&f(a.specularColorMap.channel),specularIntensityMapUv:ec&&f(a.specularIntensityMap.channel),transmissionMapUv:eh&&f(a.transmissionMap.channel),thicknessMapUv:ed&&f(a.thicknessMap.channel),alphaMapUv:ep&&f(a.alphaMap.channel),vertexTangents:!!S.attributes.tangent&&(V||W),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!S.attributes.color&&4===S.attributes.color.itemSize,pointsUvs:!0===g.isPoints&&!!S.attributes.uv&&(B||ep),fog:!!b,useFog:!0===a.fog,fogExp2:!!b&&b.isFogExp2,flatShading:!0===a.flatShading&&!1===a.wireframe,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:h,reversedDepthBuffer:I,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==S.morphAttributes.position,morphNormals:void 0!==S.morphAttributes.normal,morphColors:void 0!==S.morphAttributes.color,morphTargetsCount:C,morphTextureStride:N,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:ey,decodeVideoTexture:B&&!0===a.map.isVideoTexture&&eD.getTransfer(a.map.colorSpace)===et,decodeVideoTextureEmissive:G&&!0===a.emissiveMap.isVideoTexture&&eD.getTransfer(a.emissiveMap.colorSpace)===et,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:eg&&!0===a.extensions.clipCullDistance&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(eg&&!0===a.extensions.multiDraw||D)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return ev.vertexUv1s=u.has(1),ev.vertexUv2s=u.has(2),ev.vertexUv3s=u.has(3),u.clear(),ev},getProgramCacheKey:function(t){var r,n,i,a;let s=[];if(t.shaderID?s.push(t.shaderID):(s.push(t.customVertexShaderID),s.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)s.push(e),s.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(r=s,n=t,r.push(n.precision),r.push(n.outputColorSpace),r.push(n.envMapMode),r.push(n.envMapCubeUVHeight),r.push(n.mapUv),r.push(n.alphaMapUv),r.push(n.lightMapUv),r.push(n.aoMapUv),r.push(n.bumpMapUv),r.push(n.normalMapUv),r.push(n.displacementMapUv),r.push(n.emissiveMapUv),r.push(n.metalnessMapUv),r.push(n.roughnessMapUv),r.push(n.anisotropyMapUv),r.push(n.clearcoatMapUv),r.push(n.clearcoatNormalMapUv),r.push(n.clearcoatRoughnessMapUv),r.push(n.iridescenceMapUv),r.push(n.iridescenceThicknessMapUv),r.push(n.sheenColorMapUv),r.push(n.sheenRoughnessMapUv),r.push(n.specularMapUv),r.push(n.specularColorMapUv),r.push(n.specularIntensityMapUv),r.push(n.transmissionMapUv),r.push(n.thicknessMapUv),r.push(n.combine),r.push(n.fogExp2),r.push(n.sizeAttenuation),r.push(n.morphTargetsCount),r.push(n.morphAttributeCount),r.push(n.numDirLights),r.push(n.numPointLights),r.push(n.numSpotLights),r.push(n.numSpotLightMaps),r.push(n.numHemiLights),r.push(n.numRectAreaLights),r.push(n.numDirLightShadows),r.push(n.numPointLightShadows),r.push(n.numSpotLightShadows),r.push(n.numSpotLightShadowsWithMaps),r.push(n.numLightProbes),r.push(n.shadowMapType),r.push(n.toneMapping),r.push(n.numClippingPlanes),r.push(n.numClipIntersection),r.push(n.depthPacking),i=s,a=t,o.disableAll(),a.supportsVertexTextures&&o.enable(0),a.instancing&&o.enable(1),a.instancingColor&&o.enable(2),a.instancingMorph&&o.enable(3),a.matcap&&o.enable(4),a.envMap&&o.enable(5),a.normalMapObjectSpace&&o.enable(6),a.normalMapTangentSpace&&o.enable(7),a.clearcoat&&o.enable(8),a.iridescence&&o.enable(9),a.alphaTest&&o.enable(10),a.vertexColors&&o.enable(11),a.vertexAlphas&&o.enable(12),a.vertexUv1s&&o.enable(13),a.vertexUv2s&&o.enable(14),a.vertexUv3s&&o.enable(15),a.vertexTangents&&o.enable(16),a.anisotropy&&o.enable(17),a.alphaHash&&o.enable(18),a.batching&&o.enable(19),a.dispersion&&o.enable(20),a.batchingColor&&o.enable(21),a.gradientMap&&o.enable(22),i.push(o.mask),o.disableAll(),a.fog&&o.enable(0),a.useFog&&o.enable(1),a.flatShading&&o.enable(2),a.logarithmicDepthBuffer&&o.enable(3),a.reversedDepthBuffer&&o.enable(4),a.skinning&&o.enable(5),a.morphTargets&&o.enable(6),a.morphNormals&&o.enable(7),a.morphColors&&o.enable(8),a.premultipliedAlpha&&o.enable(9),a.shadowMapEnabled&&o.enable(10),a.doubleSided&&o.enable(11),a.flipSided&&o.enable(12),a.useDepthPacking&&o.enable(13),a.dithering&&o.enable(14),a.transmission&&o.enable(15),a.sheen&&o.enable(16),a.opaque&&o.enable(17),a.pointsUvs&&o.enable(18),a.decodeVideoTexture&&o.enable(19),a.decodeVideoTextureEmissive&&o.enable(20),a.alphaToCoverage&&o.enable(21),i.push(o.mask),s.push(e.outputColorSpace)),s.push(t.customProgramCacheKey),s.join()},getUniforms:function(e){let t,r=p[e.type];if(r){let e=l_[r];t=rG.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,r){let n;for(let e=0,t=c.length;e<t;e++){let t=c[e];if(t.cacheKey===r){n=t,++n.usedTimes;break}}return void 0===n&&(n=new ct(e,r,t,a),c.push(n)),n},releaseProgram:function(e){if(0==--e.usedTimes){let t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function cs(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function co(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function cl(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function cu(){let e=[],t=0,r=[],n=[],i=[];function a(r,n,i,a,s,o){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,groupOrder:a,renderOrder:r.renderOrder,z:s,group:o},e[t]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.groupOrder=a,l.renderOrder=r.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:r,transmissive:n,transparent:i,init:function(){t=0,r.length=0,n.length=0,i.length=0},push:function(e,t,s,o,l,u){let c=a(e,t,s,o,l,u);s.transmission>0?n.push(c):!0===s.transparent?i.push(c):r.push(c)},unshift:function(e,t,s,o,l,u){let c=a(e,t,s,o,l,u);s.transmission>0?n.unshift(c):!0===s.transparent?i.unshift(c):r.unshift(c)},finish:function(){for(let r=t,n=e.length;r<n;r++){let t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||co),n.length>1&&n.sort(t||cl),i.length>1&&i.sort(t||cl)}}}function cc(){let e=new WeakMap;return{get:function(t,r){let n,i=e.get(t);return void 0===i?(n=new cu,e.set(t,[n])):r>=i.length?(n=new cu,i.push(n)):n=i[r],n},dispose:function(){e=new WeakMap}}}function ch(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":r={direction:new ex,color:new t6};break;case"SpotLight":r={position:new ex,direction:new ex,color:new t6,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new ex,color:new t6,distance:0,decay:0};break;case"HemisphereLight":r={direction:new ex,skyColor:new t6,groundColor:new t6};break;case"RectAreaLight":r={color:new t6,position:new ex,halfWidth:new ex,halfHeight:new ex}}return e[t.id]=r,r}}}let cd=0;function cA(e,t){return 2*!!t.castShadow-2*!!e.castShadow+ +!!t.map-!!e.map}function cp(e){let t=new ch,r=function(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ey};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ey,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)n.probe.push(new ex);let i=new ex,a=new tp,s=new tp;return{setup:function(i){let a=0,s=0,o=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0;i.sort(cA);for(let e=0,v=i.length;e<v;e++){let v=i[e],x=v.color,_=v.intensity,b=v.distance,S=v.shadow&&v.shadow.map?v.shadow.map.texture:null;if(v.isAmbientLight)a+=x.r*_,s+=x.g*_,o+=x.b*_;else if(v.isLightProbe){for(let e=0;e<9;e++)n.probe[e].addScaledVector(v.sh.coefficients[e],_);y++}else if(v.isDirectionalLight){let e=t.get(v);if(e.color.copy(v.color).multiplyScalar(v.intensity),v.castShadow){let e=v.shadow,t=r.get(v);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,n.directionalShadow[l]=t,n.directionalShadowMap[l]=S,n.directionalShadowMatrix[l]=v.shadow.matrix,A++}n.directional[l]=e,l++}else if(v.isSpotLight){let e=t.get(v);e.position.setFromMatrixPosition(v.matrixWorld),e.color.copy(x).multiplyScalar(_),e.distance=b,e.coneCos=Math.cos(v.angle),e.penumbraCos=Math.cos(v.angle*(1-v.penumbra)),e.decay=v.decay,n.spot[c]=e;let i=v.shadow;if(v.map&&(n.spotLightMap[m]=v.map,m++,i.updateMatrices(v),v.castShadow&&g++),n.spotLightMatrix[c]=i.matrix,v.castShadow){let e=r.get(v);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,n.spotShadow[c]=e,n.spotShadowMap[c]=S,f++}c++}else if(v.isRectAreaLight){let e=t.get(v);e.color.copy(x).multiplyScalar(_),e.halfWidth.set(.5*v.width,0,0),e.halfHeight.set(0,.5*v.height,0),n.rectArea[h]=e,h++}else if(v.isPointLight){let e=t.get(v);if(e.color.copy(v.color).multiplyScalar(v.intensity),e.distance=v.distance,e.decay=v.decay,v.castShadow){let e=v.shadow,t=r.get(v);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,n.pointShadow[u]=t,n.pointShadowMap[u]=S,n.pointShadowMatrix[u]=v.shadow.matrix,p++}n.point[u]=e,u++}else if(v.isHemisphereLight){let e=t.get(v);e.skyColor.copy(v.color).multiplyScalar(_),e.groundColor.copy(v.groundColor).multiplyScalar(_),n.hemi[d]=e,d++}}h>0&&(!0===e.has("OES_texture_float_linear")?(n.rectAreaLTC1=lx.LTC_FLOAT_1,n.rectAreaLTC2=lx.LTC_FLOAT_2):(n.rectAreaLTC1=lx.LTC_HALF_1,n.rectAreaLTC2=lx.LTC_HALF_2)),n.ambient[0]=a,n.ambient[1]=s,n.ambient[2]=o;let v=n.hash;(v.directionalLength!==l||v.pointLength!==u||v.spotLength!==c||v.rectAreaLength!==h||v.hemiLength!==d||v.numDirectionalShadows!==A||v.numPointShadows!==p||v.numSpotShadows!==f||v.numSpotMaps!==m||v.numLightProbes!==y)&&(n.directional.length=l,n.spot.length=c,n.rectArea.length=h,n.point.length=u,n.hemi.length=d,n.directionalShadow.length=A,n.directionalShadowMap.length=A,n.pointShadow.length=p,n.pointShadowMap.length=p,n.spotShadow.length=f,n.spotShadowMap.length=f,n.directionalShadowMatrix.length=A,n.pointShadowMatrix.length=p,n.spotLightMatrix.length=f+m-g,n.spotLightMap.length=m,n.numSpotLightShadowsWithMaps=g,n.numLightProbes=y,v.directionalLength=l,v.pointLength=u,v.spotLength=c,v.rectAreaLength=h,v.hemiLength=d,v.numDirectionalShadows=A,v.numPointShadows=p,v.numSpotShadows=f,v.numSpotMaps=m,v.numLightProbes=y,n.version=cd++)},setupView:function(e,t){let r=0,o=0,l=0,u=0,c=0,h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){let d=e[t];if(d.isDirectionalLight){let e=n.directional[r];e.direction.setFromMatrixPosition(d.matrixWorld),i.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),r++}else if(d.isSpotLight){let e=n.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),i.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){let e=n.rectArea[u];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),s.identity(),a.copy(d.matrixWorld),a.premultiply(h),s.extractRotation(a),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),u++}else if(d.isPointLight){let e=n.point[o];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),o++}else if(d.isHemisphereLight){let e=n.hemi[c];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),c++}}},state:n}}function cf(e){let t=new cp(e),r=[],n=[],i={lightsArray:r,shadowsArray:n,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,r.length=0,n.length=0},state:i,setupLights:function(){t.setup(r)},setupLightsView:function(e){t.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){n.push(e)}}}function cm(e){let t=new WeakMap;return{get:function(r){let n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=t.get(r);return void 0===a?(n=new cf(e),t.set(r,[n])):i>=a.length?(n=new cf(e),a.push(n)):n=a[i],n},dispose:function(){t=new WeakMap}}}function cg(e,t,r){let n=new nX,i=new ey,a=new ey,s=new eH,o=new aK({depthPacking:3201}),l=new aZ,u={},c=r.maxTextureSize,h={0:1,1:0,2:2},d=new rH({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ey},radius:{value:4}},vertexShader:"void main() {\n	gl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	const float samples = float( VSM_SAMPLES );\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n	for ( float i = 0.0; i < samples; i ++ ) {\n		float uvOffset = uvStart + i * uvStride;\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean / samples;\n	squared_mean = squared_mean / samples;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),A=d.clone();A.defines.HORIZONTAL_PASS=1;let p=new rw;p.setAttribute("position",new rl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let f=new rU(p,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let g=this.type;function y(t,r,n,i){let a=null,s=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)a=s;else if(a=!0===n.isPointLight?l:o,e.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0||!0===r.alphaToCoverage){let e=a.uuid,t=r.uuid,n=u[e];void 0===n&&(n={},u[e]=n);let i=n[t];void 0===i&&(i=a.clone(),n[t]=i,r.addEventListener("dispose",v)),a=i}return a.visible=r.visible,a.wireframe=r.wireframe,3===i?a.side=null!==r.shadowSide?r.shadowSide:r.side:a.side=null!==r.shadowSide?r.shadowSide:h[r.side],a.alphaMap=r.alphaMap,a.alphaTest=!0===r.alphaToCoverage?.5:r.alphaTest,a.map=r.map,a.clipShadows=r.clipShadows,a.clippingPlanes=r.clippingPlanes,a.clipIntersection=r.clipIntersection,a.displacementMap=r.displacementMap,a.displacementScale=r.displacementScale,a.displacementBias=r.displacementBias,a.wireframeLinewidth=r.wireframeLinewidth,a.linewidth=r.linewidth,!0===n.isPointLight&&!0===a.isMeshDistanceMaterial&&(e.properties.get(a).light=n),a}function v(e){for(let t in e.target.removeEventListener("dispose",v),u){let r=u[t],n=e.target.uuid;n in r&&(r[n].dispose(),delete r[n])}}this.render=function(r,o,l){if(!1===m.enabled||!1===m.autoUpdate&&!1===m.needsUpdate||0===r.length)return;let u=e.getRenderTarget(),h=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),v=e.state;v.setBlending(0),!0===v.buffers.depth.getReversed()?v.buffers.color.setClear(0,0,0,0):v.buffers.color.setClear(1,1,1,1),v.buffers.depth.setTest(!0),v.setScissorTest(!1);let x=3!==g&&3===this.type,_=3===g&&3!==this.type;for(let u=0,h=r.length;u<h;u++){let h=r[u],p=h.shadow;if(void 0===p){console.warn("THREE.WebGLShadowMap:",h,"has no shadow.");continue}if(!1===p.autoUpdate&&!1===p.needsUpdate)continue;i.copy(p.mapSize);let m=p.getFrameExtents();if(i.multiply(m),a.copy(p.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/m.x),i.x=a.x*m.x,p.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/m.y),i.y=a.y*m.y,p.mapSize.y=a.y)),null===p.map||!0===x||!0===_){let e=3!==this.type?{minFilter:1003,magFilter:1003}:{};null!==p.map&&p.map.dispose(),p.map=new eW(i.x,i.y,e),p.map.texture.name=h.name+".shadowMap",p.camera.updateProjectionMatrix()}e.setRenderTarget(p.map),e.clear();let g=p.getViewportCount();for(let r=0;r<g;r++){let i=p.getViewport(r);s.set(a.x*i.x,a.y*i.y,a.x*i.z,a.y*i.w),v.viewport(s),p.updateMatrices(h,r),n=p.getFrustum(),function r(i,a,s,o,l){if(!1===i.visible)return;if(i.layers.test(a.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===l)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,i.matrixWorld);let r=t.update(i),n=i.material;if(Array.isArray(n)){let t=r.groups;for(let u=0,c=t.length;u<c;u++){let c=t[u],h=n[c.materialIndex];if(h&&h.visible){let t=y(i,h,o,l);i.onBeforeShadow(e,i,a,s,r,t,c),e.renderBufferDirect(s,null,r,t,i,c),i.onAfterShadow(e,i,a,s,r,t,c)}}}else if(n.visible){let t=y(i,n,o,l);i.onBeforeShadow(e,i,a,s,r,t,null),e.renderBufferDirect(s,null,r,t,i,null),i.onAfterShadow(e,i,a,s,r,t,null)}}let u=i.children;for(let e=0,t=u.length;e<t;e++)r(u[e],a,s,o,l)}(o,l,p.camera,h,this.type)}!0!==p.isPointLightShadow&&3===this.type&&function(r,n){let a=t.update(f);d.defines.VSM_SAMPLES!==r.blurSamples&&(d.defines.VSM_SAMPLES=r.blurSamples,A.defines.VSM_SAMPLES=r.blurSamples,d.needsUpdate=!0,A.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new eW(i.x,i.y)),d.uniforms.shadow_pass.value=r.map.texture,d.uniforms.resolution.value=r.mapSize,d.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,a,d,f,null),A.uniforms.shadow_pass.value=r.mapPass.texture,A.uniforms.resolution.value=r.mapSize,A.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,a,A,f,null)}(p,l),p.needsUpdate=!1}g=this.type,m.needsUpdate=!1,e.setRenderTarget(u,h,p)}}let cy={0:1,2:6,4:7,3:5,1:0,6:2,7:4,5:3};function cv(e,t){let r=new function(){let t=!1,r=new eH,n=null,i=new eH(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,a,s,o){!0===o&&(t*=s,n*=s,a*=s),r.set(t,n,a,s),!1===i.equals(r)&&(e.clearColor(t,n,a,s),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},n=new function(){let r=!1,n=!1,i=null,a=null,s=null;return{setReversed:function(e){if(n!==e){let r=t.get("EXT_clip_control");e?r.clipControlEXT(r.LOWER_LEFT_EXT,r.ZERO_TO_ONE_EXT):r.clipControlEXT(r.LOWER_LEFT_EXT,r.NEGATIVE_ONE_TO_ONE_EXT),n=e;let i=s;s=null,this.setClear(i)}},getReversed:function(){return n},setTest:function(t){t?k(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(t){i===t||r||(e.depthMask(t),i=t)},setFunc:function(t){if(n&&(t=cy[t]),a!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}a=t}},setLocked:function(e){r=e},setClear:function(t){s!==t&&(n&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){r=!1,i=null,a=null,s=null,n=!1}}},i=new function(){let t=!1,r=null,n=null,i=null,a=null,s=null,o=null,l=null,u=null;return{setTest:function(r){t||(r?k(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,s){(n!==t||i!==r||a!==s)&&(e.stencilFunc(t,r,s),n=t,i=r,a=s)},setOp:function(t,r,n){(s!==t||o!==r||l!==n)&&(e.stencilOp(t,r,n),s=t,o=r,l=n)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,r=null,n=null,i=null,a=null,s=null,o=null,l=null,u=null}}},a=new WeakMap,s=new WeakMap,o={},l={},u=new WeakMap,c=[],h=null,d=!1,A=null,p=null,f=null,m=null,g=null,y=null,v=null,x=new t6(0,0,0),_=0,b=!1,S=null,T=null,w=null,M=null,E=null,R=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),C=!1,N=e.getParameter(e.VERSION);-1!==N.indexOf("WebGL")?C=parseFloat(/^WebGL (\d)/.exec(N)[1])>=1:-1!==N.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL ES (\d)/.exec(N)[1])>=2);let P=null,I={},L=e.getParameter(e.SCISSOR_BOX),D=e.getParameter(e.VIEWPORT),B=new eH().fromArray(L),F=new eH().fromArray(D);function U(t,r,n,i){let a=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let s=0;s<n;s++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(r,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(r+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return s}let O={};function k(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function z(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}O[e.TEXTURE_2D]=U(e.TEXTURE_2D,e.TEXTURE_2D,1),O[e.TEXTURE_CUBE_MAP]=U(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),O[e.TEXTURE_2D_ARRAY]=U(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),O[e.TEXTURE_3D]=U(e.TEXTURE_3D,e.TEXTURE_3D,1,1),r.setClear(0,0,0,1),n.setClear(1),i.setClear(0),k(e.DEPTH_TEST),n.setFunc(3),H(!1),j(1),k(e.CULL_FACE),G(0);let V={100:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT};V[103]=e.MIN,V[104]=e.MAX;let q={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,204:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,205:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA,211:e.CONSTANT_COLOR,212:e.ONE_MINUS_CONSTANT_COLOR,213:e.CONSTANT_ALPHA,214:e.ONE_MINUS_CONSTANT_ALPHA};function G(t,r,n,i,a,s,o,l,u,c){if(0===t){!0===d&&(z(e.BLEND),d=!1);return}if(!1===d&&(k(e.BLEND),d=!0),5!==t){if(t!==A||c!==b){if((100!==p||100!==g)&&(e.blendEquation(e.FUNC_ADD),p=100,g=100),c)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 3:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}f=null,m=null,y=null,v=null,x.set(0,0,0),_=0,A=t,b=c}return}a=a||r,s=s||n,o=o||i,(r!==p||a!==g)&&(e.blendEquationSeparate(V[r],V[a]),p=r,g=a),(n!==f||i!==m||s!==y||o!==v)&&(e.blendFuncSeparate(q[n],q[i],q[s],q[o]),f=n,m=i,y=s,v=o),(!1===l.equals(x)||u!==_)&&(e.blendColor(l.r,l.g,l.b,u),x.copy(l),_=u),A=t,b=!1}function H(t){S!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),S=t)}function j(t){0!==t?(k(e.CULL_FACE),t!==T&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),T=t}function W(t,r,n){t?(k(e.POLYGON_OFFSET_FILL),(M!==r||E!==n)&&(e.polygonOffset(r,n),M=r,E=n)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:n,stencil:i},enable:k,disable:z,bindFramebuffer:function(t,r){return l[t]!==r&&(e.bindFramebuffer(t,r),l[t]=r,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=r),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=r),!0)},drawBuffers:function(t,r){let n=c,i=!1;if(t){void 0===(n=u.get(r))&&(n=[],u.set(r,n));let a=t.textures;if(n.length!==a.length||n[0]!==e.COLOR_ATTACHMENT0){for(let t=0,r=a.length;t<r;t++)n[t]=e.COLOR_ATTACHMENT0+t;n.length=a.length,i=!0}}else n[0]!==e.BACK&&(n[0]=e.BACK,i=!0);i&&e.drawBuffers(n)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:G,setMaterial:function(t,a){2===t.side?z(e.CULL_FACE):k(e.CULL_FACE);let s=1===t.side;a&&(s=!s),H(s),1===t.blending&&!1===t.transparent?G(0):G(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),n.setFunc(t.depthFunc),n.setTest(t.depthTest),n.setMask(t.depthWrite),r.setMask(t.colorWrite);let o=t.stencilWrite;i.setTest(o),o&&(i.setMask(t.stencilWriteMask),i.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),i.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),W(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?k(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:H,setCullFace:j,setLineWidth:function(t){t!==w&&(C&&e.lineWidth(t),w=t)},setPolygonOffset:W,setScissorTest:function(t){t?k(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+R-1),P!==t&&(e.activeTexture(t),P=t)},bindTexture:function(t,r,n){void 0===n&&(n=null===P?e.TEXTURE0+R-1:P);let i=I[n];void 0===i&&(i={type:void 0,texture:void 0},I[n]=i),(i.type!==t||i.texture!==r)&&(P!==n&&(e.activeTexture(n),P=n),e.bindTexture(t,r||O[t]),i.type=t,i.texture=r)},unbindTexture:function(){let t=I[P];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,r){let n=s.get(r);void 0===n&&(n=new WeakMap,s.set(r,n));let i=n.get(t);void 0===i&&(i=e.getUniformBlockIndex(r,t.name),n.set(t,i))},uniformBlockBinding:function(t,r){let n=s.get(r).get(t);a.get(r)!==n&&(e.uniformBlockBinding(r,n,t.__bindingPointIndex),a.set(r,n))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===B.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),B.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),n.setReversed(!1),e.clearDepth(1),e.stencilMask(0xffffffff),e.stencilFunc(e.ALWAYS,0,0xffffffff),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},P=null,I={},l={},u=new WeakMap,c=[],h=null,d=!1,A=null,p=null,f=null,m=null,g=null,y=null,v=null,x=new t6(0,0,0),_=0,b=!1,S=null,T=null,w=null,M=null,E=null,B.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),r.reset(),n.reset(),i.reset()}}}function cx(e,t,r,n,i,a,s){let o,l=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,u="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new ey,h=new WeakMap,d=new WeakMap,A=!1;try{A="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function p(e,t){return A?new OffscreenCanvas(e,t):eR("canvas")}function f(e,t,r){let n=1,i=q(e);if((i.width>r||i.height>r)&&(n=r/Math.max(i.width,i.height)),n<1)if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){let r=Math.floor(n*i.width),a=Math.floor(n*i.height);void 0===o&&(o=p(r,a));let s=t?p(r,a):o;return s.width=r,s.height=a,s.getContext("2d").drawImage(e,0,0,r,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+r+"x"+a+")."),s}else"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+").");return e}function m(e){return e.generateMipmaps}function g(t){e.generateMipmap(t)}function y(r,n,i,a){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let o=n;if(n===e.RED&&(i===e.FLOAT&&(o=e.R32F),i===e.HALF_FLOAT&&(o=e.R16F),i===e.UNSIGNED_BYTE&&(o=e.R8)),n===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.R8UI),i===e.UNSIGNED_SHORT&&(o=e.R16UI),i===e.UNSIGNED_INT&&(o=e.R32UI),i===e.BYTE&&(o=e.R8I),i===e.SHORT&&(o=e.R16I),i===e.INT&&(o=e.R32I)),n===e.RG&&(i===e.FLOAT&&(o=e.RG32F),i===e.HALF_FLOAT&&(o=e.RG16F),i===e.UNSIGNED_BYTE&&(o=e.RG8)),n===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RG8UI),i===e.UNSIGNED_SHORT&&(o=e.RG16UI),i===e.UNSIGNED_INT&&(o=e.RG32UI),i===e.BYTE&&(o=e.RG8I),i===e.SHORT&&(o=e.RG16I),i===e.INT&&(o=e.RG32I)),n===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RGB8UI),i===e.UNSIGNED_SHORT&&(o=e.RGB16UI),i===e.UNSIGNED_INT&&(o=e.RGB32UI),i===e.BYTE&&(o=e.RGB8I),i===e.SHORT&&(o=e.RGB16I),i===e.INT&&(o=e.RGB32I)),n===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(o=e.RGBA16UI),i===e.UNSIGNED_INT&&(o=e.RGBA32UI),i===e.BYTE&&(o=e.RGBA8I),i===e.SHORT&&(o=e.RGBA16I),i===e.INT&&(o=e.RGBA32I)),n===e.RGB&&(i===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),i===e.UNSIGNED_INT_10F_11F_11F_REV&&(o=e.R11F_G11F_B10F)),n===e.RGBA){let t=s?ee:eD.getTransfer(a);i===e.FLOAT&&(o=e.RGBA32F),i===e.HALF_FLOAT&&(o=e.RGBA16F),i===e.UNSIGNED_BYTE&&(o=t===et?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return(o===e.R16F||o===e.R32F||o===e.RG16F||o===e.RG32F||o===e.RGBA16F||o===e.RGBA32F)&&t.get("EXT_color_buffer_float"),o}function v(t,r){let n;return t?null===r||1014===r||1020===r?n=e.DEPTH24_STENCIL8:1015===r?n=e.DEPTH32F_STENCIL8:1012===r&&(n=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===r||1014===r||1020===r?n=e.DEPTH_COMPONENT24:1015===r?n=e.DEPTH_COMPONENT32F:1012===r&&(n=e.DEPTH_COMPONENT16),n}function x(e,t){return!0===m(e)||e.isFramebufferTexture&&1003!==e.minFilter&&1006!==e.minFilter?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function _(e){let t=e.target;t.removeEventListener("dispose",_),function(e){let t=n.get(e);if(void 0===t.__webglInit)return;let r=e.source,i=d.get(r);if(i){let n=i[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&S(e),0===Object.keys(i).length&&d.delete(r)}n.remove(e)}(t),t.isVideoTexture&&h.delete(t)}function b(t){let r=t.target;r.removeEventListener("dispose",b),function(t){let r=n.get(t);if(t.depthTexture&&(t.depthTexture.dispose(),n.remove(t.depthTexture)),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(r.__webglFramebuffer[t]))for(let n=0;n<r.__webglFramebuffer[t].length;n++)e.deleteFramebuffer(r.__webglFramebuffer[t][n]);else e.deleteFramebuffer(r.__webglFramebuffer[t]);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[t])}else{if(Array.isArray(r.__webglFramebuffer))for(let t=0;t<r.__webglFramebuffer.length;t++)e.deleteFramebuffer(r.__webglFramebuffer[t]);else e.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}let i=t.textures;for(let t=0,r=i.length;t<r;t++){let r=n.get(i[t]);r.__webglTexture&&(e.deleteTexture(r.__webglTexture),s.memory.textures--),n.remove(i[t])}n.remove(t)}(r)}function S(t){let r=n.get(t);e.deleteTexture(r.__webglTexture);let i=t.source,a=d.get(i);delete a[r.__cacheKey],s.memory.textures--}let T=0;function w(t,i){let a=n.get(t);if(t.isVideoTexture&&function(e){let t=s.render.frame;h.get(e)!==t&&(h.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&a.__version!==t.version){let e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void I(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null);r.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}let M={1e3:e.REPEAT,1001:e.CLAMP_TO_EDGE,1002:e.MIRRORED_REPEAT},E={1003:e.NEAREST,1004:e.NEAREST_MIPMAP_NEAREST,1005:e.NEAREST_MIPMAP_LINEAR,1006:e.LINEAR,1007:e.LINEAR_MIPMAP_NEAREST,1008:e.LINEAR_MIPMAP_LINEAR},R={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL};function C(r,a){if((1015===a.type&&!1===t.has("OES_texture_float_linear")&&(1006===a.magFilter||1007===a.magFilter||1005===a.magFilter||1008===a.magFilter||1006===a.minFilter||1007===a.minFilter||1005===a.minFilter||1008===a.minFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(r,e.TEXTURE_WRAP_S,M[a.wrapS]),e.texParameteri(r,e.TEXTURE_WRAP_T,M[a.wrapT]),(r===e.TEXTURE_3D||r===e.TEXTURE_2D_ARRAY)&&e.texParameteri(r,e.TEXTURE_WRAP_R,M[a.wrapR]),e.texParameteri(r,e.TEXTURE_MAG_FILTER,E[a.magFilter]),e.texParameteri(r,e.TEXTURE_MIN_FILTER,E[a.minFilter]),a.compareFunction&&(e.texParameteri(r,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(r,e.TEXTURE_COMPARE_FUNC,R[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic"))&&1003!==a.magFilter&&(1005===a.minFilter||1008===a.minFilter)&&(1015!==a.type||!1!==t.has("OES_texture_float_linear"))&&(a.anisotropy>1||n.get(a).__currentAnisotropy)){let s=t.get("EXT_texture_filter_anisotropic");e.texParameterf(r,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy}}function N(t,r){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",_));let i=r.source,a=d.get(i);void 0===a&&(a={},d.set(i,a));let o=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(r);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,n=!0),a[o].usedTimes++;let i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&S(r)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return n}function P(e,t,r){return Math.floor(Math.floor(e/r)/t)}function I(t,s,o){let l=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(l=e.TEXTURE_3D);let u=N(t,s),c=s.source;r.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);let h=n.get(c);if(c.version!==h.__version||!0===u){let t;r.activeTexture(e.TEXTURE0+o);let n=eD.getPrimaries(eD.workingColorSpace),d=""===s.colorSpace?null:eD.getPrimaries(s.colorSpace),A=""===s.colorSpace||n===d?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,A);let p=f(s.image,!1,i.maxTextureSize);p=V(s,p);let _=a.convert(s.format,s.colorSpace),b=a.convert(s.type),S=y(s.internalFormat,_,b,s.colorSpace,s.isVideoTexture);C(l,s);let T=s.mipmaps,w=!0!==s.isVideoTexture,M=void 0===h.__version||!0===u,E=c.dataReady,R=x(s,p);if(s.isDepthTexture)S=v(1027===s.format,s.type),M&&(w?r.texStorage2D(e.TEXTURE_2D,1,S,p.width,p.height):r.texImage2D(e.TEXTURE_2D,0,S,p.width,p.height,0,_,b,null));else if(s.isDataTexture)if(T.length>0){w&&M&&r.texStorage2D(e.TEXTURE_2D,R,S,T[0].width,T[0].height);for(let n=0,i=T.length;n<i;n++)t=T[n],w?E&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,_,b,t.data):r.texImage2D(e.TEXTURE_2D,n,S,t.width,t.height,0,_,b,t.data);s.generateMipmaps=!1}else w?(M&&r.texStorage2D(e.TEXTURE_2D,R,S,p.width,p.height),E&&function(t,n,i,a){let s=t.updateRanges;if(0===s.length)r.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,i,a,n.data);else{s.sort((e,t)=>e.start-t.start);let o=0;for(let e=1;e<s.length;e++){let t=s[o],r=s[e],i=t.start+t.count,a=P(r.start,n.width,4),l=P(t.start,n.width,4);r.start<=i+1&&a===l&&P(r.start+r.count-1,n.width,4)===a?t.count=Math.max(t.count,r.start+r.count-t.start):s[++o]=r}s.length=o+1;let l=e.getParameter(e.UNPACK_ROW_LENGTH),u=e.getParameter(e.UNPACK_SKIP_PIXELS),c=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,n.width);for(let t=0,o=s.length;t<o;t++){let o=s[t],l=Math.floor(o.start/4),u=Math.ceil(o.count/4),c=l%n.width,h=Math.floor(l/n.width);e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,h),r.texSubImage2D(e.TEXTURE_2D,0,c,h,u,1,i,a,n.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,c)}}(s,p,_,b)):r.texImage2D(e.TEXTURE_2D,0,S,p.width,p.height,0,_,b,p.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){w&&M&&r.texStorage3D(e.TEXTURE_2D_ARRAY,R,S,T[0].width,T[0].height,p.depth);for(let n=0,i=T.length;n<i;n++)if(t=T[n],1023!==s.format)if(null!==_)if(w){if(E)if(s.layerUpdates.size>0){let i=lf(t.width,t.height,s.format,s.type);for(let a of s.layerUpdates){let s=t.data.subarray(a*i/t.data.BYTES_PER_ELEMENT,(a+1)*i/t.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,a,t.width,t.height,1,_,s)}s.clearLayerUpdates()}else r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,0,t.width,t.height,p.depth,_,t.data)}else r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,n,S,t.width,t.height,p.depth,0,t.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else w?E&&r.texSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,0,t.width,t.height,p.depth,_,b,t.data):r.texImage3D(e.TEXTURE_2D_ARRAY,n,S,t.width,t.height,p.depth,0,_,b,t.data)}else{w&&M&&r.texStorage2D(e.TEXTURE_2D,R,S,T[0].width,T[0].height);for(let n=0,i=T.length;n<i;n++)t=T[n],1023!==s.format?null!==_?w?E&&r.compressedTexSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,_,t.data):r.compressedTexImage2D(e.TEXTURE_2D,n,S,t.width,t.height,0,t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):w?E&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,_,b,t.data):r.texImage2D(e.TEXTURE_2D,n,S,t.width,t.height,0,_,b,t.data)}else if(s.isDataArrayTexture)if(w){if(M&&r.texStorage3D(e.TEXTURE_2D_ARRAY,R,S,p.width,p.height,p.depth),E)if(s.layerUpdates.size>0){let t=lf(p.width,p.height,s.format,s.type);for(let n of s.layerUpdates){let i=p.data.subarray(n*t/p.data.BYTES_PER_ELEMENT,(n+1)*t/p.data.BYTES_PER_ELEMENT);r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,n,p.width,p.height,1,_,b,i)}s.clearLayerUpdates()}else r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,_,b,p.data)}else r.texImage3D(e.TEXTURE_2D_ARRAY,0,S,p.width,p.height,p.depth,0,_,b,p.data);else if(s.isData3DTexture)w?(M&&r.texStorage3D(e.TEXTURE_3D,R,S,p.width,p.height,p.depth),E&&r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,_,b,p.data)):r.texImage3D(e.TEXTURE_3D,0,S,p.width,p.height,p.depth,0,_,b,p.data);else if(s.isFramebufferTexture){if(M)if(w)r.texStorage2D(e.TEXTURE_2D,R,S,p.width,p.height);else{let t=p.width,n=p.height;for(let i=0;i<R;i++)r.texImage2D(e.TEXTURE_2D,i,S,t,n,0,_,b,null),t>>=1,n>>=1}}else if(T.length>0){if(w&&M){let t=q(T[0]);r.texStorage2D(e.TEXTURE_2D,R,S,t.width,t.height)}for(let n=0,i=T.length;n<i;n++)t=T[n],w?E&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,_,b,t):r.texImage2D(e.TEXTURE_2D,n,S,_,b,t);s.generateMipmaps=!1}else if(w){if(M){let t=q(p);r.texStorage2D(e.TEXTURE_2D,R,S,t.width,t.height)}E&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,_,b,p)}else r.texImage2D(e.TEXTURE_2D,0,S,_,b,p);m(s)&&g(l),h.__version=c.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function L(t,i,s,o,u,c){let h=a.convert(s.format,s.colorSpace),d=a.convert(s.type),A=y(s.internalFormat,h,d,s.colorSpace),p=n.get(i),f=n.get(s);if(f.__renderTarget=i,!p.__hasExternalTextures){let t=Math.max(1,i.width>>c),n=Math.max(1,i.height>>c);u===e.TEXTURE_3D||u===e.TEXTURE_2D_ARRAY?r.texImage3D(u,c,A,t,n,i.depth,0,h,d,null):r.texImage2D(u,c,A,t,n,0,h,d,null)}r.bindFramebuffer(e.FRAMEBUFFER,t),z(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,o,u,f.__webglTexture,0,k(i)):(u===e.TEXTURE_2D||u>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&u<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,o,u,f.__webglTexture,c),r.bindFramebuffer(e.FRAMEBUFFER,null)}function D(t,r,n){if(e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer){let i=r.depthTexture,a=i&&i.isDepthTexture?i.type:null,s=v(r.stencilBuffer,a),o=r.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=k(r);z(r)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,s,r.width,r.height):n?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,s,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,s,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,o,e.RENDERBUFFER,t)}else{let t=r.textures;for(let i=0;i<t.length;i++){let s=t[i],o=a.convert(s.format,s.colorSpace),u=a.convert(s.type),c=y(s.internalFormat,o,u,s.colorSpace),h=k(r);n&&!1===z(r)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,c,r.width,r.height):z(r)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,c,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,c,r.width,r.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function B(t,i){if(i&&i.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(e.FRAMEBUFFER,t),!(i.depthTexture&&i.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let a=n.get(i.depthTexture);a.__renderTarget=i,a.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),w(i.depthTexture,0);let s=a.__webglTexture,o=k(i);if(1026===i.depthTexture.format)z(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else if(1027===i.depthTexture.format)z(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0);else throw Error("Unknown depthTexture format")}function F(t){let i=n.get(t),a=!0===t.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==t.depthTexture){let e=t.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),e){let t=()=>{delete i.__boundDepthTexture,delete i.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),i.__depthDisposeCallback=t}i.__boundDepthTexture=e}if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw Error("target.depthTexture not supported in Cube render targets");let e=t.texture.mipmaps;e&&e.length>0?B(i.__webglFramebuffer[0],t):B(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)if(r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[n]),void 0===i.__webglDepthbuffer[n])i.__webglDepthbuffer[n]=e.createRenderbuffer(),D(i.__webglDepthbuffer[n],t,!1);else{let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,a=i.__webglDepthbuffer[n];e.bindRenderbuffer(e.RENDERBUFFER,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,a)}}else{let n=t.texture.mipmaps;if(n&&n.length>0?r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[0]):r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=e.createRenderbuffer(),D(i.__webglDepthbuffer,t,!1);else{let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,n=i.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,n),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,n)}}r.bindFramebuffer(e.FRAMEBUFFER,null)}let U=[],O=[];function k(e){return Math.min(i.maxSamples,e.samples)}function z(e){let r=n.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function V(e,t){let r=e.colorSpace,n=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||r!==$&&""!==r&&(eD.getTransfer(r)===et?(1023!==n||1009!==i)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),t}function q(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){let e=T;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=w,this.setTexture2DArray=function(t,i){let a=n.get(t);if(!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version)return void I(a,t,i);r.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){let a=n.get(t);if(!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version)return void I(a,t,i);r.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,s){let o=n.get(t);if(t.version>0&&o.__version!==t.version)return void function(t,s,o){if(6!==s.image.length)return;let l=N(t,s),u=s.source;r.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);let c=n.get(u);if(u.version!==c.__version||!0===l){let t;r.activeTexture(e.TEXTURE0+o);let n=eD.getPrimaries(eD.workingColorSpace),h=""===s.colorSpace?null:eD.getPrimaries(s.colorSpace),d=""===s.colorSpace||n===h?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let A=s.isCompressedTexture||s.image[0].isCompressedTexture,p=s.image[0]&&s.image[0].isDataTexture,v=[];for(let e=0;e<6;e++)A||p?v[e]=p?s.image[e].image:s.image[e]:v[e]=f(s.image[e],!0,i.maxCubemapSize),v[e]=V(s,v[e]);let _=v[0],b=a.convert(s.format,s.colorSpace),S=a.convert(s.type),T=y(s.internalFormat,b,S,s.colorSpace),w=!0!==s.isVideoTexture,M=void 0===c.__version||!0===l,E=u.dataReady,R=x(s,_);if(C(e.TEXTURE_CUBE_MAP,s),A){w&&M&&r.texStorage2D(e.TEXTURE_CUBE_MAP,R,T,_.width,_.height);for(let n=0;n<6;n++){t=v[n].mipmaps;for(let i=0;i<t.length;i++){let a=t[i];1023!==s.format?null!==b?w?E&&r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,0,0,a.width,a.height,b,a.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,T,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):w?E&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,0,0,a.width,a.height,b,S,a.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,T,a.width,a.height,0,b,S,a.data)}}}else{if(t=s.mipmaps,w&&M){t.length>0&&R++;let n=q(v[0]);r.texStorage2D(e.TEXTURE_CUBE_MAP,R,T,n.width,n.height)}for(let n=0;n<6;n++)if(p){w?E&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,0,0,v[n].width,v[n].height,b,S,v[n].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,T,v[n].width,v[n].height,0,b,S,v[n].data);for(let i=0;i<t.length;i++){let a=t[i].image[n].image;w?E&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,0,0,a.width,a.height,b,S,a.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,T,a.width,a.height,0,b,S,a.data)}}else{w?E&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,0,0,b,S,v[n]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,T,b,S,v[n]);for(let i=0;i<t.length;i++){let a=t[i];w?E&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,0,0,b,S,a.image[n]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,T,b,S,a.image[n])}}}m(s)&&g(e.TEXTURE_CUBE_MAP),c.__version=u.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(o,t,s);r.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,r,i){let a=n.get(t);void 0!==r&&L(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&F(t)},this.setupRenderTarget=function(t){let i=t.texture,o=n.get(t),l=n.get(i);t.addEventListener("dispose",b);let u=t.textures,c=!0===t.isWebGLCubeRenderTarget,h=u.length>1;if(!h&&(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,s.memory.textures++),c){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let r=0;r<i.mipmaps.length;r++)o.__webglFramebuffer[t][r]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,r=u.length;t<r;t++){let r=n.get(u[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===z(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let r=0;r<u.length;r++){let n=u[r];o.__webglColorRenderbuffer[r]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[r]);let i=a.convert(n.format,n.colorSpace),s=a.convert(n.type),l=y(n.internalFormat,i,s,n.colorSpace,!0===t.isXRRenderTarget),c=k(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,c,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+r,e.RENDERBUFFER,o.__webglColorRenderbuffer[r])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),D(o.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(c){r.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),C(e.TEXTURE_CUBE_MAP,i);for(let r=0;r<6;r++)if(i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)L(o.__webglFramebuffer[r][n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n);else L(o.__webglFramebuffer[r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0);m(i)&&g(e.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(h){for(let i=0,a=u.length;i<a;i++){let a=u[i],s=n.get(a),l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(l,s.__webglTexture),C(l,a),L(o.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+i,l,0),m(a)&&g(l)}r.unbindTexture()}else{let n=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(n=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(n,l.__webglTexture),C(n,i),i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)L(o.__webglFramebuffer[r],t,i,e.COLOR_ATTACHMENT0,n,r);else L(o.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,n,0);m(i)&&g(n),r.unbindTexture()}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(t){let i=t.textures;for(let a=0,s=i.length;a<s;a++){let s=i[a];if(m(s)){let i=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D,a=n.get(s).__webglTexture;r.bindTexture(i,a),g(i),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0){if(!1===z(t)){let i=t.textures,a=t.width,s=t.height,o=e.COLOR_BUFFER_BIT,l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=n.get(t),h=i.length>1;if(h)for(let t=0;t<i.length;t++)r.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),r.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);r.bindFramebuffer(e.READ_FRAMEBUFFER,c.__webglMultisampledFramebuffer);let d=t.texture.mipmaps;d&&d.length>0?r.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglFramebuffer[0]):r.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglFramebuffer);for(let r=0;r<i.length;r++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,c.__webglColorRenderbuffer[r]);let t=n.get(i[r]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,s,0,0,a,s,o,e.NEAREST),!0===u&&(U.length=0,O.length=0,U.push(e.COLOR_ATTACHMENT0+r),t.depthBuffer&&!1===t.resolveDepthBuffer&&(U.push(l),O.push(l),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,O)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,U))}if(r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<i.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,c.__webglColorRenderbuffer[t]);let a=n.get(i[t]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&u){let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[r])}}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=L,this.useMultisampledRTT=z}function c_(e,t){return{convert:function(r){let n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=eD.getTransfer(i);if(1009===r)return e.UNSIGNED_BYTE;if(1017===r)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===r)return e.UNSIGNED_SHORT_5_5_5_1;if(35902===r)return e.UNSIGNED_INT_5_9_9_9_REV;if(35899===r)return e.UNSIGNED_INT_10F_11F_11F_REV;if(1010===r)return e.BYTE;if(1011===r)return e.SHORT;if(1012===r)return e.UNSIGNED_SHORT;if(1013===r)return e.INT;if(1014===r)return e.UNSIGNED_INT;if(1015===r)return e.FLOAT;if(1016===r)return e.HALF_FLOAT;if(1021===r)return e.ALPHA;if(1022===r)return e.RGB;if(1023===r)return e.RGBA;if(1026===r)return e.DEPTH_COMPONENT;if(1027===r)return e.DEPTH_STENCIL;if(1028===r)return e.RED;if(1029===r)return e.RED_INTEGER;if(1030===r)return e.RG;if(1031===r)return e.RG_INTEGER;if(1033===r)return e.RGBA_INTEGER;if(33776===r||33777===r||33778===r||33779===r)if(a===et){if(null===(n=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(33776===r)return n.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===r)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===r)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===r)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===r)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===r)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===r)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===r)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===r||35841===r||35842===r||35843===r){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===r)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===r)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===r)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===r)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===r||37492===r||37496===r){if(null===(n=t.get("WEBGL_compressed_texture_etc")))return null;if(36196===r||37492===r)return a===et?n.COMPRESSED_SRGB8_ETC2:n.COMPRESSED_RGB8_ETC2;if(37496===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:n.COMPRESSED_RGBA8_ETC2_EAC}if(37808===r||37809===r||37810===r||37811===r||37812===r||37813===r||37814===r||37815===r||37816===r||37817===r||37818===r||37819===r||37820===r||37821===r){if(null===(n=t.get("WEBGL_compressed_texture_astc")))return null;if(37808===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:n.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:n.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:n.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:n.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:n.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:n.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:n.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:n.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:n.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:n.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:n.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:n.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:n.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===r)return a===et?n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:n.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===r||36494===r||36495===r){if(null===(n=t.get("EXT_texture_compression_bptc")))return null;if(36492===r)return a===et?n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:n.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===r)return n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===r)return n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===r||36284===r||36285===r||36286===r){if(null===(n=t.get("EXT_texture_compression_rgtc")))return null;if(36283===r)return n.COMPRESSED_RED_RGTC1_EXT;if(36284===r)return n.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===r)return n.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===r)return n.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return 1020===r?e.UNSIGNED_INT_24_8:void 0!==e[r]?e[r]:null}}}class cb{init(e,t){if(null===this.texture){let r=new iB(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=r}}getMesh(e){if(null!==this.texture&&null===this.mesh){let t=e.cameras[0].viewport,r=new rH({vertexShader:"\nvoid main() {\n\n	gl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n	if ( coord.x >= 1.0 ) {\n\n		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n	} else {\n\n		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n	}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new rU(new aP(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}}class cS extends es{constructor(e,t){super();let r=this,n=null,i=1,a=null,s="local-floor",o=1,l=null,u=null,c=null,h=null,d=null,A=null,p="undefined"!=typeof XRWebGLBinding,f=new cb,m={},g=t.getContextAttributes(),y=null,v=null,x=[],_=[],b=new ey,S=null,T=new rY;T.viewport=new eH;let w=new rY;w.viewport=new eH;let M=[T,w],E=new s5,R=null,C=null;function N(e){let t=_.indexOf(e.inputSource);if(-1===t)return;let r=x[t];void 0!==r&&(r.update(e.inputSource,e.frame,l||a),r.dispatchEvent({type:e.type,data:e.inputSource}))}function P(){n.removeEventListener("select",N),n.removeEventListener("selectstart",N),n.removeEventListener("selectend",N),n.removeEventListener("squeeze",N),n.removeEventListener("squeezestart",N),n.removeEventListener("squeezeend",N),n.removeEventListener("end",P),n.removeEventListener("inputsourceschange",I);for(let e=0;e<x.length;e++){let t=_[e];null!==t&&(_[e]=null,x[e].disconnect(t))}for(let e in R=null,C=null,f.reset(),m)delete m[e];e.setRenderTarget(y),d=null,h=null,c=null,n=null,v=null,U.stop(),r.isPresenting=!1,e.setPixelRatio(S),e.setSize(b.width,b.height,!1),r.dispatchEvent({type:"sessionend"})}function I(e){for(let t=0;t<e.removed.length;t++){let r=e.removed[t],n=_.indexOf(r);n>=0&&(_[n]=null,x[n].disconnect(r))}for(let t=0;t<e.added.length;t++){let r=e.added[t],n=_.indexOf(r);if(-1===n){for(let e=0;e<x.length;e++)if(e>=_.length){_.push(r),n=e;break}else if(null===_[e]){_[e]=r,n=e;break}if(-1===n)break}let i=x[n];i&&i.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=x[e];return void 0===t&&(t=new r1,x[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=x[e];return void 0===t&&(t=new r1,x[e]=t),t.getGripSpace()},this.getHand=function(e){let t=x[e];return void 0===t&&(t=new r1,x[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return null===c&&p&&(c=new XRWebGLBinding(n,t)),c},this.getFrame=function(){return A},this.getSession=function(){return n},this.setSession=async function(u){if(null!==(n=u)){if(y=e.getRenderTarget(),n.addEventListener("select",N),n.addEventListener("selectstart",N),n.addEventListener("selectend",N),n.addEventListener("squeeze",N),n.addEventListener("squeezestart",N),n.addEventListener("squeezeend",N),n.addEventListener("end",P),n.addEventListener("inputsourceschange",I),!0!==g.xrCompatible&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(b),p&&"createProjectionLayer"in XRWebGLBinding.prototype){let r=null,a=null,s=null;g.depth&&(s=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,r=g.stencil?1027:1026,a=g.stencil?1020:1014);let o={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:i};h=(c=this.getBinding()).createProjectionLayer(o),n.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),v=new eW(h.textureWidth,h.textureHeight,{format:1023,type:1009,depthTexture:new iD(h.textureWidth,h.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:4*!!g.antialias,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else{let r={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(n,t,r),n.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),v=new eW(d.framebufferWidth,d.framebufferHeight,{format:1023,type:1009,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}v.isXRRenderTarget=!0,this.setFoveation(o),l=null,a=await n.requestReferenceSpace(s),U.setContext(n),U.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode},this.getDepthTexture=function(){return f.getDepthTexture()};let L=new ex,D=new ex;function B(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){var t,r,i;if(null===n)return;let a=e.near,s=e.far;null!==f.texture&&(f.depthNear>0&&(a=f.depthNear),f.depthFar>0&&(s=f.depthFar)),E.near=w.near=T.near=a,E.far=w.far=T.far=s,(R!==E.near||C!==E.far)&&(n.updateRenderState({depthNear:E.near,depthFar:E.far}),R=E.near,C=E.far),E.layers.mask=6|e.layers.mask,T.layers.mask=3&E.layers.mask,w.layers.mask=5&E.layers.mask;let o=e.parent,l=E.cameras;B(E,o);for(let e=0;e<l.length;e++)B(l[e],o);2===l.length?function(e,t,r){L.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(r.matrixWorld);let n=L.distanceTo(D),i=t.projectionMatrix.elements,a=r.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=n/(-c+h),A=-(d*c);if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(A),e.translateZ(d),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{let t=s+d,r=o+d;e.projectionMatrix.makePerspective(s*c-A,s*h+(n-A),l*o/r*t,u*o/r*t,t,r),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(E,T,w):E.projectionMatrix.copy(T.projectionMatrix),t=e,r=E,null===(i=o)?t.matrix.copy(r.matrixWorld):(t.matrix.copy(i.matrixWorld),t.matrix.invert(),t.matrix.multiply(r.matrixWorld)),t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(r.projectionMatrix),t.projectionMatrixInverse.copy(r.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*ec*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)},this.getCamera=function(){return E},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(e){o=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==f.texture},this.getDepthSensingMesh=function(){return f.getMesh(E)},this.getCameraTexture=function(e){return m[e]};let F=null,U=new lg;U.setAnimationLoop(function(t,i){if(u=i.getViewerPose(l||a),A=i,null!==u){let t=u.views;null!==d&&(e.setRenderTargetFramebuffer(v,d.framebuffer),e.setRenderTarget(v));let i=!1;t.length!==E.cameras.length&&(E.cameras.length=0,i=!0);for(let r=0;r<t.length;r++){let n=t[r],a=null;if(null!==d)a=d.getViewport(n);else{let t=c.getViewSubImage(h,n);a=t.viewport,0===r&&(e.setRenderTargetTextures(v,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(v))}let s=M[r];void 0===s&&((s=new rY).layers.enable(r),s.viewport=new eH,M[r]=s),s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(n.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(a.x,a.y,a.width,a.height),0===r&&(E.matrix.copy(s.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),!0===i&&E.cameras.push(s)}let a=n.enabledFeatures;if(a&&a.includes("depth-sensing")&&"gpu-optimized"==n.depthUsage&&p){let e=(c=r.getBinding()).getDepthInformation(t[0]);e&&e.isValid&&e.texture&&f.init(e,n.renderState)}if(a&&a.includes("camera-access")&&p){e.state.unbindTexture(),c=r.getBinding();for(let e=0;e<t.length;e++){let r=t[e].camera;if(r){let e=m[r];e||(e=new iB,m[r]=e);let t=c.getCameraImage(r);e.sourceTexture=t}}}}for(let e=0;e<x.length;e++){let t=_[e],r=x[e];null!==t&&void 0!==r&&r.update(t,i,l||a)}F&&F(t,i),i.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:i}),A=null}),this.setAnimationLoop=function(e){F=e},this.dispose=function(){}}}let cT=new tT,cw=new tp;function cM(e,t){function r(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function n(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map,r(n.map,e.mapTransform)),n.alphaMap&&(e.alphaMap.value=n.alphaMap,r(n.alphaMap,e.alphaMapTransform)),n.bumpMap&&(e.bumpMap.value=n.bumpMap,r(n.bumpMap,e.bumpMapTransform),e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,r(n.normalMap,e.normalMapTransform),e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,r(n.displacementMap,e.displacementMapTransform),e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap,r(n.emissiveMap,e.emissiveMapTransform)),n.specularMap&&(e.specularMap.value=n.specularMap,r(n.specularMap,e.specularMapTransform)),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);let i=t.get(n),a=i.envMap,s=i.envMapRotation;a&&(e.envMap.value=a,cT.copy(s),cT.x*=-1,cT.y*=-1,cT.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(cT.y*=-1,cT.z*=-1),e.envMapRotation.value.setFromMatrix4(cw.makeRotationFromEuler(cT)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity,r(n.lightMap,e.lightMapTransform)),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity,r(n.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,r){r.color.getRGB(t.fogColor.value,rq(e)),r.isFog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r.isFogExp2&&(t.fogDensity.value=r.density)},refreshMaterialUniforms:function(e,i,a,s,o){var l,u,c,h,d,A,p,f,m,g,y,v,x,_,b,S,T,w,M,E,R;i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(e,i):i.isMeshToonMaterial?(n(e,i),l=e,(u=i).gradientMap&&(l.gradientMap.value=u.gradientMap)):i.isMeshPhongMaterial?(n(e,i),c=e,h=i,c.specular.value.copy(h.specular),c.shininess.value=Math.max(h.shininess,1e-4)):i.isMeshStandardMaterial?(n(e,i),d=e,A=i,d.metalness.value=A.metalness,A.metalnessMap&&(d.metalnessMap.value=A.metalnessMap,r(A.metalnessMap,d.metalnessMapTransform)),d.roughness.value=A.roughness,A.roughnessMap&&(d.roughnessMap.value=A.roughnessMap,r(A.roughnessMap,d.roughnessMapTransform)),A.envMap&&(d.envMapIntensity.value=A.envMapIntensity),i.isMeshPhysicalMaterial&&(p=e,f=i,m=o,p.ior.value=f.ior,f.sheen>0&&(p.sheenColor.value.copy(f.sheenColor).multiplyScalar(f.sheen),p.sheenRoughness.value=f.sheenRoughness,f.sheenColorMap&&(p.sheenColorMap.value=f.sheenColorMap,r(f.sheenColorMap,p.sheenColorMapTransform)),f.sheenRoughnessMap&&(p.sheenRoughnessMap.value=f.sheenRoughnessMap,r(f.sheenRoughnessMap,p.sheenRoughnessMapTransform))),f.clearcoat>0&&(p.clearcoat.value=f.clearcoat,p.clearcoatRoughness.value=f.clearcoatRoughness,f.clearcoatMap&&(p.clearcoatMap.value=f.clearcoatMap,r(f.clearcoatMap,p.clearcoatMapTransform)),f.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=f.clearcoatRoughnessMap,r(f.clearcoatRoughnessMap,p.clearcoatRoughnessMapTransform)),f.clearcoatNormalMap&&(p.clearcoatNormalMap.value=f.clearcoatNormalMap,r(f.clearcoatNormalMap,p.clearcoatNormalMapTransform),p.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),1===f.side&&p.clearcoatNormalScale.value.negate())),f.dispersion>0&&(p.dispersion.value=f.dispersion),f.iridescence>0&&(p.iridescence.value=f.iridescence,p.iridescenceIOR.value=f.iridescenceIOR,p.iridescenceThicknessMinimum.value=f.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=f.iridescenceThicknessRange[1],f.iridescenceMap&&(p.iridescenceMap.value=f.iridescenceMap,r(f.iridescenceMap,p.iridescenceMapTransform)),f.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=f.iridescenceThicknessMap,r(f.iridescenceThicknessMap,p.iridescenceThicknessMapTransform))),f.transmission>0&&(p.transmission.value=f.transmission,p.transmissionSamplerMap.value=m.texture,p.transmissionSamplerSize.value.set(m.width,m.height),f.transmissionMap&&(p.transmissionMap.value=f.transmissionMap,r(f.transmissionMap,p.transmissionMapTransform)),p.thickness.value=f.thickness,f.thicknessMap&&(p.thicknessMap.value=f.thicknessMap,r(f.thicknessMap,p.thicknessMapTransform)),p.attenuationDistance.value=f.attenuationDistance,p.attenuationColor.value.copy(f.attenuationColor)),f.anisotropy>0&&(p.anisotropyVector.value.set(f.anisotropy*Math.cos(f.anisotropyRotation),f.anisotropy*Math.sin(f.anisotropyRotation)),f.anisotropyMap&&(p.anisotropyMap.value=f.anisotropyMap,r(f.anisotropyMap,p.anisotropyMapTransform))),p.specularIntensity.value=f.specularIntensity,p.specularColor.value.copy(f.specularColor),f.specularColorMap&&(p.specularColorMap.value=f.specularColorMap,r(f.specularColorMap,p.specularColorMapTransform)),f.specularIntensityMap&&(p.specularIntensityMap.value=f.specularIntensityMap,r(f.specularIntensityMap,p.specularIntensityMapTransform)))):i.isMeshMatcapMaterial?(n(e,i),g=e,(y=i).matcap&&(g.matcap.value=y.matcap)):i.isMeshDepthMaterial?n(e,i):i.isMeshDistanceMaterial?(n(e,i),function(e,r){let n=t.get(r).light;e.referencePosition.value.setFromMatrixPosition(n.matrixWorld),e.nearDistance.value=n.shadow.camera.near,e.farDistance.value=n.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?n(e,i):i.isLineBasicMaterial?(v=e,x=i,v.diffuse.value.copy(x.color),v.opacity.value=x.opacity,x.map&&(v.map.value=x.map,r(x.map,v.mapTransform)),i.isLineDashedMaterial&&(_=e,b=i,_.dashSize.value=b.dashSize,_.totalSize.value=b.dashSize+b.gapSize,_.scale.value=b.scale)):i.isPointsMaterial?(S=e,T=i,w=a,M=s,S.diffuse.value.copy(T.color),S.opacity.value=T.opacity,S.size.value=T.size*w,S.scale.value=.5*M,T.map&&(S.map.value=T.map,r(T.map,S.uvTransform)),T.alphaMap&&(S.alphaMap.value=T.alphaMap,r(T.alphaMap,S.alphaMapTransform)),T.alphaTest>0&&(S.alphaTest.value=T.alphaTest)):i.isSpriteMaterial?(E=e,R=i,E.diffuse.value.copy(R.color),E.opacity.value=R.opacity,E.rotation.value=R.rotation,R.map&&(E.map.value=R.map,r(R.map,E.mapTransform)),R.alphaMap&&(E.alphaMap.value=R.alphaMap,r(R.alphaMap,E.alphaMapTransform)),R.alphaTest>0&&(E.alphaTest.value=R.alphaTest)):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function cE(e,t,r,n){let i={},a={},s=[],o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e){let t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){let r=t.target;r.removeEventListener("dispose",u);let n=s.indexOf(r.__bindingPointIndex);s.splice(n,1),e.deleteBuffer(i[r.id]),delete i[r.id],delete a[r.id]}return{bind:function(e,t){let r=t.program;n.uniformBlockBinding(e,r)},update:function(r,c){let h=i[r.id];void 0===h&&(function(e){let t=e.uniforms,r=0;for(let e=0,n=t.length;e<n;e++){let n=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=n.length;e<t;e++){let t=n[e],i=Array.isArray(t.value)?t.value:[t.value];for(let e=0,n=i.length;e<n;e++){let n=l(i[e]),a=r%16,s=a%n.boundary,o=a+s;r+=s,0!==o&&16-o<n.storage&&(r+=16-o),t.__data=new Float32Array(n.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=r,r+=n.storage}}}let n=r%16;n>0&&(r+=16-n),e.__size=r,e.__cache={}}(r),h=function(t){let r=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=r;let n=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,n),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,r,n),n}(r),i[r.id]=h,r.addEventListener("dispose",u));let d=c.program;n.updateUBOMapping(r,d);let A=t.render.frame;a[r.id]!==A&&(function(t){let r=i[t.id],n=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,r);for(let t=0,r=n.length;t<r;t++){let r=Array.isArray(n[t])?n[t]:[n[t]];for(let n=0,i=r.length;n<i;n++){let i=r[n];if(!0===function(e,t,r,n){let i=e.value,a=t+"_"+r;if(void 0===n[a])return"number"==typeof i||"boolean"==typeof i?n[a]=i:n[a]=i.clone(),!0;{let e=n[a];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return n[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}(i,t,n,a)){let t=i.__offset,r=Array.isArray(i.value)?i.value:[i.value],n=0;for(let a=0;a<r.length;a++){let s=r[a],o=l(s);"number"==typeof s||"boolean"==typeof s?(i.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,t+n,i.__data)):s.isMatrix3?(i.__data[0]=s.elements[0],i.__data[1]=s.elements[1],i.__data[2]=s.elements[2],i.__data[3]=0,i.__data[4]=s.elements[3],i.__data[5]=s.elements[4],i.__data[6]=s.elements[5],i.__data[7]=0,i.__data[8]=s.elements[6],i.__data[9]=s.elements[7],i.__data[10]=s.elements[8],i.__data[11]=0):(s.toArray(i.__data,n),n+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(r),a[r.id]=A)},dispose:function(){for(let t in i)e.deleteBuffer(i[t]);s=[],i={},a={}}}}class cR{get coordinateSystem(){return 2e3}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=eD._getDrawingBufferColorSpace(e),t.unpackColorSpace=eD._getUnpackColorSpace()}constructor(e={}){let t,r,n,i,a,s,o,l,u,c,h,d,A,p,f,m,g,y,v,x,_,b,S,T,w,{canvas:M=eC(),context:E=null,depth:R=!0,stencil:C=!1,alpha:N=!1,antialias:P=!1,premultipliedAlpha:I=!0,preserveDrawingBuffer:L=!1,powerPreference:D="default",failIfMajorPerformanceCaveat:B=!1,reversedDepthBuffer:F=!1}=e;if(this.isWebGLRenderer=!0,null!==E){if("undefined"!=typeof WebGLRenderingContext&&E instanceof WebGLRenderingContext)throw Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");t=E.getContextAttributes().alpha}else t=N;let U=new Uint32Array(4),O=new Int32Array(4),k=null,z=null,V=[],q=[];this.domElement=M,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;let G=this,H=!1;this._outputColorSpace=J;let j=0,W=0,X=null,Q=-1,Y=null,K=new eH,Z=new eH,ee=null,et=new t6(0),er=0,en=M.width,ei=M.height,ea=1,es=null,eo=null,el=new eH(0,0,en,ei),eu=new eH(0,0,en,ei),ec=!1,eh=new nX,ed=!1,eA=!1,ep=new tp,ef=new ex,em=new eH,eg={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},ey=!1;function ev(){return null===X?ea:1}let e_=E;function eb(e,t){return M.getContext(e,t)}try{if("setAttribute"in M&&M.setAttribute("data-engine","three.js r".concat("180")),M.addEventListener("webglcontextlost",ew,!1),M.addEventListener("webglcontextrestored",eM,!1),M.addEventListener("webglcontextcreationerror",eE,!1),null===e_){let e="webgl2";if(e_=eb(e,{alpha:!0,depth:R,stencil:C,antialias:P,premultipliedAlpha:I,preserveDrawingBuffer:L,powerPreference:D,failIfMajorPerformanceCaveat:B}),null===e_)if(eb(e))throw Error("Error creating WebGL context with your selected attributes.");else throw Error("Error creating WebGL context.")}}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function eS(){(r=new lY(e_)).init(),S=new c_(e_,r),n=new lR(e_,r,e,S),i=new cv(e_,r),n.reversedDepthBuffer&&F&&i.buffers.depth.setReversed(!0),a=new lJ(e_),s=new cs,o=new cx(e_,r,i,s,n,S,a),l=new lN(G),u=new lQ(G),c=new ly(e_),T=new lM(e_,c),h=new lK(e_,c,a,T),d=new l0(e_,h,c,a),x=new l$(e_,n,o),g=new lC(s),A=new ca(G,l,u,r,n,T,g),p=new cM(G,s),f=new cc,m=new cm(r),v=new lw(G,l,u,i,d,t,I),y=new cg(G,d,n),w=new cE(e_,a,n,i),_=new lE(e_,r,a),b=new lZ(e_,r,a),a.programs=A.programs,G.capabilities=n,G.extensions=r,G.properties=s,G.renderLists=f,G.shadowMap=y,G.state=i,G.info=a}eS();let eT=new cS(G,e_);function ew(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function eM(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;let e=a.autoReset,t=y.enabled,r=y.autoUpdate,n=y.needsUpdate,i=y.type;eS(),a.autoReset=e,y.enabled=t,y.autoUpdate=r,y.needsUpdate=n,y.type=i}function eE(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function eR(e){var t;let r=e.target;r.removeEventListener("dispose",eR),function(e){let t=s.get(e).programs;void 0!==t&&(t.forEach(function(e){A.releaseProgram(e)}),e.isShaderMaterial&&A.releaseShaderCache(e))}(t=r),s.remove(t)}function eN(e,t,r){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,eq(e,t,r),e.side=0,e.needsUpdate=!0,eq(e,t,r),e.side=2):eq(e,t,r)}this.xr=eT,this.getContext=function(){return e_},this.getContextAttributes=function(){return e_.getContextAttributes()},this.forceContextLoss=function(){let e=r.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=r.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return ea},this.setPixelRatio=function(e){void 0!==e&&(ea=e,this.setSize(en,ei,!1))},this.getSize=function(e){return e.set(en,ei)},this.setSize=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(eT.isPresenting)return void console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");en=e,ei=t,M.width=Math.floor(e*ea),M.height=Math.floor(t*ea),!0===r&&(M.style.width=e+"px",M.style.height=t+"px"),this.setViewport(0,0,e,t)},this.getDrawingBufferSize=function(e){return e.set(en*ea,ei*ea).floor()},this.setDrawingBufferSize=function(e,t,r){en=e,ei=t,ea=r,M.width=Math.floor(e*r),M.height=Math.floor(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(K)},this.getViewport=function(e){return e.copy(el)},this.setViewport=function(e,t,r,n){e.isVector4?el.set(e.x,e.y,e.z,e.w):el.set(e,t,r,n),i.viewport(K.copy(el).multiplyScalar(ea).round())},this.getScissor=function(e){return e.copy(eu)},this.setScissor=function(e,t,r,n){e.isVector4?eu.set(e.x,e.y,e.z,e.w):eu.set(e,t,r,n),i.scissor(Z.copy(eu).multiplyScalar(ea).round())},this.getScissorTest=function(){return ec},this.setScissorTest=function(e){i.setScissorTest(ec=e)},this.setOpaqueSort=function(e){es=e},this.setTransparentSort=function(e){eo=e},this.getClearColor=function(e){return e.copy(v.getClearColor())},this.setClearColor=function(){v.setClearColor(...arguments)},this.getClearAlpha=function(){return v.getClearAlpha()},this.setClearAlpha=function(){v.setClearAlpha(...arguments)},this.clear=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=0;if(e){let e=!1;if(null!==X){let t=X.texture.format;e=1033===t||1031===t||1029===t}if(e){let e=X.texture.type,t=1009===e||1014===e||1012===e||1020===e||1017===e||1018===e,r=v.getClearColor(),n=v.getClearAlpha(),i=r.r,a=r.g,s=r.b;t?(U[0]=i,U[1]=a,U[2]=s,U[3]=n,e_.clearBufferuiv(e_.COLOR,0,U)):(O[0]=i,O[1]=a,O[2]=s,O[3]=n,e_.clearBufferiv(e_.COLOR,0,O))}else n|=e_.COLOR_BUFFER_BIT}t&&(n|=e_.DEPTH_BUFFER_BIT),r&&(n|=e_.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(0xffffffff)),e_.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){M.removeEventListener("webglcontextlost",ew,!1),M.removeEventListener("webglcontextrestored",eM,!1),M.removeEventListener("webglcontextcreationerror",eE,!1),v.dispose(),f.dispose(),m.dispose(),s.dispose(),l.dispose(),u.dispose(),d.dispose(),T.dispose(),w.dispose(),A.dispose(),eT.dispose(),eT.removeEventListener("sessionstart",eL),eT.removeEventListener("sessionend",eB),eF.stop()},this.renderBufferDirect=function(e,t,a,d,A,f){let m;null===t&&(t=eg);let y=A.isMesh&&0>A.matrixWorld.determinant(),v=function(e,t,r,a,c){var h,d;!0!==t.isScene&&(t=eg),o.resetTextureUnits();let A=t.fog,f=a.isMeshStandardMaterial?t.environment:null,m=null===X?G.outputColorSpace:!0===X.isXRRenderTarget?X.texture.colorSpace:$,y=(a.isMeshStandardMaterial?u:l).get(a.envMap||f),v=!0===a.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,_=!!r.attributes.tangent&&(!!a.normalMap||a.anisotropy>0),b=!!r.morphAttributes.position,S=!!r.morphAttributes.normal,T=!!r.morphAttributes.color,M=0;a.toneMapped&&(null===X||!0===X.isXRRenderTarget)&&(M=G.toneMapping);let E=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,R=void 0!==E?E.length:0,C=s.get(a),N=z.state.lights;if(!0===ed&&(!0===eA||e!==Y)){let t=e===Y&&a.id===Q;g.setState(a,e,t)}let P=!1;a.version===C.__version?C.needsLights&&C.lightsStateVersion!==N.state.version||C.outputColorSpace!==m||c.isBatchedMesh&&!1===C.batching?P=!0:c.isBatchedMesh||!0!==C.batching?c.isBatchedMesh&&!0===C.batchingColor&&null===c.colorTexture||c.isBatchedMesh&&!1===C.batchingColor&&null!==c.colorTexture||c.isInstancedMesh&&!1===C.instancing?P=!0:c.isInstancedMesh||!0!==C.instancing?c.isSkinnedMesh&&!1===C.skinning?P=!0:c.isSkinnedMesh||!0!==C.skinning?c.isInstancedMesh&&!0===C.instancingColor&&null===c.instanceColor||c.isInstancedMesh&&!1===C.instancingColor&&null!==c.instanceColor||c.isInstancedMesh&&!0===C.instancingMorph&&null===c.morphTexture||c.isInstancedMesh&&!1===C.instancingMorph&&null!==c.morphTexture||C.envMap!==y||!0===a.fog&&C.fog!==A||void 0!==C.numClippingPlanes&&(C.numClippingPlanes!==g.numPlanes||C.numIntersection!==g.numIntersection)||C.vertexAlphas!==v||C.vertexTangents!==_||C.morphTargets!==b||C.morphNormals!==S||C.morphColors!==T||C.toneMapping!==M?P=!0:C.morphTargetsCount!==R&&(P=!0):P=!0:P=!0:P=!0:(P=!0,C.__version=a.version);let I=C.currentProgram;!0===P&&(I=eq(a,t,c));let L=!1,D=!1,B=!1,F=I.getUniforms(),U=C.uniforms;if(i.useProgram(I.program)&&(L=!0,D=!0,B=!0),a.id!==Q&&(Q=a.id,D=!0),L||Y!==e){i.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),F.setValue(e_,"projectionMatrix",e.projectionMatrix),F.setValue(e_,"viewMatrix",e.matrixWorldInverse);let t=F.map.cameraPosition;void 0!==t&&t.setValue(e_,ef.setFromMatrixPosition(e.matrixWorld)),n.logarithmicDepthBuffer&&F.setValue(e_,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(a.isMeshPhongMaterial||a.isMeshToonMaterial||a.isMeshLambertMaterial||a.isMeshBasicMaterial||a.isMeshStandardMaterial||a.isShaderMaterial)&&F.setValue(e_,"isOrthographic",!0===e.isOrthographicCamera),Y!==e&&(Y=e,D=!0,B=!0)}if(c.isSkinnedMesh){F.setOptional(e_,c,"bindMatrix"),F.setOptional(e_,c,"bindMatrixInverse");let e=c.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),F.setValue(e_,"boneTexture",e.boneTexture,o))}c.isBatchedMesh&&(F.setOptional(e_,c,"batchingTexture"),F.setValue(e_,"batchingTexture",c._matricesTexture,o),F.setOptional(e_,c,"batchingIdTexture"),F.setValue(e_,"batchingIdTexture",c._indirectTexture,o),F.setOptional(e_,c,"batchingColorTexture"),null!==c._colorsTexture&&F.setValue(e_,"batchingColorTexture",c._colorsTexture,o));let O=r.morphAttributes;if((void 0!==O.position||void 0!==O.normal||void 0!==O.color)&&x.update(c,r,I),(D||C.receiveShadow!==c.receiveShadow)&&(C.receiveShadow=c.receiveShadow,F.setValue(e_,"receiveShadow",c.receiveShadow)),a.isMeshGouraudMaterial&&null!==a.envMap&&(U.envMap.value=y,U.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1),a.isMeshStandardMaterial&&null===a.envMap&&null!==t.environment&&(U.envMapIntensity.value=t.environmentIntensity),D&&(F.setValue(e_,"toneMappingExposure",G.toneMappingExposure),C.needsLights&&(h=U,d=B,h.ambientLightColor.needsUpdate=d,h.lightProbe.needsUpdate=d,h.directionalLights.needsUpdate=d,h.directionalLightShadows.needsUpdate=d,h.pointLights.needsUpdate=d,h.pointLightShadows.needsUpdate=d,h.spotLights.needsUpdate=d,h.spotLightShadows.needsUpdate=d,h.rectAreaLights.needsUpdate=d,h.hemisphereLights.needsUpdate=d),A&&!0===a.fog&&p.refreshFogUniforms(U,A),p.refreshMaterialUniforms(U,a,ea,ei,z.state.transmissionRenderTarget[e.id]),uQ.upload(e_,eG(C),U,o)),a.isShaderMaterial&&!0===a.uniformsNeedUpdate&&(uQ.upload(e_,eG(C),U,o),a.uniformsNeedUpdate=!1),a.isSpriteMaterial&&F.setValue(e_,"center",c.center),F.setValue(e_,"modelViewMatrix",c.modelViewMatrix),F.setValue(e_,"normalMatrix",c.normalMatrix),F.setValue(e_,"modelMatrix",c.matrixWorld),a.isShaderMaterial||a.isRawShaderMaterial){let e=a.uniformsGroups;for(let t=0,r=e.length;t<r;t++){let r=e[t];w.update(r,I),w.bind(r,I)}}return I}(e,t,a,d,A);i.setMaterial(d,y);let S=a.index,M=1;if(!0===d.wireframe){if(void 0===(S=h.getWireframeAttribute(a)))return;M=2}let E=a.drawRange,R=a.attributes.position,C=E.start*M,N=(E.start+E.count)*M;null!==f&&(C=Math.max(C,f.start*M),N=Math.min(N,(f.start+f.count)*M)),null!==S?(C=Math.max(C,0),N=Math.min(N,S.count)):null!=R&&(C=Math.max(C,0),N=Math.min(N,R.count));let P=N-C;if(P<0||P===1/0)return;T.setup(A,d,v,a,S);let I=_;if(null!==S&&(m=c.get(S),(I=b).setIndex(m)),A.isMesh)!0===d.wireframe?(i.setLineWidth(d.wireframeLinewidth*ev()),I.setMode(e_.LINES)):I.setMode(e_.TRIANGLES);else if(A.isLine){let e=d.linewidth;void 0===e&&(e=1),i.setLineWidth(e*ev()),A.isLineSegments?I.setMode(e_.LINES):A.isLineLoop?I.setMode(e_.LINE_LOOP):I.setMode(e_.LINE_STRIP)}else A.isPoints?I.setMode(e_.POINTS):A.isSprite&&I.setMode(e_.TRIANGLES);if(A.isBatchedMesh)if(null!==A._multiDrawInstances)eP("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),I.renderMultiDrawInstances(A._multiDrawStarts,A._multiDrawCounts,A._multiDrawCount,A._multiDrawInstances);else if(r.get("WEBGL_multi_draw"))I.renderMultiDraw(A._multiDrawStarts,A._multiDrawCounts,A._multiDrawCount);else{let e=A._multiDrawStarts,t=A._multiDrawCounts,r=A._multiDrawCount,n=S?c.get(S).bytesPerElement:1,i=s.get(d).currentProgram.getUniforms();for(let a=0;a<r;a++)i.setValue(e_,"_gl_DrawID",a),I.render(e[a]/n,t[a])}else if(A.isInstancedMesh)I.renderInstances(C,P,A.count);else if(a.isInstancedBufferGeometry){let e=void 0!==a._maxInstanceCount?a._maxInstanceCount:1/0,t=Math.min(a.instanceCount,e);I.renderInstances(C,P,t)}else I.render(C,P)},this.compile=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=e),(z=m.get(r)).init(t),q.push(z),r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(z.pushLight(e),e.castShadow&&z.pushShadow(e))}),e!==r&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(z.pushLight(e),e.castShadow&&z.pushShadow(e))}),z.setupLights();let n=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;let t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){let a=t[i];eN(a,r,e),n.add(a)}else eN(t,r,e),n.add(t)}),z=q.pop(),n},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.compile(e,t,n);return new Promise(t=>{function n(){if(i.forEach(function(e){s.get(e).currentProgram.isReady()&&i.delete(e)}),0===i.size)return void t(e);setTimeout(n,10)}null!==r.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let eI=null;function eL(){eF.stop()}function eB(){eF.start()}let eF=new lg;function eU(e,t,r,n){if(!1===e.visible)return;if(e.layers.test(t.layers)){if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)z.pushLight(e),e.castShadow&&z.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||eh.intersectsSprite(e)){n&&em.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ep);let t=d.update(e),i=e.material;i.visible&&k.push(e,t,i,r,em.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||eh.intersectsObject(e))){let t=d.update(e),i=e.material;if(n&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),em.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),em.copy(t.boundingSphere.center)),em.applyMatrix4(e.matrixWorld).applyMatrix4(ep)),Array.isArray(i)){let n=t.groups;for(let a=0,s=n.length;a<s;a++){let s=n[a],o=i[s.materialIndex];o&&o.visible&&k.push(e,t,o,r,em.z,s)}}else i.visible&&k.push(e,t,i,r,em.z,null)}}let i=e.children;for(let e=0,a=i.length;e<a;e++)eU(i[e],t,r,n)}function eO(e,t,r,n){let a=e.opaque,s=e.transmissive,o=e.transparent;z.setupLightsView(r),!0===ed&&g.setGlobalState(G.clippingPlanes,r),n&&i.viewport(K.copy(n)),a.length>0&&ez(a,t,r),s.length>0&&ez(s,t,r),o.length>0&&ez(o,t,r),i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),i.setPolygonOffset(!1)}function ek(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===z.state.transmissionRenderTarget[i.id]&&(z.state.transmissionRenderTarget[i.id]=new eW(1,1,{generateMipmaps:!0,type:r.has("EXT_color_buffer_half_float")||r.has("EXT_color_buffer_float")?1016:1009,minFilter:1008,samples:4,stencilBuffer:C,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:eD.workingColorSpace}));let a=z.state.transmissionRenderTarget[i.id],s=i.viewport||K;a.setSize(s.z*G.transmissionResolutionScale,s.w*G.transmissionResolutionScale);let l=G.getRenderTarget(),u=G.getActiveCubeFace(),c=G.getActiveMipmapLevel();G.setRenderTarget(a),G.getClearColor(et),(er=G.getClearAlpha())<1&&G.setClearColor(0xffffff,.5),G.clear(),ey&&v.render(n);let h=G.toneMapping;G.toneMapping=0;let d=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),z.setupLightsView(i),!0===ed&&g.setGlobalState(G.clippingPlanes,i),ez(e,n,i),o.updateMultisampleRenderTarget(a),o.updateRenderTargetMipmap(a),!1===r.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,a=t.length;r<a;r++){let a=t[r],s=a.object,o=a.geometry,l=a.material,u=a.group;if(2===l.side&&s.layers.test(i.layers)){let t=l.side;l.side=1,l.needsUpdate=!0,eV(s,n,i,o,l,u),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(o.updateMultisampleRenderTarget(a),o.updateRenderTargetMipmap(a))}G.setRenderTarget(l,u,c),G.setClearColor(et,er),void 0!==d&&(i.viewport=d),G.toneMapping=h}function ez(e,t,r){let n=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){let a=e[i],s=a.object,o=a.geometry,l=a.group,u=a.material;!0===u.allowOverride&&null!==n&&(u=n),s.layers.test(r.layers)&&eV(s,t,r,o,u,l)}}function eV(e,t,r,n,i,a){e.onBeforeRender(G,t,r,n,i,a),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(G,t,r,n,e,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,G.renderBufferDirect(r,t,n,i,e,a),i.side=0,i.needsUpdate=!0,G.renderBufferDirect(r,t,n,i,e,a),i.side=2):G.renderBufferDirect(r,t,n,i,e,a),e.onAfterRender(G,t,r,n,i,a)}function eq(e,t,r){var n;!0!==t.isScene&&(t=eg);let i=s.get(e),a=z.state.lights,o=z.state.shadowsArray,c=a.state.version,h=A.getParameters(e,a.state,o,t,r),d=A.getProgramCacheKey(h),p=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?u:l).get(e.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===p&&(e.addEventListener("dispose",eR),i.programs=p=new Map);let f=p.get(d);if(void 0!==f){if(i.currentProgram===f&&i.lightsStateVersion===c)return ej(e,h),f}else h.uniforms=A.getUniforms(e),e.onBeforeCompile(h,G),f=A.acquireProgram(h,d),p.set(d,f),i.uniforms=h.uniforms;let m=i.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(m.clippingPlanes=g.uniform),ej(e,h),i.needsLights=(n=e).isMeshLambertMaterial||n.isMeshToonMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.isShadowMaterial||n.isShaderMaterial&&!0===n.lights,i.lightsStateVersion=c,i.needsLights&&(m.ambientLightColor.value=a.state.ambient,m.lightProbe.value=a.state.probe,m.directionalLights.value=a.state.directional,m.directionalLightShadows.value=a.state.directionalShadow,m.spotLights.value=a.state.spot,m.spotLightShadows.value=a.state.spotShadow,m.rectAreaLights.value=a.state.rectArea,m.ltc_1.value=a.state.rectAreaLTC1,m.ltc_2.value=a.state.rectAreaLTC2,m.pointLights.value=a.state.point,m.pointLightShadows.value=a.state.pointShadow,m.hemisphereLights.value=a.state.hemi,m.directionalShadowMap.value=a.state.directionalShadowMap,m.directionalShadowMatrix.value=a.state.directionalShadowMatrix,m.spotShadowMap.value=a.state.spotShadowMap,m.spotLightMatrix.value=a.state.spotLightMatrix,m.spotLightMap.value=a.state.spotLightMap,m.pointShadowMap.value=a.state.pointShadowMap,m.pointShadowMatrix.value=a.state.pointShadowMatrix),i.currentProgram=f,i.uniformsList=null,f}function eG(e){if(null===e.uniformsList){let t=e.currentProgram.getUniforms();e.uniformsList=uQ.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function ej(e,t){let r=s.get(e);r.outputColorSpace=t.outputColorSpace,r.batching=t.batching,r.batchingColor=t.batchingColor,r.instancing=t.instancing,r.instancingColor=t.instancingColor,r.instancingMorph=t.instancingMorph,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}eF.setAnimationLoop(function(e){eI&&eI(e)}),"undefined"!=typeof self&&eF.setContext(self),this.setAnimationLoop=function(e){eI=e,eT.setAnimationLoop(e),null===e?eF.stop():eF.start()},eT.addEventListener("sessionstart",eL),eT.addEventListener("sessionend",eB),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===H)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===eT.enabled&&!0===eT.isPresenting&&(!0===eT.cameraAutoUpdate&&eT.updateCamera(t),t=eT.getCamera()),!0===e.isScene&&e.onBeforeRender(G,e,t,X),(z=m.get(e,q.length)).init(t),q.push(z),ep.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),eh.setFromProjectionMatrix(ep,2e3,t.reversedDepth),eA=this.localClippingEnabled,ed=g.init(this.clippingPlanes,eA),(k=f.get(e,V.length)).init(),V.push(k),!0===eT.enabled&&!0===eT.isPresenting){let e=G.xr.getDepthSensingMesh();null!==e&&eU(e,t,-1/0,G.sortObjects)}eU(e,t,0,G.sortObjects),k.finish(),!0===G.sortObjects&&k.sort(es,eo),(ey=!1===eT.enabled||!1===eT.isPresenting||!1===eT.hasDepthSensing())&&v.addToRenderList(k,e),this.info.render.frame++,!0===ed&&g.beginShadows();let r=z.state.shadowsArray;y.render(r,e,t),!0===ed&&g.endShadows(),!0===this.info.autoReset&&this.info.reset();let n=k.opaque,i=k.transmissive;if(z.setupLights(),t.isArrayCamera){let r=t.cameras;if(i.length>0)for(let t=0,a=r.length;t<a;t++)ek(n,i,e,r[t]);ey&&v.render(e);for(let t=0,n=r.length;t<n;t++){let n=r[t];eO(k,e,n,n.viewport)}}else i.length>0&&ek(n,i,e,t),ey&&v.render(e),eO(k,e,t);null!==X&&0===W&&(o.updateMultisampleRenderTarget(X),o.updateRenderTargetMipmap(X)),!0===e.isScene&&e.onAfterRender(G,e,t),T.resetDefaultState(),Q=-1,Y=null,q.pop(),q.length>0?(z=q[q.length-1],!0===ed&&g.setGlobalState(G.clippingPlanes,z.state.camera)):z=null,V.pop(),k=V.length>0?V[V.length-1]:null},this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return W},this.getRenderTarget=function(){return X},this.setRenderTargetTextures=function(e,t,r){let n=s.get(e);n.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===n.__autoAllocateDepthBuffer&&(n.__useRenderToTexture=!1),s.get(e.texture).__webglTexture=t,s.get(e.depthTexture).__webglTexture=n.__autoAllocateDepthBuffer?void 0:r,n.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){let r=s.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t};let eX=e_.createFramebuffer();this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;X=e,j=t,W=r;let n=!0,a=null,l=!1,u=!1;if(e){let c=s.get(e);if(void 0!==c.__useDefaultFramebuffer)i.bindFramebuffer(e_.FRAMEBUFFER,null),n=!1;else if(void 0===c.__webglFramebuffer)o.setupRenderTarget(e);else if(c.__hasExternalTextures)o.rebindTextures(e,s.get(e.texture).__webglTexture,s.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){let t=e.depthTexture;if(c.__boundDepthTexture!==t){if(null!==t&&s.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");o.setupDepthRenderbuffer(e)}}let h=e.texture;(h.isData3DTexture||h.isDataArrayTexture||h.isCompressedArrayTexture)&&(u=!0);let d=s.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(a=Array.isArray(d[t])?d[t][r]:d[t],l=!0):a=e.samples>0&&!1===o.useMultisampledRTT(e)?s.get(e).__webglMultisampledFramebuffer:Array.isArray(d)?d[r]:d,K.copy(e.viewport),Z.copy(e.scissor),ee=e.scissorTest}else K.copy(el).multiplyScalar(ea).floor(),Z.copy(eu).multiplyScalar(ea).floor(),ee=ec;if(0!==r&&(a=eX),i.bindFramebuffer(e_.FRAMEBUFFER,a)&&n&&i.drawBuffers(e,a),i.viewport(K),i.scissor(Z),i.setScissorTest(ee),l){let n=s.get(e.texture);e_.framebufferTexture2D(e_.FRAMEBUFFER,e_.COLOR_ATTACHMENT0,e_.TEXTURE_CUBE_MAP_POSITIVE_X+t,n.__webglTexture,r)}else if(u)for(let n=0;n<e.textures.length;n++){let i=s.get(e.textures[n]);e_.framebufferTextureLayer(e_.FRAMEBUFFER,e_.COLOR_ATTACHMENT0+n,i.__webglTexture,r,t)}else if(null!==e&&0!==r){let t=s.get(e.texture);e_.framebufferTexture2D(e_.FRAMEBUFFER,e_.COLOR_ATTACHMENT0,e_.TEXTURE_2D,t.__webglTexture,r)}Q=-1},this.readRenderTargetPixels=function(e,t,r,a,o,l,u){let c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!(e&&e.isWebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let h=s.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==u&&(h=h[u]),h){i.bindFramebuffer(e_.FRAMEBUFFER,h);try{let i=e.textures[c],s=i.format,u=i.type;if(!n.textureFormatReadable(s))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!n.textureTypeReadable(u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-a&&r>=0&&r<=e.height-o&&(e.textures.length>1&&e_.readBuffer(e_.COLOR_ATTACHMENT0+c),e_.readPixels(t,r,a,o,S.convert(s),S.convert(u),l))}finally{let e=null!==X?s.get(X).__webglFramebuffer:null;i.bindFramebuffer(e_.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,r,a,o,l,u){let c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!(e&&e.isWebGLRenderTarget))throw Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let h=s.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==u&&(h=h[u]),h)if(t>=0&&t<=e.width-a&&r>=0&&r<=e.height-o){var d;i.bindFramebuffer(e_.FRAMEBUFFER,h);let u=e.textures[c],A=u.format,p=u.type;if(!n.textureFormatReadable(A))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!n.textureTypeReadable(p))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");let f=e_.createBuffer();e_.bindBuffer(e_.PIXEL_PACK_BUFFER,f),e_.bufferData(e_.PIXEL_PACK_BUFFER,l.byteLength,e_.STREAM_READ),e.textures.length>1&&e_.readBuffer(e_.COLOR_ATTACHMENT0+c),e_.readPixels(t,r,a,o,S.convert(A),S.convert(p),0);let m=null!==X?s.get(X).__webglFramebuffer:null;i.bindFramebuffer(e_.FRAMEBUFFER,m);let g=e_.fenceSync(e_.SYNC_GPU_COMMANDS_COMPLETE,0);return e_.flush(),await (d=e_,new Promise(function(e,t){setTimeout(function r(){switch(d.clientWaitSync(g,d.SYNC_FLUSH_COMMANDS_BIT,0)){case d.WAIT_FAILED:t();break;case d.TIMEOUT_EXPIRED:setTimeout(r,4);break;default:e()}},4)})),e_.bindBuffer(e_.PIXEL_PACK_BUFFER,f),e_.getBufferSubData(e_.PIXEL_PACK_BUFFER,0,l),e_.deleteBuffer(f),e_.deleteSync(g),l}else throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.pow(2,-r),a=Math.floor(e.image.width*n),s=Math.floor(e.image.height*n),l=null!==t?t.x:0,u=null!==t?t.y:0;o.setTexture2D(e,0),e_.copyTexSubImage2D(e_.TEXTURE_2D,r,0,0,l,u,a,s),i.unbindTexture()};let eQ=e_.createFramebuffer(),eY=e_.createFramebuffer();this.copyTextureToTexture=function(e,t){let r,n,a,l,u,c,h,d,A,p,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===y&&(0!==g?(eP("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),y=g,g=0):y=0);let v=e.isCompressedTexture?e.mipmaps[y]:e.image;if(null!==f)r=f.max.x-f.min.x,n=f.max.y-f.min.y,a=f.isBox3?f.max.z-f.min.z:1,l=f.min.x,u=f.min.y,c=f.isBox3?f.min.z:0;else{let t=Math.pow(2,-g);r=Math.floor(v.width*t),n=Math.floor(v.height*t),a=e.isDataArrayTexture?v.depth:e.isData3DTexture?Math.floor(v.depth*t):1,l=0,u=0,c=0}null!==m?(h=m.x,d=m.y,A=m.z):(h=0,d=0,A=0);let x=S.convert(t.format),_=S.convert(t.type);t.isData3DTexture?(o.setTexture3D(t,0),p=e_.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(o.setTexture2DArray(t,0),p=e_.TEXTURE_2D_ARRAY):(o.setTexture2D(t,0),p=e_.TEXTURE_2D),e_.pixelStorei(e_.UNPACK_FLIP_Y_WEBGL,t.flipY),e_.pixelStorei(e_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e_.pixelStorei(e_.UNPACK_ALIGNMENT,t.unpackAlignment);let b=e_.getParameter(e_.UNPACK_ROW_LENGTH),T=e_.getParameter(e_.UNPACK_IMAGE_HEIGHT),w=e_.getParameter(e_.UNPACK_SKIP_PIXELS),M=e_.getParameter(e_.UNPACK_SKIP_ROWS),E=e_.getParameter(e_.UNPACK_SKIP_IMAGES);e_.pixelStorei(e_.UNPACK_ROW_LENGTH,v.width),e_.pixelStorei(e_.UNPACK_IMAGE_HEIGHT,v.height),e_.pixelStorei(e_.UNPACK_SKIP_PIXELS,l),e_.pixelStorei(e_.UNPACK_SKIP_ROWS,u),e_.pixelStorei(e_.UNPACK_SKIP_IMAGES,c);let R=e.isDataArrayTexture||e.isData3DTexture,C=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){let o=s.get(e),p=s.get(t),f=s.get(o.__renderTarget),m=s.get(p.__renderTarget);i.bindFramebuffer(e_.READ_FRAMEBUFFER,f.__webglFramebuffer),i.bindFramebuffer(e_.DRAW_FRAMEBUFFER,m.__webglFramebuffer);for(let i=0;i<a;i++)R&&(e_.framebufferTextureLayer(e_.READ_FRAMEBUFFER,e_.COLOR_ATTACHMENT0,s.get(e).__webglTexture,g,c+i),e_.framebufferTextureLayer(e_.DRAW_FRAMEBUFFER,e_.COLOR_ATTACHMENT0,s.get(t).__webglTexture,y,A+i)),e_.blitFramebuffer(l,u,r,n,h,d,r,n,e_.DEPTH_BUFFER_BIT,e_.NEAREST);i.bindFramebuffer(e_.READ_FRAMEBUFFER,null),i.bindFramebuffer(e_.DRAW_FRAMEBUFFER,null)}else if(0!==g||e.isRenderTargetTexture||s.has(e)){let o=s.get(e),f=s.get(t);i.bindFramebuffer(e_.READ_FRAMEBUFFER,eQ),i.bindFramebuffer(e_.DRAW_FRAMEBUFFER,eY);for(let e=0;e<a;e++)R?e_.framebufferTextureLayer(e_.READ_FRAMEBUFFER,e_.COLOR_ATTACHMENT0,o.__webglTexture,g,c+e):e_.framebufferTexture2D(e_.READ_FRAMEBUFFER,e_.COLOR_ATTACHMENT0,e_.TEXTURE_2D,o.__webglTexture,g),C?e_.framebufferTextureLayer(e_.DRAW_FRAMEBUFFER,e_.COLOR_ATTACHMENT0,f.__webglTexture,y,A+e):e_.framebufferTexture2D(e_.DRAW_FRAMEBUFFER,e_.COLOR_ATTACHMENT0,e_.TEXTURE_2D,f.__webglTexture,y),0!==g?e_.blitFramebuffer(l,u,r,n,h,d,r,n,e_.COLOR_BUFFER_BIT,e_.NEAREST):C?e_.copyTexSubImage3D(p,y,h,d,A+e,l,u,r,n):e_.copyTexSubImage2D(p,y,h,d,l,u,r,n);i.bindFramebuffer(e_.READ_FRAMEBUFFER,null),i.bindFramebuffer(e_.DRAW_FRAMEBUFFER,null)}else C?e.isDataTexture||e.isData3DTexture?e_.texSubImage3D(p,y,h,d,A,r,n,a,x,_,v.data):t.isCompressedArrayTexture?e_.compressedTexSubImage3D(p,y,h,d,A,r,n,a,x,v.data):e_.texSubImage3D(p,y,h,d,A,r,n,a,x,_,v):e.isDataTexture?e_.texSubImage2D(e_.TEXTURE_2D,y,h,d,r,n,x,_,v.data):e.isCompressedTexture?e_.compressedTexSubImage2D(e_.TEXTURE_2D,y,h,d,v.width,v.height,x,v.data):e_.texSubImage2D(e_.TEXTURE_2D,y,h,d,r,n,x,_,v);e_.pixelStorei(e_.UNPACK_ROW_LENGTH,b),e_.pixelStorei(e_.UNPACK_IMAGE_HEIGHT,T),e_.pixelStorei(e_.UNPACK_SKIP_PIXELS,w),e_.pixelStorei(e_.UNPACK_SKIP_ROWS,M),e_.pixelStorei(e_.UNPACK_SKIP_IMAGES,E),0===y&&t.generateMipmaps&&e_.generateMipmap(p),i.unbindTexture()},this.initRenderTarget=function(e){void 0===s.get(e).__webglFramebuffer&&o.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?o.setTextureCube(e,0):e.isData3DTexture?o.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?o.setTexture2DArray(e,0):o.setTexture2D(e,0),i.unbindTexture()},this.resetState=function(){j=0,W=0,X=null,i.reset(),T.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}let cC=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var cN=e.g&&e.g.Object===Object&&e.g,cP="object"==typeof self&&self&&self.Object===Object&&self,cI=cN||cP||Function("return this")();let cL=function(){return cI.Date.now()};var cD=/\s/;let cB=function(e){for(var t=e.length;t--&&cD.test(e.charAt(t)););return t};var cF=/^\s+/,cU=cI.Symbol,cO=Object.prototype,ck=cO.hasOwnProperty,cz=cO.toString,cV=cU?cU.toStringTag:void 0;let cq=function(e){var t=ck.call(e,cV),r=e[cV];try{e[cV]=void 0;var n=!0}catch(e){}var i=cz.call(e);return n&&(t?e[cV]=r:delete e[cV]),i};var cG=Object.prototype.toString,cH=cU?cU.toStringTag:void 0;let cj=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":cH&&cH in Object(e)?cq(e):cG.call(e)},cW=function(e){return"symbol"==typeof e||null!=e&&"object"==typeof e&&"[object Symbol]"==cj(e)};var cX=0/0,cQ=/^[-+]0x[0-9a-f]+$/i,cY=/^0b[01]+$/i,cK=/^0o[0-7]+$/i,cZ=parseInt;let cJ=function(e){if("number"==typeof e)return e;if(cW(e))return cX;if(cC(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=cC(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=(t=e)?t.slice(0,cB(t)+1).replace(cF,""):t;var n=cY.test(e);return n||cK.test(e)?cZ(e.slice(2),n?2:8):cQ.test(e)?cX:+e};var c$=Math.max,c0=Math.min;let c1=function(e,t,r){var n,i,a,s,o,l,u=0,c=!1,h=!1,d=!0;if("function"!=typeof e)throw TypeError("Expected a function");function A(t){var r=n,a=i;return n=i=void 0,u=t,s=e.apply(a,r)}function p(e){var r=e-l,n=e-u;return void 0===l||r>=t||r<0||h&&n>=a}function f(){var e,r,n,i=cL();if(p(i))return m(i);o=setTimeout(f,(e=i-l,r=i-u,n=t-e,h?c0(n,a-r):n))}function m(e){return(o=void 0,d&&n)?A(e):(n=i=void 0,s)}function g(){var e,r=cL(),a=p(r);if(n=arguments,i=this,l=r,a){if(void 0===o)return u=e=l,o=setTimeout(f,t),c?A(e):s;if(h)return clearTimeout(o),o=setTimeout(f,t),A(l)}return void 0===o&&(o=setTimeout(f,t)),s}return t=cJ(t)||0,cC(r)&&(c=!!r.leading,a=(h="maxWait"in r)?c$(cJ(r.maxWait)||0,t):a,d="trailing"in r?!!r.trailing:d),g.cancel=function(){void 0!==o&&clearTimeout(o),u=0,n=l=i=o=void 0},g.flush=function(){return void 0===o?s:m(cL())},g};function c2(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var c3=function(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(t,r){var n=r.default,i=r.triggerUpdate,a=r.onChange;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");this.name=t,this.defaultVal=void 0===n?null:n,this.triggerUpdate=void 0===i||i,this.onChange=void 0===a?function(e,t){}:a});function c4(e){var t=e.stateInit,r=void 0===t?function(){return{}}:t,n=e.props,i=void 0===n?{}:n,a=e.methods,s=void 0===a?{}:a,o=e.aliases,l=void 0===o?{}:o,u=e.init,c=void 0===u?function(){}:u,h=e.update,d=void 0===h?function(){}:h,A=Object.keys(i).map(function(e){return new c3(e,i[e])});return function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=!!(this instanceof e?this.constructor:void 0),o=a?n.shift():void 0,u=n[0],h=void 0===u?{}:u,p=Object.assign({},r instanceof Function?r(h):r,{initialised:!1}),f={};function m(e){return g(e,h),y(),m}var g=function(e,t){c.call(m,e,p,t),p.initialised=!0},y=c1(function(){p.initialised&&(d.call(m,p,f),f={})},1);return A.forEach(function(e){var t,r,n,i,a,s,o,l;m[e.name]=(r=(t=e).name,i=void 0!==(n=t.triggerUpdate)&&n,s=void 0===(a=t.onChange)?function(e,t){}:a,l=void 0===(o=t.defaultVal)?null:o,function(e){var t=p[r];if(!arguments.length)return t;var n=void 0===e?l:e;return p[r]=n,s.call(m,n,p,t),f.hasOwnProperty(r)||(f[r]=t),i&&y(),m})}),Object.keys(s).forEach(function(e){m[e]=function(){for(var t,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=s[e]).call.apply(t,[m,p].concat(n))}}),Object.entries(l).forEach(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{a=(r=r.call(e)).next,!1;for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(e,2)||function(e,t){if(e){if("string"==typeof e)return c2(e,2);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c2(e,t):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=t[0],n=t[1];return m[r]=m[n]}),m.resetProps=function(){return A.forEach(function(e){m[e.name](e.defaultVal)}),m},m.resetProps(),p._rerender=y,a&&o&&m(o),m}}var c5=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1}}),Back:Object.freeze({In:function(e){return 1===e?1:e*e*(2.70158*e-1.70158)},Out:function(e){return 0===e?0:--e*e*(2.70158*e+1.70158)+1},InOut:function(e){return(e*=2)<1?e*e*(3.5949095*e-2.5949095)*.5:.5*((e-=2)*e*(3.5949095*e+2.5949095)+2)}}),Bounce:Object.freeze({In:function(e){return 1-c5.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*c5.Bounce.In(2*e):.5*c5.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),c6=function(){return performance.now()},c7=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=c6()),void 0===t&&(t=!1);var r=Object.keys(this._tweens);if(0===r.length)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<r.length;n++){var i=this._tweens[r[n]],a=!t;i&&!1===i.update(e,a)&&!t&&delete this._tweens[r[n]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),c8={Linear:function(e,t){var r=e.length-1,n=r*t,i=Math.floor(n),a=c8.Utils.Linear;return t<0?a(e[0],e[1],n):t>1?a(e[r],e[r-1],r-n):a(e[i],e[i+1>r?r:i+1],n-i)},Bezier:function(e,t){for(var r=0,n=e.length-1,i=Math.pow,a=c8.Utils.Bernstein,s=0;s<=n;s++)r+=i(1-t,n-s)*i(t,s)*e[s]*a(n,s);return r},CatmullRom:function(e,t){var r=e.length-1,n=r*t,i=Math.floor(n),a=c8.Utils.CatmullRom;return e[0]===e[r]?(t<0&&(i=Math.floor(n=r*(1+t))),a(e[(i-1+r)%r],e[i],e[(i+1)%r],e[(i+2)%r],n-i)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[r]-(a(e[r],e[r],e[r-1],e[r-1],n-r)-e[r]):a(e[i?i-1:0],e[i],e[r<i+1?r:i+1],e[r<i+2?r:i+2],n-i)},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=c8.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t])return e[t];for(var n=t;n>1;n--)r*=n;return e[t]=r,r}}(),CatmullRom:function(e,t,r,n,i){var a=(r-e)*.5,s=(n-t)*.5,o=i*i;return i*o*(2*t-2*r+a+s)+(-3*t+3*r-2*a-s)*o+a*i+t}}},c9=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),he=new c7,ht=function(){function e(e,t){void 0===t&&(t=he),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=c5.Linear.None,this._interpolationFunction=c8.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=c9.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=c6()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var r in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var n={};for(var i in this._valuesEnd)n[i]=this._valuesEnd[i];this._valuesEnd=n}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,r,n,i){for(var a in r){var s=e[a],o=Array.isArray(s),l=o?"array":typeof s,u=!o&&Array.isArray(r[a]);if("undefined"!==l&&"function"!==l){if(u){var c=r[a];if(0===c.length)continue;for(var h=[s],d=0,A=c.length;d<A;d+=1){var p=this._handleRelativeValue(s,c[d]);if(isNaN(p)){u=!1,console.warn("Found invalid interpolation list. Skipping.");break}h.push(p)}u&&(r[a]=h)}if(("object"===l||o)&&s&&!u){for(var f in t[a]=o?[]:{},s)t[a][f]=s[f];n[a]=o?[]:{};var c=r[a];if(!this._isDynamic){var m={};for(var f in c)m[f]=c[f];r[a]=c=m}this._setupProperties(s,t[a],c,n[a],i)}else(void 0===t[a]||i)&&(t[a]=s),o||(t[a]*=1),u?n[a]=r[a].slice().reverse():n[a]=t[a]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying&&(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object)),this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=c6()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=c6()),this._isPaused&&this._isPlaying&&(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this)),this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return void 0===e&&(e=he),this._group=e,this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=c5.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=c8.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){var r,n,i=this;if(void 0===e&&(e=c6()),void 0===t&&(t=!0),this._isPaused)return!0;var a=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>a)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var s=e-this._startTime,o=this._duration+(null!=(r=this._repeatDelayTime)?r:this._delayTime),l=this._duration+this._repeat*o,u=function(){if(0===i._duration||s>l)return 1;var e=Math.trunc(s/o),t=Math.min((s-e*o)/i._duration,1);return 0===t&&s===i._duration?1:t}(),c=this._easingFunction(u);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&this._onUpdateCallback(this._object,u),0===this._duration||s>=this._duration)if(this._repeat>0){var h=Math.min(Math.trunc((s-this._duration)/o)+1,this._repeat);for(n in isFinite(this._repeat)&&(this._repeat-=h),this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];this._yoyo&&(this._reversed=!this._reversed),this._startTime+=o*h,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var d=0,A=this._chainedTweens.length;d<A;d++)this._chainedTweens[d].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,r,n){for(var i in r)if(void 0!==t[i]){var a=t[i]||0,s=r[i],o=Array.isArray(e[i]),l=Array.isArray(s);!o&&l?e[i]=this._interpolationFunction(s,n):"object"==typeof s&&s?this._updateProperties(e[i],a,s,n):"number"==typeof(s=this._handleRelativeValue(a,s))&&(e[i]=a+(s-a)*n)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],r=this._valuesEnd[e];"string"==typeof r?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(r):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},e}();function hr(e,t,r,n,i){if(isNaN(t)||isNaN(r)||isNaN(n))return e;var a,s,o,l,u,c,h,d,A,p,f,m,g=e._root,y={data:i},v=e._x0,x=e._y0,_=e._z0,b=e._x1,S=e._y1,T=e._z1;if(!g)return e._root=y,e;for(;g.length;)if((d=t>=(s=(v+b)/2))?v=s:b=s,(A=r>=(o=(x+S)/2))?x=o:S=o,(p=n>=(l=(_+T)/2))?_=l:T=l,a=g,!(g=g[f=p<<2|A<<1|d]))return a[f]=y,e;if(u=+e._x.call(null,g.data),c=+e._y.call(null,g.data),h=+e._z.call(null,g.data),t===u&&r===c&&n===h)return y.next=g,a?a[f]=y:e._root=y,e;do a=a?a[f]=Array(8):e._root=Array(8),(d=t>=(s=(v+b)/2))?v=s:b=s,(A=r>=(o=(x+S)/2))?x=o:S=o,(p=n>=(l=(_+T)/2))?_=l:T=l;while((f=p<<2|A<<1|d)==(m=(h>=l)<<2|(c>=o)<<1|u>=s))return a[m]=g,a[f]=y,e}function hn(e,t,r,n,i,a,s){this.node=e,this.x0=t,this.y0=r,this.z0=n,this.x1=i,this.y1=a,this.z1=s}c9.nextId,he.getAll.bind(he),he.removeAll.bind(he),he.add.bind(he),he.remove.bind(he),he.update.bind(he);let hi=(e,t,r,n,i,a)=>Math.sqrt((e-n)**2+(t-i)**2+(r-a)**2);function ha(e){return e[0]}function hs(e){return e[1]}function ho(e){return e[2]}function hl(e,t,r,n){var i=new hu(null==t?ha:t,null==r?hs:r,null==n?ho:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function hu(e,t,r,n,i,a,s,o,l){this._x=e,this._y=t,this._z=r,this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this._root=void 0}function hc(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var hh=hl.prototype=hu.prototype;hh.copy=function(){var e,t,r=new hu(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=hc(n),r;for(e=[{source:n,target:r._root=Array(8)}];n=e.pop();)for(var i=0;i<8;++i)(t=n.source[i])&&(t.length?e.push({source:t,target:n.target[i]=Array(8)}):n.target[i]=hc(t));return r},hh.add=function(e){let t=+this._x.call(null,e),r=+this._y.call(null,e),n=+this._z.call(null,e);return hr(this.cover(t,r,n),t,r,n,e)},hh.addAll=function(e){Array.isArray(e)||(e=Array.from(e));let t=e.length,r=new Float64Array(t),n=new Float64Array(t),i=new Float64Array(t),a=1/0,s=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h=0,d,A,p,f;h<t;++h)!(isNaN(A=+this._x.call(null,d=e[h]))||isNaN(p=+this._y.call(null,d))||isNaN(f=+this._z.call(null,d)))&&(r[h]=A,n[h]=p,i[h]=f,A<a&&(a=A),A>l&&(l=A),p<s&&(s=p),p>u&&(u=p),f<o&&(o=f),f>c&&(c=f));if(a>l||s>u||o>c)return this;this.cover(a,s,o).cover(l,u,c);for(let a=0;a<t;++a)hr(this,r[a],n[a],i[a],e[a]);return this},hh.cover=function(e,t,r){if(isNaN(e*=1)||isNaN(t*=1)||isNaN(r*=1))return this;var n=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,l=this._z1;if(isNaN(n))s=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1,l=(a=Math.floor(r))+1;else{for(var u,c,h=s-n||1,d=this._root;n>e||e>=s||i>t||t>=o||a>r||r>=l;)switch(c=(r<a)<<2|(t<i)<<1|e<n,(u=Array(8))[c]=d,d=u,h*=2,c){case 0:s=n+h,o=i+h,l=a+h;break;case 1:n=s-h,o=i+h,l=a+h;break;case 2:s=n+h,i=o-h,l=a+h;break;case 3:n=s-h,i=o-h,l=a+h;break;case 4:s=n+h,o=i+h,a=l-h;break;case 5:n=s-h,o=i+h,a=l-h;break;case 6:s=n+h,i=o-h,a=l-h;break;case 7:n=s-h,i=o-h,a=l-h}this._root&&this._root.length&&(this._root=d)}return this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this},hh.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},hh.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},hh.find=function(e,t,r,n){var i,a,s,o,l,u,c,h,d,A=this._x0,p=this._y0,f=this._z0,m=this._x1,g=this._y1,y=this._z1,v=[],x=this._root;for(x&&v.push(new hn(x,A,p,f,m,g,y)),null==n?n=1/0:(A=e-n,p=t-n,f=r-n,m=e+n,g=t+n,y=r+n,n*=n);h=v.pop();)if((x=h.node)&&!((a=h.x0)>m)&&!((s=h.y0)>g)&&!((o=h.z0)>y)&&!((l=h.x1)<A)&&!((u=h.y1)<p)&&!((c=h.z1)<f))if(x.length){var _=(a+l)/2,b=(s+u)/2,S=(o+c)/2;v.push(new hn(x[7],_,b,S,l,u,c),new hn(x[6],a,b,S,_,u,c),new hn(x[5],_,s,S,l,b,c),new hn(x[4],a,s,S,_,b,c),new hn(x[3],_,b,o,l,u,S),new hn(x[2],a,b,o,_,u,S),new hn(x[1],_,s,o,l,b,S),new hn(x[0],a,s,o,_,b,S)),(d=(r>=S)<<2|(t>=b)<<1|e>=_)&&(h=v[v.length-1],v[v.length-1]=v[v.length-1-d],v[v.length-1-d]=h)}else{var T=e-this._x.call(null,x.data),w=t-this._y.call(null,x.data),M=r-this._z.call(null,x.data),E=T*T+w*w+M*M;if(E<n){var R=Math.sqrt(n=E);A=e-R,p=t-R,f=r-R,m=e+R,g=t+R,y=r+R,i=x.data}}return i},hh.findAllWithinRadius=function(e,t,r,n){let i=[],a=e-n,s=t-n,o=r-n,l=e+n,u=t+n,c=r+n;return this.visit((h,d,A,p,f,m,g)=>{if(!h.length)do{let a=h.data;hi(e,t,r,this._x(a),this._y(a),this._z(a))<=n&&i.push(a)}while(h=h.next)return d>l||A>u||p>c||f<a||m<s||g<o}),i},hh.remove=function(e){if(isNaN(a=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e))||isNaN(o=+this._z.call(null,e)))return this;var t,r,n,i,a,s,o,l,u,c,h,d,A,p,f,m=this._root,g=this._x0,y=this._y0,v=this._z0,x=this._x1,_=this._y1,b=this._z1;if(!m)return this;if(m.length)for(;;){if((h=a>=(l=(g+x)/2))?g=l:x=l,(d=s>=(u=(y+_)/2))?y=u:_=u,(A=o>=(c=(v+b)/2))?v=c:b=c,t=m,!(m=m[p=A<<2|d<<1|h]))return this;if(!m.length)break;(t[p+1&7]||t[p+2&7]||t[p+3&7]||t[p+4&7]||t[p+5&7]||t[p+6&7]||t[p+7&7])&&(r=t,f=p)}for(;m.data!==e;)if(n=m,!(m=m.next))return this;return((i=m.next)&&delete m.next,n)?i?n.next=i:delete n.next:t?(i?t[p]=i:delete t[p],(m=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&m===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!m.length&&(r?r[f]=m:this._root=m)):this._root=i,this},hh.removeAll=function(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this},hh.root=function(){return this._root},hh.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},hh.visit=function(e){var t,r,n,i,a,s,o,l,u=[],c=this._root;for(c&&u.push(new hn(c,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=u.pop();)if(!e(c=t.node,n=t.x0,i=t.y0,a=t.z0,s=t.x1,o=t.y1,l=t.z1)&&c.length){var h=(n+s)/2,d=(i+o)/2,A=(a+l)/2;(r=c[7])&&u.push(new hn(r,h,d,A,s,o,l)),(r=c[6])&&u.push(new hn(r,n,d,A,h,o,l)),(r=c[5])&&u.push(new hn(r,h,i,A,s,d,l)),(r=c[4])&&u.push(new hn(r,n,i,A,h,d,l)),(r=c[3])&&u.push(new hn(r,h,d,a,s,o,A)),(r=c[2])&&u.push(new hn(r,n,d,a,h,o,A)),(r=c[1])&&u.push(new hn(r,h,i,a,s,d,A)),(r=c[0])&&u.push(new hn(r,n,i,a,h,d,A))}return this},hh.visitAfter=function(e){var t,r=[],n=[];for(this._root&&r.push(new hn(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=r.pop();){var i=t.node;if(i.length){var a,s=t.x0,o=t.y0,l=t.z0,u=t.x1,c=t.y1,h=t.z1,d=(s+u)/2,A=(o+c)/2,p=(l+h)/2;(a=i[0])&&r.push(new hn(a,s,o,l,d,A,p)),(a=i[1])&&r.push(new hn(a,d,o,l,u,A,p)),(a=i[2])&&r.push(new hn(a,s,A,l,d,c,p)),(a=i[3])&&r.push(new hn(a,d,A,l,u,c,p)),(a=i[4])&&r.push(new hn(a,s,o,p,d,A,h)),(a=i[5])&&r.push(new hn(a,d,o,p,u,A,h)),(a=i[6])&&r.push(new hn(a,s,A,p,d,c,h)),(a=i[7])&&r.push(new hn(a,d,A,p,u,c,h))}n.push(t)}for(;t=n.pop();)e(t.node,t.x0,t.y0,t.z0,t.x1,t.y1,t.z1);return this},hh.x=function(e){return arguments.length?(this._x=e,this):this._x},hh.y=function(e){return arguments.length?(this._y=e,this):this._y},hh.z=function(e){return arguments.length?(this._z=e,this):this._z};let hd=Math.sqrt(50),hA=Math.sqrt(10),hp=Math.sqrt(2);function hf(e,t,r){let n,i,a,s=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(s)),l=s/Math.pow(10,o),u=l>=hd?10:l>=hA?5:l>=hp?2:1;return(o<0?(n=Math.round(e*(a=Math.pow(10,-o)/u)),i=Math.round(t*a),n/a<e&&++n,i/a>t&&--i,a=-a):(n=Math.round(e/(a=Math.pow(10,o)*u)),i=Math.round(t/a),n*a<e&&++n,i*a>t&&--i),i<n&&.5<=r&&r<2)?hf(e,t,2*r):[n,i,a]}function hm(e,t,r){return hf(e*=1,t*=1,r*=1)[2]}function hg(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hy(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hv(e){let t,r,n;function i(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(n,n))return a;do{let t=i+a>>>1;0>r(e[t],n)?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=hg,r=(t,r)=>hg(e(t),r),n=(t,r)=>e(t)-r):(t=e===hg||e===hy?e:hx,r=e,n=e),{left:i,center:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,s=i(e,t,r,a-1);return s>r&&n(e[s-1],t)>-n(e[s],t)?s-1:s},right:function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(n,n))return a;do{let t=i+a>>>1;0>=r(e[t],n)?i=t+1:a=t}while(i<a)}return i}}}function hx(){return 0}let h_=hv(hg),hb=h_.right;function hS(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function hT(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function hw(){}h_.left,hv(function(e){return null===e?NaN:+e}).center;var hM="\\s*([+-]?\\d+)\\s*",hE="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",hR="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hC=/^#([0-9a-f]{3,8})$/,hN=new RegExp("^rgb\\(".concat(hM,",").concat(hM,",").concat(hM,"\\)$")),hP=new RegExp("^rgb\\(".concat(hR,",").concat(hR,",").concat(hR,"\\)$")),hI=new RegExp("^rgba\\(".concat(hM,",").concat(hM,",").concat(hM,",").concat(hE,"\\)$")),hL=new RegExp("^rgba\\(".concat(hR,",").concat(hR,",").concat(hR,",").concat(hE,"\\)$")),hD=new RegExp("^hsl\\(".concat(hE,",").concat(hR,",").concat(hR,"\\)$")),hB=new RegExp("^hsla\\(".concat(hE,",").concat(hR,",").concat(hR,",").concat(hE,"\\)$")),hF={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function hU(){return this.rgb().formatHex()}function hO(){return this.rgb().formatRgb()}function hk(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=hC.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?hz(t):3===r?new hG(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?hV(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?hV(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=hN.exec(e))?new hG(t[1],t[2],t[3],1):(t=hP.exec(e))?new hG(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=hI.exec(e))?hV(t[1],t[2],t[3],t[4]):(t=hL.exec(e))?hV(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=hD.exec(e))?hY(t[1],t[2]/100,t[3]/100,1):(t=hB.exec(e))?hY(t[1],t[2]/100,t[3]/100,t[4]):hF.hasOwnProperty(e)?hz(hF[e]):"transparent"===e?new hG(NaN,NaN,NaN,0):null}function hz(e){return new hG(e>>16&255,e>>8&255,255&e,1)}function hV(e,t,r,n){return n<=0&&(e=t=r=NaN),new hG(e,t,r,n)}function hq(e,t,r,n){var i;return 1==arguments.length?((i=e)instanceof hw||(i=hk(i)),i)?new hG((i=i.rgb()).r,i.g,i.b,i.opacity):new hG:new hG(e,t,r,null==n?1:n)}function hG(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function hH(){return"#".concat(hQ(this.r)).concat(hQ(this.g)).concat(hQ(this.b))}function hj(){let e=hW(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(hX(this.r),", ").concat(hX(this.g),", ").concat(hX(this.b)).concat(1===e?")":", ".concat(e,")"))}function hW(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hX(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hQ(e){return((e=hX(e))<16?"0":"")+e.toString(16)}function hY(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new hZ(e,t,r,n)}function hK(e){if(e instanceof hZ)return new hZ(e.h,e.s,e.l,e.opacity);if(e instanceof hw||(e=hk(e)),!e)return new hZ;if(e instanceof hZ)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(s=t===a?(r-n)/o+(r<n)*6:r===a?(n-t)/o+2:(t-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new hZ(s,o,l,e.opacity)}function hZ(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function hJ(e){return(e=(e||0)%360)<0?e+360:e}function h$(e){return Math.max(0,Math.min(1,e||0))}function h0(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function h1(e,t,r,n,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*r+(1+3*e+3*a-3*s)*n+s*i)/6}hS(hw,hk,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:hU,formatHex:hU,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return hK(this).formatHsl()},formatRgb:hO,toString:hO}),hS(hG,hq,hT(hw,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new hG(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new hG(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hG(hX(this.r),hX(this.g),hX(this.b),hW(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hH,formatHex:hH,formatHex8:function(){return"#".concat(hQ(this.r)).concat(hQ(this.g)).concat(hQ(this.b)).concat(hQ((isNaN(this.opacity)?1:this.opacity)*255))},formatRgb:hj,toString:hj})),hS(hZ,function(e,t,r,n){return 1==arguments.length?hK(e):new hZ(e,t,r,null==n?1:n)},hT(hw,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new hZ(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new hZ(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new hG(h0(e>=240?e-240:e+120,i,n),h0(e,i,n),h0(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new hZ(hJ(this.h),h$(this.s),h$(this.l),hW(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=hW(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(hJ(this.h),", ").concat(100*h$(this.s),"%, ").concat(100*h$(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));let h2=e=>()=>e;function h3(e,t){var r=t-e;return r?function(t){return e+t*r}:h2(isNaN(e)?t:e)}let h4=function e(t){var r,n=1==(r=+t)?h3:function(e,t){var n,i,a;return t-e?(n=e,i=t,n=Math.pow(n,a=r),i=Math.pow(i,a)-n,a=1/a,function(e){return Math.pow(n+e*i,a)}):h2(isNaN(e)?t:e)};function i(e,t){var r=n((e=hq(e)).r,(t=hq(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),s=h3(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function h5(e){return function(t){var r,n,i=t.length,a=Array(i),s=Array(i),o=Array(i);for(r=0;r<i;++r)n=hq(t[r]),a[r]=n.r||0,s[r]=n.g||0,o[r]=n.b||0;return a=e(a),s=e(s),o=e(o),n.opacity=1,function(e){return n.r=a(e),n.g=s(e),n.b=o(e),n+""}}}function h6(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(r=0;r<n;++r)i[r]=e[r]*(1-a)+t[r]*a;return i}}function h7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function h8(e,t){return(h7(t)?h6:h9)(e,t)}function h9(e,t){var r,n=t?t.length:0,i=e?Math.min(n,e.length):0,a=Array(i),s=Array(n);for(r=0;r<i;++r)a[r]=dn(e[r],t[r]);for(;r<n;++r)s[r]=t[r];return function(e){for(r=0;r<i;++r)s[r]=a[r](e);return s}}function de(e,t){return e*=1,t*=1,function(r){return e*(1-r)+t*r}}h5(function(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],s=n>0?e[n-1]:2*i-a,o=n<t-1?e[n+2]:2*a-i;return h1((r-n/t)*t,s,i,a,o)}}),h5(function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],s=e[(n+1)%t],o=e[(n+2)%t];return h1((r-n/t)*t,i,a,s,o)}});var dt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dr=RegExp(dt.source,"g");function dn(e,t){var r,n=typeof t;return null==t||"boolean"===n?h2(t):("number"===n?de:"string"===n?(r=hk(t))?(t=r,h4):function(e,t){var r,n,i,a,s,o=dt.lastIndex=dr.lastIndex=0,l=-1,u=[],c=[];for(e+="",t+="";(i=dt.exec(e))&&(a=dr.exec(t));)(s=a.index)>o&&(s=t.slice(o,s),u[l]?u[l]+=s:u[++l]=s),(i=i[0])===(a=a[0])?u[l]?u[l]+=a:u[++l]=a:(u[++l]=null,c.push({i:l,x:de(i,a)})),o=dr.lastIndex;return o<t.length&&(s=t.slice(o),u[l]?u[l]+=s:u[++l]=s),u.length<2?c[0]?(r=c[0].x,function(e){return r(e)+""}):(n=t,function(){return n}):(t=c.length,function(e){for(var r,n=0;n<t;++n)u[(r=c[n]).i]=r.x(e);return u.join("")})}:t instanceof hk?h4:t instanceof Date?function(e,t){var r=new Date;return e*=1,t*=1,function(n){return r.setTime(e*(1-n)+t*n),r}}:h7(t)?h6:Array.isArray(t)?h9:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var r,n={},i={};for(r in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)r in e?n[r]=dn(e[r],t[r]):i[r]=t[r];return function(e){for(r in n)i[r]=n[r](e);return i}}:de)(e,t)}function di(e,t){return e*=1,t*=1,function(r){return Math.round(e*(1-r)+t*r)}}function da(e){return+e}var ds=[0,1];function dl(e){return e}function du(e,t){var r;return(t-=e*=1)?function(r){return(r-e)/t}:(r=isNaN(t)?NaN:.5,function(){return r})}function dc(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=du(i,n),a=r(s,a)):(n=du(n,i),a=r(a,s)),function(e){return a(n(e))}}function dh(e,t,r){var n=Math.min(e.length,t.length)-1,i=Array(n),a=Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=du(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(t){var r=hb(e,t,1,n)-1;return a[r](i[r](t))}}function dd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function dA(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function dp(e){return(e=dA(Math.abs(e)))?e[1]:NaN}var df=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function dm(e){var t;if(!(t=df.exec(e)))throw Error("invalid format: "+e);return new dg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function dg(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function dy(e,t){var r=dA(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+Array(i-n.length+2).join("0")}dm.prototype=dg.prototype,dg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let dv={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>dy(100*e,t),r:dy,s:function(e,t){var r=dA(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(f5=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=n.length;return a===s?n:a>s?n+Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+Array(1-a).join("0")+dA(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function dx(e){return e}var d_=Array.prototype.map,db=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function dS(e){var t=e.domain;return e.ticks=function(e){var r=t();return function(e,t,r){if(t*=1,e*=1,!((r*=1)>0))return[];if(e===t)return[e];let n=t<e,[i,a,s]=n?hf(t,e,r):hf(e,t,r);if(!(a>=i))return[];let o=a-i+1,l=Array(o);if(n)if(s<0)for(let e=0;e<o;++e)l[e]=-((a-e)/s);else for(let e=0;e<o;++e)l[e]=(a-e)*s;else if(s<0)for(let e=0;e<o;++e)l[e]=-((i+e)/s);else for(let e=0;e<o;++e)l[e]=(i+e)*s;return l}(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,r){var n=t();return function(e,t,r,n){var i,a,s=function(e,t,r){t*=1,e*=1,r*=1;let n=t<e,i=n?hm(t,e,r):hm(e,t,r);return(n?-1:1)*(i<0?-(1/i):i)}(e,t,r);switch((n=dm(null==n?",f":n)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=n.precision||isNaN(a=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(dp(o)/3)))-dp(Math.abs(s))))||(n.precision=a),f8(n,o);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(a=Math.max(0,dp(Math.abs(Math.max(Math.abs(e),Math.abs(t)))-(i=Math.abs(i=s)))-dp(i))+1)||(n.precision=a-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(a=Math.max(0,-dp(Math.abs(s))))||(n.precision=a-("%"===n.type)*2)}return f7(n)}(n[0],n[n.length-1],null==e?10:e,r)},e.nice=function(r){null==r&&(r=10);var n,i,a=t(),s=0,o=a.length-1,l=a[s],u=a[o],c=10;for(u<l&&(i=l,l=u,u=i,i=s,s=o,o=i);c-- >0;){if((i=hm(l,u,r))===n)return a[s]=l,a[o]=u,t(a);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else if(i<0)l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i;else break;n=i}return e},e}function dT(){var e=(function(){var e,t,r,n,i,a,s=ds,o=ds,l=dn,u=dl;function c(){var e,t,r,l=Math.min(s.length,o.length);return u!==dl&&(e=s[0],t=s[l-1],e>t&&(r=e,e=t,t=r),u=function(r){return Math.max(e,Math.min(t,r))}),n=l>2?dh:dc,i=a=null,h}function h(t){return null==t||isNaN(t*=1)?r:(i||(i=n(s.map(e),o,l)))(e(u(t)))}return h.invert=function(r){return u(t((a||(a=n(o,s.map(e),de)))(r)))},h.domain=function(e){return arguments.length?(s=Array.from(e,da),c()):s.slice()},h.range=function(e){return arguments.length?(o=Array.from(e),c()):o.slice()},h.rangeRound=function(e){return o=Array.from(e),l=di,c()},h.clamp=function(e){return arguments.length?(u=!!e||dl,c()):u!==dl},h.interpolate=function(e){return arguments.length?(l=e,c()):l},h.unknown=function(e){return arguments.length?(r=e,h):r},function(r,n){return e=r,t=n,c()}})()(dl,dl);return e.copy=function(){return dT().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())},dd.apply(e,arguments),dS(e)}f7=(f6=function(e){var t,r,n,i=void 0===e.grouping||void 0===e.thousands?dx:(t=d_.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,a=[],s=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(e.substring(i-=o,i+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(r)}),a=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",l=void 0===e.numerals?dx:(n=d_.call(e.numerals,String),function(e){return e.replace(/[0-9]/g,function(e){return n[+e]})}),u=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",h=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=dm(e)).fill,r=e.align,n=e.sign,d=e.symbol,A=e.zero,p=e.width,f=e.comma,m=e.precision,g=e.trim,y=e.type;"n"===y?(f=!0,y="g"):dv[y]||(void 0===m&&(m=12),g=!0,y="g"),(A||"0"===t&&"="===r)&&(A=!0,t="0",r="=");var v="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?s:/[%p]/.test(y)?u:"",_=dv[y],b=/[defgprs%]/.test(y);function S(e){var a,s,u,d=v,S=x;if("c"===y)S=_(e)+S,e="";else{var T=(e*=1)<0||1/e<0;if(e=isNaN(e)?h:_(Math.abs(e),m),g&&(e=function(e){o:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break o;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0==+e&&"+"!==n&&(T=!1),d=(T?"("===n?n:c:"-"===n||"("===n?"":n)+d,S=("s"===y?db[8+f5/3]:"")+S+(T&&"("===n?")":""),b){for(a=-1,s=e.length;++a<s;)if(48>(u=e.charCodeAt(a))||u>57){S=(46===u?o+e.slice(a+1):e.slice(a))+S,e=e.slice(0,a);break}}}f&&!A&&(e=i(e,1/0));var w=d.length+e.length+S.length,M=w<p?Array(p-w+1).join(t):"";switch(f&&A&&(e=i(M+e,M.length?p-S.length:1/0),M=""),r){case"<":e=d+e+S+M;break;case"=":e=d+M+e+S;break;case"^":e=M.slice(0,w=M.length>>1)+d+e+S+M.slice(w);break;default:e=M+d+e+S}return l(e)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return e+""},S}return{format:d,formatPrefix:function(e,t){var r=d(((e=dm(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(dp(t)/3))),i=Math.pow(10,-n),a=db[8+n/3];return function(e){return r(i*e)+a}}}}({thousands:",",grouping:[3],currency:["$",""]})).format,f8=f6.formatPrefix;var dw=Math.PI,dM=dw/2,dE=dw/4,dR=2*dw,dC=180/dw,dN=dw/180,dP=Math.abs,dI=Math.atan,dL=Math.atan2,dD=Math.cos,dB=Math.ceil,dF=Math.exp,dU=Math.hypot,dO=Math.log,dk=Math.sin,dz=Math.sign||function(e){return e>0?1:e<0?-1:0},dV=Math.sqrt,dq=Math.tan;function dG(e){return e>1?dM:e<-1?-dM:Math.asin(e)}function dH(e,t){function r(r,n){return t((r=e(r,n))[0],r[1])}return e.invert&&t.invert&&(r.invert=function(r,n){return(r=t.invert(r,n))&&e.invert(r[0],r[1])}),r}function dj(e,t){return dP(e)>dw&&(e-=Math.round(e/dR)*dR),[e,t]}function dW(e,t,r){return(e%=dR)?t||r?dH(dQ(e),dY(t,r)):dQ(e):t||r?dY(t,r):dj}function dX(e){return function(t,r){return dP(t+=e)>dw&&(t-=Math.round(t/dR)*dR),[t,r]}}function dQ(e){var t=dX(e);return t.invert=dX(-e),t}function dY(e,t){var r=dD(e),n=dk(e),i=dD(t),a=dk(t);function s(e,t){var s=dD(t),o=dD(e)*s,l=dk(e)*s,u=dk(t),c=u*r+o*n;return[dL(l*i-c*a,o*r-u*n),dG(c*i+l*a)]}return s.invert=function(e,t){var s=dD(t),o=dD(e)*s,l=dk(e)*s,u=dk(t),c=u*i-l*a;return[dL(l*i+u*a,o*r+c*n),dG(c*r-o*n)]},s}function dK(){}function dZ(){var e,t=[];return{point:function(t,r,n){e.push([t,r,n])},lineStart:function(){t.push(e=[])},lineEnd:dK,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function dJ(e,t){return 1e-6>dP(e[0]-t[0])&&1e-6>dP(e[1]-t[1])}function d$(e,t,r,n){this.x=e,this.z=t,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function d0(e,t,r,n,i){var a,s,o=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,r,n=e[0],s=e[t];if(dJ(n,s)){if(!n[2]&&!s[2]){for(i.lineStart(),a=0;a<t;++a)i.point((n=e[a])[0],n[1]);i.lineEnd();return}s[0]+=2e-6}o.push(r=new d$(n,e,null,!0)),l.push(r.o=new d$(n,null,r,!1)),o.push(r=new d$(s,e,null,!1)),l.push(r.o=new d$(s,null,r,!0))}}),o.length){for(l.sort(t),d1(o),d1(l),a=0,s=l.length;a<s;++a)l[a].e=r=!r;for(var u,c,h=o[0];;){for(var d=h,A=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(A)for(a=0,s=u.length;a<s;++a)i.point((c=u[a])[0],c[1]);else n(d.x,d.n.x,1,i);d=d.n}else{if(A)for(a=(u=d.p.z).length-1;a>=0;--a)i.point((c=u[a])[0],c[1]);else n(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,A=!A}while(!d.v)i.lineEnd()}}}function d1(e){if(t=e.length){for(var t,r,n=0,i=e[0];++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}dj.invert=dj;class d2{add(e){let t=this._partials,r=0;for(let n=0;n<this._n&&n<32;n++){let i=t[n],a=e+i,s=Math.abs(e)<Math.abs(i)?e-(a-i):i-(a-e);s&&(t[r++]=s),e=a}return t[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,t=this._n,r,n,i,a=0;if(t>0){for(a=e[--t];t>0&&(a=(r=a)+(n=e[--t]),!(i=n-(a-r))););t>0&&(i<0&&e[t-1]<0||i>0&&e[t-1]>0)&&(r=a+(n=2*i),n==r-a&&(a=r))}return a}constructor(){this._partials=new Float64Array(32),this._n=0}}function d3(e){return[dL(e[1],e[0]),dG(e[2])]}function d4(e){var t=e[0],r=e[1],n=dD(r);return[n*dD(t),n*dk(t),dk(r)]}function d5(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function d6(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function d7(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function d8(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function d9(e){var t=dV(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ae(e){return dP(e[0])<=dw?e[0]:dz(e[0])*((dP(e[0])+dw)%dR-dw)}function At(e,t){var r=Ae(t),n=t[1],i=dk(n),a=[dk(r),-dD(r),0],s=0,o=0,l=new d2;1===i?n=dM+1e-6:-1===i&&(n=-dM-1e-6);for(var u=0,c=e.length;u<c;++u)if(d=(h=e[u]).length)for(var h,d,A=h[d-1],p=Ae(A),f=A[1]/2+dE,m=dk(f),g=dD(f),y=0;y<d;++y,p=x,m=b,g=S,A=v){var v=h[y],x=Ae(v),_=v[1]/2+dE,b=dk(_),S=dD(_),T=x-p,w=T>=0?1:-1,M=w*T,E=M>dw,R=m*b;if(l.add(dL(R*w*dk(M),g*S+R*dD(M))),s+=E?T+w*dR:T,E^p>=r^x>=r){var C=d6(d4(A),d4(v));d9(C);var N=d6(a,C);d9(N);var P=(E^T>=0?-1:1)*dG(N[2]);(n>P||n===P&&(C[0]||C[1]))&&(o+=E^T>=0?1:-1)}}return(s<-1e-6||s<1e-6&&l<-1e-12)^1&o}function Ar(e){return Array.from(function*(e){for(let t of e)yield*t}(e))}function An(e,t,r,n){return function(i){var a,s,o,l=t(i),u=dZ(),c=t(u),h=!1,d={point:A,lineStart:f,lineEnd:m,polygonStart:function(){d.point=g,d.lineStart=y,d.lineEnd=v,s=[],a=[]},polygonEnd:function(){d.point=A,d.lineStart=f,d.lineEnd=m,s=Ar(s);var e=At(a,n);s.length?(h||(i.polygonStart(),h=!0),d0(s,Aa,e,r,i)):e&&(h||(i.polygonStart(),h=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),s=a=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function A(t,r){e(t,r)&&i.point(t,r)}function p(e,t){l.point(e,t)}function f(){d.point=p,l.lineStart()}function m(){d.point=A,l.lineEnd()}function g(e,t){o.push([e,t]),c.point(e,t)}function y(){c.lineStart(),o=[]}function v(){g(o[0][0],o[0][1]),c.lineEnd();var e,t,r,n,l=c.clean(),d=u.result(),A=d.length;if(o.pop(),a.push(o),o=null,A){if(1&l){if((t=(r=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),e=0;e<t;++e)i.point((n=r[e])[0],n[1]);i.lineEnd()}return}A>1&&2&l&&d.push(d.pop().concat(d.shift())),s.push(d.filter(Ai))}}return d}}function Ai(e){return e.length>1}function Aa(e,t){return((e=e.x)[0]<0?e[1]-dM-1e-6:dM-e[1])-((t=t.x)[0]<0?t[1]-dM-1e-6:dM-t[1])}let As=An(function(){return!0},function(e){var t,r=NaN,n=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,s){var o,l,u,c,h,d,A,p=a>0?dw:-dw,f=dP(a-r);1e-6>dP(f-dw)?(e.point(r,n=(n+s)/2>0?dM:-dM),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(p,n),e.point(a,n),t=0):i!==p&&f>=dw&&(1e-6>dP(r-i)&&(r-=1e-6*i),1e-6>dP(a-p)&&(a-=1e-6*p),o=r,l=n,u=a,c=s,n=dP(A=dk(o-u))>1e-6?dI((dk(l)*(d=dD(c))*dk(u)-dk(c)*(h=dD(l))*dk(o))/(h*d*A)):(l+c)/2,e.point(i,n),e.lineEnd(),e.lineStart(),e.point(p,n),t=0),e.point(r=a,n=s),i=p},lineEnd:function(){e.lineEnd(),r=n=NaN},clean:function(){return 2-t}}},function(e,t,r,n){var i;if(null==e)i=r*dM,n.point(-dw,i),n.point(0,i),n.point(dw,i),n.point(dw,0),n.point(dw,-i),n.point(0,-i),n.point(-dw,-i),n.point(-dw,0),n.point(-dw,i);else if(dP(e[0]-t[0])>1e-6){var a=e[0]<t[0]?dw:-dw;i=r*a/2,n.point(-a,i),n.point(0,i),n.point(a,i)}else n.point(t[0],t[1])},[-dw,-dM]);function Ao(e,t){t=d4(t),t[0]-=e,d9(t);var r,n=(r=-t[1])>1?0:r<-1?dw:Math.acos(r);return((0>-t[2]?-n:n)+dR-1e-6)%dR}let Al=e=>e;function Au(e){return function(t){var r=new Ac;for(var n in e)r[n]=e[n];return r.stream=t,r}}function Ac(){}function Ah(e,t){e&&AA.hasOwnProperty(e.type)&&AA[e.type](e,t)}Ac.prototype={constructor:Ac,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ad={Feature:function(e,t){Ah(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,i=r.length;++n<i;)Ah(r[n].geometry,t)}},AA={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ap(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)Ap(r[n],t,0)},Polygon:function(e,t){Af(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)Af(r[n],t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,i=r.length;++n<i;)Ah(r[n],t)}};function Ap(e,t,r){var n,i=-1,a=e.length-r;for(t.lineStart();++i<a;)n=e[i],t.point(n[0],n[1],n[2]);t.lineEnd()}function Af(e,t){var r=-1,n=e.length;for(t.polygonStart();++r<n;)Ap(e[r],t,1);t.polygonEnd()}function Am(e,t){e&&Ad.hasOwnProperty(e.type)?Ad[e.type](e,t):Ah(e,t)}var Ag=1/0,Ay=1/0,Av=-1/0,Ax=Av;let A_={point:function(e,t){e<Ag&&(Ag=e),e>Av&&(Av=e),t<Ay&&(Ay=t),t>Ax&&(Ax=t)},lineStart:dK,lineEnd:dK,polygonStart:dK,polygonEnd:dK,result:function(){var e=[[Ag,Ay],[Av,Ax]];return Av=Ax=-(Ay=Ag=1/0),e}};function Ab(e,t,r){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=n&&e.clipExtent(null),Am(r,e.stream(A_)),t(A_.result()),null!=n&&e.clipExtent(n),e}function AS(e,t,r){return Ab(e,function(r){var n=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(n/(r[1][0]-r[0][0]),i/(r[1][1]-r[0][1])),s=+t[0][0]+(n-a*(r[1][0]+r[0][0]))/2,o=+t[0][1]+(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,o])},r)}var AT=dD(30*dN);function Aw(e,t){var r;return+t?function(e,t){function r(n,i,a,s,o,l,u,c,h,d,A,p,f,m){var g=u-n,y=c-i,v=g*g+y*y;if(v>4*t&&f--){var x=s+d,_=o+A,b=l+p,S=dV(x*x+_*_+b*b),T=dG(b/=S),w=1e-6>dP(dP(b)-1)||1e-6>dP(a-h)?(a+h)/2:dL(_,x),M=e(w,T),E=M[0],R=M[1],C=E-n,N=R-i,P=y*C-g*N;(P*P/v>t||dP((g*C+y*N)/v-.5)>.3||s*d+o*A+l*p<AT)&&(r(n,i,a,s,o,l,E,R,w,x/=S,_/=S,b,f,m),m.point(E,R),r(E,R,w,x,_,b,u,c,h,d,A,p,f,m))}}return function(t){var n,i,a,s,o,l,u,c,h,d,A,p,f={point:m,lineStart:g,lineEnd:v,polygonStart:function(){t.polygonStart(),f.lineStart=x},polygonEnd:function(){t.polygonEnd(),f.lineStart=g}};function m(r,n){r=e(r,n),t.point(r[0],r[1])}function g(){c=NaN,f.point=y,t.lineStart()}function y(n,i){var a=d4([n,i]),s=e(n,i);r(c,h,u,d,A,p,c=s[0],h=s[1],u=n,d=a[0],A=a[1],p=a[2],16,t),t.point(c,h)}function v(){f.point=m,t.lineEnd()}function x(){g(),f.point=_,f.lineEnd=b}function _(e,t){y(n=e,t),i=c,a=h,s=d,o=A,l=p,f.point=y}function b(){r(c,h,u,d,A,p,i,a,n,s,o,l,16,t),f.lineEnd=v,v()}return f}}(e,t):(r=e,Au({point:function(e,t){e=r(e,t),this.stream.point(e[0],e[1])}}))}var AM=Au({point:function(e,t){this.stream.point(e*dN,t*dN)}});function AE(e,t,r,n,i,a){if(!a){function s(a,s){return[t+e*(a*=n),r-e*(s*=i)]}return s.invert=function(a,s){return[(a-t)/e*n,(r-s)/e*i]},s}var o=dD(a),l=dk(a),u=o*e,c=l*e,h=o/e,d=l/e,A=(l*r-o*t)/e,p=(l*t+o*r)/e;function f(e,a){return[u*(e*=n)-c*(a*=i)+t,r-c*e-u*a]}return f.invert=function(e,t){return[n*(h*e-d*t+A),i*(p-d*e-h*t)]},f}function AR(e,t){return[e,dO(dq((dM+t)/2))]}function AC(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function AN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw TypeError("Private element is not present on this object")}function AP(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function AI(e,t){return e.get(AN(e,t))}function AL(e,t,r){AP(e,t),t.set(e,r)}function AD(e,t,r){return e.set(AN(e,t),r),r}function AB(e,t,r){return(t=AV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AF(e){return(AF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(AU=function(){return!!e})()}function AO(e,t){return(AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ak(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t);else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(e,t)||Aq(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Az(e){return function(e){if(Array.isArray(e))return AC(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Aq(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AV(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function Aq(e,t){if(e){if("string"==typeof e)return AC(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?AC(e,t):void 0}}AR.invert=function(e,t){return[e,2*dI(dF(t))-dM]};var AG=function(e){e instanceof Array?e.forEach(AG):(e.map&&e.map.dispose(),e.dispose())},AH=function(e){e.geometry&&e.geometry.dispose(),e.material&&AG(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(AH)},Aj=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),AH(t)}};function AW(e,t,r){var n=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180;return{x:r*Math.sin(n)*Math.cos(i),y:r*Math.cos(n),z:r*Math.sin(n)*Math.sin(i)}}function AX(e){return e*Math.PI/180}var AQ=function(e){return 1-(AR(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},AY=function(e){return Math.max(0,Math.min(1,AQ(e)))},AK=function(e){return .5-AR.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},AZ=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=dT().domain([1,0]).range([t,r]).clamp(!0),i=dT().domain([AY(t),AY(r)]).range([1,0]).clamp(!0),a=e.array,s=0,o=a.length;s<o;s+=2)a[s+1]=i(AY(n(a[s+1])));e.needsUpdate=!0},AJ=function(e,t,r,n){var i=Math.pow(2,e),a=Math.max(0,Math.min(i-1,Math.floor((r+180)*i/360))),s=(90-n)/180;return t&&(s=Math.max(0,Math.min(1,AQ(s)))),[a,Math.floor(s*i)]},A$=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=[],o=Math.pow(2,e),l=360/o,u=180/o,c=void 0===a?o-1:a,h=r,d=Math.min(o-1,void 0===i?o-1:i);h<=d;h++)for(var A=n,p=Math.min(o-1,c);A<=p;A++){var f=A,m=u;t&&(f=0===A?A:AK(A/o)*o,m=((A+1===o?A+1:AK((A+1)/o)*o)-f)*180/o);var g=-180+(h+.5)*l,y=90-(180*f/o+m/2),v=m;s.push({x:h,y:A,lng:g,lat:y,latLen:v})}return s},A0=new WeakMap,A1=new WeakMap,A2=new WeakMap,A3=new WeakMap,A4=new WeakMap,A5=new WeakMap,A6=new WeakMap,A7=new WeakMap,A8=new WeakSet,A9=function(e){var t;function r(e){var t,n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.tileUrl,o=a.minLevel,l=a.maxLevel,u=a.mercatorProjection;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");return t=AF(t=r),AP(n=i=function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,AU()?Reflect.construct(t,[],AF(this).constructor):t.apply(this,void 0)),A8),A8.add(n),AL(i,A0,void 0),AL(i,A1,void 0),AL(i,A2,void 0),AL(i,A3,void 0),AL(i,A4,{}),AL(i,A5,void 0),AL(i,A6,void 0),AL(i,A7,void 0),AB(i,"minLevel",void 0),AB(i,"maxLevel",void 0),AB(i,"thresholds",Az(Array(30)).map(function(e,t){return 8/Math.pow(2,t)})),AB(i,"curvatureResolution",5),AB(i,"tileMargin",0),AB(i,"clearTiles",function(){Object.values(AI(A4,i)).forEach(function(e){e.forEach(function(e){e.obj&&(i.remove(e.obj),Aj(e.obj),delete e.obj)})}),AD(A4,i,{})}),AD(A0,i,e),i.tileUrl=s,AD(A1,i,void 0===u||u),i.minLevel=void 0===o?0:o,i.maxLevel=void 0===l?17:l,i.level=0,i.add(AD(A7,i,new rU(new aD(.99*AI(A0,i),180,90),new re({color:0})))),AI(A7,i).visible=!1,AI(A7,i).material.polygonOffset=!0,AI(A7,i).material.polygonOffsetUnits=3,AI(A7,i).material.polygonOffsetFactor=1,i}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&AO(r,e),t=[{key:"tileUrl",get:function(){return AI(A2,this)},set:function(e){AD(A2,this,e),this.updatePov(AI(A6,this))}},{key:"level",get:function(){return AI(A3,this)},set:function(e){var t=this;AI(A4,this)[e]||AN(A8,this,pe).call(this,e);var r=AI(A3,this);if(AD(A3,this,e),e!==r&&void 0!==r){if(AI(A7,this).visible=e>0,AI(A4,this)[e].forEach(function(e){return e.obj&&(e.obj.material.depthWrite=!0)}),r<e&&AI(A4,this)[r].forEach(function(e){return e.obj&&(e.obj.material.depthWrite=!1)}),r>e)for(var n=e+1;n<=r;n++)AI(A4,this)[n]&&AI(A4,this)[n].forEach(function(e){e.obj&&(t.remove(e.obj),Aj(e.obj),delete e.obj)});AN(A8,this,pt).call(this)}}},{key:"updatePov",value:function(e){var t,r=this;if(e&&e instanceof rj&&(AD(A6,this,e),AD(A5,this,function(n){if(!n.hullPnts){var i=360/Math.pow(2,r.level),a=n.lng,s=n.lat,o=n.latLen,l=a-i/2,u=a+i/2,c=s-o/2,h=s+o/2;n.hullPnts=[[s,a],[c,l],[h,l],[c,u],[h,u]].map(function(e){var t=Ak(e,2);return AW(t[0],t[1],AI(A0,r))}).map(function(e){return new ex(e.x,e.y,e.z)})}return t||(t=new nX,e.updateMatrix(),e.updateMatrixWorld(),t.setFromProjectionMatrix(new tp().multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse))),n.hullPnts.some(function(e){return t.containsPoint(e.clone().applyMatrix4(r.matrixWorld))})}),this.tileUrl)){var n=(e.position.clone().distanceTo(this.getWorldPosition(new ex))-AI(A0,this))/AI(A0,this),i=this.thresholds.findIndex(function(e){return e&&e<=n});this.level=Math.min(this.maxLevel,Math.max(this.minLevel,i<0?this.thresholds.length:i)),AN(A8,this,pt).call(this)}}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AV(n.key),n)}}(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}(r$);function pe(e){var t=this;if(e>7){AI(A4,this)[e]=[];return}var r=AI(A4,this)[e]=A$(e,AI(A1,this));r.forEach(function(e){return e.centroid=AW(e.lat,e.lng,AI(A0,t))}),r.octree=hl().x(function(e){return e.centroid.x}).y(function(e){return e.centroid.y}).z(function(e){return e.centroid.z}).addAll(r)}function pt(){var e=this;if(this.tileUrl&&void 0!==this.level&&AI(A4,this).hasOwnProperty(this.level)&&(AI(A5,this)||!(this.level>6))){var t=AI(A4,this)[this.level];if(AI(A6,this)){var r=this.worldToLocal(AI(A6,this).position.clone());if(t.octree){var n,i=this.worldToLocal(AI(A6,this).position.clone()),a=(i.length()-AI(A0,this))*3;t=(n=t.octree).findAllWithinRadius.apply(n,Az(i).concat([a]))}else{var s,o,l,u,c,h=(s=r.x,u=Math.sqrt(s*s+(o=r.y)*o+(l=r.z)*l),{lat:90-180*Math.acos(o/u)/Math.PI,lng:90-180*(c=Math.atan2(l,s))/Math.PI-360*(c<-Math.PI/2),r:u}),d=(h.r/AI(A0,this)-1)*90,A=d/Math.cos(AX(h.lat)),p=[h.lng-A,h.lng+A],f=[h.lat+d,h.lat-d],m=Ak(AJ(this.level,AI(A1,this),p[0],f[0]),2),g=m[0],y=m[1],v=Ak(AJ(this.level,AI(A1,this),p[1],f[1]),2),x=v[0],_=v[1];t.record||(t.record={});var b=t.record;if(b.hasOwnProperty("".concat(Math.round((g+x)/2),"_").concat(Math.round((y+_)/2)))){for(var S=[],T=g;T<=x;T++)for(var w=y;w<=_;w++){var M="".concat(T,"_").concat(w);b.hasOwnProperty(M)||(b[M]=A$(this.level,AI(A1,this),T,w,T,w)[0],t.push(b[M])),S.push(b[M])}t=S}else t=A$(this.level,AI(A1,this),g,y,x,_).map(function(e){var r="".concat(e.x,"_").concat(e.y);return b.hasOwnProperty(r)?b[r]:(b[r]=e,t.push(e),e)})}}t.filter(function(e){return!e.obj}).filter(AI(A5,this)||function(){return!0}).forEach(function(t){var r=t.x,n=t.y,i=t.lng,a=t.lat,s=t.latLen,o=360/Math.pow(2,e.level);if(!t.obj){var l=o*(1-e.tileMargin),u=s*(1-e.tileMargin),c=AX(i),h=AX(-a),d=new rU(new aD(AI(A0,e),Math.ceil(l/e.curvatureResolution),Math.ceil(u/e.curvatureResolution),AX(90-l/2)+c,AX(l),AX(90-u/2)+h,AX(u)),new aY);if(AI(A1,e)){var A=Ak([a+s/2,a-s/2].map(function(e){return .5-e/180}),2),p=A[0],f=A[1];AZ(d.geometry.attributes.uv,p,f)}t.obj=d}t.loading||(t.loading=!0,new sb().load(e.tileUrl(r,n,e.level),function(r){var n=t.obj;n&&(r.colorSpace=J,n.material.map=r,n.material.color=null,n.material.needsUpdate=!0,e.add(n)),t.loading=!1}))})}}function pr(e,t,r,n,i){let a;if(i===function(e,t,r,n){let i=0;for(let a=t,s=r-n;a<r;a+=n)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}(e,t,r,n)>0)for(let i=t;i<r;i+=n)a=pf(i/n|0,e[i],e[i+1],a);else for(let i=r-n;i>=t;i-=n)a=pf(i/n|0,e[i],e[i+1],a);return a&&pu(a,a.next)&&(pm(a),a=a.next),a}function pn(e,t){if(!e)return e;t||(t=e);let r=e,n;do if(n=!1,!r.steiner&&(pu(r,r.next)||0===pl(r.prev,r,r.next))){if(pm(r),(r=t=r.prev)===r.next)break;n=!0}else r=r.next;while(n||r!==t)return t}function pi(e,t){let r=e.x-t.x;return 0===r&&0==(r=e.y-t.y)&&(r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function pa(e,t,r,n,i){return(e=((e=((e=((e=((e=(e-r)*i|0)|e<<8)&0xff00ff)|e<<4)&0xf0f0f0f)|e<<2)&0x33333333)|e<<1)&0x55555555)|(t=((t=((t=((t=((t=(t-n)*i|0)|t<<8)&0xff00ff)|t<<4)&0xf0f0f0f)|t<<2)&0x33333333)|t<<1)&0x55555555)<<1}function ps(e,t,r,n,i,a,s,o){return(i-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(n-o)>=(r-s)*(t-o)&&(r-s)*(a-o)>=(i-s)*(n-o)}function po(e,t,r,n,i,a,s,o){return(e!==s||t!==o)&&ps(e,t,r,n,i,a,s,o)}function pl(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function pu(e,t){return e.x===t.x&&e.y===t.y}function pc(e,t,r,n){let i=pd(pl(e,t,r)),a=pd(pl(e,t,n)),s=pd(pl(r,n,e)),o=pd(pl(r,n,t));return!!(i!==a&&s!==o||0===i&&ph(e,r,t)||0===a&&ph(e,n,t)||0===s&&ph(r,e,n)||0===o&&ph(r,t,n))}function ph(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function pd(e){return e>0?1:e<0?-1:0}function pA(e,t){return 0>pl(e.prev,e,e.next)?pl(e,t,e.next)>=0&&pl(e,e.prev,t)>=0:0>pl(e,t,e.prev)||0>pl(e,e.next,t)}function pp(e,t){let r=pg(e.i,e.x,e.y),n=pg(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function pf(e,t,r,n){let i=pg(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function pm(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function pg(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function py(e){let t=[],r=[],n=e[0][0].length,i=0,a=0;for(let s of e){for(let e of s)for(let r=0;r<n;r++)t.push(e[r]);a&&(i+=a,r.push(i)),a=s.length}return{vertices:t,holes:r,dimensions:n}}var pv={sphere:dK,point:dK,lineStart:function(){pv.point=p_,pv.lineEnd=px},lineEnd:dK,polygonStart:dK,polygonEnd:dK};function px(){pv.point=pv.lineEnd=dK}function p_(e,t){e*=dN,t*=dN,me=e,mt=dk(t),mr=dD(t),pv.point=pb}function pb(e,t){e*=dN;var r=dk(t*=dN),n=dD(t),i=dP(e-me),a=dD(i),s=n*dk(i),o=mr*r-mt*n*a,l=mt*r+mr*n*a;f9.add(dL(dV(s*s+o*o),l)),me=e,mt=r,mr=n}var pS=[null,null],pT={type:"LineString",coordinates:pS};function pw(e,t){return pS[0]=e,pS[1]=t,f9=new d2,Am(pT,pv),+f9}function pM(e,t){var r,n,i=e[0]*dN,a=e[1]*dN,s=t[0]*dN,o=t[1]*dN,l=dD(a),u=dk(a),c=dD(o),h=dk(o),d=l*dD(i),A=l*dk(i),p=c*dD(s),f=c*dk(s),m=2*dG(dV((r=dk((r=o-a)/2))*r+l*c*((n=dk((n=s-i)/2))*n))),g=dk(m),y=m?function(e){var t=dk(e*=m)/g,r=dk(m-e)/g,n=r*d+t*p,i=r*A+t*f;return[dL(i,n)*dC,dL(r*u+t*h,dV(n*n+i*i))*dC]}:function(){return[i*dC,a*dC]};return y.distance=m,y}function pE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function pR(e){return(pR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(pC=function(){return!!e})()}function pN(e,t){return(pN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function pP(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(e,t)||pI(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pI(e,t){if(e){if("string"==typeof e)return pE(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pE(e,t):void 0}}var pL=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[],n=null;return e.forEach(function(e){if(n){var i=180*pw(e,n)/Math.PI;if(i>t)for(var a=pM(n,e),s=n.length>2||e.length>2?de(n[2]||0,e[2]||0):null,o=s?function(e){var t;return[].concat(function(e){if(Array.isArray(e))return pE(e)}(t=a(e))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||pI(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[s(e)])}:a,l=1/Math.ceil(i/t),u=l;u<1;)r.push(o(u)),u+=l}r.push(n=e)}),r},pD="undefined"!=typeof window&&window.THREE?window.THREE:{BufferGeometry:rw,Float32BufferAttribute:rg},pB=new pD.BufferGeometry().setAttribute?"setAttribute":"addAttribute",pF=function(e){function t(e){var r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");r=pR(r=t),(n=function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,pC()?Reflect.construct(r,[],pR(this).constructor):r.apply(this,void 0))).type="GeoJsonGeometry",n.parameters={geoJson:e,radius:i,resolution:a};var s=(({Point:c,MultiPoint:function(e,t){var r={vertices:[],indices:[]};return e.map(function(e){return c(e,t)}).forEach(function(e){pU(r,pP(e,1)[0])}),[r]},LineString:h,MultiLineString:function(e,t){var r={vertices:[],indices:[]};return e.map(function(e){return h(e,t)}).forEach(function(e){pU(r,pP(e,1)[0])}),[r]},Polygon:d,MultiPolygon:function(e,t){var r={vertices:[],indices:[]},n={vertices:[],indices:[]};e.map(function(e){return d(e,t)}).forEach(function(e){var t=pP(e,2),i=t[0],a=t[1];pU(r,i),a&&pU(n,a)});var i=[r];return n.vertices.length&&i.push(n),i}})[e.type]||function(){return[]})(e.coordinates,i),o=[],l=[],u=0;function c(e,t){return[{vertices:pk(e[1],e[0],t+(e[2]||0)),indices:[]}]}function h(e,t){for(var r=py([pL(e,a).map(function(e){var r=pP(e,3),n=r[0],i=r[1],a=r[2];return pk(i,n,t+(void 0===a?0:a))})]).vertices,n=Math.round(r.length/3),i=[],s=1;s<n;s++)i.push(s-1,s);return[{vertices:r,indices:i}]}function d(e,t){for(var r=py(e.map(function(e){return pL(e,a).map(function(e){var r=pP(e,3),n=r[0],i=r[1],a=r[2];return pk(i,n,t+(void 0===a?0:a))})})),n=r.vertices,i=r.holes,s=i[0]||1/0,o=n.slice(0,3*s),l=n.slice(3*s),u=new Set(i),c=Math.round(n.length/3),h=[],d=[],A=1;A<c;A++)u.has(A)||(A<s?h.push(A-1,A):d.push(A-1-s,A-s));var p=[{indices:h,vertices:o}];return i.length&&p.push({indices:d,vertices:l}),p}return s.forEach(function(e){var t=o.length;pU({indices:o,vertices:l},e),n.addGroup(t,o.length-t,u++)}),o.length&&n.setIndex(o),l.length&&n[pB]("position",new pD.Float32BufferAttribute(l,3)),n}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pN(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(pD.BufferGeometry);function pU(e,t){var r=Math.round(e.vertices.length/3);pO(e.vertices,t.vertices),pO(e.indices,t.indices.map(function(e){return e+r}))}function pO(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=pI(e))){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.push(i)}}catch(e){n.e(e)}finally{n.f()}}function pk(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180;return[r*Math.sin(n)*Math.cos(i),r*Math.cos(n),r*Math.sin(n)*Math.sin(i)]}function pz(e,t,r){e*=1,t*=1,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((t-e)/r)),a=Array(i);++n<i;)a[n]=e+n*r;return a}function pV(e,t,r){var n=pz(e,t-1e-6,r).concat(t);return function(e){return n.map(function(t){return[e,t]})}}function pq(e,t,r){var n=pz(e,t-1e-6,r).concat(t);return function(e){return n.map(function(t){return[t,e]})}}function pG(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!t||!t.isReady)throw Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!e.hasAttribute("position")||!e.hasAttribute("normal")||!e.hasAttribute("uv"))throw Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function n(e){if(e.normalized||e.isInterleavedBufferAttribute){let t=new Float32Array(e.count*e.itemSize);for(let r=0,n=0;r<e.count;r++)t[n++]=e.getX(r),t[n++]=e.getY(r),e.itemSize>2&&(t[n++]=e.getZ(r));return t}return e.array instanceof Float32Array?e.array:new Float32Array(e.array)}let i=e.index?e.toNonIndexed():e,a=t.generateTangents(n(i.attributes.position),n(i.attributes.normal),n(i.attributes.uv));if(r)for(let e=3;e<a.length;e+=4)a[e]*=-1;return i.setAttribute("tangent",new rl(a,4)),e!==i&&e.copy(i),e}function pH(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),a={},s={},o=e[0].morphTargetsRelative,l=new rw,u=0;for(let c=0;c<e.length;++c){let h=e[c],d=0;if(r!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let e in h.attributes){if(!n.has(e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[e]&&(a[e]=[]),a[e].push(h.attributes[e]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let e in h.morphAttributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===s[e]&&(s[e]=[]),s[e].push(h.morphAttributes[e])}if(t){let e;if(r)e=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;e=h.attributes.position.count}l.addGroup(u,e,c),u+=e}}if(r){let t=0,r=[];for(let n=0;n<e.length;++n){let i=e[n].index;for(let e=0;e<i.count;++e)r.push(i.getX(e)+t);t+=e[n].attributes.position.count}l.setIndex(r)}for(let e in a){let t=pj(a[e]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+e+" attribute."),null;l.setAttribute(e,t)}for(let e in s){let t=s[e][0].length;if(0===t)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[e]=[];for(let r=0;r<t;++r){let t=[];for(let n=0;n<s[e].length;++n)t.push(s[e][n][r]);let n=pj(t);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+e+" morphAttribute."),null;l.morphAttributes[e].push(n)}}return l}function pj(e){let t,r,n,i=-1,a=0;for(let s=0;s<e.length;++s){let o=e[s];if(void 0===t&&(t=o.array.constructor),t!==o.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=o.itemSize),r!==o.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===n&&(n=o.normalized),n!==o.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===i&&(i=o.gpuType),i!==o.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=o.count*r}let s=new t(a),o=new rl(s,r,n),l=0;for(let t=0;t<e.length;++t){let n=e[t];if(n.isInterleavedBufferAttribute){let e=l/r;for(let t=0,i=n.count;t<i;t++)for(let i=0;i<r;i++){let r=n.getComponent(t,i);o.setComponent(t+e,i,r)}}else s.set(n.array,l);l+=n.count*r}return void 0!==i&&(o.gpuType=i),o}function pW(e){return e.isInstancedInterleavedBufferAttribute||e.isInterleavedBufferAttribute?pQ(e):e.isInstancedBufferAttribute?new nP().copy(e):new rl().copy(e)}function pX(e){let t,r=0,n=0;for(let i=0,a=e.length;i<a;++i){let a=e[i];if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;r+=a.array.length,n+=a.itemSize}let i=new r5(new t(r),n),a=0,s=[],o=["getX","getY","getZ","getW"],l=["setX","setY","setZ","setW"];for(let t=0,r=e.length;t<r;t++){let r=e[t],n=r.itemSize,u=r.count,c=new r7(i,n,a,r.normalized);s.push(c),a+=n;for(let e=0;e<u;e++)for(let t=0;t<n;t++)c[l[t]](e,r[o[t]](e))}return s}function pQ(e){let t,r=e.data.array.constructor,n=e.count,i=e.itemSize,a=e.normalized,s=new r(n*i);t=e.isInstancedInterleavedBufferAttribute?new nP(s,i,a,e.meshPerAttribute):new rl(s,i,a);for(let r=0;r<n;r++)t.setX(r,e.getX(r)),i>=2&&t.setY(r,e.getY(r)),i>=3&&t.setZ(r,e.getZ(r)),i>=4&&t.setW(r,e.getW(r));return t}function pY(e){let t=e.attributes,r=e.morphTargets,n=new Map;for(let e in t){let r=t[e];r.isInterleavedBufferAttribute&&(n.has(r)||n.set(r,pQ(r)),t[e]=n.get(r))}for(let e in r){let t=r[e];t.isInterleavedBufferAttribute&&(n.has(t)||n.set(t,pQ(t)),r[e]=n.get(t))}}function pK(e){let t=0;for(let r in e.attributes){let n=e.getAttribute(r);t+=n.count*n.itemSize*n.array.BYTES_PER_ELEMENT}let r=e.getIndex();return t+(r?r.count*r.itemSize*r.array.BYTES_PER_ELEMENT:0)}function pZ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);let r={},n=e.getIndex(),i=e.getAttribute("position"),a=n?n.count:i.count,s=0,o=Object.keys(e.attributes),l={},u={},c=[],h=["getX","getY","getZ","getW"],d=["setX","setY","setZ","setW"];for(let t=0,r=o.length;t<r;t++){let r=o[t],n=e.attributes[r];l[r]=new n.constructor(new n.array.constructor(n.count*n.itemSize),n.itemSize,n.normalized);let i=e.morphAttributes[r];i&&(u[r]||(u[r]=[]),i.forEach((e,t)=>{let n=new e.array.constructor(e.count*e.itemSize);u[r][t]=new e.constructor(n,e.itemSize,e.normalized)}))}let A=.5*t,p=Math.pow(10,Math.log10(1/t)),f=A*p;for(let t=0;t<a;t++){let i=n?n.getX(t):t,a="";for(let t=0,r=o.length;t<r;t++){let r=o[t],n=e.getAttribute(r),s=n.itemSize;for(let e=0;e<s;e++)a+="".concat(~~(n[h[e]](i)*p+f),",")}if(a in r)c.push(r[a]);else{for(let t=0,r=o.length;t<r;t++){let r=o[t],n=e.getAttribute(r),a=e.morphAttributes[r],c=n.itemSize,A=l[r],p=u[r];for(let e=0;e<c;e++){let t=h[e],r=d[e];if(A[r](s,n[t](i)),a)for(let e=0,n=a.length;e<n;e++)p[e][r](s,a[e][t](i))}}r[a]=s,c.push(s),s++}}let m=e.clone();for(let t in e.attributes){let e=l[t];if(m.setAttribute(t,new e.constructor(e.array.slice(0,s*e.itemSize),e.itemSize,e.normalized)),t in u)for(let e=0;e<u[t].length;e++){let r=u[t][e];m.morphAttributes[t][e]=new r.constructor(r.array.slice(0,s*r.itemSize),r.itemSize,r.normalized)}}return m.setIndex(c),m}function pJ(e,t){if(0===t)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(2!==t&&1!==t)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let n=r.count-2,i=[];if(2===t)for(let e=1;e<=n;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(i),a.clearGroups(),a}}function p$(e){let t,r,n,i,a,s,o,l,u,c,h=new ex,d=new ex,A=new ex,p=new ex,f=new ex,m=new ex,g=new ex,y=new ex,v=new ex;function x(e,t,r,n,i,a,s,o){h.fromBufferAttribute(t,i),d.fromBufferAttribute(t,a),A.fromBufferAttribute(t,s);let l=e.morphTargetInfluences;if(r&&l){g.set(0,0,0),y.set(0,0,0),v.set(0,0,0);for(let e=0,t=r.length;e<t;e++){let t=l[e],o=r[e];0!==t&&(p.fromBufferAttribute(o,i),f.fromBufferAttribute(o,a),m.fromBufferAttribute(o,s),n?(g.addScaledVector(p,t),y.addScaledVector(f,t),v.addScaledVector(m,t)):(g.addScaledVector(p.sub(h),t),y.addScaledVector(f.sub(d),t),v.addScaledVector(m.sub(A),t)))}h.add(g),d.add(y),A.add(v)}e.isSkinnedMesh&&(e.applyBoneTransform(i,h),e.applyBoneTransform(a,d),e.applyBoneTransform(s,A)),o[3*i+0]=h.x,o[3*i+1]=h.y,o[3*i+2]=h.z,o[3*a+0]=d.x,o[3*a+1]=d.y,o[3*a+2]=d.z,o[3*s+0]=A.x,o[3*s+1]=A.y,o[3*s+2]=A.z}let _=e.geometry,b=e.material,S=_.index,T=_.attributes.position,w=_.morphAttributes.position,M=_.morphTargetsRelative,E=_.attributes.normal,R=_.morphAttributes.position,C=_.groups,N=_.drawRange,P=new Float32Array(T.count*T.itemSize),I=new Float32Array(E.count*E.itemSize);if(null!==S)if(Array.isArray(b))for(i=0,s=C.length;i<s;i++)for(u=Math.max((l=C[i]).start,N.start),c=Math.min(l.start+l.count,N.start+N.count),a=u,o=c;a<o;a+=3)t=S.getX(a),x(e,T,w,M,t,r=S.getX(a+1),n=S.getX(a+2),P),x(e,E,R,M,t,r,n,I);else for(u=Math.max(0,N.start),c=Math.min(S.count,N.start+N.count),i=u,s=c;i<s;i+=3)t=S.getX(i),x(e,T,w,M,t,r=S.getX(i+1),n=S.getX(i+2),P),x(e,E,R,M,t,r,n,I);else if(Array.isArray(b))for(i=0,s=C.length;i<s;i++)for(u=Math.max((l=C[i]).start,N.start),c=Math.min(l.start+l.count,N.start+N.count),a=u,o=c;a<o;a+=3)x(e,T,w,M,t=a,r=a+1,n=a+2,P),x(e,E,R,M,t,r,n,I);else for(u=Math.max(0,N.start),c=Math.min(T.count,N.start+N.count),i=u,s=c;i<s;i+=3)x(e,T,w,M,t=i,r=i+1,n=i+2,P),x(e,E,R,M,t,r,n,I);return{positionAttribute:T,normalAttribute:E,morphedPositionAttribute:new rg(P,3),morphedNormalAttribute:new rg(I,3)}}function p0(e){if(0===e.groups.length)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),e;let t=e.groups;if(t=t.sort((e,t)=>e.materialIndex!==t.materialIndex?e.materialIndex-t.materialIndex:e.start-t.start),null===e.getIndex()){let t=e.getAttribute("position"),r=[];for(let e=0;e<t.count;e+=3)r.push(e,e+1,e+2);e.setIndex(r)}let r=e.getIndex(),n=[];for(let e=0;e<t.length;e++){let i=t[e],a=i.start,s=a+i.count;for(let e=a;e<s;e++)n.push(r.getX(e))}e.dispose(),e.setIndex(n);let i=0;for(let e=0;e<t.length;e++){let r=t[e];r.start=i,i+=r.count}let a=t[0];e.groups=[a];for(let r=1;r<t.length;r++){let n=t[r];a.materialIndex===n.materialIndex?a.count+=n.count:(a=n,e.groups.push(a))}return e}function p1(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI/3,r=Math.cos(t),n=(1+1e-10)*100,i=[new ex,new ex,new ex],a=new ex,s=new ex,o=new ex,l=new ex;function u(e){let t=~~(e.x*n),r=~~(e.y*n),i=~~(e.z*n);return"".concat(t,",").concat(r,",").concat(i)}let c=e.index?e.toNonIndexed():e,h=c.attributes.position,d={};for(let e=0,t=h.count/3;e<t;e++){let t=3*e,r=i[0].fromBufferAttribute(h,t+0),n=i[1].fromBufferAttribute(h,t+1),o=i[2].fromBufferAttribute(h,t+2);a.subVectors(o,n),s.subVectors(r,n);let l=new ex().crossVectors(a,s).normalize();for(let e=0;e<3;e++){let t=u(i[e]);t in d||(d[t]=[]),d[t].push(l)}}let A=new rl(new Float32Array(3*h.count),3,!1);for(let e=0,t=h.count/3;e<t;e++){let t=3*e,n=i[0].fromBufferAttribute(h,t+0),c=i[1].fromBufferAttribute(h,t+1),p=i[2].fromBufferAttribute(h,t+2);a.subVectors(p,c),s.subVectors(n,c),o.crossVectors(a,s).normalize();for(let e=0;e<3;e++){let n=d[u(i[e])];l.set(0,0,0);for(let e=0,t=n.length;e<t;e++){let t=n[e];o.dot(t)>r&&l.add(t)}l.normalize(),A.setXYZ(t+e,l.x,l.y,l.z)}}return c.setAttribute("normal",A),c}e.s(["computeMikkTSpaceTangents",()=>pG,"computeMorphedAttributes",()=>p$,"deepCloneAttribute",()=>pW,"deinterleaveAttribute",()=>pQ,"deinterleaveGeometry",()=>pY,"estimateBytesUsed",()=>pK,"interleaveAttributes",()=>pX,"mergeAttributes",()=>pj,"mergeGeometries",()=>pH,"mergeGroups",()=>p0,"mergeVertices",()=>pZ,"toCreasedNormals",()=>p1,"toTrianglesDrawMode",()=>pJ],52260);var p2=e.i(52260),p3=function(e){return"function"==typeof e?e:"string"==typeof e?function(t){return t[e]}:function(t){return e}};function p4(e){return(p4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p5=/^\s+/,p6=/\s+$/;function p7(e,t){if(t=t||{},(e=e||"")instanceof p7)return e;if(!(this instanceof p7))return new p7(e,t);var r,n,i,a,s,o,l,u,c,h,d,A,p,f,m,g,y,v,x,_,b=(n={r:0,g:0,b:0},i=1,a=null,s=null,o=null,l=!1,u=!1,"string"==typeof(r=e)&&(r=function(e){e=e.replace(p5,"").replace(p6,"").toLowerCase();var t,r=!1;if(fp[e])e=fp[e],r=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=fS.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=fS.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=fS.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=fS.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=fS.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=fS.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=fS.hex8.exec(e))?{r:fv(t[1]),g:fv(t[2]),b:fv(t[3]),a:fv(t[4])/255,format:r?"name":"hex8"}:(t=fS.hex6.exec(e))?{r:fv(t[1]),g:fv(t[2]),b:fv(t[3]),format:r?"name":"hex"}:(t=fS.hex4.exec(e))?{r:fv(t[1]+""+t[1]),g:fv(t[2]+""+t[2]),b:fv(t[3]+""+t[3]),a:fv(t[4]+""+t[4])/255,format:r?"name":"hex8"}:!!(t=fS.hex3.exec(e))&&{r:fv(t[1]+""+t[1]),g:fv(t[2]+""+t[2]),b:fv(t[3]+""+t[3]),format:r?"name":"hex"}}(r)),"object"==p4(r)&&(fT(r.r)&&fT(r.g)&&fT(r.b)?(c=r.r,h=r.g,d=r.b,n={r:255*fg(c,255),g:255*fg(h,255),b:255*fg(d,255)},l=!0,u="%"===String(r.r).substr(-1)?"prgb":"rgb"):fT(r.h)&&fT(r.s)&&fT(r.v)?(a=f_(r.s),s=f_(r.v),A=r.h,p=a,f=s,A=6*fg(A,360),p=fg(p,100),f=fg(f,100),m=Math.floor(A),g=A-m,y=f*(1-p),v=f*(1-g*p),x=f*(1-(1-g)*p),n={r:255*[f,v,y,y,x,f][_=m%6],g:255*[x,f,f,v,y,y][_],b:255*[y,y,x,f,f,v][_]},l=!0,u="hsv"):fT(r.h)&&fT(r.s)&&fT(r.l)&&(a=f_(r.s),o=f_(r.l),n=function(e,t,r){var n,i,a;function s(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}if(e=fg(e,360),t=fg(t,100),r=fg(r,100),0===t)n=i=a=r;else{var o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;n=s(l,o,e+1/3),i=s(l,o,e),a=s(l,o,e-1/3)}return{r:255*n,g:255*i,b:255*a}}(r.h,a,o),l=!0,u="hsl"),r.hasOwnProperty("a")&&(i=r.a)),i=fm(i),{ok:l,format:r.format||u,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:i});this._originalInput=e,this._r=b.r,this._g=b.g,this._b=b.b,this._a=b.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||b.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=b.ok}function p8(e,t,r){e=fg(e,255);var n,i,a=Math.max(e,t=fg(t,255),r=fg(r,255)),s=Math.min(e,t,r),o=(a+s)/2;if(a==s)n=i=0;else{var l=a-s;switch(i=o>.5?l/(2-a-s):l/(a+s),a){case e:n=(t-r)/l+6*(t<r);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,l:o}}function p9(e,t,r){e=fg(e,255);var n,i=Math.max(e,t=fg(t,255),r=fg(r,255)),a=Math.min(e,t,r),s=i-a;if(i==a)n=0;else{switch(i){case e:n=(t-r)/s+6*(t<r);break;case t:n=(r-e)/s+2;break;case r:n=(e-t)/s+4}n/=6}return{h:n,s:0===i?0:s/i,v:i}}function fe(e,t,r,n){var i=[fx(Math.round(e).toString(16)),fx(Math.round(t).toString(16)),fx(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function ft(e,t,r,n){return[fx(fb(n)),fx(Math.round(e).toString(16)),fx(Math.round(t).toString(16)),fx(Math.round(r).toString(16))].join("")}function fr(e,t){t=0===t?0:t||10;var r=p7(e).toHsl();return r.s-=t/100,r.s=fy(r.s),p7(r)}function fn(e,t){t=0===t?0:t||10;var r=p7(e).toHsl();return r.s+=t/100,r.s=fy(r.s),p7(r)}function fi(e){return p7(e).desaturate(100)}function fa(e,t){t=0===t?0:t||10;var r=p7(e).toHsl();return r.l+=t/100,r.l=fy(r.l),p7(r)}function fs(e,t){t=0===t?0:t||10;var r=p7(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-(t/100*255)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-(t/100*255)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-(t/100*255)))),p7(r)}function fo(e,t){t=0===t?0:t||10;var r=p7(e).toHsl();return r.l-=t/100,r.l=fy(r.l),p7(r)}function fl(e,t){var r=p7(e).toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,p7(r)}function fu(e){var t=p7(e).toHsl();return t.h=(t.h+180)%360,p7(t)}function fc(e,t){if(isNaN(t)||t<=0)throw Error("Argument to polyad must be a positive number");for(var r=p7(e).toHsl(),n=[p7(e)],i=360/t,a=1;a<t;a++)n.push(p7({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function fh(e){var t=p7(e).toHsl(),r=t.h;return[p7(e),p7({h:(r+72)%360,s:t.s,l:t.l}),p7({h:(r+216)%360,s:t.s,l:t.l})]}function fd(e,t,r){t=t||6,r=r||30;var n=p7(e).toHsl(),i=360/r,a=[p7(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,a.push(p7(n));return a}function fA(e,t){t=t||6;for(var r=p7(e).toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/t;t--;)s.push(p7({h:n,s:i,v:a})),a=(a+o)%1;return s}p7.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,r,n=this.toRgb();return e=n.r/255,t=n.g/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*((r=n.b/255)<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},setAlpha:function(e){return this._a=fm(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=p9(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=p9(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=p8(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=p8(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return fe(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){var t,r,n,i,a,s;return t=this._r,r=this._g,n=this._b,i=this._a,a=e,s=[fx(Math.round(t).toString(16)),fx(Math.round(r).toString(16)),fx(Math.round(n).toString(16)),fx(fb(i))],a&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*fg(this._r,255))+"%",g:Math.round(100*fg(this._g,255))+"%",b:Math.round(100*fg(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*fg(this._r,255))+"%, "+Math.round(100*fg(this._g,255))+"%, "+Math.round(100*fg(this._b,255))+"%)":"rgba("+Math.round(100*fg(this._r,255))+"%, "+Math.round(100*fg(this._g,255))+"%, "+Math.round(100*fg(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(ff[fe(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+ft(this._r,this._g,this._b,this._a),r=t,n=this._gradientType?"GradientType = 1, ":"";if(e){var i=p7(e);r="#"+ft(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,n=this._a<1&&this._a>=0;return!t&&n&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e)?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return p7(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(fa,arguments)},brighten:function(){return this._applyModification(fs,arguments)},darken:function(){return this._applyModification(fo,arguments)},desaturate:function(){return this._applyModification(fr,arguments)},saturate:function(){return this._applyModification(fn,arguments)},greyscale:function(){return this._applyModification(fi,arguments)},spin:function(){return this._applyModification(fl,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(fd,arguments)},complement:function(){return this._applyCombination(fu,arguments)},monochromatic:function(){return this._applyCombination(fA,arguments)},splitcomplement:function(){return this._applyCombination(fh,arguments)},triad:function(){return this._applyCombination(fc,[3])},tetrad:function(){return this._applyCombination(fc,[4])}},p7.fromRatio=function(e,t){if("object"==p4(e)){var r={};for(var n in e)e.hasOwnProperty(n)&&("a"===n?r[n]=e[n]:r[n]=f_(e[n]));e=r}return p7(e,t)},p7.equals=function(e,t){return!!e&&!!t&&p7(e).toRgbString()==p7(t).toRgbString()},p7.random=function(){return p7.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},p7.mix=function(e,t,r){r=0===r?0:r||50;var n=p7(e).toRgb(),i=p7(t).toRgb(),a=r/100;return p7({r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a})},p7.readability=function(e,t){var r=p7(e),n=p7(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)},p7.isReadable=function(e,t,r){var n,i,a,s,o,l=p7.readability(e,t);switch(o=!1,(i=((n=(n=r)||{level:"AA",size:"small"}).level||"AA").toUpperCase(),a=(n.size||"small").toLowerCase(),"AA"!==i&&"AAA"!==i&&(i="AA"),"small"!==a&&"large"!==a&&(a="small"),s={level:i,size:a}).level+s.size){case"AAsmall":case"AAAlarge":o=l>=4.5;break;case"AAlarge":o=l>=3;break;case"AAAsmall":o=l>=7}return o},p7.mostReadable=function(e,t,r){var n,i,a,s,o=null,l=0;i=(r=r||{}).includeFallbackColors,a=r.level,s=r.size;for(var u=0;u<t.length;u++)(n=p7.readability(e,t[u]))>l&&(l=n,o=p7(t[u]));return p7.isReadable(e,o,{level:a,size:s})||!i?o:(r.includeFallbackColors=!1,p7.mostReadable(e,["#fff","#000"],r))};var fp=p7.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},ff=p7.hexNames=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}(fp);function fm(e){return(isNaN(e=parseFloat(e))||e<0||e>1)&&(e=1),e}function fg(e,t){"string"==typeof(r=e)&&-1!=r.indexOf(".")&&1===parseFloat(r)&&(e="100%");var r,n,i="string"==typeof(n=e)&&-1!=n.indexOf("%");return(e=Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(e*t,10)/100),1e-6>Math.abs(e-t))?1:e%t/parseFloat(t)}function fy(e){return Math.min(1,Math.max(0,e))}function fv(e){return parseInt(e,16)}function fx(e){return 1==e.length?"0"+e:""+e}function f_(e){return e<=1&&(e=100*e+"%"),e}function fb(e){return Math.round(255*parseFloat(e)).toString(16)}var fS=function(){var e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",r="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:RegExp("rgb"+t),rgba:RegExp("rgba"+r),hsl:RegExp("hsl"+t),hsla:RegExp("hsla"+r),hsv:RegExp("hsv"+t),hsva:RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function fT(e){return!!fS.CSS_UNIT.exec(e)}function fw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function fM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw TypeError("Private element is not present on this object")}function fE(e,t){return e.get(fM(e,t))}function fR(e,t,r){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function fC(e,t,r){return e.set(fM(e,t),r),r}function fN(e,t){if(e){if("string"==typeof e)return fw(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fw(e,t):void 0}}var fP=new WeakMap,fI=new WeakMap,fL=new WeakMap,fD=new WeakMap,fB=new WeakMap,fF=new WeakMap,fU=function(){var e,t;return e=function e(){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");fR(this,fP,new Map),fR(this,fI,new Map),fR(this,fL,function(e){return e}),fR(this,fD,function(){return{}}),fR(this,fB,function(){}),fR(this,fF,function(){})},t=[{key:"getObj",value:function(e){return fE(fP,this).get(fE(fL,this).call(this,e))}},{key:"getData",value:function(e){return fE(fI,this).get(e)}},{key:"entries",value:function(){var e;return((function(e){if(Array.isArray(e))return fw(e)})(e=fE(fI,this).entries())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fN(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{a=(r=r.call(e)).next,!1;for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(e,2)||fN(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=t[0];return[t[1],r]})}},{key:"id",value:function(e){return fC(fL,this,p3(e)),this}},{key:"onCreateObj",value:function(e){return fC(fD,this,e),this}},{key:"onUpdateObj",value:function(e){return fC(fB,this,e),this}},{key:"onRemoveObj",value:function(e){return fC(fF,this,e),this}},{key:"digest",value:function(e){var t=this;e.filter(function(e){return!fE(fP,t).has(fE(fL,t).call(t,e))}).forEach(function(e){var r=fE(fD,t).call(t,e);fE(fP,t).set(fE(fL,t).call(t,e),r),fE(fI,t).set(r,e)});var r=new Map(e.map(function(e){return[fE(fL,t).call(t,e),e]}));return fE(fP,this).forEach(function(e,n){r.has(n)?fE(fB,t).call(t,e,r.get(n)):(fE(fF,t).call(t,e,n),fE(fP,t).delete(n),fE(fI,t).delete(e))}),this}},{key:"clear",value:function(){return this.digest([]),this}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(),fO=e.i(98641);function fk(e,t){let r,n;if(void 0===t)for(let t of e)null!=t&&(void 0===r?t>=t&&(r=n=t):(r>t&&(r=t),n<t&&(n=t)));else{let i=-1;for(let a of e)null!=(a=t(a,++i,e))&&(void 0===r?a>=a&&(r=n=a):(r>a&&(r=a),n<a&&(n=a)))}return[r,n]}let fz=(3+8881784197001252e-31)*11102230246251565e-32;function fV(e,t,r,n,i){let a,s,o,l,u=t[0],c=n[0],h=0,d=0;c>u==c>-u?(a=u,u=t[++h]):(a=c,c=n[++d]);let A=0;if(h<e&&d<r)for(c>u==c>-u?(s=u+a,o=a-(s-u),u=t[++h]):(s=c+a,o=a-(s-c),c=n[++d]),a=s,0!==o&&(i[A++]=o);h<e&&d<r;)c>u==c>-u?(l=(s=a+u)-a,o=a-(s-l)+(u-l),u=t[++h]):(l=(s=a+c)-a,o=a-(s-l)+(c-l),c=n[++d]),a=s,0!==o&&(i[A++]=o);for(;h<e;)l=(s=a+u)-a,o=a-(s-l)+(u-l),u=t[++h],a=s,0!==o&&(i[A++]=o);for(;d<r;)l=(s=a+c)-a,o=a-(s-l)+(c-l),c=n[++d],a=s,0!==o&&(i[A++]=o);return(0!==a||0===A)&&(i[A++]=a),A}function fq(e){return new Float64Array(e)}let fG=(3+17763568394002505e-31)*11102230246251565e-32,fH=(2+13322676295501878e-31)*11102230246251565e-32,fj=(9+7105427357601002e-30)*11102230246251565e-32*11102230246251565e-32,fW=fq(4),fX=fq(8),fQ=fq(12),fY=fq(16),fK=fq(4);function fZ(e,t,r,n,i,a){let s=(t-a)*(r-i),o=(e-i)*(n-a),l=s-o,u=Math.abs(s+o);return Math.abs(l)>=fG*u?l:-function(e,t,r,n,i,a,s){let o,l,u,c,h,d,A,p,f,m,g,y,v,x,_,b,S,T,w=e-i,M=r-i,E=t-a,R=n-a;x=w*R,A=(d=0x8000001*w)-(d-w),p=w-A,f=(d=0x8000001*R)-(d-R),_=p*(m=R-f)-(x-A*f-p*f-A*m),b=E*M,A=(d=0x8000001*E)-(d-E),p=E-A,f=(d=0x8000001*M)-(d-M),g=_-(S=p*(m=M-f)-(b-A*f-p*f-A*m)),h=_-g,fW[0]=_-(g+h)+(h-S),h=(y=x+g)-x,g=(v=x-(y-h)+(g-h))-b,h=v-g,fW[1]=v-(g+h)+(h-b),h=(T=y+g)-y,fW[2]=y-(T-h)+(g-h),fW[3]=T;let C=function(e,t){let r=t[0];for(let e=1;e<4;e++)r+=t[e];return r}(0,fW),N=fH*s;if(C>=N||-C>=N||(h=e-w,o=e-(w+h)+(h-i),h=r-M,u=r-(M+h)+(h-i),h=t-E,l=t-(E+h)+(h-a),h=n-R,c=n-(R+h)+(h-a),0===o&&0===l&&0===u&&0===c)||(N=fj*s+fz*Math.abs(C),(C+=w*c+R*o-(E*u+M*l))>=N||-C>=N))return C;x=o*R,A=(d=0x8000001*o)-(d-o),p=o-A,f=(d=0x8000001*R)-(d-R),_=p*(m=R-f)-(x-A*f-p*f-A*m),b=l*M,A=(d=0x8000001*l)-(d-l),p=l-A,f=(d=0x8000001*M)-(d-M),g=_-(S=p*(m=M-f)-(b-A*f-p*f-A*m)),h=_-g,fK[0]=_-(g+h)+(h-S),h=(y=x+g)-x,g=(v=x-(y-h)+(g-h))-b,h=v-g,fK[1]=v-(g+h)+(h-b),h=(T=y+g)-y,fK[2]=y-(T-h)+(g-h),fK[3]=T;let P=fV(4,fW,4,fK,fX);x=w*c,A=(d=0x8000001*w)-(d-w),p=w-A,f=(d=0x8000001*c)-(d-c),_=p*(m=c-f)-(x-A*f-p*f-A*m),b=E*u,A=(d=0x8000001*E)-(d-E),p=E-A,f=(d=0x8000001*u)-(d-u),g=_-(S=p*(m=u-f)-(b-A*f-p*f-A*m)),h=_-g,fK[0]=_-(g+h)+(h-S),h=(y=x+g)-x,g=(v=x-(y-h)+(g-h))-b,h=v-g,fK[1]=v-(g+h)+(h-b),h=(T=y+g)-y,fK[2]=y-(T-h)+(g-h),fK[3]=T;let I=fV(P,fX,4,fK,fQ);x=o*c,A=(d=0x8000001*o)-(d-o),p=o-A,f=(d=0x8000001*c)-(d-c),_=p*(m=c-f)-(x-A*f-p*f-A*m),b=l*u,A=(d=0x8000001*l)-(d-l),p=l-A,f=(d=0x8000001*u)-(d-u),g=_-(S=p*(m=u-f)-(b-A*f-p*f-A*m)),h=_-g,fK[0]=_-(g+h)+(h-S),h=(y=x+g)-x,g=(v=x-(y-h)+(g-h))-b,h=v-g,fK[1]=v-(g+h)+(h-b),h=(T=y+g)-y,fK[2]=y-(T-h)+(g-h),fK[3]=T;let L=fV(I,fQ,4,fK,fY);return fY[L-1]}(e,t,r,n,i,a,u)}fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(8),fq(8),fq(8),fq(4),fq(8),fq(8),fq(8),fq(12),fq(192),fq(192),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(8),fq(8),fq(8),fq(8),fq(8),fq(8),fq(8),fq(8),fq(8),fq(4),fq(4),fq(4),fq(8),fq(16),fq(16),fq(16),fq(32),fq(32),fq(48),fq(64),fq(1152),fq(1152),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(4),fq(24),fq(24),fq(24),fq(24),fq(24),fq(24),fq(24),fq(24),fq(24),fq(24),fq(1152),fq(1152),fq(1152),fq(1152),fq(1152),fq(2304),fq(2304),fq(3456),fq(5760),fq(8),fq(8),fq(8),fq(16),fq(24),fq(48),fq(48),fq(96),fq(192),fq(384),fq(384),fq(384),fq(768),fq(96),fq(96),fq(96),fq(1152);let fJ=new Uint32Array(512);class f${static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f4,n=e.length,i=new Float64Array(2*n);for(let a=0;a<n;a++){let n=e[a];i[2*a]=t(n),i[2*a+1]=r(n)}return new f$(i)}update(){let e,t,r,{coords:n,_hullPrev:i,_hullNext:a,_hullTri:s,_hullHash:o}=this,l=n.length>>1,u=1/0,c=1/0,h=-1/0,d=-1/0;for(let e=0;e<l;e++){let t=n[2*e],r=n[2*e+1];t<u&&(u=t),r<c&&(c=r),t>h&&(h=t),r>d&&(d=r),this._ids[e]=e}let A=(u+h)/2,p=(c+d)/2;for(let t=0,r=1/0;t<l;t++){let i=f0(A,p,n[2*t],n[2*t+1]);i<r&&(e=t,r=i)}let f=n[2*e],m=n[2*e+1];for(let r=0,i=1/0;r<l;r++){if(r===e)continue;let a=f0(f,m,n[2*r],n[2*r+1]);a<i&&a>0&&(t=r,i=a)}let g=n[2*t],y=n[2*t+1],v=1/0;for(let i=0;i<l;i++){if(i===e||i===t)continue;let a=function(e,t,r,n,i,a){let s=r-e,o=n-t,l=i-e,u=a-t,c=s*s+o*o,h=l*l+u*u,d=.5/(s*u-o*l),A=(u*c-o*h)*d,p=(s*h-l*c)*d;return A*A+p*p}(f,m,g,y,n[2*i],n[2*i+1]);a<v&&(r=i,v=a)}let x=n[2*r],_=n[2*r+1];if(v===1/0){for(let e=0;e<l;e++)this._dists[e]=n[2*e]-n[0]||n[2*e+1]-n[1];f1(this._ids,this._dists,0,l-1);let e=new Uint32Array(l),t=0;for(let r=0,n=-1/0;r<l;r++){let i=this._ids[r],a=this._dists[i];a>n&&(e[t++]=i,n=a)}this.hull=e.subarray(0,t),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(0>fZ(f,m,g,y,x,_)){let e=t,n=g,i=y;t=r,g=x,y=_,r=e,x=n,_=i}let b=function(e,t,r,n,i,a){let s=r-e,o=n-t,l=i-e,u=a-t,c=s*s+o*o,h=l*l+u*u,d=.5/(s*u-o*l);return{x:e+(u*c-o*h)*d,y:t+(s*h-l*c)*d}}(f,m,g,y,x,_);this._cx=b.x,this._cy=b.y;for(let e=0;e<l;e++)this._dists[e]=f0(n[2*e],n[2*e+1],b.x,b.y);f1(this._ids,this._dists,0,l-1),this._hullStart=e;let S=3;a[e]=i[r]=t,a[t]=i[e]=r,a[r]=i[t]=e,s[e]=0,s[t]=1,s[r]=2,o.fill(-1),o[this._hashKey(f,m)]=e,o[this._hashKey(g,y)]=t,o[this._hashKey(x,_)]=r,this.trianglesLen=0,this._addTriangle(e,t,r,-1,-1,-1);for(let l=0,u,c;l<this._ids.length;l++){let h=this._ids[l],d=n[2*h],A=n[2*h+1];if(l>0&&2220446049250313e-31>=Math.abs(d-u)&&2220446049250313e-31>=Math.abs(A-c)||(u=d,c=A,h===e||h===t||h===r))continue;let p=0;for(let e=0,t=this._hashKey(d,A);e<this._hashSize&&(-1===(p=o[(t+e)%this._hashSize])||p===a[p]);e++);let f=p=i[p],m;for(;m=a[f],fZ(d,A,n[2*f],n[2*f+1],n[2*m],n[2*m+1])>=0;)if((f=m)===p){f=-1;break}if(-1===f)continue;let g=this._addTriangle(f,h,a[f],-1,-1,s[f]);s[h]=this._legalize(g+2),s[f]=g,S++;let y=a[f];for(;m=a[y],0>fZ(d,A,n[2*y],n[2*y+1],n[2*m],n[2*m+1]);)g=this._addTriangle(y,h,m,s[h],-1,s[y]),s[h]=this._legalize(g+2),a[y]=y,S--,y=m;if(f===p)for(;0>fZ(d,A,n[2*(m=i[f])],n[2*m+1],n[2*f],n[2*f+1]);)g=this._addTriangle(m,h,f,-1,s[f],s[m]),this._legalize(g+2),s[m]=g,a[f]=f,S--,f=m;this._hullStart=i[h]=f,a[f]=i[y]=h,a[h]=y,o[this._hashKey(d,A)]=h,o[this._hashKey(n[2*f],n[2*f+1])]=f}this.hull=new Uint32Array(S);for(let e=0,t=this._hullStart;e<S;e++)this.hull[e]=t,t=a[t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){let r=e/(Math.abs(e)+Math.abs(t));return(t>0?3-r:1+r)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){let{_triangles:t,_halfedges:r,coords:n}=this,i=0,a=0;for(;;){let s=r[e],o=e-e%3;if(a=o+(e+2)%3,-1===s){if(0===i)break;e=fJ[--i];continue}let l=s-s%3,u=o+(e+1)%3,c=l+(s+2)%3,h=t[a],d=t[e],A=t[u],p=t[c];if(function(e,t,r,n,i,a,s,o){let l=e-s,u=t-o,c=r-s,h=n-o,d=i-s,A=a-o,p=c*c+h*h,f=d*d+A*A;return l*(h*f-p*A)-u*(c*f-p*d)+(l*l+u*u)*(c*A-h*d)<0}(n[2*h],n[2*h+1],n[2*d],n[2*d+1],n[2*A],n[2*A+1],n[2*p],n[2*p+1])){t[e]=p,t[s]=h;let n=r[c];if(-1===n){let t=this._hullStart;do{if(this._hullTri[t]===c){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,n),this._link(s,r[a]),this._link(a,c);let o=l+(s+1)%3;i<fJ.length&&(fJ[i++]=o)}else{if(0===i)break;e=fJ[--i]}}return a}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,r,n,i,a){let s=this.trianglesLen;return this._triangles[s]=e,this._triangles[s+1]=t,this._triangles[s+2]=r,this._link(s,n),this._link(s+1,i),this._link(s+2,a),this.trianglesLen+=3,s}constructor(e){let t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw Error("Expected coords to contain numbers.");this.coords=e;let r=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}}function f0(e,t,r,n){let i=e-r,a=t-n;return i*i+a*a}function f1(e,t,r,n){if(n-r<=20)for(let i=r+1;i<=n;i++){let n=e[i],a=t[n],s=i-1;for(;s>=r&&t[e[s]]>a;)e[s+1]=e[s--];e[s+1]=n}else{let i=r+n>>1,a=r+1,s=n;f2(e,i,a),t[e[r]]>t[e[n]]&&f2(e,r,n),t[e[a]]>t[e[n]]&&f2(e,a,n),t[e[r]]>t[e[a]]&&f2(e,r,a);let o=e[a],l=t[o];for(;;){do a++;while(t[e[a]]<l)do s--;while(t[e[s]]>l)if(s<a)break;f2(e,a,s)}e[r+1]=e[s],e[s]=o,n-a+1>=s-r?(f1(e,t,a,n),f1(e,t,r,s-1)):(f1(e,t,r,s-1),f1(e,t,a,n))}}function f2(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function f3(e){return e[0]}function f4(e){return e[1]}var f5,f6,f7,f8,f9,me,mt,mr,mn,mi,ma,ms,mo,ml=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)throw Error("point is required");if(!t)throw Error("polygon is required");let n=function(e){if(!e)throw Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return[...e.geometry.coordinates];if("Point"===e.type)return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw Error("coord must be GeoJSON Point or an Array of numbers")}(e),i="Feature"===t.type?t.geometry:t,a=i.type,s=t.bbox,o=i.coordinates;if(s&&!1==(u=n,(c=s)[0]<=u[0]&&c[1]<=u[1]&&c[2]>=u[0]&&c[3]>=u[1]))return!1;"Polygon"===a&&(o=[o]);let l=!1;for(var u,c,h=0;h<o.length;++h){let e=function(e,t){var r,n,i,a,s,o,l,u,c,h=0,d=e[0],A=e[1],p=t.length;for(r=0;r<p;r++){n=0;var f=t[r],m=f.length-1;if((u=f[0])[0]!==f[m][0]&&u[1]!==f[m][1])throw Error("First and last coordinates in a ring must be the same");for(a=u[0]-d,s=u[1]-A;n<m;n++){if(o=(c=f[n+1])[0]-d,l=c[1]-A,0===s&&0===l){if(o<=0&&a>=0||a<=0&&o>=0)return 0}else if(l>=0&&s<=0||l<=0&&s>=0){if(0===(i=fZ(a,o,s,l,0,0)))return 0;(i>0&&l>0&&s<=0||i<0&&l<=0&&s>0)&&h++}u=c,s=l,a=o}}return h%2!=0}(n,o[h]);if(0===e)return!r.ignoreBoundary;e&&(l=!0)}return l},mu=new d2,mc=new d2,mh={point:dK,lineStart:dK,lineEnd:dK,polygonStart:function(){mu=new d2,mh.lineStart=md,mh.lineEnd=mA},polygonEnd:function(){var e=+mu;mc.add(e<0?dR+e:e),this.lineStart=this.lineEnd=this.point=dK},sphere:function(){mc.add(dR)}};function md(){mh.point=mp}function mA(){mf(mn,mi)}function mp(e,t){mh.point=mf,mn=e,mi=t,e*=dN,t*=dN,ma=e,ms=dD(t=t/2+dE),mo=dk(t)}function mf(e,t){e*=dN,t*=dN;var r=e-ma,n=r>=0?1:-1,i=n*r,a=dD(t=t/2+dE),s=dk(t),o=mo*s,l=ms*a+o*dD(i),u=o*n*dk(i);mu.add(dL(u,l)),ma=e,ms=a,mo=s}var mm={point:mg,lineStart:mv,lineEnd:mx,polygonStart:function(){mm.point=m_,mm.lineStart=mb,mm.lineEnd=mS,E=new d2,mh.polygonStart()},polygonEnd:function(){mh.polygonEnd(),mm.point=mg,mm.lineStart=mv,mm.lineEnd=mx,mu<0?(v=-(_=180),x=-(b=90)):E>1e-6?b=90:E<-1e-6&&(x=-90),C[0]=v,C[1]=_},sphere:function(){v=-(_=180),x=-(b=90)}};function mg(e,t){R.push(C=[v=e,_=e]),t<x&&(x=t),t>b&&(b=t)}function my(e,t){var r=d4([e*dN,t*dN]);if(M){var n=d6(M,r),i=d6([n[1],-n[0],0],n);d9(i),i=d3(i);var a,s=e-S,o=s>0?1:-1,l=i[0]*dC*o,u=dP(s)>180;u^(o*S<l&&l<o*e)?(a=i[1]*dC)>b&&(b=a):u^(o*S<(l=(l+360)%360-180)&&l<o*e)?(a=-i[1]*dC)<x&&(x=a):(t<x&&(x=t),t>b&&(b=t)),u?e<S?mT(v,e)>mT(v,_)&&(_=e):mT(e,_)>mT(v,_)&&(v=e):_>=v?(e<v&&(v=e),e>_&&(_=e)):e>S?mT(v,e)>mT(v,_)&&(_=e):mT(e,_)>mT(v,_)&&(v=e)}else R.push(C=[v=e,_=e]);t<x&&(x=t),t>b&&(b=t),M=r,S=e}function mv(){mm.point=my}function mx(){C[0]=v,C[1]=_,mm.point=mg,M=null}function m_(e,t){if(M){var r=e-S;E.add(dP(r)>180?r+(r>0?360:-360):r)}else T=e,w=t;mh.point(e,t),my(e,t)}function mb(){mh.lineStart()}function mS(){m_(T,w),mh.lineEnd(),dP(E)>1e-6&&(v=-(_=180)),C[0]=v,C[1]=_,M=null}function mT(e,t){return(t-=e)<0?t+360:t}function mw(e,t){return e[0]-t[0]}function mM(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function mE(e){var t,r,n,i,a,s,o;if(b=_=-(v=x=1/0),R=[],Am(e,mm),r=R.length){for(R.sort(mw),t=1,a=[n=R[0]];t<r;++t)mM(n,(i=R[t])[0])||mM(n,i[1])?(mT(n[0],i[1])>mT(n[0],n[1])&&(n[1]=i[1]),mT(i[0],n[1])>mT(n[0],n[1])&&(n[0]=i[0])):a.push(n=i);for(s=-1/0,r=a.length-1,t=0,n=a[r];t<=r;n=i,++t)i=a[t],(o=mT(n[1],i[0]))>s&&(s=o,v=i[0],_=n[1])}return R=C=null,v===1/0||x===1/0?[[NaN,NaN],[NaN,NaN]]:[[v,x],[_,b]]}var mR={Feature:function(e,t){return mN(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,i=r.length;++n<i;)if(mN(r[n].geometry,t))return!0;return!1}},mC={Sphere:function(){return!0},Point:function(e,t){var r;return r=e.coordinates,0===pw(r,t)},MultiPoint:function(e,t){for(var r,n=e.coordinates,i=-1,a=n.length;++i<a;){if(r=n[i],0===pw(r,t))return!0}return!1},LineString:function(e,t){return mP(e.coordinates,t)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)if(mP(r[n],t))return!0;return!1},Polygon:function(e,t){return mI(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)if(mI(r[n],t))return!0;return!1},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,i=r.length;++n<i;)if(mN(r[n],t))return!0;return!1}};function mN(e,t){return!!(e&&mC.hasOwnProperty(e.type))&&mC[e.type](e,t)}function mP(e,t){for(var r,n,i,a=0,s=e.length;a<s;a++){if(0===(n=pw(e[a],t))||a>0&&(i=pw(e[a],e[a-1]))>0&&r<=i&&n<=i&&(r+n-i)*(1-Math.pow((r-n)/i,2))<1e-12*i)return!0;r=n}return!1}function mI(e,t){return!!At(e.map(mL),mD(t))}function mL(e){return(e=e.map(mD)).pop(),e}function mD(e){return[e[0]*dN,e[1]*dN]}var mB={sphere:dK,point:mF,lineStart:mO,lineEnd:mV,polygonStart:function(){mB.lineStart=mq,mB.lineEnd=mG},polygonEnd:function(){mB.lineStart=mO,mB.lineEnd=mV}};function mF(e,t){e*=dN;var r=dD(t*=dN);mU(r*dD(e),r*dk(e),dk(t))}function mU(e,t,r){++N,I+=(e-I)/N,L+=(t-L)/N,D+=(r-D)/N}function mO(){mB.point=mk}function mk(e,t){e*=dN;var r=dD(t*=dN);G=r*dD(e),H=r*dk(e),j=dk(t),mB.point=mz,mU(G,H,j)}function mz(e,t){e*=dN;var r=dD(t*=dN),n=r*dD(e),i=r*dk(e),a=dk(t),s=dL(dV((s=H*a-j*i)*s+(s=j*n-G*a)*s+(s=G*i-H*n)*s),G*n+H*i+j*a);P+=s,B+=s*(G+(G=n)),F+=s*(H+(H=i)),U+=s*(j+(j=a)),mU(G,H,j)}function mV(){mB.point=mF}function mq(){mB.point=mH}function mG(){mj(V,q),mB.point=mF}function mH(e,t){V=e,q=t,e*=dN,t*=dN,mB.point=mj;var r=dD(t);G=r*dD(e),H=r*dk(e),j=dk(t),mU(G,H,j)}function mj(e,t){e*=dN;var r=dD(t*=dN),n=r*dD(e),i=r*dk(e),a=dk(t),s=H*a-j*i,o=j*n-G*a,l=G*i-H*n,u=dU(s,o,l),c=dG(u),h=u&&-c/u;O.add(h*s),k.add(h*o),z.add(h*l),P+=c,B+=c*(G+(G=n)),F+=c*(H+(H=i)),U+=c*(j+(j=a)),mU(G,H,j)}function mW(e){N=P=I=L=D=B=F=U=0,O=new d2,k=new d2,z=new d2,Am(e,mB);var t=+O,r=+k,n=+z,i=dU(t,r,n);return i<1e-12&&(t=B,r=F,n=U,P<1e-6&&(t=I,r=L,n=D),(i=dU(t,r,n))<1e-12)?[NaN,NaN]:[dL(r,t)*dC,dG(n/i)*dC]}class mX{moveTo(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}arc(e,t,r){e*=1,t*=1,r*=1;let n=e+r,i=t;if(r<0)throw Error("negative radius");null===this._x1?this._+="M".concat(n,",").concat(i):(Math.abs(this._x1-n)>1e-6||Math.abs(this._y1-i)>1e-6)&&(this._+="L"+n+","+i),r&&(this._+="A".concat(r,",").concat(r,",0,1,1,").concat(e-r,",").concat(t,"A").concat(r,",").concat(r,",0,1,1,").concat(this._x1=n,",").concat(this._y1=i))}rect(e,t,r,n){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+r,"v").concat(+n,"h").concat(-r,"Z")}value(){return this._||null}constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}}class mQ{moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}constructor(){this._=[]}}class mY{update(){return this.delaunay.update(),this._init(),this}_init(){let e,t,{delaunay:{points:r,hull:n,triangles:i},vectors:a}=this,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let a=0,o=0,l=i.length,u,c;a<l;a+=3,o+=2){let l=2*i[a],h=2*i[a+1],d=2*i[a+2],A=r[l],p=r[l+1],f=r[h],m=r[h+1],g=r[d],y=r[d+1],v=f-A,x=m-p,_=g-A,b=y-p,S=(v*b-x*_)*2;if(1e-9>Math.abs(S)){if(void 0===e){for(let i of(e=t=0,n))e+=r[2*i],t+=r[2*i+1];e/=n.length,t/=n.length}let i=1e9*Math.sign((e-A)*b-(t-p)*_);u=(A+g)/2-i*b,c=(p+y)/2+i*_}else{let e=1/S,t=v*v+x*x,r=_*_+b*b;u=A+(b*t-x*r)*e,c=p+(v*r-_*t)*e}s[o]=u,s[o+1]=c}let o=n[n.length-1],l,u=4*o,c,h=r[2*o],d,A=r[2*o+1];a.fill(0);for(let e=0;e<n.length;++e)o=n[e],l=u,c=h,d=A,u=4*o,h=r[2*o],A=r[2*o+1],a[l+2]=a[u]=d-A,a[l+3]=a[u+1]=h-c}render(e){let t=null==e?e=new mX:void 0,{delaunay:{halfedges:r,inedges:n,hull:i},circumcenters:a,vectors:s}=this;if(i.length<=1)return null;for(let t=0,n=r.length;t<n;++t){let n=r[t];if(n<t)continue;let i=2*Math.floor(t/3),s=2*Math.floor(n/3),o=a[i],l=a[i+1],u=a[s],c=a[s+1];this._renderSegment(o,l,u,c,e)}let o,l=i[i.length-1];for(let t=0;t<i.length;++t){o=l;let r=2*Math.floor(n[l=i[t]]/3),u=a[r],c=a[r+1],h=4*o,d=this._project(u,c,s[h+2],s[h+3]);d&&this._renderSegment(u,c,d[0],d[1],e)}return t&&t.value()}renderBounds(e){let t=null==e?e=new mX:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){let r=null==t?t=new mX:void 0,n=this._clip(e);if(null===n||!n.length)return;t.moveTo(n[0],n[1]);let i=n.length;for(;n[0]===n[i-2]&&n[1]===n[i-1]&&i>1;)i-=2;for(let e=2;e<i;e+=2)(n[e]!==n[e-2]||n[e+1]!==n[e-1])&&t.lineTo(n[e],n[e+1]);return t.closePath(),r&&r.value()}*cellPolygons(){let{delaunay:{points:e}}=this;for(let t=0,r=e.length/2;t<r;++t){let e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){let t=new mQ;return this.renderCell(e,t),t.value()}_renderSegment(e,t,r,n,i){let a,s=this._regioncode(e,t),o=this._regioncode(r,n);0===s&&0===o?(i.moveTo(e,t),i.lineTo(r,n)):(a=this._clipSegment(e,t,r,n,s,o))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}contains(e,t,r){return(t*=1)==t&&(r*=1)==r&&this.delaunay._step(e,t,r)===e}*neighbors(e){let t=this._clip(e);if(t)for(let r of this.delaunay.neighbors(e)){let e=this._clip(r);if(e){l:for(let n=0,i=t.length;n<i;n+=2)for(let a=0,s=e.length;a<s;a+=2)if(t[n]===e[a]&&t[n+1]===e[a+1]&&t[(n+2)%i]===e[(a+s-2)%s]&&t[(n+3)%i]===e[(a+s-1)%s]){yield r;break l}}}}_cell(e){let{circumcenters:t,delaunay:{inedges:r,halfedges:n,triangles:i}}=this,a=r[e];if(-1===a)return null;let s=[],o=a;do{let r=Math.floor(o/3);if(s.push(t[2*r],t[2*r+1]),i[o=o%3==2?o-2:o+1]!==e)break;o=n[o]}while(o!==a&&-1!==o)return s}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let t=this._cell(e);if(null===t)return null;let{vectors:r}=this,n=4*e;return this._simplify(r[n]||r[n+1]?this._clipInfinite(e,t,r[n],r[n+1],r[n+2],r[n+3]):this._clipFinite(e,t))}_clipFinite(e,t){let r=t.length,n=null,i,a,s=t[r-2],o=t[r-1],l,u=this._regioncode(s,o),c,h=0;for(let d=0;d<r;d+=2)if(i=s,a=o,s=t[d],o=t[d+1],l=u,u=this._regioncode(s,o),0===l&&0===u)c=h,h=0,n?n.push(s,o):n=[s,o];else{let t,r,d,A,p;if(0===l){if(null===(t=this._clipSegment(i,a,s,o,l,u)))continue;[r,d,A,p]=t}else{if(null===(t=this._clipSegment(s,o,i,a,u,l)))continue;[A,p,r,d]=t,c=h,h=this._edgecode(r,d),c&&h&&this._edge(e,c,h,n,n.length),n?n.push(r,d):n=[r,d]}c=h,h=this._edgecode(A,p),c&&h&&this._edge(e,c,h,n,n.length),n?n.push(A,p):n=[A,p]}if(n)c=h,h=this._edgecode(n[0],n[1]),c&&h&&this._edge(e,c,h,n,n.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return n}_clipSegment(e,t,r,n,i,a){let s=i<a;for(s&&([e,t,r,n,i,a]=[r,n,e,t,a,i]);;){if(0===i&&0===a)return s?[r,n,e,t]:[e,t,r,n];if(i&a)return null;let o,l,u=i||a;8&u?(o=e+(r-e)*(this.ymax-t)/(n-t),l=this.ymax):4&u?(o=e+(r-e)*(this.ymin-t)/(n-t),l=this.ymin):2&u?(l=t+(n-t)*(this.xmax-e)/(r-e),o=this.xmax):(l=t+(n-t)*(this.xmin-e)/(r-e),o=this.xmin),i?(e=o,t=l,i=this._regioncode(e,t)):(r=o,n=l,a=this._regioncode(r,n))}}_clipInfinite(e,t,r,n,i,a){let s=Array.from(t),o;if((o=this._project(s[0],s[1],r,n))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(e,s))for(let t=0,r=s.length,n,i=this._edgecode(s[r-2],s[r-1]);t<r;t+=2)n=i,i=this._edgecode(s[t],s[t+1]),n&&i&&(t=this._edge(e,n,i,s,t),r=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,r,n,i){for(;t!==r;){let r,a;switch(t){case 5:t=4;continue;case 4:t=6,r=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,r=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,r=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,r=this.xmin,a=this.ymin}(n[i]!==r||n[i+1]!==a)&&this.contains(e,r,a)&&(n.splice(i,0,r,a),i+=2)}return i}_project(e,t,r,n){let i=1/0,a,s,o;if(n<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/n)<i&&(o=this.ymin,s=e+(i=a)*r)}else if(n>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/n)<i&&(o=this.ymax,s=e+(i=a)*r)}if(r>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/r)<i&&(s=this.xmax,o=t+(i=a)*n)}else if(r<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/r)<i&&(s=this.xmin,o=t+(i=a)*n)}return[s,o]}_edgecode(e,t){return(e===this.xmin?1:2*(e===this.xmax))|(t===this.ymin?4:8*(t===this.ymax))}_regioncode(e,t){return(e<this.xmin?1:2*(e>this.xmax))|(t<this.ymin?4:8*(t>this.ymax))}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){let r=(t+2)%e.length,n=(t+4)%e.length;(e[t]===e[r]&&e[r]===e[n]||e[t+1]===e[r+1]&&e[r+1]===e[n+1])&&(e.splice(r,2),t-=2)}e.length||(e=null)}return e}constructor(e,[t,r,n,i]=[0,0,960,500]){if(!((n*=1)>=(t*=1))||!((i*=1)>=(r*=1)))throw Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=n,this.xmin=t,this.ymax=i,this.ymin=r,this._init()}}let mK=2*Math.PI,mZ=Math.pow;function mJ(e){return e[0]}function m$(e){return e[1]}class m0{static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mJ,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m$,n=arguments.length>3?arguments[3]:void 0;return new m0("length"in e?function(e,t,r,n){let i=e.length,a=new Float64Array(2*i);for(let s=0;s<i;++s){let i=e[s];a[2*s]=t.call(n,i,s,e),a[2*s+1]=r.call(n,i,s,e)}return a}(e,t,r,n):Float64Array.from(function*(e,t,r,n){let i=0;for(let a of e)yield t.call(n,a,i,e),yield r.call(n,a,i,e),++i}(e,t,r,n)))}update(){return this._delaunator.update(),this._init(),this}_init(){let e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){let{triangles:t,coords:r}=e;for(let e=0;e<t.length;e+=3){let n=2*t[e],i=2*t[e+1],a=2*t[e+2];if((r[a]-r[n])*(r[i+1]-r[n+1])-(r[i]-r[n])*(r[a+1]-r[n+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(e,t)=>t).sort((e,r)=>t[2*e]-t[2*r]||t[2*e+1]-t[2*r+1]);let e=this.collinear[0],i=this.collinear[this.collinear.length-1],a=[t[2*e],t[2*e+1],t[2*i],t[2*i+1]],s=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]);for(let e=0,i=t.length/2;e<i;++e){var r,n;let i=(r=t[2*e],[r+Math.sin(r+(n=t[2*e+1]))*s,n+Math.cos(r-n)*s]);t[2*e]=i[0],t[2*e+1]=i[1]}this._delaunator=new f$(t)}else delete this.collinear;let i=this.halfedges=this._delaunator.halfedges,a=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let e=0,t=i.length;e<t;++e){let t=s[e%3==2?e-2:e+1];(-1===i[e]||-1===o[t])&&(o[t]=e)}for(let e=0,t=a.length;e<t;++e)l[a[e]]=e;a.length<=2&&a.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=a[0],o[a[0]]=1,2===a.length&&(o[a[1]]=0,this.triangles[1]=a[1],this.triangles[2]=a[1]))}voronoi(e){return new mY(this,e)}*neighbors(e){let{inedges:t,hull:r,_hullIndex:n,halfedges:i,triangles:a,collinear:s}=this;if(s){let t=s.indexOf(e);t>0&&(yield s[t-1]),t<s.length-1&&(yield s[t+1]);return}let o=t[e];if(-1===o)return;let l=o,u=-1;do{if(yield u=a[l],a[l=l%3==2?l-2:l+1]!==e)return;if(-1===(l=i[l])){let t=r[(n[e]+1)%r.length];t!==u&&(yield t);return}}while(l!==o)}find(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e*=1)!=e||(t*=1)!=t)return -1;let i=n;for(;(r=this._step(n,e,t))>=0&&r!==n&&r!==i;)n=r;return r}_step(e,t,r){let{inedges:n,hull:i,_hullIndex:a,halfedges:s,triangles:o,points:l}=this;if(-1===n[e]||!l.length)return(e+1)%(l.length>>1);let u=e,c=mZ(t-l[2*e],2)+mZ(r-l[2*e+1],2),h=n[e],d=h;do{let n=o[d],h=mZ(t-l[2*n],2)+mZ(r-l[2*n+1],2);if(h<c&&(c=h,u=n),o[d=d%3==2?d-2:d+1]!==e)break;if(-1===(d=s[d])){if((d=i[(a[e]+1)%i.length])!==n&&mZ(t-l[2*d],2)+mZ(r-l[2*d+1],2)<c)return d;break}}while(d!==h)return u}render(e){let t=null==e?e=new mX:void 0,{points:r,halfedges:n,triangles:i}=this;for(let t=0,a=n.length;t<a;++t){let a=n[t];if(a<t)continue;let s=2*i[t],o=2*i[a];e.moveTo(r[s],r[s+1]),e.lineTo(r[o],r[o+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){void 0!==t||e&&"function"==typeof e.moveTo||(t=e,e=null),t=void 0==t?2:+t;let r=null==e?e=new mX:void 0,{points:n}=this;for(let r=0,i=n.length;r<i;r+=2){let i=n[r],a=n[r+1];e.moveTo(i+t,a),e.arc(i,a,t,0,mK)}return r&&r.value()}renderHull(e){let t=null==e?e=new mX:void 0,{hull:r,points:n}=this,i=2*r[0],a=r.length;e.moveTo(n[i],n[i+1]);for(let t=1;t<a;++t){let i=2*r[t];e.lineTo(n[i],n[i+1])}return e.closePath(),t&&t.value()}hullPolygon(){let e=new mQ;return this.renderHull(e),e.value()}renderTriangle(e,t){let r=null==t?t=new mX:void 0,{points:n,triangles:i}=this,a=2*i[e*=3],s=2*i[e+1],o=2*i[e+2];return t.moveTo(n[a],n[a+1]),t.lineTo(n[s],n[s+1]),t.lineTo(n[o],n[o+1]),t.closePath(),r&&r.value()}*trianglePolygons(){let{triangles:e}=this;for(let t=0,r=e.length/3;t<r;++t)yield this.trianglePolygon(t)}trianglePolygon(e){let t=new mQ;return this.renderTriangle(e,t),t.value()}constructor(e){this._delaunator=new f$(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}}function m1(e,t){var r=dD(t),n=1+dD(e)*r;return[r*dk(e)/n,dk(t)/n]}m1.invert=function(e,t){var r=dV(e*e+t*t),n=function(e){return 2*dI(e)}(r),i=dk(n);return[dL(e*i,r*dD(n)),dG(r&&t*i/r)]};let m2=Math.PI,m3=m2/2,m4=180/m2,m5=m2/180,m6=Math.atan2,m7=Math.cos,m8=Math.max,m9=Math.min,ge=Math.sin,gt=Math.sign||function(e){return e>0?1:e<0?-1:0},gr=Math.sqrt;function gn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function gi(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ga(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function gs(e){var t=gr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]}function go(e){var t;return[m6(e[1],e[0])*m4,((t=m8(-1,m9(1,e[2])))>1?m3:t<-1?-m3:Math.asin(t))*m4]}function gl(e){let t=e[0]*m5,r=e[1]*m5,n=m7(r);return[n*m7(t),n*ge(t),ge(r)]}function gu(e){return gn((e=e.map(e=>gl(e)))[0],gi(e[2],e[1]))}function gc(e,t,r){e=gl(e),t=gl(t),r=gl(r);let n=gt(gn(gi(t,e),r));return go(gs(ga(e,t)).map(e=>n*e))}function gh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function gd(e){return(gd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(gA=function(){return!!e})()}function gp(e,t){return(gp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function gf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t);else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(e,t)||gg(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gm(e){return function(e){if(Array.isArray(e))return gh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||gg(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gg(e,t){if(e){if("string"==typeof e)return gh(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gh(e,t):void 0}}function gy(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?(t&&mR.hasOwnProperty(t.type)?mR[t.type]:mN)(t,e):ml(e,t)}var gv=window.THREE?window.THREE:{BufferGeometry:rw,Float32BufferAttribute:rg},gx=new gv.BufferGeometry().setAttribute?"setAttribute":"addAttribute",g_=function(e){function t(e,r,n,i,a,s,o){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");l=gd(l=t),(u=function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,gA()?Reflect.construct(l,[],gd(this).constructor):l.apply(this,void 0))).type="ConicPolygonGeometry",u.parameters={polygonGeoJson:e,bottomHeight:r,topHeight:n,closedBottom:i,closedTop:a,includeSides:s,curvatureResolution:o},r=r||0,n=n||1,i=void 0===i||i,a=void 0===a||a,s=void 0===s||s;var l,u,c=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.resolution,a=void 0===i?1/0:i,s=(t=e,r=a,t.map(function(e){var t,n=[];return e.forEach(function(e){if(t){var i=180*pw(e,t)/Math.PI;if(i>r)for(var a=pM(t,e),s=1/Math.ceil(i/r),o=s;o<1;)n.push(a(o)),o+=s}n.push(t=e)}),n})),o=Ar(s),l=function(e,t){var r={type:"Polygon",coordinates:e},n=gf(mE(r),2),i=gf(n[0],2),a=i[0],s=i[1],o=gf(n[1],2),l=o[0],u=o[1];if(Math.min(Math.abs(l-a),Math.abs(u-s))<t)return[];var c=a>l||u>=89||s<=-89;return(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minLng,n=t.maxLng,i=t.minLat,a=t.maxLat,s=Math.round(Math.pow(360/e,2)/Math.PI),o=(1+Math.sqrt(5))/2,l=function(e){return s*(Math.cos((e+90)*Math.PI/180)+1)/2},u=[void 0!==a?Math.ceil(l(a)):0,void 0!==i?Math.floor(l(i)):s-1],c=void 0===r&&void 0===n?function(){return!0}:void 0===r?function(e){return e<=n}:void 0===n?function(e){return e>=r}:n>=r?function(e){return e>=r&&e<=n}:function(e){return e>=r||e<=n},h=[],d=u[0];d<=u[1];d++){var A=d/o*360%360-180;c(A)&&h.push([A,Math.acos(2*d/s-1)/Math.PI*180-90])}return h})(t,{minLng:a,maxLng:l,minLat:s,maxLat:u}).filter(function(e){return gy(e,r,c)})}(e,a),u=[].concat(gm(o),gm(l)),c={type:"Polygon",coordinates:e},h=gf(mE(c),2),d=gf(h[0],2),A=d[0],p=d[1],f=gf(h[1],2),m=f[0],g=f[1],y=A>m||g>=89||p<=-89,v=[];if(y){var x=(function(e){let t=function(e){if(t.delaunay=null,t._data=e,"object"==typeof t._data&&"FeatureCollection"===t._data.type&&(t._data=t._data.features),"object"==typeof t._data){let e=t._data.map(e=>[t._vx(e),t._vy(e),e]).filter(e=>isFinite(e[0]+e[1]));t.points=e.map(e=>[e[0],e[1]]),t.valid=e.map(e=>e[2]),t.delaunay=function(e){var t,r,n,i;let a=function(e){if(e.length<2)return{};let t=0;for(;isNaN(e[t][0]+e[t][1])&&t++<e.length;);let r=function(e){function t(t){return t=e(t[0]*dN,t[1]*dN),t[0]*=dC,t[1]*=dC,t}return e=dW(e[0]*dN,e[1]*dN,e.length>2?e[2]*dN:0),t.invert=function(t){return t=e.invert(t[0]*dN,t[1]*dN),t[0]*=dC,t[1]*=dC,t},t}(e[t]),n=(function(e){var t,r,n,i,a,s,o,l,u,c,h=150,d=480,A=250,p=0,f=0,m=0,g=0,y=0,v=0,x=1,_=1,b=null,S=As,T=null,w=Al,M=.5;function E(e){return l(e[0]*dN,e[1]*dN)}function R(e){return(e=l.invert(e[0],e[1]))&&[e[0]*dC,e[1]*dC]}function C(){var e=AE(h,0,0,x,_,v).apply(null,t(p,f)),n=AE(h,d-e[0],A-e[1],x,_,v);return r=dW(m,g,y),o=dH(t,n),l=dH(r,o),s=Aw(o,M),N()}function N(){return u=c=null,E}return E.stream=function(e){var t;return u&&c===e?u:u=AM((t=r,Au({point:function(e,r){var n=t(e,r);return this.stream.point(n[0],n[1])}}))(S(s(w(c=e)))))},E.preclip=function(e){return arguments.length?(S=e,b=void 0,N()):S},E.postclip=function(e){return arguments.length?(w=e,T=n=i=a=null,N()):w},E.clipAngle=function(e){return arguments.length?(S=+e?function(e){var t=dD(e),r=2*dN,n=t>0,i=dP(t)>1e-6;function a(e,r){return dD(e)*dD(r)>t}function s(e,r,n){var i=d4(e),a=d4(r),s=[1,0,0],o=d6(i,a),l=d5(o,o),u=o[0],c=l-u*u;if(!c)return!n&&e;var h=d6(s,o),d=d8(s,t*l/c);d7(d,d8(o,-t*u/c));var A=d5(d,h),p=d5(h,h),f=A*A-p*(d5(d,d)-1);if(!(f<0)){var m=dV(f),g=d8(h,(-A-m)/p);if(d7(g,d),g=d3(g),!n)return g;var y,v=e[0],x=r[0],_=e[1],b=r[1];x<v&&(y=v,v=x,x=y);var S=x-v,T=1e-6>dP(S-dw);if(!T&&b<_&&(y=_,_=b,b=y),T||S<1e-6?T?_+b>0^g[1]<(1e-6>dP(g[0]-v)?_:b):_<=g[1]&&g[1]<=b:S>dw^(v<=g[0]&&g[0]<=x)){var w=d8(h,(-A+m)/p);return d7(w,d),[g,d3(w)]}}}function o(t,r){var i=n?e:dw-e,a=0;return t<-i?a|=1:t>i&&(a|=2),r<-i?a|=4:r>i&&(a|=8),a}return An(a,function(e){var t,r,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var A,p,f=[h,d],m=a(h,d),g=n?m?0:o(h,d):m?o(h+(h<0?dw:-dw),d):0;!t&&(u=l=m)&&e.lineStart(),m!==l&&(!(p=s(t,f))||dJ(t,p)||dJ(f,p))&&(f[2]=1),m!==l?(c=0,m?(e.lineStart(),p=s(f,t),e.point(p[0],p[1])):(p=s(t,f),e.point(p[0],p[1],2),e.lineEnd()),t=p):i&&t&&n^m&&!(g&r)&&(A=s(f,t,!0))&&(c=0,n?(e.lineStart(),e.point(A[0][0],A[0][1]),e.point(A[1][0],A[1][1]),e.lineEnd()):(e.point(A[1][0],A[1][1]),e.lineEnd(),e.lineStart(),e.point(A[0][0],A[0][1],3))),!m||t&&dJ(t,f)||e.point(f[0],f[1]),t=f,l=m,r=g},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return c|(u&&l)<<1}}},function(t,n,i,a){!function(e,t,r,n,i,a){if(r){var s=dD(t),o=dk(t),l=n*r;null==i?(i=t+n*dR,a=t-l/2):(i=Ao(s,i),a=Ao(s,a),(n>0?i<a:i>a)&&(i+=n*dR));for(var u,c=i;n>0?c>a:c<a;c-=l)u=d3([s,-o*dD(c),-o*dk(c)]),e.point(u[0],u[1])}}(a,e,r,i,t,n)},n?[0,-e]:[-dw,e-dw])}(b=e*dN):(b=null,As),N()):b*dC},E.clipExtent=function(e){return arguments.length?(w=null==e?(T=n=i=a=null,Al):function(e,t,r,n){function i(i,a){return e<=i&&i<=r&&t<=a&&a<=n}function a(i,a,o,u){var c=0,h=0;if(null==i||(c=s(i,o))!==(h=s(a,o))||0>l(i,a)^o>0)do u.point(0===c||3===c?e:r,c>1?n:t);while((c=(c+o+4)%4)!==h)else u.point(a[0],a[1])}function s(n,i){return 1e-6>dP(n[0]-e)?i>0?0:3:1e-6>dP(n[0]-r)?i>0?2:1:1e-6>dP(n[1]-t)?+(i>0):i>0?3:2}function o(e,t){return l(e.x,t.x)}function l(e,t){var r=s(e,1),n=s(t,1);return r!==n?r-n:0===r?t[1]-e[1]:1===r?e[0]-t[0]:2===r?e[1]-t[1]:t[0]-e[0]}return function(s){var l,u,c,h,d,A,p,f,m,g,y,v=s,x=dZ(),_={point:b,lineStart:function(){_.point=S,u&&u.push(c=[]),g=!0,m=!1,p=f=NaN},lineEnd:function(){l&&(S(h,d),A&&m&&x.rejoin(),l.push(x.result())),_.point=b,m&&v.lineEnd()},polygonStart:function(){v=x,l=[],u=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,r=0,i=u.length;r<i;++r)for(var a,s,o=u[r],l=1,c=o.length,h=o[0],d=h[0],A=h[1];l<c;++l)a=d,s=A,d=(h=o[l])[0],A=h[1],s<=n?A>n&&(d-a)*(n-s)>(A-s)*(e-a)&&++t:A<=n&&(d-a)*(n-s)<(A-s)*(e-a)&&--t;return t}(),r=y&&t,i=(l=Ar(l)).length;(r||i)&&(s.polygonStart(),r&&(s.lineStart(),a(null,null,1,s),s.lineEnd()),i&&d0(l,o,t,a,s),s.polygonEnd()),v=s,l=u=c=null}};function b(e,t){i(e,t)&&v.point(e,t)}function S(a,s){var o=i(a,s);if(u&&c.push([a,s]),g)h=a,d=s,A=o,g=!1,o&&(v.lineStart(),v.point(a,s));else if(o&&m)v.point(a,s);else{var l=[p=Math.max(-1e9,Math.min(1e9,p)),f=Math.max(-1e9,Math.min(1e9,f))],x=[a=Math.max(-1e9,Math.min(1e9,a)),s=Math.max(-1e9,Math.min(1e9,s))];!function(e,t,r,n,i,a){var s,o=e[0],l=e[1],u=t[0],c=t[1],h=0,d=1,A=u-o,p=c-l;if(s=r-o,!A&&s>0)return;if(s/=A,A<0){if(s<h)return;s<d&&(d=s)}else if(A>0){if(s>d)return;s>h&&(h=s)}if(s=i-o,A||!(s<0)){if(s/=A,A<0){if(s>d)return;s>h&&(h=s)}else if(A>0){if(s<h)return;s<d&&(d=s)}if(s=n-l,p||!(s>0)){if(s/=p,p<0){if(s<h)return;s<d&&(d=s)}else if(p>0){if(s>d)return;s>h&&(h=s)}if(s=a-l,p||!(s<0)){if(s/=p,p<0){if(s>d)return;s>h&&(h=s)}else if(p>0){if(s<h)return;s<d&&(d=s)}return h>0&&(e[0]=o+h*A,e[1]=l+h*p),d<1&&(t[0]=o+d*A,t[1]=l+d*p),!0}}}}(l,x,e,t,r,n)?o&&(v.lineStart(),v.point(a,s),y=!1):(m||(v.lineStart(),v.point(l[0],l[1])),v.point(x[0],x[1]),o||v.lineEnd(),y=!1)}p=a,f=s,m=o}return _}}(T=+e[0][0],n=+e[0][1],i=+e[1][0],a=+e[1][1]),N()):null==T?null:[[T,n],[i,a]]},E.scale=function(e){return arguments.length?(h=+e,C()):h},E.translate=function(e){return arguments.length?(d=+e[0],A=+e[1],C()):[d,A]},E.center=function(e){return arguments.length?(p=e[0]%360*dN,f=e[1]%360*dN,C()):[p*dC,f*dC]},E.rotate=function(e){return arguments.length?(m=e[0]%360*dN,g=e[1]%360*dN,y=e.length>2?e[2]%360*dN:0,C()):[m*dC,g*dC,y*dC]},E.angle=function(e){return arguments.length?(v=e%360*dN,C()):v*dC},E.reflectX=function(e){return arguments.length?(x=e?-1:1,C()):x<0},E.reflectY=function(e){return arguments.length?(_=e?-1:1,C()):_<0},E.precision=function(e){return arguments.length?(s=Aw(o,M=e*e),N()):dV(M)},E.fitExtent=function(e,t){return AS(E,e,t)},E.fitSize=function(e,t){return AS(E,[[0,0],e],t)},E.fitWidth=function(e,t){return Ab(E,function(t){var r=+e,n=r/(t[1][0]-t[0][0]),i=(r-n*(t[1][0]+t[0][0]))/2,a=-n*t[0][1];E.scale(150*n).translate([i,a])},t)},E.fitHeight=function(e,t){return Ab(E,function(t){var r=+e,n=r/(t[1][1]-t[0][1]),i=-n*t[0][0],a=(r-n*(t[1][1]+t[0][1]))/2;E.scale(150*n).translate([i,a])},t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&R,C()}})(function(){return m1})().scale(250).clipAngle(142).translate([0,0]).scale(1).rotate(r.invert([180,0]));e=e.map(n);let i=[],a=1;for(let t=0,r=e.length;t<r;t++){let r=e[t][0]**2+e[t][1]**2;!isFinite(r)||r>1e32?i.push(t):r>a&&(a=r)}let s=1e6*gr(a);i.forEach(t=>e[t]=[s,0]),e.push([0,s]),e.push([-s,0]),e.push([0,-s]);let o=m0.from(e);o.projection=n;let{triangles:l,halfedges:u,inedges:c}=o,h=[];for(let r=0,n=u.length;r<n;r++)if(u[r]<0){let e=r%3==2?r-2:r+1,n=r%3==0?r+2:r-1,i=u[e],a=u[n];u[i]=a,u[a]=i,u[e]=u[n]=-1,l[r]=l[e]=l[n]=t,c[l[i]]=i%3==0?i+2:i-1,c[l[a]]=a%3==0?a+2:a-1,h.push(Math.min(r,e,n)),r+=2-r%3}else l[r]>e.length-3-1&&(l[r]=t);return o}(e),s=function(e){let{triangles:t}=e;if(!t)return[];let r=[];for(let e=0,n=t.length/3;e<n;e++){let n=t[3*e],i=t[3*e+1],a=t[3*e+2];n!==i&&i!==a&&r.push([n,a,i])}return r}(a),o=function(e,t){let r=new Set;return 2===t.length?[[0,1]]:(e.forEach(e=>{if(e[0]!==e[1]&&!(0>gu(e.map(e=>t[e]))))for(let t=0,n;t<3;t++)n=(t+1)%3,r.add(fk([e[t],e[n]]).join("-"))}),Array.from(r,e=>e.split("-").map(Number)))}(s,e),l=function(e,t){let r=[];return e.forEach(e=>{for(let t=0;t<3;t++){let n=e[t],i=e[(t+1)%3];r[n]=r[n]||[],r[n].push(i)}}),0===e.length&&(2===t?(r[0]=[1],r[1]=[0]):1===t&&(r[0]=[])),r}(s,e.length),u=function(e,t){function r(e,t){let r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}return function(n,i,a){void 0===a&&(a=0);let s,o,l=a,u=gl([n,i]);do s=a,a=null,o=r(u,gl(t[s])),e[s].forEach(e=>{let n=r(u,gl(t[e]));if(n<o){o=n,a=e,l=e;return}});while(null!==a)return l}}(l,e),{polygons:c,centers:h}=function(e,t,r){let n=[],i=e.slice();if(0===t.length){if(r.length<2)return{polygons:n,centers:i};if(2===r.length){let e=gl(r[0]),t=gl(r[1]),s=gs(ga(e,t)),o=gs(gi(e,t)),l=gi(s,o),u=[s,gi(s,l),gi(gi(s,l),l),gi(gi(gi(s,l),l),l)].map(go).map(a);return n.push(u),n.push(u.slice().reverse()),{polygons:n,centers:i}}}function a(e){let r=-1;return i.slice(t.length,1/0).forEach((n,i)=>{n[0]===e[0]&&n[1]===e[1]&&(r=i+t.length)}),r<0&&(r=i.length,i.push(e)),r}return t.forEach((e,t)=>{for(let r=0;r<3;r++){let i=e[r],a=e[(r+1)%3],s=e[(r+2)%3];n[i]=n[i]||[],n[i].push([a,s,t,[i,a,s]])}}),{polygons:n.map(e=>{let t=[e[0][2]],n=e[0][1];for(let r=1;r<e.length;r++)for(let r=0;r<e.length;r++)if(e[r][0]==n){n=e[r][1],t.push(e[r][2]);break}if(t.length>2)return t;if(2==t.length){let n=gc(r[e[0][3][0]],r[e[0][3][1]],i[t[0]]),s=gc(r[e[0][3][2]],r[e[0][3][0]],i[t[0]]),o=a(n),l=a(s);return[t[0],l,t[1],o]}}),centers:i}}((t=s,r=e,t.map(e=>{let t=e.map(e=>r[e]).map(gl);return go(gs(ga(ga(gi(t[1],t[0]),gi(t[2],t[1])),gi(t[0],t[2]))))})),s,e),d=function(e){let t=[];return e.forEach(e=>{if(!e)return;let r=e[e.length-1];for(let n of e)n>r&&t.push([r,n]),r=n}),t}(c),A=function(e,t){let r,n=new Set,i=[];e.map(e=>{if(!(gu(e.map(e=>t[e>t.length?0:e]))>1e-12))for(let t=0;t<3;t++){let r=[e[t],e[(t+1)%3]],i="".concat(r[0],"-").concat(r[1]);n.has(i)?n.delete(i):n.add("".concat(r[1],"-").concat(r[0]))}});let a=new Map;if(n.forEach(e=>{e=e.split("-").map(Number),a.set(e[0],e[1]),r=e[0]}),void 0===r)return i;let s=r;do{i.push(s);let e=a.get(s);a.set(s,-1),s=e}while(s>-1&&s!==r)return i}(s,e),p=(n=o,i=s,function(e){let t=new Map,r=new Map;return n.forEach((n,i)=>{let a=n.join("-");t.set(a,e[i]),r.set(a,!0)}),i.forEach(e=>{let n=0,i=-1;for(let r=0;r<3;r++){let a=fk([e[r],e[(r+1)%3]]).join("-");t.get(a)>n&&(n=t.get(a),i=a)}r.set(i,!1)}),n.map(e=>r.get(e.join("-")))});return{delaunay:a,edges:o,triangles:s,centers:h,neighbors:l,polygons:c,mesh:d,hull:A,urquhart:p,find:u}}(t.points)}return t};return t._vx=function(e){return"object"==typeof e&&"type"in e?mW(e)[0]:0 in e?e[0]:void 0},t._vy=function(e){return"object"==typeof e&&"type"in e?mW(e)[1]:1 in e?e[1]:void 0},t.x=function(e){return e?(t._vx=e,t):t._vx},t.y=function(e){return e?(t._vy=e,t):t._vy},t.polygons=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;let r={type:"FeatureCollection",features:[]};return 0===t.valid.length||(t.delaunay.polygons.forEach((e,n)=>r.features.push({type:"Feature",geometry:e?{type:"Polygon",coordinates:[[...e,e[0]].map(e=>t.delaunay.centers[e])]}:null,properties:{site:t.valid[n],sitecoordinates:t.points[n],neighbours:t.delaunay.neighbors[n]}})),1===t.valid.length&&r.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:t.valid[0],sitecoordinates:t.points[0],neighbours:[]}})),r},t.triangles=function(e){return void 0!==e&&t(e),!!t.delaunay&&{type:"FeatureCollection",features:t.delaunay.triangles.map((e,r)=>((e=e.map(e=>t.points[e])).center=t.delaunay.centers[r],e)).filter(e=>gu(e)>0).map(e=>({type:"Feature",properties:{circumcenter:e.center},geometry:{type:"Polygon",coordinates:[[...e,e[0]]]}}))}},t.links=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;let r=t.delaunay.edges.map(e=>pw(t.points[e[0]],t.points[e[1]])),n=t.delaunay.urquhart(r);return{type:"FeatureCollection",features:t.delaunay.edges.map((e,i)=>({type:"Feature",properties:{source:t.valid[e[0]],target:t.valid[e[1]],length:r[i],urquhart:!!n[i]},geometry:{type:"LineString",coordinates:[t.points[e[0]],t.points[e[1]]]}}))}},t.mesh=function(e){return void 0!==e&&t(e),!!t.delaunay&&{type:"MultiLineString",coordinates:t.delaunay.edges.map(e=>[t.points[e[0]],t.points[e[1]]])}},t.cellMesh=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;let{centers:r,polygons:n}=t.delaunay,i=[];for(let e of n)if(e)for(let t=e.length,n=e[t-1],a=e[0],s=0;s<t;n=a,a=e[++s])a>n&&i.push([r[n],r[a]]);return{type:"MultiLineString",coordinates:i}},t._found=void 0,t.find=function(e,r,n){if(t._found=t.delaunay.find(e,r,t._found),!n||pw([e,r],t.points[t._found])<n)return t._found},t.hull=function(e){void 0!==e&&t(e);let r=t.delaunay.hull,n=t.points;return 0===r.length?null:{type:"Polygon",coordinates:[[...r.map(e=>n[e]),n[r[0]]]]}},e?t(e):t})(u).triangles(),_=new Map(u.map(function(e,t){var r=gf(e,2),n=r[0],i=r[1];return["".concat(n,"-").concat(i),t]}));x.features.forEach(function(e){var t,r=e.geometry.coordinates[0].slice(0,3).reverse(),n=[];if(r.forEach(function(e){var t=gf(e,2),r=t[0],i=t[1],a="".concat(r,"-").concat(i);_.has(a)&&n.push(_.get(a))}),3===n.length){if(n.some(function(e){return e<o.length})&&!gy(e.properties.circumcenter,c,y))return;(t=v).push.apply(t,n)}})}else if(l.length){for(var b=f$.from(u),S=function(e){var t,r=[2,1,0].map(function(t){return b.triangles[e+t]}),n=r.map(function(e){return u[e]});if(r.some(function(e){return e<o.length})&&!gy([0,1].map(function(e){return function(e,t){let r=0,n=0;if(void 0===t)for(let t of e)null!=t&&(t*=1)>=t&&(++r,n+=t);else{let i=-1;for(let a of e)null!=(a=t(a,++i,e))&&(a*=1)>=a&&(++r,n+=a)}if(r)return n/r}(n,function(t){return t[e]})}),c,y))return 1;(t=v).push.apply(t,gm(r))},T=0,w=b.triangles.length;T<w;T+=3)if(S(T))continue}else{var M=py(s),E=M.vertices,R=M.holes;v=function(e,t){let r,n,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,s=t&&t.length,o=s?t[0]*a:e.length,l=pr(e,0,o,a,!0),u=[];if(!l||l.next===l.prev)return u;if(s&&(l=function(e,t,r,n){let i=[];for(let r=0,a=t.length;r<a;r++){let s=t[r]*n,o=r<a-1?t[r+1]*n:e.length,l=pr(e,s,o,n,!1);l===l.next&&(l.steiner=!0),i.push(function(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e)return r}(l))}i.sort(pi);for(let e=0;e<i.length;e++)r=function(e,t){let r=function(e,t){let r,n=t,i=e.x,a=e.y,s=-1/0;if(pu(e,n))return n;do{if(pu(e,n.next))return n.next;if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){let e=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>s&&(s=e,r=n.x<n.next.x?n:n.next,e===i))return r}n=n.next}while(n!==t)if(!r)return null;let o=r,l=r.x,u=r.y,c=1/0;n=r;do{if(i>=n.x&&n.x>=l&&i!==n.x&&ps(a<u?i:s,a,l,u,a<u?s:i,a,n.x,n.y)){var h,d;let t=Math.abs(a-n.y)/(i-n.x);pA(n,e)&&(t<c||t===c&&(n.x>r.x||n.x===r.x&&(h=r,d=n,0>pl(h.prev,h,d.prev)&&0>pl(d.next,h,h.next))))&&(r=n,c=t)}n=n.next}while(n!==o)return r}(e,t);if(!r)return t;let n=pp(r,e);return pn(n,n.next),pn(r,r.next)}(i[e],r);return r}(e,t,l,a)),e.length>80*a){r=e[0],n=e[1];let t=r,s=n;for(let i=a;i<o;i+=a){let a=e[i],o=e[i+1];a<r&&(r=a),o<n&&(n=o),a>t&&(t=a),o>s&&(s=o)}i=0!==(i=Math.max(t-r,s-n))?32767/i:0}return function e(t,r,n,i,a,s,o){if(!t)return;!o&&s&&function(e,t,r,n){let i=e;do 0===i.z&&(i.z=pa(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e)i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r=1;do{let n,i=e;e=null;let a=null;for(t=0;i;){t++;let s=i,o=0;for(let e=0;e<r&&(o++,s=s.nextZ);e++);let l=r;for(;o>0||l>0&&s;)0!==o&&(0===l||!s||i.z<=s.z)?(n=i,i=i.nextZ,o--):(n=s,s=s.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=s}a.nextZ=null,r*=2}while(t>1)}(i)}(t,i,a,s);let l=t;for(;t.prev!==t.next;){let u=t.prev,c=t.next;if(s?function(e,t,r,n){let i=e.prev,a=e.next;if(pl(i,e,a)>=0)return!1;let s=i.x,o=e.x,l=a.x,u=i.y,c=e.y,h=a.y,d=Math.min(s,o,l),A=Math.min(u,c,h),p=Math.max(s,o,l),f=Math.max(u,c,h),m=pa(d,A,t,r,n),g=pa(p,f,t,r,n),y=e.prevZ,v=e.nextZ;for(;y&&y.z>=m&&v&&v.z<=g;){if(y.x>=d&&y.x<=p&&y.y>=A&&y.y<=f&&y!==i&&y!==a&&po(s,u,o,c,l,h,y.x,y.y)&&pl(y.prev,y,y.next)>=0||(y=y.prevZ,v.x>=d&&v.x<=p&&v.y>=A&&v.y<=f&&v!==i&&v!==a&&po(s,u,o,c,l,h,v.x,v.y)&&pl(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;y&&y.z>=m;){if(y.x>=d&&y.x<=p&&y.y>=A&&y.y<=f&&y!==i&&y!==a&&po(s,u,o,c,l,h,y.x,y.y)&&pl(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=g;){if(v.x>=d&&v.x<=p&&v.y>=A&&v.y<=f&&v!==i&&v!==a&&po(s,u,o,c,l,h,v.x,v.y)&&pl(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}(t,i,a,s):function(e){let t=e.prev,r=e.next;if(pl(t,e,r)>=0)return!1;let n=t.x,i=e.x,a=r.x,s=t.y,o=e.y,l=r.y,u=Math.min(n,i,a),c=Math.min(s,o,l),h=Math.max(n,i,a),d=Math.max(s,o,l),A=r.next;for(;A!==t;){if(A.x>=u&&A.x<=h&&A.y>=c&&A.y<=d&&po(n,s,i,o,a,l,A.x,A.y)&&pl(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}(t)){r.push(u.i,t.i,c.i),pm(t),t=c.next,l=c.next;continue}if((t=c)===l){o?1===o?e(t=function(e,t){let r=e;do{let n=r.prev,i=r.next.next;!pu(n,i)&&pc(n,r,r.next,i)&&pA(n,i)&&pA(i,n)&&(t.push(n.i,r.i,i.i),pm(r),pm(r.next),r=e=i),r=r.next}while(r!==e)return pn(r)}(pn(t),r),r,n,i,a,s,2):2===o&&function(t,r,n,i,a,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){var l,u;if(o.i!==t.i&&(l=o,u=t,l.next.i!==u.i&&l.prev.i!==u.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&pc(r,r.next,e,t))return!0;r=r.next}while(r!==e)return!1}(l,u)&&(pA(l,u)&&pA(u,l)&&function(e,t){let r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e)return n}(l,u)&&(pl(l.prev,l,u.prev)||pl(l,u.prev,u))||pu(l,u)&&pl(l.prev,l,l.next)>0&&pl(u.prev,u,u.next)>0))){let l=pp(o,t);o=pn(o,o.next),l=pn(l,l.next),e(o,r,n,i,a,s,0),e(l,r,n,i,a,s,0);return}t=t.next}o=o.next}while(o!==t)}(t,r,n,i,a,s):e(pn(t),r,n,i,a,s,1);break}}}(l,u,a,r,n,i,0),u}(E,void 0===R?[]:R,2)}var C=dT(fk(u,function(e){return e[0]}),[0,1]),N=dT(fk(u,function(e){return e[1]}),[0,1]),P=u.map(function(e){var t=gf(e,2),r=t[0],n=t[1];return[C(r),N(n)]});return{contour:s,triangles:{points:u,indices:v,uvs:P}}}(e,{resolution:o=o||5}),h=c.contour,d=c.triangles,A=Ar(d.uvs),p=[],f=[],m=[],g=0,y=function(e){var t=Math.round(p.length/3),r=m.length;p=p.concat(e.vertices),f=f.concat(e.uvs),m=m.concat(t?e.indices.map(function(e){return e+t}):e.indices),u.addGroup(r,m.length-r,g++)};function v(e,t){var r="function"==typeof t?t:function(){return t};return py(e.map(function(e){return e.map(function(e){var t=gf(e,2),n=t[0],i=t[1];return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180;return[r*Math.sin(n)*Math.cos(i),r*Math.cos(n),r*Math.sin(n)*Math.sin(i)]}(i,n,r(n,i))})}))}function x(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return{indices:t?d.indices:d.indices.slice().reverse(),vertices:v([d.points],e).vertices,uvs:A}}return s&&y(function(){for(var e=v(h,r),t=e.vertices,i=e.holes,a=v(h,n).vertices,s=Ar([a,t]),o=Math.round(a.length/3),l=new Set(i),u=0,c=[],d=0;d<o;d++){var A=d+1;if(A===o)A=u;else if(l.has(A)){var p=A;A=u,u=p}c.push(d,d+o,A+o),c.push(A+o,A,d)}for(var f=[],m=1;m>=0;m--)for(var g=0;g<o;g+=1)f.push(g/(o-1),m);return{indices:c,vertices:s,uvs:f}}()),i&&y(x(r,!1)),a&&y(x(n,!0)),u.setIndex(m),u[gx]("position",new gv.Float32BufferAttribute(p,3)),u[gx]("uv",new gv.Float32BufferAttribute(f,2)),u.computeVertexNormals(),u}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gp(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(gv.BufferGeometry);function gb(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function gS(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function gT(e,t){if(e){if("string"==typeof e)return gb(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gb(e,t):void 0}}var gw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(t instanceof Array?t.length?t:[void 0]:[t]).map(function(e){return{keyAccessor:e,isProp:!(e instanceof Function)}}),a=e.reduce(function(e,t){var n=e,a=t;return i.forEach(function(e,t){var s,o=e.keyAccessor;if(e.isProp){var l=a,u=l[o],c=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.includes(r)||({}).propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(l,[o].map(gS));s=u,a=c}else s=o(a,t);t+1<i.length?(n.hasOwnProperty(s)||(n[s]={}),n=n[s]):r?(n.hasOwnProperty(s)||(n[s]=[]),n[s].push(a)):n[s]=a}),e},{});r instanceof Function&&function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;n===i.length?Object.keys(t).forEach(function(e){return t[e]=r(t[e])}):Object.values(t).forEach(function(t){return e(t,n+1)})}(a);var s=a;return n&&(s=[],!function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];r.length===i.length?s.push({keys:r,vals:t}):Object.entries(t).forEach(function(t){var n=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{a=(r=r.call(e)).next,!1;for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(t,2)||gT(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=n[0];return e(n[1],[].concat(function(e){if(Array.isArray(e))return gb(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||gT(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[i]))})}(a),t instanceof Array&&0===t.length&&1===s.length&&(s[0].keys=[])),s},gM=function(e){var t,r,n,i,a,s,o,l,u,c,h,d,A=void 0!==(e=e||{})?e:{},p={};for(t in A)A.hasOwnProperty(t)&&(p[t]=A[t]);var f=[],m="";"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",r=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){if(200==n.status||0==n.status&&n.response)return void t(n.response);var i=W(e);if(i)return void t(i.buffer);r()},n.onerror=r,n.send(null)};var g=A.print||console.log.bind(console),y=A.printErr||console.warn.bind(console);for(t in p)p.hasOwnProperty(t)&&(A[t]=p[t]);p=null,A.arguments&&(f=A.arguments);var v=0,x=!1;function _(e){var t,r=A["_"+e];return t="Cannot call unknown function "+e+", make sure it is exported",r||ei("Assertion failed: "+t),r}var b="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function S(e,t){return e?function(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.subarray&&b)return b.decode(e.subarray(t,i));for(var a="";t<i;){var s=e[t++];if(!(128&s)){a+=String.fromCharCode(s);continue}var o=63&e[t++];if((224&s)==192){a+=String.fromCharCode((31&s)<<6|o);continue}var l=63&e[t++];if((s=(240&s)==224?(15&s)<<12|o<<6|l:(7&s)<<18|o<<12|l<<6|63&e[t++])<65536)a+=String.fromCharCode(s);else{var u=s-65536;a+=String.fromCharCode(55296|u>>10,56320|1023&u)}}return a}(a,e,t):""}function T(e,t){return e%t>0&&(e+=t-e%t),e}function w(e){n=e,A.HEAP8=i=new Int8Array(e),A.HEAP16=s=new Int16Array(e),A.HEAP32=o=new Int32Array(e),A.HEAPU8=a=new Uint8Array(e),A.HEAPU16=new Uint16Array(e),A.HEAPU32=new Uint32Array(e),A.HEAPF32=l=new Float32Array(e),A.HEAPF64=u=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var M=A.TOTAL_MEMORY||0x2000000;function E(e){for(;e.length>0;){var t=e.shift();if("function"==typeof t){t();continue}var r=t.func;"number"==typeof r?void 0===t.arg?A.dynCall_v(r):A.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}}M=(n=A.buffer?A.buffer:new ArrayBuffer(M)).byteLength,w(n),o[7152]=5271520;var R=[],C=[],N=[],P=[],I=Math.abs,L=Math.ceil,D=Math.floor,B=Math.min,F=0,U=null;A.preloadedImages={},A.preloadedAudios={};var O=null,k="data:application/octet-stream;base64,";function z(e){return String.prototype.startsWith?e.startsWith(k):0===e.indexOf(k)}O="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";function V(e){return e.replace(/\b__Z[\w\d_]+/g,function(e){return e==e?e:e+" ["+e+"]"})}function q(){var e=Error();if(!e.stack){try{throw Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function G(){return i.length}function H(e){try{var t=new ArrayBuffer(e);if(t.byteLength!=e)return;return new Int8Array(t).set(i),Q(t),w(t),1}catch(e){}}var j="function"==typeof atob?atob:function(e){var t,r,n,i,a,s,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do i=l.indexOf(e.charAt(c++)),a=l.indexOf(e.charAt(c++)),s=l.indexOf(e.charAt(c++)),o=l.indexOf(e.charAt(c++)),t=i<<2|a>>4,r=(15&a)<<4|s>>2,n=(3&s)<<6|o,u+=String.fromCharCode(t),64!==s&&(u+=String.fromCharCode(r)),64!==o&&(u+=String.fromCharCode(n));while(c<e.length)return u};function W(e){if(z(e))return function(e){try{for(var t=j(e),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}catch(e){throw Error("Converting base64 string to bytes failed.")}}(e.slice(k.length))}var X=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int32Array(r),a=(new e.Uint8Array(r),new e.Float32Array(r),new e.Float64Array(r)),s=0|t.o,o=0|t.p,l=e.Math.floor,u=e.Math.abs,c=e.Math.sqrt,h=e.Math.pow,d=e.Math.cos,A=e.Math.sin,p=e.Math.tan,f=e.Math.acos,m=e.Math.asin,g=e.Math.atan,y=e.Math.atan2,v=e.Math.ceil,x=e.Math.imul,_=e.Math.min,b=e.Math.max,S=e.Math.clz32,T=t.b,w=t.c,M=t.d,E=t.e,R=t.f,C=t.g,N=t.h,P=t.i,I=28640;function L(e,t,r,n){return 0|D(e|=0,t|=0,r|=0,n|=0,0)}function D(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0,c=0;if(u=I,I=I+16|0,o=u,!(0|B(e,t,r,n,a)))return n=0,I=u,0|n;do if((0|r)>=0){if((0|r)>0xd2461d){if(0|(s=0|eZ(15,o)))break;o=0|i[(l=o)>>2],l=0|i[l+4>>2]}else s=((0|r)<0)<<31>>31,c=0|tT(0|r,0|s,3,0),s=0|tT(0|c,0|(l=0|w()),0|(s=0|tv(0|r,0|s,1,0)),0|w()),s=0|tv(0|s,0|w(),1,0),l=0|w(),i[o>>2]=s,i[o+4>>2]=l,o=s;if(tB(0|n,0,o<<3),0|a){tB(0|a,0,o<<2),s=0|F(e,t,r,n,a,o,l,0);break}(s=0|ty(o,4))?(c=0|F(e,t,r,n,s,o,l,0),tg(s),s=c):s=13}else s=2;while(0)return c=s,I=u,0|c}function B(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0;if(m=I,I=I+16|0,p=m,f=m+8|0,i[(A=p)>>2]=e,i[A+4>>2]=t,(0|r)<0)return f=2,I=m,0|f;if(i[(s=n)>>2]=e,i[s+4>>2]=t,(s=(0|a)!=0)&&(i[a>>2]=0),0|eC(e,t))return f=9,I=m,0|f;i[f>>2]=0;e:do if((0|r)>=1)if(s)for(h=1,c=0,d=0,A=1,s=e;;){if(!(c|d)){if(0|(s=0|U(s,t,4,f,p)))break e;if(0|eC(s=0|i[(t=p)>>2],t=0|i[t+4>>2])){s=9;break e}}if(0|(s=0|U(s,t,0|i[26800+(d<<2)>>2],f,p)))break e;if(s=0|i[(t=p)>>2],t=0|i[t+4>>2],i[(e=n+(h<<3)|0)>>2]=s,i[e+4>>2]=t,i[a+(h<<2)>>2]=A,o=(0|(e=c+1|0))==(0|A),u=(0|(l=d+1|0))==6,0|eC(s,t)){s=9;break e}if((0|(A=A+(u&o&1)|0))>(0|r)){s=0;break}h=h+1|0,c=o?0:e,d=o?u?0:l:d}else for(h=1,c=0,d=0,A=1,s=e;;){if(!(c|d)){if(0|(s=0|U(s,t,4,f,p)))break e;if(0|eC(s=0|i[(t=p)>>2],t=0|i[t+4>>2])){s=9;break e}}if(0|(s=0|U(s,t,0|i[26800+(d<<2)>>2],f,p)))break e;if(s=0|i[(t=p)>>2],t=0|i[t+4>>2],i[(e=n+(h<<3)|0)>>2]=s,i[e+4>>2]=t,o=(0|(e=c+1|0))==(0|A),u=(0|(l=d+1|0))==6,0|eC(s,t)){s=9;break e}if((0|(A=A+(u&o&1)|0))>(0|r)){s=0;break}h=h+1|0,c=o?0:e,d=o?u?0:l:d}else s=0;while(0)return f=s,I=m,0|f}function F(e,t,r,n,a,s,o,l){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,o|=0,l|=0;var u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0;if(m=I,I=I+16|0,p=m+8|0,f=m,u=0|tM(0|e,0|t,0|s,0|o),h=0|w(),c=(0|(y=0|i[(g=d=n+(u<<3)|0)>>2]))==(0|e)&(0|(g=0|i[g+4>>2]))==(0|t),!((0|y)==0&(0|g)==0|c))do u=0|tw(0|(u=0|tv(0|u,0|h,1,0)),0|w(),0|s,0|o),h=0|w(),c=(0|(g=0|i[(y=d=n+(u<<3)|0)>>2]))==(0|e)&(0|(y=0|i[y+4>>2]))==(0|t);while(!((0|g)==0&(0|y)==0|c))if(u=a+(u<<2)|0,(c?(0|i[u>>2])<=(0|l):0)||(i[(y=d)>>2]=e,i[y+4>>2]=t,i[u>>2]=l,(0|l)>=(0|r)))return y=0,I=m,0|y;switch(c=l+1|0,i[p>>2]=0,0|(u=0|U(e,t,2,p,f))){case 9:A=9;break;case 0:(u=0|F(0|i[(u=f)>>2],0|i[u+4>>2],r,n,a,s,o,c))||(A=9)}e:do if((0|A)==9){switch(i[p>>2]=0,0|(u=0|U(e,t,3,p,f))){case 9:break;case 0:if(0|(u=0|F(0|i[(u=f)>>2],0|i[u+4>>2],r,n,a,s,o,c)))break e;break;default:break e}switch(i[p>>2]=0,0|(u=0|U(e,t,1,p,f))){case 9:break;case 0:if(0|(u=0|F(0|i[(u=f)>>2],0|i[u+4>>2],r,n,a,s,o,c)))break e;break;default:break e}switch(i[p>>2]=0,0|(u=0|U(e,t,5,p,f))){case 9:break;case 0:if(0|(u=0|F(0|i[(u=f)>>2],0|i[u+4>>2],r,n,a,s,o,c)))break e;break;default:break e}switch(i[p>>2]=0,0|(u=0|U(e,t,4,p,f))){case 9:break;case 0:if(0|(u=0|F(0|i[(u=f)>>2],0|i[u+4>>2],r,n,a,s,o,c)))break e;break;default:break e}switch(i[p>>2]=0,0|(u=0|U(e,t,6,p,f))){case 9:break;case 0:if(0|(u=0|F(0|i[(u=f)>>2],0|i[u+4>>2],r,n,a,s,o,c)))break e;break;default:break e}return y=0,I=m,0|y}while(0)return y=u,I=m,0|y}function U(e,t,r,n,a){e|=0,t|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0;if((r|=0)>>>0>6)return 0|(a=1);if(d=(0|i[n>>2])%6|0,i[n>>2]=d,(0|d)>0){s=0;do r=0|eh(r),s=s+1|0;while((0|s)<(0|i[n>>2]))}if(d=0|tR(0|e,0|t,45),w(),(h=127&d)>>>0>121)return 0|(a=5);u=0|eI(e,t),s=0|tR(0|e,0|t,52),w(),s&=15;e:do{if(s){for(;;){if(l=0|tR(0|e,0|t,0|(o=(15-s|0)*3|0)),w(),(0|(l&=7))==7){t=5;break}if(f=(0|eF(s))==0,s=s+-1|0,A=0|tC(7,0,0|o),t&=~(0|w()),p=0|tC(0|i[(f?432:16)+(28*l|0)+(r<<2)>>2],0,0|o),o=0|w(),r=0|i[(f?640:224)+(28*l|0)+(r<<2)>>2],e=p|e&~A,t|=o,!r){r=0;break e}if(!s){c=8;break e}}return 0|t}c=8}while(0)(0|c)==8&&(e|=p=0|tC(0|(f=0|i[848+(28*h|0)+(r<<2)>>2]),0,45),t=0|w()|-1040385&t,r=0|i[4272+(28*h|0)+(r<<2)>>2],(127&f)==127&&(f=0|tC(0|i[848+(28*h|0)+20>>2],0,45),t=0|w()|-1040385&t,r=0|i[4272+(28*h|0)+20>>2],e=0|eD(f|e,t),t=0|w(),i[n>>2]=(0|i[n>>2])+1)),l=0|tR(0|e,0|t,45),w(),l&=127;t:do if(0|V(l)){u:do if((0|eI(e,t))==1){if((0|h)!=(0|l))if(0|H(l,0|i[7696+(28*h|0)>>2])){e=0|eB(e,t),o=1,t=0|w();break}else M(27795,26864,533,26872);switch(0|u){case 3:e=0|eD(e,t),t=0|w(),i[n>>2]=(0|i[n>>2])+1,o=0;break u;case 5:e=0|eB(e,t),t=0|w(),i[n>>2]=(0|i[n>>2])+5,o=0;break u;case 0:return 0|(f=9);default:return 0|(f=1)}}else o=0;while(0)if((0|r)>0){s=0;do e=0|eL(e,t),t=0|w(),s=s+1|0;while((0|s)!=(0|r))}if((0|h)!=(0|l)){if(!(0|q(l))){if((0|o)!=0|(0|eI(e,t))!=5)break;i[n>>2]=(0|i[n>>2])+1;break}switch(127&d){case 8:case 118:break t}(0|eI(e,t))!=3&&(i[n>>2]=(0|i[n>>2])+1)}}else if((0|r)>0){s=0;do e=0|eD(e,t),t=0|w(),s=s+1|0;while((0|s)!=(0|r))}while(0)return i[n>>2]=((0|i[n>>2])+r|0)%6|0,i[(f=a)>>2]=e,i[f+4>>2]=t,0|(f=0)}function O(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0;if(f=I,I=I+16|0,A=f,p=f+8|0,i[(d=A)>>2]=e,i[d+4>>2]=t,(0|r)<0)return p=2,I=f,0|p;if(!r)return i[(p=n)>>2]=e,i[p+4>>2]=t,p=0,I=f,0|p;i[p>>2]=0;e:do if(0|eC(e,t))e=9;else{a=0,d=e;do{if(0|(e=0|U(d,t,4,p,A)))break e;if(d=0|i[(t=A)>>2],t=0|i[t+4>>2],a=a+1|0,0|eC(d,t)){e=9;break e}}while((0|a)<(0|r))i[(h=n)>>2]=d,i[h+4>>2]=t,h=r+-1|0,c=0,e=1;do{if(a=26800+(c<<2)|0,(0|c)==5)for(o=0|i[a>>2],s=0,a=e;;){if(0|(e=0|U(0|i[(e=A)>>2],0|i[e+4>>2],o,p,A)))break e;if((0|s)!=(0|h)){if(l=0|i[(u=A)>>2],u=0|i[u+4>>2],i[(e=n+(a<<3)|0)>>2]=l,i[e+4>>2]=u,0|eC(l,u)){e=9;break e}e=a+1|0}else e=a;if((0|(s=s+1|0))>=(0|r))break;a=e}else for(o=A,u=0|i[a>>2],l=0,a=e,s=0|i[o>>2],o=0|i[o+4>>2];;){if(0|(e=0|U(s,o,u,p,A)))break e;if(s=0|i[(o=A)>>2],o=0|i[o+4>>2],i[(e=n+(a<<3)|0)>>2]=s,i[e+4>>2]=o,e=a+1|0,0|eC(s,o)){e=9;break e}if((0|(l=l+1|0))>=(0|r))break;a=e}c=c+1|0}while(c>>>0<6)e=9*((0|d)!=(0|i[(e=A)>>2])||(0|t)!=(0|i[e+4>>2]))}while(0)return p=e,I=f,0|p}function k(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0;for(l=I,I=I+16|0,s=l,o=l+8|0,a=(a=(0|eC(e,t))==0)?1:2;;){if(i[o>>2]=0,(c=(0|U(e,t,a,o,s))==0)&((0|i[(u=s)>>2])==(0|r)?(0|i[u+4>>2])==(0|n):0)){e=4;break}if((a=a+1|0)>>>0>=7){a=7,e=4;break}}return(0|e)==4?(I=l,0|a):0}function z(e,t,r,n,o,c,h){e|=0,t|=0,r|=0,n|=0,o|=0,c|=0,h|=0;var d=0,A=0,p=0,f=0,m=0,g=0,y=0,x=0,b=0,S=0,T=0,M=0,E=0,R=0,C=0,N=0,P=0,L=0,D=0,B=0,F=0,U=0,O=0,k=0,z=0,V=0,q=0,G=0,H=0;if(z=I,I=I+64|0,F=z+48|0,U=z+32|0,O=z+24|0,C=z+8|0,N=z,(0|(A=0|i[e>>2]))<=0)return k=0,I=z,0|k;for(P=e+4|0,L=F+8|0,D=U+8|0,B=C+8|0,d=0,E=0;;){M=(p=0|i[P>>2])+(E<<4)|0,i[F>>2]=i[M>>2],i[F+4>>2]=i[M+4>>2],i[F+8>>2]=i[M+8>>2],i[F+12>>2]=i[M+12>>2],(0|E)==(A+-1|0)?(i[U>>2]=i[p>>2],i[U+4>>2]=i[p+4>>2],i[U+8>>2]=i[p+8>>2],i[U+12>>2]=i[p+12>>2]):(M=p+(E+1<<4)|0,i[U>>2]=i[M>>2],i[U+4>>2]=i[M+4>>2],i[U+8>>2]=i[M+8>>2],i[U+12>>2]=i[M+12>>2]),A=0|function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var o=0,c=0,h=0,d=0,A=0,p=0,f=0;p=I,I=I+288|0,h=p+264|0,d=p+96|0,c=(o=A=p)+96|0;do i[o>>2]=0,o=o+4|0;while((0|o)<(0|c))return 0|(r=0|eq(r,A))?n=r:(ez(o=0|i[(r=A)>>2],r=0|i[r+4>>2],h),eV(o,r,d),f=+eY(h,d+8|0),f=+v(+(eY(e,t)/(2*f))),a[s>>3]=f,r=~~f>>>0,o=+u(f)>=1?f>0?~~_(+l(f/0x100000000),0xffffffff)>>>0:~~v((f-(~~f>>>0))/0x100000000)>>>0:0,(0x7ff00000&i[s+4>>2])==0x7ff00000)?n=1:(A=(0|r)==0&(0|o)==0,i[n>>2]=A?1:r,i[n+4>>2]=A?0:o,n=0),I=p,0|n}(F,U,n,O);e:do if(A)p=0,d=A;else if(p=0|i[(A=O)>>2],(0|(A=0|i[A+4>>2]))>0|(0|A)==0&p>>>0>0){T=0,M=0;t:for(;;){if(q=1/(+(p>>>0)+0x100000000*(0|A)),H=+a[F>>3],G=+((A=0|tx(0|p,0|A,0|T,0|M))>>>0)+0x100000000*(0|w()),V=+(T>>>0)+0x100000000*(0|M),a[C>>3]=H*G*q+q*(a[U>>3]*V),a[B>>3]=q*(a[L>>3]*G)+q*(a[D>>3]*V),0|(A=0|eU(C,n,N))){d=A;break}g=0|tM(0|(b=0|i[(S=N)>>2]),0|(S=0|i[S+4>>2]),0|t,0|r),f=0|w(),p=0|i[(m=A=h+(g<<3)|0)>>2],m=0|i[m+4>>2];u:do if((0|p)==0&(0|m)==0)R=A,k=16;else for(y=0,x=0;;){if((0|y)>(0|r)|(0|y)==(0|r)&x>>>0>t>>>0){d=1;break t}if((0|p)==(0|b)&(0|m)==(0|S))break u;if(g=0|tw(0|(A=0|tv(0|g,0|f,1,0)),0|w(),0|t,0|r),f=0|w(),x=0|tv(0|x,0|y,1,0),y=0|w(),(0|(p=0|i[(m=A=h+(g<<3)|0)>>2]))==0&(0|(m=0|i[m+4>>2]))==0){R=A,k=16;break}}while(0)if(((0|k)==16?(k=0,!((0|b)==0&(0|S)==0)):0)&&(i[(x=R)>>2]=b,i[x+4>>2]=S,x=c+(i[o>>2]<<3)|0,i[x>>2]=b,i[x+4>>2]=S,x=0|tv(0|i[(x=o)>>2],0|i[x+4>>2],1,0),b=0|w(),i[(S=o)>>2]=x,i[S+4>>2]=b),T=0|tv(0|T,0|M,1,0),M=0|w(),p=0|i[(A=O)>>2],!((0|(A=0|i[A+4>>2]))>(0|M)|(0|A)==(0|M)&p>>>0>T>>>0)){p=1;break e}}p=0}else p=1;while(0)if(E=E+1|0,!p){k=21;break}if((0|E)>=(0|(A=0|i[e>>2]))){d=0,k=21;break}}return(0|k)==21?(I=z,0|d):0}function V(e){return(e|=0)>>>0>121?0|(e=0):0|(e=0|i[7696+(28*e|0)+16>>2])}function q(e){return(0|(e|=0))==4|(0|e)==117}function G(e){return 0|i[11120+((0|i[(e|=0)>>2])*216|0)+((0|i[e+4>>2])*72|0)+((0|i[e+8>>2])*24|0)+(i[e+12>>2]<<3)>>2]}function H(e,t){return(t|=0,(0|i[7696+(28*(e|=0)|0)+20>>2])==(0|t))?0|(t=1):0|(t=(0|i[7696+(28*e|0)+24>>2])==(0|t))}function j(e,t){return 0|i[848+(28*(e|=0)|0)+((t|=0)<<2)>>2]}function W(e,t){return(t|=0,(0|i[848+(28*(e|=0)|0)>>2])==(0|t))?0|(t=0):(0|i[848+(28*e|0)+4>>2])==(0|t)?0|(t=1):(0|i[848+(28*e|0)+8>>2])==(0|t)?0|(t=2):(0|i[848+(28*e|0)+12>>2])==(0|t)?0|(t=3):(0|i[848+(28*e|0)+16>>2])==(0|t)?0|(t=4):(0|i[848+(28*e|0)+20>>2])==(0|t)?0|(t=5):((0|i[848+(28*e|0)+24>>2])==(0|t)?6:7)|0}function X(e){return+a[(e|=0)+16>>3]<+a[e+24>>3]|0}function Q(e,t){e|=0,t|=0;var r=0,n=0,i=0;return(r=+a[t>>3])>=+a[e+8>>3]&&r<=+a[e>>3]?(n=+a[e+16>>3],r=+a[e+24>>3],t=(i=+a[t+8>>3])>=r,e=i<=n&1,n<r?t&&(e=1):t||(e=0),0|(t=(0|e)!=0)):0|(t=0)}function Y(e,t){t|=0;var r=0,n=0,i=0,s=0,o=0,l=0,u=0,c=0,h=0;return+a[(e|=0)>>3]<+a[t+8>>3]||+a[e+8>>3]>+a[t>>3]?0|(n=0):(o=(s=+a[e+16>>3])<(h=+a[(r=e+24|0)>>3]),l=(c=+a[(n=t+16|0)>>3])<(u=+a[(i=t+24|0)>>3]),t=h-c<u-s,e=o?l|t?1:2:0,t=l?o?1:t?2:1:0,(s=+eQ(s,e))<+eQ(+a[i>>3],t)||(h=+eQ(+a[r>>3],e))>+eQ(+a[n>>3],t))?0|(l=0):0|(l=1)}function K(e,t){t|=0;var r=0,n=0,i=0,s=0,o=0,l=0,u=0,c=0,h=0;return+a[(e|=0)>>3]<+a[t>>3]||+a[e+8>>3]>+a[t+8>>3]?0|(n=0):(o=(u=+a[(n=e+16|0)>>3])<(s=+a[e+24>>3]),l=(h=+a[(r=t+16|0)>>3])<(c=+a[(i=t+24|0)>>3]),t=s-h<c-u,e=o?l|t?1:2:0,t=l?o?1:t?2:1:0,(s=+eQ(s,e))<=+eQ(+a[i>>3],t))?0|(l=(h=+eQ(+a[n>>3],e))>=+eQ(+a[r>>3],t)):0|(l=0)}function Z(e,t){e|=0,t|=0;var r=0,n=0,s=0,o=0,l=0,u=0;s=I,I=I+176|0,i[(n=s)>>2]=4,u=+a[t>>3],a[n+8>>3]=u,o=+a[t+16>>3],a[n+16>>3]=o,a[n+24>>3]=u,u=+a[t+24>>3],a[n+32>>3]=u,l=+a[t+8>>3],a[n+40>>3]=l,a[n+48>>3]=u,a[n+56>>3]=l,a[n+64>>3]=o,r=(t=n+72|0)+96|0;do i[t>>2]=0,t=t+4|0;while((0|t)<(0|r))tD(0|e,0|n,168),I=s}function J(e,t,r){e|=0,t|=0,r|=0;var n=0,o=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,x=0,b=0,S=0;x=I,I=I+288|0,f=x+264|0,m=x+96|0,A=(d=p=x)+96|0;do i[d>>2]=0,d=d+4|0;while((0|d)<(0|A))return 0|(t=0|eq(t,p))||(ez(p=0|i[(A=p)>>2],A=0|i[A+4>>2],f),eV(p,A,m),h=+eY(f,m+8|0),a[f>>3]=+a[e>>3],a[(A=f+8|0)>>3]=+a[e+16>>3],a[m>>3]=+a[e+8>>3],a[(p=m+8|0)>>3]=+a[e+24>>3],o=+eY(f,m),c=+u(+(S=a[A>>3]-a[p>>3])),n=+u(+(b=a[f>>3]-a[m>>3])),(0==S|0==b?0:(S=+v(+(o*o/tI(+((S=+tP(+c,+n))/tI(+c,+n)),3)/(2.59807621135*h*h*.8))),a[s>>3]=S,g=~~S>>>0,y=+u(S)>=1?S>0?~~_(+l(S/0x100000000),0xffffffff)>>>0:~~v((S-(~~S>>>0))/0x100000000)>>>0:0,(0x7ff00000&i[s+4>>2])!=0x7ff00000))?(m=(0|g)==0&(0|y)==0,i[(t=r)>>2]=m?1:g,i[t+4>>2]=m?0:y,t=0):t=1),y=t,I=x,0|y}function $(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0;t=0|i[e>>2],r=0|i[(o=e+4|0)>>2],(0|t)<0&&(r=r-t|0,i[o>>2]=r,i[(s=e+8|0)>>2]=(0|i[s>>2])-t,i[e>>2]=0,t=0),(0|r)<0?(t=t-r|0,i[e>>2]=t,a=(0|i[(s=e+8|0)>>2])-r|0,i[s>>2]=a,i[o>>2]=0,r=0):(s=a=e+8|0,a=0|i[a>>2]),(0|a)<0&&(t=t-a|0,i[e>>2]=t,r=r-a|0,i[o>>2]=r,i[s>>2]=0,a=0),(0|(n=(0|a)<(0|(n=(0|r)<(0|t)?r:t))?a:n))<=0||(i[e>>2]=t-n,i[o>>2]=r-n,i[s>>2]=a-n)}function ee(e,t){e|=0,t|=0;var r=0,n=0;n=0|i[e+8>>2],r=+((0|i[e+4>>2])-n|0),a[t>>3]=((0|i[e>>2])-n|0)-.5*r,a[t+8>>3]=.8660254037844386*r}function et(e,t,r){e|=0,t|=0,i[(r|=0)>>2]=(0|i[t>>2])+(0|i[e>>2]),i[r+4>>2]=(0|i[t+4>>2])+(0|i[e+4>>2]),i[r+8>>2]=(0|i[t+8>>2])+(0|i[e+8>>2])}function er(e,t,r){e|=0,t|=0,i[(r|=0)>>2]=(0|i[e>>2])-(0|i[t>>2]),i[r+4>>2]=(0|i[e+4>>2])-(0|i[t+4>>2]),i[r+8>>2]=(0|i[e+8>>2])-(0|i[t+8>>2])}function en(e,t){e|=0,t|=0;var r=0,n=0;r=0|x(0|i[e>>2],t),i[e>>2]=r,n=0|x(0|i[(r=e+4|0)>>2],t),i[r>>2]=n,t=0|x(0|i[(e=e+8|0)>>2],t),i[e>>2]=t}function ei(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;l=(0|(o=0|i[e>>2]))<0,n=(0|(r=(0|(e=(r=(0|(a=((s=(0|(n=(0|i[e+4>>2])-(l?o:0)|0))<0)?0-n|0:0)+((0|i[e+8>>2])-(l?o:0))|0))<0)?0:a))<(0|(r=(0|(t=(s?0:n)-(r?a:0)|0))<(0|(a=(l?0:o)-(s?n:0)-(r?a:0)|0))?t:a))?e:r))>0,e=e-(n?r:0)|0,t=t-(n?r:0)|0;e:do switch(a-(n?r:0)|0){case 0:switch(0|t){case 0:return 0|(l=(0|e)==0?0:(0|e)==1?1:7);case 1:return 0|(l=(0|e)==0?2:(0|e)==1?3:7);default:break e}case 1:switch(0|t){case 0:return 0|(l=(0|e)==0?4:(0|e)==1?5:7);case 1:if(e)break e;return 0|(e=6);default:break e}}while(0)return 0|(l=7)}function ea(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;r=0|i[(o=e+8|0)>>2],n=0|tf((((t=(0|i[e>>2])-r|0)<<1)+(r=(0|i[(l=e+4|0)>>2])-r|0)|0)*.14285714285714285),i[e>>2]=n,t=0|tf(((3*r|0)-t|0)*.14285714285714285),i[l>>2]=t,i[o>>2]=0,r=t-n|0,(0|n)<0?(s=0-n|0,i[l>>2]=r,i[o>>2]=s,i[e>>2]=0,t=r,n=0,r=s):r=0,(0|t)<0&&(n=n-t|0,i[e>>2]=n,r=r-t|0,i[o>>2]=r,i[l>>2]=0,t=0),s=n-r|0,a=t-r|0,(0|r)<0?(i[e>>2]=s,i[l>>2]=a,i[o>>2]=0,t=a,a=s,r=0):a=n,(0|(n=(0|r)<(0|(n=(0|t)<(0|a)?t:a))?r:n))<=0||(i[e>>2]=a-n,i[l>>2]=t-n,i[o>>2]=r-n)}function es(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;t=0|i[e>>2],r=0|i[(o=e+4|0)>>2],n=0|i[(l=e+8|0)>>2],a=r+(3*t|0)|0,i[e>>2]=a,r=n+(3*r|0)|0,i[o>>2]=r,t=(3*n|0)+t|0,i[l>>2]=t,n=r-a|0,(0|a)<0?(t=t-a|0,i[o>>2]=n,i[l>>2]=t,i[e>>2]=0,r=n,n=0):n=a,(0|r)<0&&(n=n-r|0,i[e>>2]=n,t=t-r|0,i[l>>2]=t,i[o>>2]=0,r=0),s=n-t|0,a=r-t|0,(0|t)<0?(i[e>>2]=s,i[o>>2]=a,i[l>>2]=0,n=s,t=0):a=r,(0|(r=(0|t)<(0|(r=(0|a)<(0|n)?a:n))?t:r))<=0||(i[e>>2]=n-r,i[o>>2]=a-r,i[l>>2]=t-r)}function eo(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;a=0|i[e>>2],t=0|i[(o=e+4|0)>>2],r=0|i[(l=e+8|0)>>2],n=(3*t|0)+a|0,a=r+(3*a|0)|0,i[e>>2]=a,i[o>>2]=n,t=(3*r|0)+t|0,i[l>>2]=t,r=n-a|0,(0|a)<0?(t=t-a|0,i[o>>2]=r,i[l>>2]=t,i[e>>2]=0,a=0):r=n,(0|r)<0&&(a=a-r|0,i[e>>2]=a,t=t-r|0,i[l>>2]=t,i[o>>2]=0,r=0),s=a-t|0,n=r-t|0,(0|t)<0?(i[e>>2]=s,i[o>>2]=n,i[l>>2]=0,a=s,t=0):n=r,(0|(r=(0|t)<(0|(r=(0|n)<(0|a)?n:a))?t:r))<=0||(i[e>>2]=a-r,i[o>>2]=n-r,i[l>>2]=t-r)}function el(e,t){e|=0;var r=0,n=0,a=0,s=0,o=0,l=0;!(((t|=0)+-1|0)>>>0>=6)&&(a=(0|i[15440+(12*t|0)>>2])+(0|i[e>>2])|0,i[e>>2]=a,l=e+4|0,n=(0|i[15440+(12*t|0)+4>>2])+(0|i[l>>2])|0,i[l>>2]=n,o=e+8|0,t=(0|i[15440+(12*t|0)+8>>2])+(0|i[o>>2])|0,i[o>>2]=t,r=n-a|0,(0|a)<0?(t=t-a|0,i[l>>2]=r,i[o>>2]=t,i[e>>2]=0,n=0):(r=n,n=a),(0|r)<0&&(n=n-r|0,i[e>>2]=n,t=t-r|0,i[o>>2]=t,i[l>>2]=0,r=0),s=n-t|0,a=r-t|0,(0|t)<0?(i[e>>2]=s,i[l>>2]=a,i[o>>2]=0,n=s,t=0):a=r,(0|(r=(0|t)<(0|(r=(0|a)<(0|n)?a:n))?t:r))<=0||(i[e>>2]=n-r,i[l>>2]=a-r,i[o>>2]=t-r))}function eu(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;a=0|i[e>>2],t=0|i[(o=e+4|0)>>2],r=0|i[(l=e+8|0)>>2],n=t+a|0,a=r+a|0,i[e>>2]=a,i[o>>2]=n,t=r+t|0,i[l>>2]=t,r=n-a|0,(0|a)<0?(t=t-a|0,i[o>>2]=r,i[l>>2]=t,i[e>>2]=0,n=0):(r=n,n=a),(0|r)<0&&(n=n-r|0,i[e>>2]=n,t=t-r|0,i[l>>2]=t,i[o>>2]=0,r=0),s=n-t|0,a=r-t|0,(0|t)<0?(i[e>>2]=s,i[o>>2]=a,i[l>>2]=0,n=s,t=0):a=r,(0|(r=(0|t)<(0|(r=(0|a)<(0|n)?a:n))?t:r))<=0||(i[e>>2]=n-r,i[o>>2]=a-r,i[l>>2]=t-r)}function ec(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;t=0|i[e>>2],n=0|i[(o=e+4|0)>>2],r=0|i[(l=e+8|0)>>2],a=n+t|0,i[e>>2]=a,n=r+n|0,i[o>>2]=n,t=r+t|0,i[l>>2]=t,r=n-a|0,(0|a)<0?(t=t-a|0,i[o>>2]=r,i[l>>2]=t,i[e>>2]=0,n=0):(r=n,n=a),(0|r)<0&&(n=n-r|0,i[e>>2]=n,t=t-r|0,i[l>>2]=t,i[o>>2]=0,r=0),s=n-t|0,a=r-t|0,(0|t)<0?(i[e>>2]=s,i[o>>2]=a,i[l>>2]=0,n=s,t=0):a=r,(0|(r=(0|t)<(0|(r=(0|a)<(0|n)?a:n))?t:r))<=0||(i[e>>2]=n-r,i[o>>2]=a-r,i[l>>2]=t-r)}function eh(e){switch(0|(e|=0)){case 1:e=5;break;case 5:e=4;break;case 4:e=6;break;case 6:e=2;break;case 2:e=3;break;case 3:e=1}return 0|e}function ed(e){switch(0|(e|=0)){case 1:e=3;break;case 3:e=2;break;case 2:e=6;break;case 6:e=4;break;case 4:e=5;break;case 5:e=1}return 0|e}function eA(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;t=0|i[e>>2],r=0|i[(o=e+4|0)>>2],n=0|i[(l=e+8|0)>>2],a=r+(t<<1)|0,i[e>>2]=a,r=n+(r<<1)|0,i[o>>2]=r,t=(n<<1)+t|0,i[l>>2]=t,n=r-a|0,(0|a)<0?(t=t-a|0,i[o>>2]=n,i[l>>2]=t,i[e>>2]=0,r=n,n=0):n=a,(0|r)<0&&(n=n-r|0,i[e>>2]=n,t=t-r|0,i[l>>2]=t,i[o>>2]=0,r=0),s=n-t|0,a=r-t|0,(0|t)<0?(i[e>>2]=s,i[o>>2]=a,i[l>>2]=0,n=s,t=0):a=r,(0|(r=(0|t)<(0|(r=(0|a)<(0|n)?a:n))?t:r))<=0||(i[e>>2]=n-r,i[o>>2]=a-r,i[l>>2]=t-r)}function ep(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;a=0|i[e>>2],t=0|i[(o=e+4|0)>>2],r=0|i[(l=e+8|0)>>2],n=(t<<1)+a|0,a=r+(a<<1)|0,i[e>>2]=a,i[o>>2]=n,t=(r<<1)+t|0,i[l>>2]=t,r=n-a|0,(0|a)<0?(t=t-a|0,i[o>>2]=r,i[l>>2]=t,i[e>>2]=0,a=0):r=n,(0|r)<0&&(a=a-r|0,i[e>>2]=a,t=t-r|0,i[l>>2]=t,i[o>>2]=0,r=0),s=a-t|0,n=r-t|0,(0|t)<0?(i[e>>2]=s,i[o>>2]=n,i[l>>2]=0,a=s,t=0):n=r,(0|(r=(0|t)<(0|(r=(0|n)<(0|a)?n:a))?t:r))<=0||(i[e>>2]=a-r,i[o>>2]=n-r,i[l>>2]=t-r)}function ef(e,t){e|=0,t|=0;var r=0,n=0,a=0,s=0,o=0,l=0;return l=(0|(o=(0|i[e>>2])-(0|i[t>>2])|0))<0,s=(0|(n=(0|i[e+4>>2])-(0|i[t+4>>2])-(l?o:0)|0))<0,n=(0|(e=(0|(t=(e=(0|(a=(l?0-o|0:0)+(0|i[e+8>>2])-(0|i[t+8>>2])+(s?0-n|0:0)|0))<0)?0:a))<(0|(e=(0|(r=(s?0:n)-(e?a:0)|0))<(0|(a=(l?0:o)-(s?n:0)-(e?a:0)|0))?r:a))?t:e))>0,t=t-(n?e:0)|0,r=r-(n?e:0)|0,((0|(e=(0|(e=a-(n?e:0)|0))>-1?e:0-e|0))>(0|(t=(0|(r=(0|r)>-1?r:0-r|0))>(0|(t=(0|t)>-1?t:0-t|0))?r:t))?e:t)|0}function em(e){e|=0;var t=0,r=0,n=0,a=0;r=(a=0|i[(t=e+8|0)>>2])-(0|i[e>>2])|0,i[e>>2]=r,e=(0|i[(n=e+4|0)>>2])-a|0,i[n>>2]=e,i[t>>2]=0-(e+r)}function eg(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0;return(o=I,I=I+16|0,a=o,s=-0x7f000001&t|0x8000000,!0&(0x78000000&t)==0x10000000)?(n=0|tR(0|e,0|t,56),w(),(0|(n=0|function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0;if(s=I,I=I+16|0,a=s,n=0|eC(e,t),(r+-1|0)>>>0>5||(0|r)==1&(n=(0|n)!=0))return a=-1,I=s,0|a;do if(0|tu(e,t,a))n=-1;else if(n){n=((0|i[26352+(r<<2)>>2])+5-(0|i[a>>2])|0)%5|0;break}else{n=((0|i[26384+(r<<2)>>2])+6-(0|i[a>>2])|0)%6|0;break}while(0)return a=n,I=s,0|a}(e,s,7&n)))==-1)?(i[r>>2]=0,s=6):(0|ek(e,s,a)&&M(27795,26932,282,26947),t=0|tR(0|e,0|t,52),w(),t&=15,0|eC(e,s)?ev(a,t,n,2,r):eb(a,t,n,2,r),s=0):s=6,I=o,0|s}function ey(e,t,r,n,s){e|=0,t|=0,r|=0,n|=0,s|=0;var o,l,h,p=0,f=0,v=0;if((p=+(l=0,h=0,+c(+((h=+a[(o=0|e)>>3])*h+(l=+a[o+8>>3])*l))))<1e-16){t=15600+(t<<4)|0,i[s>>2]=i[t>>2],i[s+4>>2]=i[t+4>>2],i[s+8>>2]=i[t+8>>2],i[s+12>>2]=i[t+12>>2];return}if(f=+y(+a[e+8>>3],+a[e>>3]),(0|r)>0){e=0;do p*=.37796447300922725,e=e+1|0;while((0|e)!=(0|r))}v=.3333333333333333*p,n?p=+g(+(((r=(0|eF(r))==0)?v:.37796447300922725*v)*.381966011250105)):(p=+g(+(.381966011250105*p)),0|eF(r)&&(f=+eW(f+.3334731722518321))),function(e,t,r,n){e|=0,t*=1,n|=0;var s=0,o=0,l=0,c=0;if((r*=1)<1e-16){i[n>>2]=i[e>>2],i[n+4>>2]=i[e+4>>2],i[n+8>>2]=i[e+8>>2],i[n+12>>2]=i[e+12>>2];return}o=t<0?t+6.283185307179586:t,o=t>=6.283185307179586?o+-6.283185307179586:o;do if(o<1e-16)t=+a[e>>3]+r,a[n>>3]=t,s=n;else{if(s=1e-16>+u(+(o+-3.141592653589793)),t=+a[e>>3],s){t-=r,a[n>>3]=t,s=n;break}if(l=+d(+r),r=+A(+r),t=+m(+((t=(t=l*A(+t)+d(+o)*(r*d(+t)))>1?1:t)<-1?-1:t)),a[n>>3]=t,1e-16>+u(+(t+-1.5707963267948966))){a[n>>3]=1.5707963267948966,a[n+8>>3]=0;return}if(1e-16>+u(+(t+1.5707963267948966))){a[n>>3]=-1.5707963267948966,a[n+8>>3]=0;return}if(c=1/d(+t),o=r*A(+o)*c,r=+a[e>>3],t=c*((l-A(+t)*A(+r))/d(+r)),l=o>1?1:o,t=t>1?1:t,(t=+a[e+8>>3]+ +y(+(l<-1?-1:l),+(t<-1?-1:t)))>3.141592653589793)do t+=-6.283185307179586;while(t>3.141592653589793)if(t<-3.141592653589793)do t+=6.283185307179586;while(t<-3.141592653589793)a[n+8>>3]=t;return}while(0)if(1e-16>+u(+(t+-1.5707963267948966))){a[s>>3]=1.5707963267948966,a[n+8>>3]=0;return}if(1e-16>+u(+(t+1.5707963267948966))){a[s>>3]=-1.5707963267948966,a[n+8>>3]=0;return}if((t=+a[e+8>>3])>3.141592653589793)do t+=-6.283185307179586;while(t>3.141592653589793)if(t<-3.141592653589793)do t+=6.283185307179586;while(t<-3.141592653589793)a[n+8>>3]=t}(15600+(t<<4)|0,+eW(a[15920+(24*t|0)>>3]-f),p,s)}function ev(e,t,r,n,s){e|=0,t|=0,r|=0,n|=0,s|=0;var o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,w=0,E=0,R=0,C=0,N=0,P=0,L=0,D=0,B=0,F=0;if(D=I,I=I+272|0,o=D+256|0,x=D+240|0,N=D,P=D+224|0,L=D+208|0,_=D+176|0,b=D+160|0,S=D+192|0,T=D+144|0,w=D+128|0,E=D+112|0,R=D+96|0,C=D+80|0,i[o>>2]=t,i[x>>2]=i[e>>2],i[x+4>>2]=i[e+4>>2],i[x+8>>2]=i[e+8>>2],i[x+12>>2]=i[e+12>>2],ex(x,o,N),i[s>>2]=0,(0|(x=n+r+((0|n)==5&1)|0))<=(0|r)){I=D;return}c=0|i[o>>2],h=P+4|0,d=_+4|0,A=r+5|0,p=16880+(c<<2)|0,f=16960+(c<<2)|0,m=w+8|0,g=E+8|0,y=R+8|0,v=L+4|0,u=r;e:for(;;){l=N+(((0|u)%5|0)<<4)|0,i[L>>2]=i[l>>2],i[L+4>>2]=i[l+4>>2],i[L+8>>2]=i[l+8>>2],i[L+12>>2]=i[l+12>>2];do;while((0|e_(L,c,0,1))==2)if((0|u)>(0|r)&(0|eF(t))!=0){if(i[_>>2]=i[L>>2],i[_+4>>2]=i[L+4>>2],i[_+8>>2]=i[L+8>>2],i[_+12>>2]=i[L+12>>2],ee(h,b),n=0|i[_>>2],o=0|i[17040+(80*n|0)+(i[P>>2]<<2)>>2],i[_>>2]=i[18640+(80*n|0)+(20*o|0)>>2],(0|(l=0|i[18640+(80*n|0)+(20*o|0)+16>>2]))>0){e=0;do eu(d),e=e+1|0;while((0|e)<(0|l))}switch(l=18640+(80*n|0)+(20*o|0)+4|0,i[S>>2]=i[l>>2],i[S+4>>2]=i[l+4>>2],i[S+8>>2]=i[l+8>>2],en(S,(0|i[p>>2])*3|0),et(d,S,d),$(d),ee(d,T),B=+(0|i[f>>2]),a[w>>3]=3*B,a[m>>3]=0,F=-1.5*B,a[E>>3]=F,a[g>>3]=2.598076211353316*B,a[R>>3]=F,a[y>>3]=-2.598076211353316*B,0|i[17040+((0|i[_>>2])*80|0)+(i[L>>2]<<2)>>2]){case 1:e=E,n=w;break;case 3:e=R,n=E;break;case 2:e=w,n=R;break;default:e=12;break e}ts(b,T,n,e,C),ey(C,0|i[_>>2],c,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=(0|i[s>>2])+1}if((0|u)<(0|A)&&(ee(v,_),ey(_,0|i[L>>2],c,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=(0|i[s>>2])+1),i[P>>2]=i[L>>2],i[P+4>>2]=i[L+4>>2],i[P+8>>2]=i[L+8>>2],i[P+12>>2]=i[L+12>>2],(0|(u=u+1|0))>=(0|x)){e=3;break}}if((0|e)==3){I=D;return}(0|e)==12&&M(26970,27017,572,27027)}function ex(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0,l=0,u=0;u=I,I=I+128|0,n=u+64|0,a=u,o=20240,l=(s=n)+60|0;do i[s>>2]=i[o>>2],s=s+4|0,o=o+4|0;while((0|s)<(0|l))o=20304,l=(s=a)+60|0;do i[s>>2]=i[o>>2],s=s+4|0,o=o+4|0;while((0|s)<(0|l))n=(l=(0|eF(0|i[t>>2]))==0)?n:a,eA(a=e+4|0),ep(a),0|eF(0|i[t>>2])&&(eo(a),i[t>>2]=(0|i[t>>2])+1),i[r>>2]=i[e>>2],et(a,n,t=r+4|0),$(t),i[r+16>>2]=i[e>>2],et(a,n+12|0,t=r+20|0),$(t),i[r+32>>2]=i[e>>2],et(a,n+24|0,t=r+36|0),$(t),i[r+48>>2]=i[e>>2],et(a,n+36|0,t=r+52|0),$(t),i[r+64>>2]=i[e>>2],et(a,n+48|0,r=r+68|0),$(r),I=u}function e_(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a,s,o,l,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0;if(v=I,I=I+32|0,g=v+12|0,d=v,y=e+4|0,m=0|i[16960+(t<<2)>>2],m=(f=(0|n)!=0)?3*m|0:m,u=0|i[y>>2],h=0|i[(p=e+8|0)>>2],f){if((0|(u=h+u+(n=0|i[(c=e+12|0)>>2])|0))==(0|m))return y=1,I=v,0|y;A=c}else u=h+u+(n=0|i[(A=e+12|0)>>2])|0;if((0|u)<=(0|m))return y=0,I=v,0|y;do if((0|n)>0){if(n=0|i[e>>2],(0|h)>0){c=18640+(80*n|0)+60|0,n=e;break}n=18640+(80*n|0)+40|0,r&&(a=g,o=0,l=0,s=0|m,o|=0,l|=0,i[(a|=0)>>2]=s,i[a+4>>2]=o,i[a+8>>2]=l,er(y,g,d),ec(d),et(d,g,y)),c=n,n=e}else c=18640+((0|i[e>>2])*80|0)+20|0,n=e;while(0)if(i[n>>2]=i[c>>2],(0|i[(u=c+16|0)>>2])>0){n=0;do eu(y),n=n+1|0;while((0|n)<(0|i[u>>2]))}return e=c+4|0,i[g>>2]=i[e>>2],i[g+4>>2]=i[e+4>>2],i[g+8>>2]=i[e+8>>2],t=0|i[16880+(t<<2)>>2],en(g,f?3*t|0:t),et(y,g,y),$(y),y=n=f&&((0|i[p>>2])+(0|i[y>>2])+(0|i[A>>2])|0)==(0|m)?1:2,I=v,0|y}function eb(e,t,r,n,s){e|=0,t|=0,r|=0,n|=0,s|=0;var o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,w=0,E=0,R=0,C=0,N=0;if(R=I,I=I+240|0,o=R+224|0,S=R+208|0,T=R,w=R+192|0,E=R+176|0,y=R+160|0,v=R+144|0,x=R+128|0,_=R+112|0,b=R+96|0,i[o>>2]=t,i[S>>2]=i[e>>2],i[S+4>>2]=i[e+4>>2],i[S+8>>2]=i[e+8>>2],i[S+12>>2]=i[e+12>>2],eS(S,o,T),i[s>>2]=0,(0|(g=n+r+((0|n)==6&1)|0))<=(0|r)){I=R;return}c=0|i[o>>2],h=r+6|0,d=16960+(c<<2)|0,A=v+8|0,p=x+8|0,f=_+8|0,m=w+4|0,l=0,u=r,n=-1;e:for(;;){if(e=T+((o=(0|u)%6|0)<<4)|0,i[w>>2]=i[e>>2],i[w+4>>2]=i[e+4>>2],i[w+8>>2]=i[e+8>>2],i[w+12>>2]=i[e+12>>2],e=l,l=0|e_(w,c,0,1),(0|u)>(0|r)&(0|eF(t))!=0&&(0|e)!=1?(0|i[w>>2])!=(0|n):0){switch(ee(T+(((o+5|0)%6|0)<<4)+4|0,E),ee(T+(o<<4)+4|0,y),C=+(0|i[d>>2]),a[v>>3]=3*C,a[A>>3]=0,N=-1.5*C,a[x>>3]=N,a[p>>3]=2.598076211353316*C,a[_>>3]=N,a[f>>3]=-2.598076211353316*C,o=0|i[S>>2],0|i[17040+(80*o|0)+(((0|n)==(0|o)?0|i[w>>2]:n)<<2)>>2]){case 1:e=x,n=v;break;case 3:e=_,n=x;break;case 2:e=v,n=_;break;default:e=8;break e}ts(E,y,n,e,b),(0|to(E,b)?0:!(0|to(y,b)))&&(ey(b,0|i[S>>2],c,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=(0|i[s>>2])+1)}if((0|u)<(0|h)&&(ee(m,E),ey(E,0|i[w>>2],c,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=(0|i[s>>2])+1),(0|(u=u+1|0))>=(0|g)){e=3;break}n=0|i[w>>2]}if((0|e)==3){I=R;return}(0|e)==8&&M(27054,27017,737,27099)}function eS(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0,l=0,u=0;u=I,I=I+160|0,n=u+80|0,a=u,o=20368,l=(s=n)+72|0;do i[s>>2]=i[o>>2],s=s+4|0,o=o+4|0;while((0|s)<(0|l))o=20448,l=(s=a)+72|0;do i[s>>2]=i[o>>2],s=s+4|0,o=o+4|0;while((0|s)<(0|l))n=(l=(0|eF(0|i[t>>2]))==0)?n:a,eA(a=e+4|0),ep(a),0|eF(0|i[t>>2])&&(eo(a),i[t>>2]=(0|i[t>>2])+1),i[r>>2]=i[e>>2],et(a,n,t=r+4|0),$(t),i[r+16>>2]=i[e>>2],et(a,n+12|0,t=r+20|0),$(t),i[r+32>>2]=i[e>>2],et(a,n+24|0,t=r+36|0),$(t),i[r+48>>2]=i[e>>2],et(a,n+36|0,t=r+52|0),$(t),i[r+64>>2]=i[e>>2],et(a,n+48|0,t=r+68|0),$(t),i[r+80>>2]=i[e>>2],et(a,n+60|0,r=r+84|0),$(r),I=u}function eT(e,t){return e|=0,t|=0,t=0|tR(0|e,0|t,45),w(),127&t}function ew(e,t){e|=0;var r=0,i=0,a=0,s=0,o=0;return!0&(-0x1000000&(t|=0))==0x8000000?(i=0|tR(0|e,0|t,52),w(),i&=15,r=0|tR(0|e,0|t,45),w(),(r&=127)>>>0>121)?0|(e=0):(s=0|tx(-0x4924924a,-1171,0|(o=0|tC(0|(a=0|tR(0|e,0|t,0|(o=(15^i)*3|0))),0|w(),0|o)),0|(a=0|w())),(0x24924924&o&s)==0&(4681&a&(0|w()))==0&&(o=0|tR(0|(s=0|tC(~e,~t,0|(o=(3*i|0)+19|0))),0|w(),0|o),(0|i)==15|(0|o)==0&(0|w())==0))?0|n[20528+r|0]?(0|e)==0&(0|(t&=8191))==0?0|(o=1):(o=0|tN(0|e,0|t,0),w(),((63-o|0)%3|0)!=0|0):0|(o=1):0|(o=0):0|(e=0)}function eM(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0;if(a=0|tC(0|t,0,52),s=0|w(),r=0|tC(0|r,0,45),r=s|(0|w())|0x8001fff,(0|t)<1){s=-1,n=r,i[(t=e)>>2]=s,i[(e=e+4|0)>>2]=n;return}for(s=1,a=-1;l=0|tC(7,0,0|(o=(15-s|0)*3|0)),r&=~(0|w()),a=a&~l|(o=0|tC(0|n,0,0|o)),r|=w(),(0|s)!=(0|t);)s=s+1|0;i[(o=l=e)>>2]=a,i[(l=l+4|0)>>2]=r}function eE(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0;if(s=0|tR(0|e,0|t,52),w(),s&=15,r>>>0>15)return 0|(n=4);if((0|s)<(0|r))return 0|(n=12);if((0|s)==(0|r))return i[n>>2]=e,i[n+4>>2]=t,0|(n=0);if(a=0|tC(0|r,0,52)|e,e=0|w()|-0xf00001&t,(0|s)>(0|r))do t=0|tC(7,0,(14-r|0)*3|0),r=r+1|0,a|=t,e=0|w()|e;while((0|r)<(0|s))return i[n>>2]=a,i[n+4>>2]=e,0|(n=0)}function eR(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0;if(s=0|tR(0|e,0|t,52),w(),!((0|r)<16&(0|(s&=15))<=(0|r)))return 0|(n=4);a=r-s|0,r=0|tR(0|e,0|t,45),w();e:do if(0|V(127&r)){t:do if(0|s){for(r=1;((o=0|tC(7,0,(15-r|0)*3|0))&e)==0&((0|w())&t)==0;)if(r>>>0<s>>>0)r=r+1|0;else break t;r=0|e4(7,0,a,((0|a)<0)<<31>>31),a=0|w();break e}while(0)r=0|tS(0|(r=0|tv(0|(r=0|tT(0|(r=0|e4(7,0,a,((0|a)<0)<<31>>31)),0|w(),5,0)),0|w(),-5,-1)),0|w(),6,0),r=0|tv(0|r,0|w(),1,0),a=0|w()}else r=0|e4(7,0,a,((0|a)<0)<<31>>31),a=0|w();while(0)return i[(o=n)>>2]=r,i[o+4>>2]=a,0|(o=0)}function eC(e,t){e|=0,t|=0;var r=0,n=0,i=0;if(i=0|tR(0|e,0|t,45),w(),!(0|V(127&i)))return 0|(i=0);i=0|tR(0|e,0|t,52),w(),i&=15;e:do if(i)for(n=1;;){if(r=0|tR(0|e,0|t,(15-n|0)*3|0),w(),0|(r&=7))break e;if(n>>>0<i>>>0)n=n+1|0;else{r=0;break}}else r=0;while(0)return 0|(i=(0|r)==0&1)}function eN(e,t,r,n){return(e|=0,t|=0,(0|(n|=0))<(0|(r|=0)))?(r=t,n=e):(r=0|tC(-1,-1,((n-r|0)*3|0)+3|0),n=0|tC(~r,~(0|w()),(15-n|0)*3|0),r=~(0|w())&t,n=~n&e),T(0|r),0|n}function eP(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0;return(a=0|tR(0|e,0|t,52),w(),(0|r)<16&(0|(a&=15))<=(0|r))?((0|a)<(0|r)&&(a=0|tC(-1,-1,((r+-1-a|0)*3|0)+3|0),a=0|tC(~a,~(0|w()),(15-r|0)*3|0),t=~(0|w())&t,e=~a&e),a=0|tC(0|r,0,52),r=-0xf00001&t|(0|w()),i[n>>2]=e|a,i[n+4>>2]=r,0|(n=0)):0|(n=4)}function eI(e,t){e|=0,t|=0;var r=0,n=0,i=0;if(i=0|tR(0|e,0|t,52),w(),!(i&=15))return 0|(i=0);for(n=1;;){if(r=0|tR(0|e,0|t,(15-n|0)*3|0),w(),0|(r&=7)){n=5;break}if(n>>>0<i>>>0)n=n+1|0;else{r=0,n=5;break}}return(0|n)==5?0|r:0}function eL(e,t){e|=0,t|=0;var r=0,n=0,i=0,a=0,s=0,o=0,l=0;if(l=0|tR(0|e,0|t,52),w(),!(l&=15))return o=t,l=e,T(0|o),0|l;for(o=1,r=0;;){n=0|tC(7,0,0|(a=(15-o|0)*3|0)),i=0|w(),s=0|tR(0|e,0|t,0|a),w(),a=0|tC(0|eh(7&s),0,0|a),s=0|w(),e=a|e&~n,t=s|t&~i;e:do if(!r)if((a&n)==0&(s&i)==0)r=0;else if(n=0|tR(0|e,0|t,52),w(),n&=15){r=1;t:for(;;){switch(s=0|tR(0|e,0|t,(15-r|0)*3|0),w(),7&s){case 1:break t;case 0:break;default:r=1;break e}if(r>>>0<n>>>0)r=r+1|0;else{r=1;break e}}for(r=1;;)if(i=0|tR(0|e,0|t,0|(s=(15-r|0)*3|0)),w(),a=0|tC(7,0,0|s),t&=~(0|w()),e=e&~a|(s=0|tC(0|eh(7&i),0,0|s)),t|=w(),r>>>0<n>>>0)r=r+1|0;else{r=1;break}}else r=1;while(0)if(o>>>0<l>>>0)o=o+1|0;else break}return T(0|t),0|e}function eD(e,t){e|=0,t|=0;var r=0,n=0,i=0,a=0,s=0;if(n=0|tR(0|e,0|t,52),w(),!(n&=15))return r=t,n=e,T(0|r),0|n;for(r=1;;)if(s=0|tR(0|e,0|t,0|(a=(15-r|0)*3|0)),w(),i=0|tC(7,0,0|a),t&=~(0|w()),e=(a=0|tC(0|eh(7&s),0,0|a))|e&~i,t=0|w()|t,r>>>0<n>>>0)r=r+1|0;else break;return T(0|t),0|e}function eB(e,t){e|=0,t|=0;var r=0,n=0,i=0,a=0,s=0;if(n=0|tR(0|e,0|t,52),w(),!(n&=15))return r=t,n=e,T(0|r),0|n;for(r=1;;)if(a=0|tC(7,0,0|(s=(15-r|0)*3|0)),i=t&~(0|w()),t=0|tR(0|e,0|t,0|s),w(),e=(t=0|tC(0|ed(7&t),0,0|s))|e&~a,t=0|w()|i,r>>>0<n>>>0)r=r+1|0;else break;return T(0|t),0|e}function eF(e){return(0|(e|=0))%2|0}function eU(e,t,r){e|=0,t|=0,r|=0;var n,s,o,l,c,h=0,m=0;return(m=I,I=I+16|0,h=m,t>>>0>15)?(h=4,I=m,0|h):(0x7ff00000&i[e+4>>2])==0x7ff00000||(0x7ff00000&i[e+8+4>>2])==0x7ff00000?(h=3,I=m,0|h):(n=0|e,s=0|t,o=0|h,l=0,c=0,l=I,I=I+16|0,function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var s,o,l,u,c,h,m,g=0,v=0,x=0,_=0,b=0;if(_=I,I=I+16|0,function(e,t,r){e|=0,t|=0,r|=0;var n,s,o,l,u,c=0,h=0,p=0;if(p=I,I=I+32|0,n=e,s=h=p,n|=0,s|=0,o=0,l=0,u=0,l=+d(+(o=+a[n>>3])),o=+A(+o),a[s+16>>3]=o,u=l*d(+(o=+a[n+8>>3])),a[s>>3]=u,o=l*A(+o),a[s+8>>3]=o,i[t>>2]=0,a[r>>3]=5,(c=+tl(16400,h))<+a[r>>3]&&(i[t>>2]=0,a[r>>3]=c),(c=+tl(16424,h))<+a[r>>3]&&(i[t>>2]=1,a[r>>3]=c),(c=+tl(16448,h))<+a[r>>3]&&(i[t>>2]=2,a[r>>3]=c),(c=+tl(16472,h))<+a[r>>3]&&(i[t>>2]=3,a[r>>3]=c),(c=+tl(16496,h))<+a[r>>3]&&(i[t>>2]=4,a[r>>3]=c),(c=+tl(16520,h))<+a[r>>3]&&(i[t>>2]=5,a[r>>3]=c),(c=+tl(16544,h))<+a[r>>3]&&(i[t>>2]=6,a[r>>3]=c),(c=+tl(16568,h))<+a[r>>3]&&(i[t>>2]=7,a[r>>3]=c),(c=+tl(16592,h))<+a[r>>3]&&(i[t>>2]=8,a[r>>3]=c),(c=+tl(16616,h))<+a[r>>3]&&(i[t>>2]=9,a[r>>3]=c),(c=+tl(16640,h))<+a[r>>3]&&(i[t>>2]=10,a[r>>3]=c),(c=+tl(16664,h))<+a[r>>3]&&(i[t>>2]=11,a[r>>3]=c),(c=+tl(16688,h))<+a[r>>3]&&(i[t>>2]=12,a[r>>3]=c),(c=+tl(16712,h))<+a[r>>3]&&(i[t>>2]=13,a[r>>3]=c),(c=+tl(16736,h))<+a[r>>3]&&(i[t>>2]=14,a[r>>3]=c),(c=+tl(16760,h))<+a[r>>3]&&(i[t>>2]=15,a[r>>3]=c),(c=+tl(16784,h))<+a[r>>3]&&(i[t>>2]=16,a[r>>3]=c),(c=+tl(16808,h))<+a[r>>3]&&(i[t>>2]=17,a[r>>3]=c),(c=+tl(16832,h))<+a[r>>3]&&(i[t>>2]=18,a[r>>3]=c),!((c=+tl(16856,h))<+a[r>>3])){I=p;return}i[t>>2]=19,a[r>>3]=c,I=p}(e,r,b=_),(v=+f(+(1-.5*a[b>>3])))<1e-16){i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,i[n+12>>2]=0,I=_;return}if(g=+eW((g=+a[15920+(24*(b=0|i[r>>2])|0)>>3])-eW(+(s=15600+(b<<4)|0,l=0,u=0,c=0,h=0,m=0,m=(u=+d(+(h=+a[(o=0|e)>>3])))*A(+(c=a[o+8>>3]-a[s+8>>3])),l=+a[s>>3],+y(+m,+(A(+h)*d(+l)-d(+c)*(u*A(+l))))))),x=0|eF(t)?+eW(g+-.3334731722518321):g,g=2.618033988749896*p(+v),(0|t)>0){e=0;do g*=2.6457513110645907,e=e+1|0;while((0|e)!=(0|t))}v=d(+x)*g,a[n>>3]=v,x=A(+x)*g,a[n+8>>3]=x,I=_}(n,s,o,c=l),function(e,t){e|=0,t|=0;var r=0,n=0,s=0,o=0,l=0,c=0,h=0,d=0,A=0,p=0,f=0;i[(p=t+8|0)>>2]=0,r=~~(l=+u(+(h=+a[e>>3]))+.5*(c=1.1547005383792515*u(+(d=+a[e+8>>3])))),e=~~c,l-=0|r,c-=0|e;do{if(l<.5)if(l<.3333333333333333){if(i[t>>2]=r,c<(l+1)*.5){i[t+4>>2]=e;break}e=e+1|0,i[t+4>>2]=e;break}else{if(e=(1&!(c<(f=1-l)))+e|0,i[t+4>>2]=e,f<=c&c<2*l){r=r+1|0,i[t>>2]=r;break}i[t>>2]=r;break}if(!(l<.6666666666666666)){if(r=r+1|0,i[t>>2]=r,c<.5*l){i[t+4>>2]=e;break}e=e+1|0,i[t+4>>2]=e;break}if(c<1-l){if(i[t+4>>2]=e,2*l+-1<c){i[t>>2]=r;break}}else e=e+1|0,i[t+4>>2]=e;r=r+1|0,i[t>>2]=r}while(0)do if(h<0)if(1&e){A=0|tx(0|r,((0|r)<0)<<31>>31,0|(A=(e+1|0)/2|0),((0|A)<0)<<31>>31),r=~~((0|r)-((+(A>>>0)+0x100000000*(0|w()))*2+1)),i[t>>2]=r;break}else{A=0|tx(0|r,((0|r)<0)<<31>>31,0|(A=(0|e)/2|0),((0|A)<0)<<31>>31),r=~~((0|r)-(+(A>>>0)+0x100000000*(0|w()))*2),i[t>>2]=r;break}while(0)A=t+4|0,d<0&&(r=r-((e<<1|1)/2|0)|0,i[t>>2]=r,e=0-e|0,i[A>>2]=e),n=e-r|0,(0|r)<0?(s=0-r|0,i[A>>2]=n,i[p>>2]=s,i[t>>2]=0,e=n,r=0):s=0,(0|e)<0&&(r=r-e|0,i[t>>2]=r,s=s-e|0,i[p>>2]=s,i[A>>2]=0,e=0),o=r-s|0,n=e-s|0,(0|s)<0&&(i[t>>2]=o,i[A>>2]=n,i[p>>2]=0,e=n,r=o,s=0),(0|(n=(0|s)<(0|(n=(0|e)<(0|r)?e:r))?s:n))<=0||(i[t>>2]=r-n,i[A>>2]=e-n,i[p>>2]=s-n)}(c,o+4|0),I=l,t=0|function(e,t){e|=0,t|=0;var r,n=0,a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0;if(c=I,I=I+64|0,u=c+40|0,a=c+24|0,s=c+12|0,o=c,tC(0|t,0,52),n=0|w()|0x8001fff,!t)return(0|i[e+4>>2])>2||(0|i[e+8>>2])>2||(0|i[e+12>>2])>2?(u=0,T(0|(l=0))):(tC(0|G(e),0,45),l=0|w()|n,u=-1,T(0|l)),I=c,0|u;if(i[u>>2]=i[e>>2],i[u+4>>2]=i[e+4>>2],i[u+8>>2]=i[e+8>>2],i[u+12>>2]=i[e+12>>2],l=u+4|0,(0|t)>0)for(e=-1;;)if(i[a>>2]=i[l>>2],i[a+4>>2]=i[l+4>>2],i[a+8>>2]=i[l+8>>2],1&t?(!function(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;r=0|i[(o=e+8|0)>>2],n=0|tf(((3*(t=(0|i[e>>2])-r|0)|0)-(r=(0|i[(l=e+4|0)>>2])-r|0)|0)*.14285714285714285),i[e>>2]=n,t=0|tf(((r<<1)+t|0)*.14285714285714285),i[l>>2]=t,i[o>>2]=0,r=t-n|0,(0|n)<0?(s=0-n|0,i[l>>2]=r,i[o>>2]=s,i[e>>2]=0,t=r,n=0,r=s):r=0,(0|t)<0&&(n=n-t|0,i[e>>2]=n,r=r-t|0,i[o>>2]=r,i[l>>2]=0,t=0),s=n-r|0,a=t-r|0,(0|r)<0?(i[e>>2]=s,i[l>>2]=a,i[o>>2]=0,t=a,a=s,r=0):a=n,(0|(n=(0|r)<(0|(n=(0|t)<(0|a)?t:a))?r:n))<=0||(i[e>>2]=a-n,i[l>>2]=t-n,i[o>>2]=r-n)}(l),i[s>>2]=i[l>>2],i[s+4>>2]=i[l+4>>2],i[s+8>>2]=i[l+8>>2],es(s)):(ea(l),i[s>>2]=i[l>>2],i[s+4>>2]=i[l+4>>2],i[s+8>>2]=i[l+8>>2],eo(s)),er(a,s,o),$(o),h=0|tC(7,0,0|(d=(15-t|0)*3|0)),n&=~(0|w()),e=(d=0|tC(0|ei(o),0,0|d))|e&~h,n=0|w()|n,(0|t)>1)t=t+-1|0;else break;else e=-1;e:do if(((0|i[l>>2])<=2?(0|i[u+8>>2])<=2:0)?(0|i[u+12>>2])<=2:0){if(t=0|tC(0|(a=0|G(u)),0,45)|e,e=0|w()|-1040385&n,o=0|i[11120+((0|i[(r=0|u)>>2])*216|0)+((0|i[r+4>>2])*72|0)+((0|i[r+8>>2])*24|0)+(i[r+12>>2]<<3)+4>>2],!(0|V(a))){if((0|o)<=0)break;for(s=0;;){if(a=0|tR(0|t,0|e,52),w(),a&=15)for(n=1;;)if(u=0|tR(0|t,0|e,0|(d=(15-n|0)*3|0)),w(),h=0|tC(7,0,0|d),e&=~(0|w()),t=t&~h|(d=0|tC(0|eh(7&u),0,0|d)),e|=w(),n>>>0<a>>>0)n=n+1|0;else break;if((0|(s=s+1|0))==(0|o))break e}}s=0|tR(0|t,0|e,52),w(),s&=15;t:do if(s){n=1;u:for(;;){switch(d=0|tR(0|t,0|e,(15-n|0)*3|0),w(),7&d){case 1:break u;case 0:break;default:break t}if(n>>>0<s>>>0)n=n+1|0;else break t}if(0|H(a,0|i[u>>2]))for(n=1;;)if(h=0|tC(7,0,0|(u=(15-n|0)*3|0)),d=e&~(0|w()),e=0|tR(0|t,0|e,0|u),w(),t=t&~h|(e=0|tC(0|ed(7&e),0,0|u)),e=d|(0|w()),n>>>0<s>>>0)n=n+1|0;else break;else for(n=1;;)if(u=0|tR(0|t,0|e,0|(d=(15-n|0)*3|0)),w(),h=0|tC(7,0,0|d),e&=~(0|w()),t=t&~h|(d=0|tC(0|eh(7&u),0,0|d)),e|=w(),n>>>0<s>>>0)n=n+1|0;else break}while(0)if((0|o)>0){n=0;do t=0|eL(t,e),e=0|w(),n=n+1|0;while((0|n)!=(0|o))}}else t=0,e=0;while(0)return h=e,d=t,T(0|h),I=c,0|d}(h,t),h=0|w(),i[r>>2]=t,i[r+4>>2]=h,(0|t)==0&(0|h)==0&&M(27795,27122,959,27145),h=0,I=m,0|h)}function eO(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0;if(a=r+4|0,s=0|tR(0|e,0|t,52),w(),s&=15,o=0|tR(0|e,0|t,45),w(),n=(0|s)==0,0|V(127&o))if(n)return 0|(o=1);else n=1;else{if(n)return 0|(o=0);n=((0|i[a>>2])==0?(0|i[r+8>>2])==0:0)?(0|i[r+12>>2])!=0&1:1}for(r=1;;)if(1&r?es(a):eo(a),o=0|tR(0|e,0|t,(15-r|0)*3|0),w(),el(a,7&o),r>>>0<s>>>0)r=r+1|0;else break;return 0|n}function ek(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0,l=0,u=0,c=0,h=0;if(h=I,I=I+16|0,u=h,c=0|tR(0|e,0|t,45),w(),(c&=127)>>>0>121)return i[r>>2]=0,i[r+4>>2]=0,i[r+8>>2]=0,i[r+12>>2]=0,c=5,I=h,0|c;e:do if((0|V(c))!=0?(s=0|tR(0|e,0|t,52),w(),(0|(s&=15))!=0):0){n=1;t:for(;;){switch(l=0|tR(0|e,0|t,(15-n|0)*3|0),w(),7&l){case 5:break t;case 0:break;default:n=t;break e}if(n>>>0<s>>>0)n=n+1|0;else{n=t;break e}}for(a=1,n=t;;)if(o=0|tC(7,0,0|(t=(15-a|0)*3|0)),l=n&~(0|w()),n=0|tR(0|e,0|n,0|t),w(),e=e&~o|(n=0|tC(0|ed(7&n),0,0|t)),n=l|(0|w()),a>>>0<s>>>0)a=a+1|0;else break}else n=t;while(0)if(l=7696+(28*c|0)|0,i[r>>2]=i[l>>2],i[r+4>>2]=i[l+4>>2],i[r+8>>2]=i[l+8>>2],i[r+12>>2]=i[l+12>>2],!(0|eO(e,n,r)))return c=0,I=h,0|c;if(o=r+4|0,i[u>>2]=i[o>>2],i[u+4>>2]=i[o+4>>2],i[u+8>>2]=i[o+8>>2],s=0|tR(0|e,0|n,52),w(),l=15&s,1&s?(eo(o),s=l+1|0):s=l,0|V(c)){u:do if(l)for(t=1;;){if(a=0|tR(0|e,0|n,(15-t|0)*3|0),w(),0|(a&=7)){n=a;break u}if(t>>>0<l>>>0)t=t+1|0;else{n=0;break}}else n=0;while(0)n=(0|n)==4&1}else n=0;if(0|e_(r,s,n,0)){if(0|V(c))do;while((0|e_(r,s,0,0))!=0)(0|s)!=(0|l)&&ea(o)}else(0|s)!=(0|l)&&(i[o>>2]=i[u>>2],i[o+4>>2]=i[u+4>>2],i[o+8>>2]=i[u+8>>2]);return c=0,I=h,0|c}function ez(e,t,r){e|=0,t|=0,r|=0;var n,a,s,o,l,u=0,c=0,h=0;return(h=I,I=I+16|0,0|(c=0|ek(e,t,u=h)))?(I=h,0|c):(c=0|tR(0|e,0|t,52),w(),n=0|u,a=15&c,s=0|r,o=0,l=0,o=I,I=I+16|0,ee(n+4|0,l=o),ey(l,0|i[n>>2],a,0,s),I=o,c=0,I=h,0|c)}function eV(e,t,r){e|=0,t|=0,r|=0;var n=0,i=0,a=0,s=0,o=0;if(s=I,I=I+16|0,0|(n=0|ek(e,t,a=s)))return a=n,I=s,0|a;n=0|tR(0|e,0|t,45),w(),n=(0|V(127&n))==0,i=0|tR(0|e,0|t,52),w(),i&=15;e:do if(!n){if(0|i)for(n=1;;){if(!(((o=0|tC(7,0,(15-n|0)*3|0))&e)==0&((0|w())&t)==0))break e;if(n>>>0<i>>>0)n=n+1|0;else break}return ev(a,i,0,5,r),o=0,I=s,0|o}while(0)return eb(a,i,0,6,r),o=0,I=s,0|o}function eq(e,t){t|=0;var r=0,n=0,a=0,s=0,o=0,l=0,u=0;if((e|=0)>>>0>15)return 0|(l=4);if(tC(0|e,0,52),l=0|w()|0x8001fff,!e){r=0,n=0;do 0|V(n)&&(tC(0|n,0,45),o=l|(0|w()),i[(e=t+(r<<3)|0)>>2]=-1,i[e+4>>2]=o,r=r+1|0),n=n+1|0;while((0|n)!=122)return 0|(r=0)}r=0,o=0;do{if(0|V(o)){for(tC(0|o,0,45),n=1,a=-1,s=l|(0|w());a&=~(u=0|tC(7,0,(15-n|0)*3|0)),s&=~(0|w()),(0|n)!=(0|e);)n=n+1|0;i[(u=t+(r<<3)|0)>>2]=a,i[u+4>>2]=s,r=r+1|0}o=o+1|0}while((0|o)!=122)return 0|(r=0)}function eG(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0;a=0|tR(0|t,0|r,52),w(),(0|n)>15|(0|(a&=15))>(0|n)|(0|t)==0&(0|r)==0?(s=-1,t=-1,r=0,a=0):(t=0|eN(t,r,a+1|0,n),o=(0|w())&-0xf00001,r=0|tC(0|n,0,52)|t,o|=w(),t=(0|eC(r,o))==0,s=a,t=t?-1:n,a=o),i[(o=e)>>2]=r,i[o+4>>2]=a,i[e+8>>2]=s,i[e+12>>2]=t}function eH(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0;if(a=0|tR(0|e,0|t,52),w(),a&=15,i[(s=n+8|0)>>2]=a,(0|r)>15|(0|a)>(0|r)|(0|e)==0&(0|t)==0){i[(r=n)>>2]=0,i[r+4>>2]=0,i[s>>2]=-1,i[n+12>>2]=-1;return}if(e=0|eN(e,t,a+1|0,r),s=(0|w())&-0xf00001,a=0|tC(0|r,0,52)|e,s|=w(),i[(e=n)>>2]=a,i[e+4>>2]=s,e=n+12|0,0|eC(a,s)){i[e>>2]=r;return}i[e>>2]=-1}function ej(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0,u=0,c=0;if(!((0|(t=0|i[(r=e)>>2]))==0&(0|(r=0|i[r+4>>2]))==0)&&(n=0|tR(0|t,0|r,52),w(),n&=15,t=0|tv(0|(l=0|tC(1,0,(15^n)*3|0)),0|w(),0|t,0|r),r=0|w(),i[(l=e)>>2]=t,i[l+4>>2]=r,!((0|n)<(0|(o=0|i[(l=e+8|0)>>2]))))){for(u=e+12|0,s=n;;){if((0|s)==(0|o)){n=5;break}if(c=(0|s)==(0|i[u>>2]),n=0|tR(0|t,0|r,0|(a=(15-s|0)*3|0)),w(),(0|(n&=7))==1&!0&c){n=7;break}if(!((0|n)==7&!0)){n=10;break}if(t=0|tv(0|t,0|r,0|(c=0|tC(1,0,0|a)),0|w()),r=0|w(),i[(c=e)>>2]=t,i[c+4>>2]=r,(0|s)>(0|o))s=s+-1|0;else{n=10;break}}if((0|n)==5){i[(c=e)>>2]=0,i[c+4>>2]=0,i[l>>2]=-1,i[u>>2]=-1;return}if((0|n)==7){o=0|tv(0|t,0|r,0|(o=0|tC(1,0,0|a)),0|w()),l=0|w(),i[(c=e)>>2]=o,i[c+4>>2]=l,i[u>>2]=s+-1;return}if((0|n)==10)return}}function eW(e){e*=1;var t=0;return t=e<0?e+6.283185307179586:e,+(!(e>=6.283185307179586)?t:t+-6.283185307179586)}function eX(e,t){return(t|=0,17453292519943298e-27>+u(+(a[(e|=0)>>3]-a[t>>3])))?0|(t=17453292519943298e-27>+u(+(a[e+8>>3]-a[t+8>>3]))):0|(t=0)}function eQ(e,t){switch(e*=1,0|(t|=0)){case 1:e=e<0?e+6.283185307179586:e;break;case 2:e=e>0?e+-6.283185307179586:e}return+e}function eY(e,t){e|=0,t|=0;var r=0,n=0,i=0,s=0;return+(2*y(+c(+(r=(s=+A(+(((i=+a[t>>3])-(n=+a[e>>3]))*.5)))*s+(r=+A(+((a[t+8>>3]-a[e+8>>3])*.5)))*(d(+i)*d(+n)*r))),+c(+(1-r)))*6371.007180918475)}function eK(e,t){return(t|=0,(e|=0)>>>0>15)?0|(t=4):(a[t>>3]=+a[20656+(e<<3)>>3],0|(t=0))}function eZ(e,t){t|=0;var r=0;return(e|=0)>>>0>15?0|(t=4):(r=0|tT(0|(r=0|e4(7,0,e,((0|e)<0)<<31>>31)),0|w(),120,0),e=0|w(),i[t>>2]=2|r,i[t+4>>2]=e,0|(t=0))}function eJ(e,t,r){e|=0,t|=0,r|=0;var n=0,i=0,s=0,o=0,l=0,u=0,h=0,f=0,m=0,v=0;return u=+A(+(((v=+a[t>>3])-(f=+a[e>>3]))*.5)),o=+A(+(((s=+a[t+8>>3])-(h=+a[e+8>>3]))*.5)),l=+d(+f),o=2*y(+c(+(o=u*u+(m=+d(+v))*l*o*o)),+c(+(1-o))),v=+A(+(((u=+a[r>>3])-v)*.5)),s=+A(+(((n=+a[r+8>>3])-s)*.5)),s=2*y(+c(+(s=v*v+m*(i=+d(+u))*s*s)),+c(+(1-s))),i=(o+s+(n=2*y(+c(+(n=(u=+A(+((f-u)*.5)))*u+l*i*(n=+A(+((h-n)*.5)))*n)),+c(+(1-n)))))*.5,+(4*g(+c(+(p(+(.5*i))*p(+((i-o)*.5))*p(+((i-s)*.5))*p(+((i-n)*.5))))))}function e$(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0,u=0;if(u=I,I=I+192|0,o=u+168|0,l=u,0|(s=0|ez(e,t,o)))return r=s,I=u,0|r;if(0|eV(e,t,l)&&M(27795,27190,415,27199),(0|(t=0|i[l>>2]))>0){if(n=+eJ(l+8|0,l+8+(((0|t)!=1&1)<<4)|0,o)+0,(0|t)!=1){e=1;do n+=+eJ(l+8+((s=e)<<4)|0,l+8+(((0|(e=e+1|0))%(0|t)|0)<<4)|0,o);while((0|e)<(0|t))}}else n=0;return a[r>>3]=n,r=0,I=u,0|r}function e0(e){var t=0,r=0,n=0,a=0;if(e|=0)for(n=1;;){if(0|(t=0|i[e>>2]))do{if(0|(r=0|i[t>>2]))do a=r,r=0|i[r+16>>2],tg(a);while((0|r)!=0)a=t,t=0|i[t+8>>2],tg(a)}while((0|t)!=0)if(t=e,e=0|i[e+8>>2],n||tg(t),e)n=0;else break}}function e1(e,t,r){e|=0;var n=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0;if(!(0|Q(t|=0,r|=0))||(t=0|X(t),n=+a[r>>3],s=t&(s=+a[r+8>>3])<0?s+6.283185307179586:s,!(e=0|i[e>>2])))return 0|(e=0);if(t){t=0,h=s,r=e;e:for(;;){for(;l=+a[r>>3],s=+a[r+8>>3],o=+a[(d=(0|(d=0|i[(r=r+16|0)>>2]))==0?e:d)>>3],u=+a[d+8>>3],l>o?(c=l,l=u):(c=o,o=l,l=s,s=u),(n=n==o|n==c?n+2220446049250313e-31:n)<o|n>c;)if(!(r=0|i[r>>2])){r=22;break e}if(h=(u=l<0?l+6.283185307179586:l)==h|(l=s<0?s+6.283185307179586:s)==h?h+-2220446049250313e-31:h,((c=u+(n-o)/(c-o)*(l-u))<0?c+6.283185307179586:c)>h&&(t^=1),!(r=0|i[r>>2])){r=22;break}}if((0|r)==22)return 0|t}else{t=0,h=s,r=e;t:for(;;){for(;l=+a[r>>3],s=+a[r+8>>3],o=+a[(d=(0|(d=0|i[(r=r+16|0)>>2]))==0?e:d)>>3],u=+a[d+8>>3],l>o?(c=l,l=u):(c=o,o=l,l=s,s=u),(n=n==o|n==c?n+2220446049250313e-31:n)<o|n>c;)if(!(r=0|i[r>>2])){r=22;break t}if(h=l==h|s==h?h+-2220446049250313e-31:h,l+(n-o)/(c-o)*(s-l)>h&&(t^=1),!(r=0|i[r>>2])){r=22;break}}if((0|r)==22)return 0|t}return 0}function e2(e,t,r,a,s){e|=0,t|=0,r|=0,a|=0,s|=0;var o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0;if(x=I,I=I+32|0,v=x+16|0,y=x,o=0|tR(0|e,0|t,52),w(),o&=15,f=0|tR(0|r,0|a,52),w(),(0|o)!=(15&f))return v=12,I=x,0|v;if(h=0|tR(0|e,0|t,45),w(),h&=127,d=0|tR(0|r,0|a,45),w(),h>>>0>121|(d&=127)>>>0>121)return v=5,I=x,0|v;if(f=(0|h)!=(0|d)){if((0|(u=0|W(h,d)))==7)return v=1,I=x,0|v;(0|(c=0|W(d,h)))==7?M(27514,27538,161,27548):(m=u,l=c)}else m=0,l=0;A=0|V(h),p=0|V(d),i[v>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,i[v+12>>2]=0;do if(m){if(u=(0|(d=0|i[4272+(28*h|0)+(m<<2)>>2]))>0,p)if(u){h=0,c=r,u=a;do c=0|function(e,t){e|=0,t|=0;var r=0,n=0,i=0,a=0,s=0,o=0,l=0;if(l=0|tR(0|e,0|t,52),w(),!(l&=15))return o=t,l=e,T(0|o),0|l;for(o=1,r=0;;){n=0|tC(7,0,0|(a=(15-o|0)*3|0)),i=0|w(),s=0|tR(0|e,0|t,0|a),w(),a=0|tC(0|ed(7&s),0,0|a),s=0|w(),e=a|e&~n,t=s|t&~i;e:do if(!r)if((a&n)==0&(s&i)==0)r=0;else if(n=0|tR(0|e,0|t,52),w(),n&=15){r=1;t:for(;;){switch(s=0|tR(0|e,0|t,(15-r|0)*3|0),w(),7&s){case 1:break t;case 0:break;default:r=1;break e}if(r>>>0<n>>>0)r=r+1|0;else{r=1;break e}}for(r=1;;)if(a=0|tC(7,0,0|(i=(15-r|0)*3|0)),s=t&~(0|w()),t=0|tR(0|e,0|t,0|i),w(),e=e&~a|(t=0|tC(0|ed(7&t),0,0|i)),t=s|(0|w()),r>>>0<n>>>0)r=r+1|0;else{r=1;break}}else r=1;while(0)if(o>>>0<l>>>0)o=o+1|0;else break}return T(0|t),0|e}(c,u),u=0|w(),(0|(l=0|ed(l)))==1&&(l=0|ed(1)),h=h+1|0;while((0|h)!=(0|d))d=l,h=c,c=u}else d=l,h=r,c=a;else if(u){h=0,c=r,u=a;do c=0|eB(c,u),u=0|w(),l=0|ed(l),h=h+1|0;while((0|h)!=(0|d))d=l,h=c,c=u}else d=l,h=r,c=a;if(eO(h,c,v),f||M(27563,27538,191,27548),(u=(0|A)!=0)&(l=(0|p)!=0)&&M(27590,27538,192,27548),u){if((0|(l=0|eI(e,t)))==7){o=5;break}if(0|n[22e3+(7*l|0)+m|0]){o=1;break}h=c=0|i[21168+(28*l|0)+(m<<2)>>2]}else if(l){if((0|(l=0|eI(h,c)))==7){o=5;break}if(0|n[22e3+(7*l|0)+d|0]){o=1;break}h=0,c=0|i[21168+(28*d|0)+(l<<2)>>2]}else h=0,c=0;if((h|c)<0)o=5;else{if((0|c)>0){u=v+4|0,l=0;do ec(u),l=l+1|0;while((0|l)!=(0|c))}if(i[y>>2]=0,i[y+4>>2]=0,i[y+8>>2]=0,el(y,m),0|o)for(;;)if(0|eF(o)?es(y):eo(y),(0|o)>1)o=o+-1|0;else break;if((0|h)>0){o=0;do ec(y),o=o+1|0;while((0|o)!=(0|h))}et(g=v+4|0,y,g),$(g),g=51}}else if(eO(r,a,v),(0|A)!=0&(0|p)!=0)if((0|d)!=(0|h)&&M(27621,27538,261,27548),(0|(l=0|eI(e,t)))==7|(0|(o=0|eI(r,a)))==7)o=5;else if(0|n[22e3+(7*l|0)+o|0])o=1;else if((0|(l=0|i[21168+(28*l|0)+(o<<2)>>2]))>0){u=v+4|0,o=0;do ec(u),o=o+1|0;while((0|o)!=(0|l))g=51}else g=51;else g=51;while(0)return(0|g)==51&&(o=v+4|0,i[s>>2]=i[o>>2],i[s+4>>2]=i[o+4>>2],i[s+8>>2]=i[o+8>>2],o=0),v=o,I=x,0|v}function e3(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0;if(m=I,I=I+48|0,c=m+36|0,o=m+24|0,l=m+12|0,u=m,a=0|tR(0|e,0|t,52),w(),a&=15,A=0|tR(0|e,0|t,45),w(),(A&=127)>>>0>121)return n=5,I=m,0|n;if(h=0|V(A),tC(0|a,0,52),g=0|w()|0x8001fff,i[(s=n)>>2]=-1,i[s+4>>2]=g,!a)return(0|(a=0|ei(r)))==7||(0|(a=0|j(A,a)))==127?g=1:(p=0|tC(0|a,0,45),f=0|w(),f=-1040385&i[(A=n)+4>>2]|f,i[(g=n)>>2]=i[A>>2]|p,i[g+4>>2]=f,g=0),I=m,0|g;for(i[c>>2]=i[r>>2],i[c+4>>2]=i[r+4>>2],i[c+8>>2]=i[r+8>>2],r=a;;){if(s=r,r=r+-1|0,i[o>>2]=i[c>>2],i[o+4>>2]=i[c+4>>2],i[o+8>>2]=i[c+8>>2],0|eF(s)){if(0|(a=0|function(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0,u=0,c=0;if(o=0|i[(u=e+8|0)>>2],(l=(0|i[e>>2])-o|0)>>>0>0x2aaaaaa9|(o=(0|i[(c=e+4|0)>>2])-o|0)>>>0>0x2aaaaaa9){if(n=(0|l)>0,a=0x7fffffff-l|0,s=-0x80000000-l|0,(n?(0|a)<(0|l):(0|s)>(0|l))||(r=l<<1,(n?(0x7fffffff-r|0)<(0|l):(-0x80000000-r|0)>(0|l))||((0|o)>0?(0x7fffffff-o|0)<(0|o):(-0x80000000-o|0)>(0|o)))||(t=3*l|0,r=o<<1,(n?(0|a)<(0|r):(0|s)>(0|r))?1:(0|l)>-1?(-0x80000000|t)>=(0|o):(-0x80000000^t)<(0|o)))return 0|(c=1)}else r=o<<1,t=3*l|0;return n=0|tf((t-o|0)*.14285714285714285),i[e>>2]=n,a=0|tf((r+l|0)*.14285714285714285),i[c>>2]=a,i[u>>2]=0,t=(r=(0|a)<(0|n))?n:a,(0|(r=r?a:n))<0&&(((0|r)==-0x80000000?1:(0|t)>0?(0x7fffffff-t|0)<(0|r):(-0x80000000-t|0)>(0|r))&&M(27795,26892,354,26903),((0|t)>-1?(-0x80000000|t)>=(0|r):(-0x80000000^t)<(0|r))&&M(27795,26892,354,26903)),t=a-n|0,(0|n)<0?(r=0-n|0,i[c>>2]=t,i[u>>2]=r,i[e>>2]=0,n=0):(t=a,r=0),(0|t)<0&&(n=n-t|0,i[e>>2]=n,r=r-t|0,i[u>>2]=r,i[c>>2]=0,t=0),s=n-r|0,a=t-r|0,(0|r)<0?(i[e>>2]=s,i[c>>2]=a,i[u>>2]=0,t=a,a=s,r=0):a=n,(0|(n=(0|r)<(0|(n=(0|t)<(0|a)?t:a))?r:n))<=0||(i[e>>2]=a-n,i[c>>2]=t-n,i[u>>2]=r-n),0|(c=0)}(c))){r=13;break}i[l>>2]=i[c>>2],i[l+4>>2]=i[c+4>>2],i[l+8>>2]=i[c+8>>2],es(l)}else{if(0|(a=0|function(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0,u=0;if(a=0|i[(o=e+8|0)>>2],(s=(0|i[e>>2])-a|0)>>>0>0x2aaaaaa9|(a=(0|i[(l=e+4|0)>>2])-a|0)>>>0>0x2aaaaaa9){if(((r=(0|s)>0)?(0x7fffffff-s|0)<(0|s):(-0x80000000-s|0)>(0|s))||(t=s<<1,(n=(0|a)>0)?(0x7fffffff-a|0)<(0|a):(-0x80000000-a|0)>(0|a)))return 0|(l=1);if(u=a<<1,(n?(0x7fffffff-u|0)<(0|a):(-0x80000000-u|0)>(0|a))||(r?(0x7fffffff-t|0)<(0|a):(-0x80000000-t|0)>(0|a))||(r=3*a|0,(0|a)>-1?(-0x80000000|r)>=(0|s):(-0x80000000^r)<(0|s)))return 0|(u=1)}else r=3*a|0,t=s<<1;return n=0|tf((t+a|0)*.14285714285714285),i[e>>2]=n,a=0|tf((r-s|0)*.14285714285714285),i[l>>2]=a,i[o>>2]=0,t=(r=(0|a)<(0|n))?n:a,(0|(r=r?a:n))<0&&(((0|r)==-0x80000000?1:(0|t)>0?(0x7fffffff-t|0)<(0|r):(-0x80000000-t|0)>(0|r))&&M(27795,26892,402,26917),((0|t)>-1?(-0x80000000|t)>=(0|r):(-0x80000000^t)<(0|r))&&M(27795,26892,402,26917)),t=a-n|0,(0|n)<0?(r=0-n|0,i[l>>2]=t,i[o>>2]=r,i[e>>2]=0,n=0):(t=a,r=0),(0|t)<0&&(n=n-t|0,i[e>>2]=n,r=r-t|0,i[o>>2]=r,i[l>>2]=0,t=0),s=n-r|0,a=t-r|0,(0|r)<0?(i[e>>2]=s,i[l>>2]=a,i[o>>2]=0,t=a,a=s,r=0):a=n,(0|(n=(0|r)<(0|(n=(0|t)<(0|a)?t:a))?r:n))<=0||(i[e>>2]=a-n,i[l>>2]=t-n,i[o>>2]=r-n),0|(u=0)}(c))){r=13;break}i[l>>2]=i[c>>2],i[l+4>>2]=i[c+4>>2],i[l+8>>2]=i[c+8>>2],eo(l)}if(er(o,l,u),$(u),v=0|i[(a=n)>>2],a=0|i[a+4>>2],y=0|tC(7,0,0|(x=(15-s|0)*3|0)),a&=~(0|w()),x=0|tC(0|ei(u),0,0|x),a=0|w()|a,i[(g=n)>>2]=x|v&~y,i[g+4>>2]=a,(0|s)<=1){r=14;break}}e:do if((0|r)!=13&&(0|r)==14)if(((0|i[c>>2])<=1?(0|i[c+4>>2])<=1:0)?(0|i[c+8>>2])<=1:0){u=(0|(a=0|j(A,r=0|ei(c))))==127?0:0|V(a);t:do if(r){if(h){if((0|(a=0|eI(e,t)))==7){a=5;break e}if((0|(s=0|i[21376+(28*a|0)+(r<<2)>>2]))>0){a=r,r=0;do a=0|eh(a),r=r+1|0;while((0|r)!=(0|s))}else a=r;if((0|a)==1){a=9;break e}(0|(r=0|j(A,a)))==127&&M(27648,27538,411,27678),0|V(r)?M(27693,27538,412,27678):(f=r,p=s,d=a)}else f=a,p=0,d=r;if((0|(l=0|i[4272+(28*A|0)+(d<<2)>>2]))<=-1&&M(27724,27538,419,27678),!u){if((0|p)<0){a=5;break e}if(0|p){a=0,r=0|i[(s=n)>>2],s=0|i[s+4>>2];do r=0|eD(r,s),s=0|w(),i[(x=n)>>2]=r,i[x+4>>2]=s,a=a+1|0;while((0|a)<(0|p))}if((0|l)<=0){a=f,r=58;break}for(a=0,r=0|i[(s=n)>>2],s=0|i[s+4>>2];;)if(r=0|eD(r,s),s=0|w(),i[(x=n)>>2]=r,i[x+4>>2]=s,(0|(a=a+1|0))==(0|l)){a=f,r=58;break t}}if((0|(o=0|W(f,A)))==7&&M(27514,27538,428,27678),r=0|i[(a=n)>>2],a=0|i[a+4>>2],(0|l)>0){s=0;do r=0|eD(r,a),a=0|w(),i[(x=n)>>2]=r,i[x+4>>2]=a,s=s+1|0;while((0|s)!=(0|l))}if((0|(a=0|eI(r,a)))==7&&M(27795,27538,440,27678),(0|(r=0|i[((r=0|q(f))?21792:21584)+(28*o|0)+(a<<2)>>2]))<0&&M(27795,27538,454,27678),r){a=0,s=0|i[(o=n)>>2],o=0|i[o+4>>2];do s=0|eL(s,o),o=0|w(),i[(x=n)>>2]=s,i[x+4>>2]=o,a=a+1|0;while((0|a)<(0|r))a=f,r=58}else a=f,r=58}else if((0|h)!=0&(0|u)!=0){if((0|(r=0|eI(e,t)))==7|(0|(s=0|eI(0|i[(s=n)>>2],0|i[s+4>>2])))==7||(0|(s=0|i[21376+(28*r|0)+(s<<2)>>2]))<0){a=5;break e}if(s){r=0,o=0|i[(l=n)>>2],l=0|i[l+4>>2];do o=0|eD(o,l),l=0|w(),i[(x=n)>>2]=o,i[x+4>>2]=l,r=r+1|0;while((0|r)<(0|s))r=58}else r=59}else r=58;while(0)if((0|r)==58&&u&&(r=59),(0|r)==59&&(0|eI(0|i[(x=n)>>2],0|i[x+4>>2]))==1){a=9;break}y=0|i[(x=n)>>2],x=-1040385&i[x+4>>2],v=0|tC(0|a,0,45),x|=w(),i[(a=n)>>2]=y|v,i[a+4>>2]=x,a=0}else a=1;while(0)return x=a,I=m,0|x}function e4(e,t,r,n){e|=0,t|=0;var i=0,a=0,s=0;if((0|(r|=0))==0&(0|(n|=0))==0)return a=1,T(0|(i=0)),0|a;a=e,i=t,e=1,t=0;do e=0|tT(((s=(1&r)==0&!0)?1:a)|0,(s?0:i)|0,0|e,0|t),t=0|w(),r=0|tE(0|r,0|n,1),n=0|w(),a=0|tT(0|a,0|i,0|a,0|i),i=0|w();while(!((0|r)==0&(0|n)==0))return T(0|t),0|e}function e5(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var s,o,l,u,c,h,A,p,f,m,g,y=0,v=0,x=0,_=0,b=0,S=0,T=0;_=I,I=I+16|0,v=_,x=0|tR(0|e,0|t,52),w(),x&=15;do{if(x){if(!(y=0|ez(e,t,v))){b=1/d(+(S=+a[v>>3])),T=+a[25968+(x<<3)>>3],a[r>>3]=S+T,a[r+8>>3]=S-T,S=+a[v+8>>3],b*=T,a[r+16>>3]=b+S,a[r+24>>3]=S-b;break}return x=y,I=_,0|x}if(y=0|tR(0|e,0|t,45),w(),(y&=127)>>>0>121)return x=5,I=_,0|x;v=22064+(y<<5)|0,i[r>>2]=i[v>>2],i[r+4>>2]=i[v+4>>2],i[r+8>>2]=i[v+8>>2],i[r+12>>2]=i[v+12>>2],i[r+16>>2]=i[v+16>>2],i[r+20>>2]=i[v+20>>2],i[r+24>>2]=i[v+24>>2],i[r+28>>2]=i[v+28>>2];break}while(0)return s=0|r,o=(n?1.4:1.1)*1,l=0,u=0,c=0,h=0,A=0,p=0,f=0,m=0,g=0,u=(A=+a[(h=s+16|0)>>3])-(c=+a[(l=s+24|0)>>3]),u=A<c?u+6.283185307179586:u,g=(m=+a[s>>3])-(f=+a[(p=s+8|0)>>3]),u=(u*o-u)*.5,m+=o=(g*o-g)*.5,a[s>>3]=m>1.5707963267948966?1.5707963267948966:m,o=f-o,a[p>>3]=o<-1.5707963267948966?-1.5707963267948966:o,o=(o=A+u)>3.141592653589793?o+-6.283185307179586:o,a[h>>3]=o<-3.141592653589793?o+6.283185307179586:o,o=(o=c-u)>3.141592653589793?o+-6.283185307179586:o,a[l>>3]=o<-3.141592653589793?o+6.283185307179586:o,((0|i[(n=26096+(x<<3)|0)>>2])==(0|e)?(0|i[n+4>>2])==(0|t):0)&&(a[r>>3]=1.5707963267948966),((0|i[(x=26224+(x<<3)|0)>>2])==(0|e)?(0|i[x+4>>2])==(0|t):0)&&(a[r+8>>3]=-1.5707963267948966),(1.5707963267948966!=+a[r>>3]?-1.5707963267948966!=+a[r+8>>3]:0)||(a[r+16>>3]=3.141592653589793,a[r+24>>3]=-3.141592653589793),x=0,I=_,0|x}function e6(e){e|=0;var t=0,r=0,a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0;if(b=I,I=I+336|0,f=b+168|0,m=b,(0|(r=0|i[(a=e)>>2]))==0&(0|(a=0|i[a+4>>2]))==0){I=b;return}if(0|n[0|(t=e+28|0)]?(r=0|e7(r,a),a=0|w()):n[0|t]=1,!(0|i[i[(_=e+20|0)>>2]>>2])){0|(r=0|i[(t=e+24|0)>>2])&&tg(r),i[(x=e)>>2]=0,i[x+4>>2]=0,i[e+8>>2]=0,i[_>>2]=0,i[e+12>>2]=-1,i[e+16>>2]=0,i[t>>2]=0,I=b;return}s=15&(t=0|i[(x=e+16|0)>>2]);e:do if((0|r)==0&(0|a)==0)v=e+24|0;else{g=e+12|0,A=(0|s)==3,d=255&t,c=(1|s)==3,p=e+24|0,h=(s+-1|0)>>>0<3,l=(2|s)==3,u=m+8|0;t:for(;;){if(o=0|tR(0|r,0|a,52),w(),(0|(o&=15))==(0|i[g>>2])){switch(15&d){case 0:case 2:case 3:if(0|(s=0|ez(r,a,f))){y=15;break t}if(0|tr(0|i[_>>2],0|i[p>>2],f)){y=19;break t}}if(c?(s=0|i[(0|i[_>>2])+4>>2],i[f>>2]=i[s>>2],i[f+4>>2]=i[s+4>>2],i[f+8>>2]=i[s+8>>2],i[f+12>>2]=i[s+12>>2],0|Q(26832,f)):0){if(0|eU(0|i[(0|i[_>>2])+4>>2],o,m)){y=25;break}if((0|i[(s=m)>>2])==(0|r)?(0|i[s+4>>2])==(0|a):0){y=29;break}}if(h){if(0|(s=0|eV(r,a,f))){y=32;break}if(0|e5(r,a,m,0)){y=36;break}if((l?0|tn(0|i[_>>2],0|i[p>>2],f,m):0)||(c?0|ta(0|i[_>>2],0|i[p>>2],f,m):0)){y=42;break}}if(A){if(t=0|e5(r,a,f,1),s=0|i[p>>2],0|t){y=45;break}if(0|Y(s,f)&&(Z(m,f),0|K(f,0|i[p>>2])||0|tr(0|i[_>>2],0|i[p>>2],u)||0|ta(0|i[_>>2],0|i[p>>2],m,f))){y=53;break}}}do if((0|o)<(0|i[g>>2])){if(t=0|e5(r,a,f,1),s=0|i[p>>2],0|t){y=58;break t}if(!(0|Y(s,f))){y=73;break}if(0|K(0|i[p>>2],f)?(Z(m,f),0|tn(0|i[_>>2],0|i[p>>2],m,f)):0){y=65;break t}if(0|(r=0|eP(r,a,o+1|0,m))){y=67;break t}r=0|i[(a=m)>>2],a=0|i[a+4>>2]}else y=73;while(0)if((0|y)==73&&(y=0,r=0|e7(r,a),a=0|w()),(0|r)==0&(0|a)==0){v=p;break e}}switch(0|y){case 15:0|(t=0|i[p>>2])&&tg(t),i[(y=e)>>2]=0,i[y+4>>2]=0,i[_>>2]=0,i[g>>2]=-1,i[x>>2]=0,i[p>>2]=0,i[e+8>>2]=s,y=20;break;case 19:i[e>>2]=r,i[e+4>>2]=a,y=20;break;case 25:M(27795,27761,470,27772);break;case 29:case 42:i[e>>2]=r,i[e+4>>2]=a,I=b;return;case 32:0|(t=0|i[p>>2])&&tg(t),i[(v=e)>>2]=0,i[v+4>>2]=0,i[_>>2]=0,i[g>>2]=-1,i[x>>2]=0,i[p>>2]=0,i[e+8>>2]=s,I=b;return;case 36:M(27795,27761,493,27772);break;case 45:0|s&&tg(s),i[(y=e)>>2]=0,i[y+4>>2]=0,i[_>>2]=0,i[g>>2]=-1,i[x>>2]=0,i[p>>2]=0,i[e+8>>2]=t,y=55;break;case 53:i[e>>2]=r,i[e+4>>2]=a,y=55;break;case 58:0|s&&tg(s),i[(y=e)>>2]=0,i[y+4>>2]=0,i[_>>2]=0,i[g>>2]=-1,i[x>>2]=0,i[p>>2]=0,i[e+8>>2]=t,y=71;break;case 65:i[e>>2]=r,i[e+4>>2]=a,y=71;break;case 67:0|(t=0|i[p>>2])&&tg(t),i[(v=e)>>2]=0,i[v+4>>2]=0,i[_>>2]=0,i[g>>2]=-1,i[x>>2]=0,i[p>>2]=0,i[e+8>>2]=r,I=b;return}if((0|y)==20){I=b;return}if((0|y)==55){I=b;return}if((0|y)==71){I=b;return}}while(0)0|(t=0|i[v>>2])&&tg(t),i[(y=e)>>2]=0,i[y+4>>2]=0,i[e+8>>2]=0,i[_>>2]=0,i[e+12>>2]=-1,i[x>>2]=0,i[v>>2]=0,I=b}function e7(e,t){e|=0,t|=0;var r=0,n=0,a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0;d=I,I=I+16|0,h=d,n=0|tR(0|e,0|t,52),w(),n&=15,r=0|tR(0|e,0|t,45),w();do if(n){for(;r=0|tC(n+4095|0,0,52),a=0|w()|-0xf00001&t,o=0|tC(7,0,0|(s=(15-n|0)*3|0)),l=0|w(),r=r|e|o,a|=l,u=0|tR(0|e,0|t,0|s),w(),n=n+-1|0,!((u&=7)>>>0<6);)if(n)t=a,e=r;else{c=4;break}if((0|c)==4){r=0|tR(0|r,0|a,45),w();break}return h=0|tC(((h=(0|u)==0&(0|eC(r,a))!=0)?2:1)+u|0,0,0|s),c=0|w()|t&~l,h|=e&~o,T(0|c),I=d,0|h}while(0)return(r&=127)>>>0>120?(h=0,T(0|(c=0))):(eM(h,0,r+1|0,0),c=0|i[h+4>>2],h=0|i[h>>2],T(0|c)),I=d,0|h}function e8(e,t,r){e|=0;var n=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0;if(!(0|Q(t|=0,r|=0))||(t=0|X(t),n=+a[r>>3],s=t&(s=+a[r+8>>3])<0?s+6.283185307179586:s,(0|(p=0|i[e>>2]))<=0))return 0|(p=0);if(A=0|i[e+4>>2],t){t=0,d=s,r=-1,e=0;e:for(;;){for(h=e;l=+a[A+(h<<4)>>3],s=+a[A+(h<<4)+8>>3],o=+a[A+((e=(r+2|0)%(0|p)|0)<<4)>>3],u=+a[A+(e<<4)+8>>3],l>o?(c=l,l=u):(c=o,o=l,l=s,s=u),(n=n==o|n==c?n+2220446049250313e-31:n)<o|n>c;){if((0|(r=h+1|0))>=(0|p)){r=22;break e}e=h,h=r,r=e}if(d=(u=l<0?l+6.283185307179586:l)==d|(l=s<0?s+6.283185307179586:s)==d?d+-2220446049250313e-31:d,((c=u+(n-o)/(c-o)*(l-u))<0?c+6.283185307179586:c)>d&&(t^=1),(0|(e=h+1|0))>=(0|p)){r=22;break}r=h}if((0|r)==22)return 0|t}else{t=0,d=s,r=-1,e=0;t:for(;;){for(h=e;l=+a[A+(h<<4)>>3],s=+a[A+(h<<4)+8>>3],o=+a[A+((e=(r+2|0)%(0|p)|0)<<4)>>3],u=+a[A+(e<<4)+8>>3],l>o?(c=l,l=u):(c=o,o=l,l=s,s=u),(n=n==o|n==c?n+2220446049250313e-31:n)<o|n>c;){if((0|(r=h+1|0))>=(0|p)){r=22;break t}e=h,h=r,r=e}if(d=l==d|s==d?d+-2220446049250313e-31:d,l+(n-o)/(c-o)*(s-l)>d&&(t^=1),(0|(e=h+1|0))>=(0|p)){r=22;break}r=h}if((0|r)==22)return 0|t}return 0}function e9(e,t){e|=0,t|=0;var r=0,n=0,s=0,o=0,l=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0;if(!(g=0|i[e>>2])){i[t>>2]=0,i[t+4>>2]=0,i[t+8>>2]=0,i[t+12>>2]=0,i[t+16>>2]=0,i[t+20>>2]=0,i[t+24>>2]=0,i[t+28>>2]=0;return}if(a[(y=t+8|0)>>3]=17976931348623157e292,a[(v=t+24|0)>>3]=17976931348623157e292,a[t>>3]=-17976931348623157e292,a[(x=t+16|0)>>3]=-17976931348623157e292,!((0|g)<=0)){for(f=0|i[e+4>>2],d=17976931348623157e292,A=-17976931348623157e292,p=0,e=-1,o=17976931348623157e292,l=17976931348623157e292,h=-17976931348623157e292,n=-17976931348623157e292,m=0;r=+a[f+(m<<4)>>3],c=+a[f+(m<<4)+8>>3],s=+a[f+(((0|(e=e+2|0))==(0|g)?0:e)<<4)+8>>3],r<o&&(a[y>>3]=r,o=r),c<l&&(a[v>>3]=c,l=c),r>h?a[t>>3]=r:r=h,c>n&&(a[x>>3]=c,n=c),d=c>0&c<d?c:d,A=c<0&c>A?c:A,p|=+u(+(c-s))>3.141592653589793,(0|(e=m+1|0))!=(0|g);)_=m,h=r,m=e,e=_;p&&(a[x>>3]=A,a[v>>3]=d)}}function te(e){return((e|=0)>>>0<4?0:15)|0}function tt(e,t){e|=0,t|=0;var r=0,n=0,s=0,o=0,l=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,w=0,M=0;if(g=0|i[e>>2]){if(a[(y=t+8|0)>>3]=17976931348623157e292,a[(v=t+24|0)>>3]=17976931348623157e292,a[t>>3]=-17976931348623157e292,a[(x=t+16|0)>>3]=-17976931348623157e292,(0|g)>0){for(s=0|i[e+4>>2],f=17976931348623157e292,m=-17976931348623157e292,n=0,r=-1,h=17976931348623157e292,d=17976931348623157e292,p=-17976931348623157e292,l=-17976931348623157e292,_=0;o=+a[s+(_<<4)>>3],A=+a[s+(_<<4)+8>>3],c=+a[s+(((0|(w=r+2|0))==(0|g)?0:w)<<4)+8>>3],o<h&&(a[y>>3]=o,h=o),A<d&&(a[v>>3]=A,d=A),o>p?a[t>>3]=o:o=p,A>l&&(a[x>>3]=A,l=A),f=A>0&A<f?A:f,m=A<0&A>m?A:m,n|=+u(+(A-c))>3.141592653589793,(0|(r=_+1|0))!=(0|g);)w=_,p=o,_=r,r=w;n&&(a[x>>3]=m,a[v>>3]=f)}}else i[t>>2]=0,i[t+4>>2]=0,i[t+8>>2]=0,i[t+12>>2]=0,i[t+16>>2]=0,i[t+20>>2]=0,i[t+24>>2]=0,i[t+28>>2]=0;if(!((0|(r=0|i[(w=e+8|0)>>2]))<=0)){T=e+12|0,S=0;do if(s=0|i[T>>2],n=S,v=t+((S=S+1|0)<<5)|0,x=0|i[s+(n<<3)>>2]){if(a[(_=t+(S<<5)+8|0)>>3]=17976931348623157e292,a[(e=t+(S<<5)+24|0)>>3]=17976931348623157e292,a[v>>3]=-17976931348623157e292,a[(b=t+(S<<5)+16|0)>>3]=-17976931348623157e292,(0|x)>0){for(g=0|i[s+(n<<3)+4>>2],f=17976931348623157e292,m=-17976931348623157e292,s=0,n=-1,y=0,h=17976931348623157e292,d=17976931348623157e292,A=-17976931348623157e292,l=-17976931348623157e292;o=+a[g+(y<<4)>>3],p=+a[g+(y<<4)+8>>3],c=+a[g+(((0|(n=n+2|0))==(0|x)?0:n)<<4)+8>>3],o<h&&(a[_>>3]=o,h=o),p<d&&(a[e>>3]=p,d=p),o>A?a[v>>3]=o:o=A,p>l&&(a[b>>3]=p,l=p),f=p>0&p<f?p:f,m=p<0&p>m?p:m,s|=+u(+(p-c))>3.141592653589793,(0|(n=y+1|0))!=(0|x);)M=y,y=n,A=o,n=M;s&&(a[b>>3]=m,a[e>>3]=f)}}else i[v>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,i[v+12>>2]=0,i[v+16>>2]=0,i[v+20>>2]=0,i[v+24>>2]=0,i[v+28>>2]=0,r=0|i[w>>2];while((0|S)<(0|r))}}function tr(e,t,r){var n=0,a=0,s=0;if(!(0|e8(e|=0,t|=0,r|=0)))return 0|(a=0);if((0|i[(a=e+8|0)>>2])<=0)return 0|(a=1);for(n=e+12|0,e=0;;){if(s=e,e=e+1|0,0|e8((0|i[n>>2])+(s<<3)|0,t+(e<<5)|0,r)){e=0,n=6;break}if((0|e)>=(0|i[a>>2])){e=1,n=6;break}}return(0|n)==6?0|e:0}function tn(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0;if(c=I,I=I+16|0,l=c,!(0|e8(e,t,o=r+8|0)))return u=0,I=c,0|u;u=e+8|0;e:do if((0|i[u>>2])>0){for(s=e+12|0,a=0;;){if(h=a,a=a+1|0,0|e8((0|i[s>>2])+(h<<3)|0,t+(a<<5)|0,o)){a=0;break}if((0|a)>=(0|i[u>>2]))break e}return I=c,0|a}while(0)if(0|ti(e,t,r,n))return h=0,I=c,0|h;i[l>>2]=i[r>>2],i[l+4>>2]=o,a=0|i[u>>2];t:do if((0|a)>0)for(e=e+12|0,o=0,s=a;;){if(a=0|i[e>>2],(0|i[a+(o<<3)>>2])>0){if(0|e8(l,n,0|i[a+(o<<3)+4>>2])||(a=o+1|0,0|ti((0|i[e>>2])+(o<<3)|0,t+(a<<5)|0,r,n))){a=0;break t}s=0|i[u>>2]}else a=o+1|0;if((0|a)<(0|s))o=a;else{a=1;break}}else a=1;while(0)return h=a,I=c,0|h}function ti(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var s,o,l,u,c,h,d,A,p,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,w=0,M=0,E=0,R=0,C=0,N=0,P=0,L=0,D=0,B=0,F=0;if(D=I,I=I+176|0,C=D+172|0,f=D+168|0,N=D,!(0|Y(t,n)))return e=0,I=D,0|e;if(s=0|t,o=0|n,l=0|C,u=0|f,c=0,h=0,d=0,A=0,p=0,s=(h=+a[s+16>>3])<(p=+a[s+24>>3]),c=(A=+a[o+16>>3])<(d=+a[o+24>>3]),o=p-A<d-h,i[l>>2]=s?c|o?1:2:0,i[u>>2]=c?s?1:o?2:1:0,tD(0|N,0|r,168),(0|i[r>>2])>0){t=0;do R=+eQ(+a[(B=N+8+(t<<4)+8|0)>>3],0|i[f>>2]),a[B>>3]=R,t=t+1|0;while((0|t)<(0|i[r>>2]))}M=+a[n>>3],E=+a[n+8>>3],R=+eQ(+a[n+16>>3],0|i[f>>2]),T=+eQ(+a[n+24>>3],0|i[f>>2]);e:do if((0|i[e>>2])>0){if(n=e+4|0,(0|(f=0|i[N>>2]))<=0){for(t=0;;)if((0|(t=t+1|0))>=(0|i[e>>2])){t=0;break e}}for(r=0;;){if(S=+a[(t=0|i[n>>2])+(r<<4)>>3],w=+eQ(+a[t+(r<<4)+8>>3],0|i[C>>2]),m=+a[(t=0|i[n>>2])+((B=(0|(r=r+1|0))%(0|i[e>>2])|0)<<4)>>3],g=+eQ(+a[t+(B<<4)+8>>3],0|i[C>>2]),((!(S>=M)|!(m>=M)?!(S<=E)|!(m<=E):0)?!(w<=T)|!(g<=T):0)?!(w>=R)|!(g>=R):0){b=m-S,x=g-w,t=0;do if(F=t,B=(0|(t=t+1|0))==(0|f)?0:t,m=+a[N+8+(F<<4)+8>>3],g=a[N+8+(B<<4)+8>>3]-m,y=+a[N+8+(F<<4)>>3],(0!=(_=b*g-x*(v=a[N+8+(B<<4)>>3]-y))?!((v=((P=w-m)*v-g*(L=S-y))/_)<0|v>1):0)?(_=(b*P-x*L)/_)>=0&_<=1:0){t=1;break e}while((0|t)<(0|f))}if((0|r)>=(0|i[e>>2])){t=0;break}}}else t=0;while(0)return F=t,I=D,0|F}function ta(e,t,r,n){var a=0,s=0,o=0;if(0|ti(e|=0,t|=0,r|=0,n|=0))return 0|(s=1);if((0|i[(s=e+8|0)>>2])<=0)return 0|(s=0);for(a=e+12|0,e=0;;){if(o=e,e=e+1|0,0|ti((0|i[a>>2])+(o<<3)|0,t+(e<<5)|0,r,n)){e=1,a=6;break}if((0|e)>=(0|i[s>>2])){e=0,a=6;break}}return(0|a)==6?0|e:0}function ts(e,t,r,n,i){e|=0,t|=0,r|=0,n|=0,i|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0;c=+a[e>>3],u=a[t>>3]-c,l=+a[e+8>>3],o=a[t+8>>3]-l,d=+a[r>>3],s=a[n>>3]-d,A=+a[r+8>>3],h=a[n+8>>3]-A,s=(s*(l-A)-(c-d)*h)/(u*h-o*s),a[i>>3]=c+u*s,a[i+8>>3]=l+o*s}function to(e,t){return(t|=0,11920928955078125e-23>+u(+(a[(e|=0)>>3]-a[t>>3])))?0|(t=11920928955078125e-23>+u(+(a[e+8>>3]-a[t+8>>3]))):0|(t=0)}function tl(e,t){e|=0,t|=0;var r=0,n=0,i=0;return i=a[e>>3]-a[t>>3],+(i*i+(n=a[e+8>>3]-a[t+8>>3])*n+(r=a[e+16>>3]-a[t+16>>3])*r)}function tu(e,t,r){e|=0,t|=0,r|=0;var n,a,s=0,o=0,l=0,u=0,c=0,h=0,d=0;if(d=I,I=I+32|0,u=d+16|0,c=d,0|(s=0|ek(e,t,u)))return r=s,I=d,0|r;l=0|eT(e,t),h=0|eI(e,t),n=7696+(28*(n=0|l)|0)|0,i[(a=0|c)>>2]=i[n>>2],i[a+4>>2]=i[n+4>>2],i[a+8>>2]=i[n+8>>2],i[a+12>>2]=i[n+12>>2],s=0|function(e,t){e|=0;var r=0,n=0;if((t|=0)>>>0>20)return 0|(t=-1);do if((0|i[11120+(216*t|0)>>2])!=(0|e))if((0|i[11120+(216*t|0)+8>>2])!=(0|e))if((0|i[11120+(216*t|0)+16>>2])!=(0|e))if((0|i[11120+(216*t|0)+24>>2])!=(0|e))if((0|i[11120+(216*t|0)+32>>2])!=(0|e))if((0|i[11120+(216*t|0)+40>>2])!=(0|e))if((0|i[11120+(216*t|0)+48>>2])!=(0|e))if((0|i[11120+(216*t|0)+56>>2])!=(0|e))if((0|i[11120+(216*t|0)+64>>2])!=(0|e))if((0|i[11120+(216*t|0)+72>>2])!=(0|e))if((0|i[11120+(216*t|0)+80>>2])!=(0|e))if((0|i[11120+(216*t|0)+88>>2])!=(0|e))if((0|i[11120+(216*t|0)+96>>2])!=(0|e))if((0|i[11120+(216*t|0)+104>>2])!=(0|e))if((0|i[11120+(216*t|0)+112>>2])!=(0|e))if((0|i[11120+(216*t|0)+120>>2])!=(0|e))if((0|i[11120+(216*t|0)+128>>2])!=(0|e))if((0|i[11120+(216*t|0)+136>>2])==(0|e))e=2,r=1,n=2;else{if((0|i[11120+(216*t|0)+144>>2])==(0|e)){e=0,r=2,n=0;break}if((0|i[11120+(216*t|0)+152>>2])==(0|e)){e=0,r=2,n=1;break}if((0|i[11120+(216*t|0)+160>>2])==(0|e)){e=0,r=2,n=2;break}if((0|i[11120+(216*t|0)+168>>2])==(0|e)){e=1,r=2,n=0;break}if((0|i[11120+(216*t|0)+176>>2])==(0|e)){e=1,r=2,n=1;break}if((0|i[11120+(216*t|0)+184>>2])==(0|e)){e=1,r=2,n=2;break}if((0|i[11120+(216*t|0)+192>>2])==(0|e)){e=2,r=2,n=0;break}if((0|i[11120+(216*t|0)+200>>2])==(0|e)){e=2,r=2,n=1;break}if((0|i[11120+(216*t|0)+208>>2])==(0|e)){e=2,r=2,n=2;break}return 0|(e=-1)}else e=2,r=1,n=1;else e=2,r=1,n=0;else e=1,r=1,n=2;else e=1,r=1,n=1;else e=1,r=1,n=0;else e=0,r=1,n=2;else e=0,r=1,n=1;else e=0,r=1,n=0;else e=2,r=0,n=2;else e=2,r=0,n=1;else e=2,r=0,n=0;else e=1,r=0,n=2;else e=1,r=0,n=1;else e=1,r=0,n=0;else e=0,r=0,n=2;else e=0,r=0,n=1;else e=0,r=0,n=0;while(0)return 0|(t=0|i[11120+(216*t|0)+(72*r|0)+(24*e|0)+(n<<3)+4>>2])}(l,0|i[u>>2]);e:do if(0|V(l)){do switch(0|l){case 4:e=0;break;case 14:e=1;break;case 24:e=2;break;case 38:e=3;break;case 49:e=4;break;case 58:e=5;break;case 63:e=6;break;case 72:e=7;break;case 83:e=8;break;case 97:e=9;break;case 107:e=10;break;case 117:e=11;break;default:s=1;break e}while(0)if(o=0|i[26416+(24*e|0)+8>>2],t=0|i[26416+(24*e|0)+16>>2],(0|(e=0|i[u>>2]))!=(0|i[c>>2])&&(c=0|q(l))|(0|(e=0|i[u>>2]))==(0|t)&&(s=(s+1|0)%6|0),(0|h)==3&(0|e)==(0|t)){s=(s+5|0)%6|0,o=22;break}(0|h)==5&(0|e)==(0|o)&&(s=(s+1|0)%6|0),o=22}else o=22;while(0)return(0|o)==22&&(i[r>>2]=s,s=0),r=s,I=d,0|r}function tc(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0;if(x=I,I=I+32|0,v=x+24|0,g=x+20|0,f=x+8|0,p=x+16|0,A=x,u=(u=(0|eC(e,t))==0)?6:5,h=0|tR(0|e,0|t,52),w(),h&=15,u>>>0<=r>>>0)return n=2,I=x,0|n;((d=(0|h)==0)?0:((m=0|tC(7,0,(15^h)*3|0))&e)==0&((0|w())&t)==0)?a=r:s=4;e:do if((0|s)==4){if((((a=(0|eC(e,t))!=0)?4:5)|0)<(0|r)||0|tu(e,t,v)||(s=(0|i[v>>2])+r|0,(0|(m=0|i[(a=a?26704+(((0|s)%5|0)<<2)|0:26736+(((0|s)%6|0)<<2)|0)>>2]))==7))return n=1,I=x,0|n;i[g>>2]=0,a=0|U(e,t,m,g,f);do if(!a){if(c=0|i[(l=f)>>2],s=(o=(l=0|i[l+4>>2])>>>0<t>>>0|(0|l)==(0|t)&c>>>0<e>>>0)?c:e,o=o?l:t,d?0:(c&(d=0|tC(7,0,(15^h)*3|0)))==0&(l&(0|w()))==0)a=r;else{if(l=(r+-1+u|0)%(0|u)|0,a=0|eC(e,t),(0|l)<0&&M(27795,27797,246,27806),(((u=(0|a)!=0)?4:5)|0)<(0|l)&&M(27795,27797,246,27806),0|tu(e,t,v)&&M(27795,27797,246,27806),a=(0|i[v>>2])+l|0,(0|(l=0|i[(a=u?26704+(((0|a)%5|0)<<2)|0:26736+(((0|a)%6|0)<<2)|0)>>2]))==7&&M(27795,27797,246,27806),i[p>>2]=0,0|(a=0|U(e,t,l,p,A)))break;u=0|i[(c=A)>>2],c=0|i[c+4>>2];do if(c>>>0<o>>>0|(0|c)==(0|o)&u>>>0<s>>>0){if(s=0|eC(u,c)?0|k(u,c,e,t):0|i[26800+((((0|i[p>>2])+(0|i[26768+(l<<2)>>2])|0)%6|0)<<2)>>2],a=0|eC(u,c),(s+-1|0)>>>0>5||(0|s)==1&(a=(0|a)!=0)){a=-1,s=u,o=c;break}do if(0|tu(u,c,v))a=-1;else if(a){a=((0|i[26352+(s<<2)>>2])+5-(0|i[v>>2])|0)%5|0;break}else{a=((0|i[26384+(s<<2)>>2])+6-(0|i[v>>2])|0)%6|0;break}while(0)s=u,o=c}else a=r;while(0)c=0|i[(l=f)>>2],l=0|i[l+4>>2]}if((0|s)==(0|c)&(0|o)==(0|l)){if(e=(u=(0|eC(c,l))!=0)?0|k(c,l,e,t):0|i[26800+((((0|i[g>>2])+(0|i[26768+(m<<2)>>2])|0)%6|0)<<2)>>2],a=0|eC(c,l),(e+-1|0)>>>0<=5?!((0|e)==1&(y=(0|a)!=0)):0)do if(0|tu(c,l,v))a=-1;else if(y){a=((0|i[26352+(e<<2)>>2])+5-(0|i[v>>2])|0)%5|0;break}else{a=((0|i[26384+(e<<2)>>2])+6-(0|i[v>>2])|0)%6|0;break}while(0)else a=-1;a=(0|(a=a+1|0))==6|u&(0|a)==5?0:a}t=o,e=s;break e}while(0)return n=a,I=x,0|n}while(0)return y=0|tC(0|a,0,56),v=0|w()|-0x7f000001&t|0x20000000,i[n>>2]=y|e,i[n+4>>2]=v,n=0,I=x,0|n}function th(e,t,r){e|=0,r|=0;var n=0;(0|(t|=0))>0?(n=0|ty(t,4),i[e>>2]=n,n||M(27819,27842,40,27856)):i[e>>2]=0,i[e+4>>2]=t,i[e+8>>2]=0,i[e+12>>2]=r}function td(e){e|=0;var t=0,r=0,n=0,s=0,o=0,l=0,c=0;s=e+4|0,o=e+12|0,l=e+8|0;e:for(;;){for(r=0|i[s>>2],t=0;;){if((0|t)>=(0|r))break e;if(n=0|i[e>>2],c=0|i[n+(t<<2)>>2])break;t=t+1|0}t=n+(~~(u(+(h(10,+(15-(0|i[o>>2])|0))*(+a[c>>3]+ +a[c+8>>3])))%(0|r))>>>0<<2)|0,r=0|i[t>>2];t:do if(0|r){if(n=c+32|0,(0|r)==(0|c))i[t>>2]=i[n>>2];else{if(!(t=0|i[(r=r+32|0)>>2]))break;for(;(0|t)!=(0|c);)if(!(t=0|i[(r=t+32|0)>>2]))break t;i[r>>2]=i[n>>2]}tg(c),i[l>>2]=(0|i[l>>2])+-1}while(0)}tg(0|i[e>>2])}function tA(e){e|=0;var t=0,r=0,n=0;for(n=0|i[e+4>>2],r=0;;){if((0|r)>=(0|n)){t=0,r=4;break}if(t=0|i[(0|i[e>>2])+(r<<2)>>2]){r=4;break}r=r+1|0}return(0|r)==4?0|t:0}function tp(e,t){e|=0,t|=0;var r=0,n=0,s=0,o=0;if(r=~~(u(+(h(10,+(15-(0|i[e+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3])))%(0|i[e+4>>2]))>>>0,r=(0|i[e>>2])+(r<<2)|0,!(n=0|i[r>>2]))return 0|(o=1);o=t+32|0;do if((0|n)!=(0|t)){if(!(r=0|i[n+32>>2]))return 0|(o=1);for(s=r;;){if((0|s)==(0|t)){s=8;break}if(r=0|i[s+32>>2])n=s,s=r;else{r=1,s=10;break}}if((0|s)==8){i[n+32>>2]=i[o>>2];break}if((0|s)==10)return 0|r}else i[r>>2]=i[o>>2];while(0)return tg(t),i[(o=e+8|0)>>2]=(0|i[o>>2])+-1,0|(o=0)}function tf(e){return~~tF(+(e*=1))}function tm(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0;b=I,I=I+16|0,A=b;do if(e>>>0<245){if(e=(c=e>>>0<11?16:e+11&-8)>>>3,3&(r=(d=0|i[6977])>>>e))return a=(n=0|i[(r=(e=27948+((t=(1&r^1)+e|0)<<1<<2)|0)+8|0)>>2])+8|0,(0|(s=0|i[a>>2]))==(0|e)?i[6977]=d&~(1<<t):(i[s+12>>2]=e,i[r>>2]=s),_=t<<3,i[n+4>>2]=3|_,i[(_=n+_+4|0)>>2]=1|i[_>>2],_=a,I=b,0|_;if(c>>>0>(h=0|i[6979])>>>0){if(0|r)return t=2<<e,l=(t=((t=r<<e&(t|0-t))&0-t)+-1|0)>>>12&16,t>>>=l,r=t>>>5&8,t>>>=r,s=t>>>2&4,t>>>=s,e=t>>>1&2,t>>>=e,l=(s=0|i[(e=(t=27948+((n=(r|l|s|e|(n=t>>>1&1))+(t>>>n)|0)<<1<<2)|0)+8|0)>>2])+8|0,(0|(r=0|i[l>>2]))==(0|t)?(e=d&~(1<<n),i[6977]=e):(i[r+12>>2]=t,i[e>>2]=r,e=d),o=(_=n<<3)-c|0,i[s+4>>2]=3|c,i[(a=s+c|0)+4>>2]=1|o,i[s+_>>2]=o,0|h&&(n=0|i[6982],r=27948+((t=h>>>3)<<1<<2)|0,e&(t=1<<t)?t=0|i[(e=r+8|0)>>2]:(i[6977]=e|t,t=r,e=r+8|0),i[e>>2]=n,i[t+12>>2]=n,i[n+8>>2]=t,i[n+12>>2]=r),i[6979]=o,i[6982]=a,_=l,I=b,0|_;if(s=0|i[6978]){for(a=(r=(s&0-s)+-1|0)>>>12&16,r>>>=a,n=r>>>5&8,r>>>=n,o=r>>>2&4,r>>>=o,l=r>>>1&2,r>>>=l,r=u=0|i[28212+((n|a|o|l|(u=r>>>1&1))+(r>>>u)<<2)>>2],l=u,u=(-8&i[u+4>>2])-c|0;(e=0|i[r+16>>2])||(e=0|i[r+20>>2]);)a=(o=(-8&i[e+4>>2])-c|0)>>>0<u>>>0,r=e,l=a?e:l,u=a?o:u;if((o=l+c|0)>>>0>l>>>0){a=0|i[l+24>>2],t=0|i[l+12>>2];do if((0|t)==(0|l)){if(!(t=0|i[(e=l+20|0)>>2])&&!(t=0|i[(e=l+16|0)>>2])){r=0;break}for(;;)if(r=0|i[(n=t+20|0)>>2])t=r,e=n;else if(r=0|i[(n=t+16|0)>>2])t=r,e=n;else break;i[e>>2]=0,r=t}else r=0|i[l+8>>2],i[r+12>>2]=t,i[t+8>>2]=r,r=t;while(0)do if(0|a){if(e=28212+((t=0|i[l+28>>2])<<2)|0,(0|l)==(0|i[e>>2])){if(i[e>>2]=r,!r){i[6978]=s&~(1<<t);break}}else if(i[((0|i[(_=a+16|0)>>2])==(0|l)?_:a+20|0)>>2]=r,!r)break;i[r+24>>2]=a,0|(t=0|i[l+16>>2])&&(i[r+16>>2]=t,i[t+24>>2]=r),0|(t=0|i[l+20>>2])&&(i[r+20>>2]=t,i[t+24>>2]=r)}while(0)return u>>>0<16?(_=u+c|0,i[l+4>>2]=3|_,i[(_=l+_+4|0)>>2]=1|i[_>>2]):(i[l+4>>2]=3|c,i[o+4>>2]=1|u,i[o+u>>2]=u,0|h&&(n=0|i[6982],r=27948+((t=h>>>3)<<1<<2)|0,(t=1<<t)&d?t=0|i[(e=r+8|0)>>2]:(i[6977]=t|d,t=r,e=r+8|0),i[e>>2]=n,i[t+12>>2]=n,i[n+8>>2]=t,i[n+12>>2]=r),i[6979]=u,i[6982]=o),_=l+8|0,I=b,0|_}d=c}else d=c}else d=c}else if(e>>>0<=0xffffffbf)if(c=-8&(e=e+11|0),n=0|i[6978]){a=0-c|0,(e>>>=8)?c>>>0>0xffffff?u=31:(d=(e+1048320|0)>>>16&8,l=((m=e<<d)+520192|0)>>>16&4,m<<=l,u=c>>>((u=14-(l|d|(u=(m+245760|0)>>>16&2))+(m<<u>>>15)|0)+7|0)&1|u<<1):u=0,r=0|i[28212+(u<<2)>>2];e:do if(r)for(e=0,l=c<<((0|u)==31?0:25-(u>>>1)|0),s=0;;){if((o=(-8&i[r+4>>2])-c|0)>>>0<a>>>0)if(o)e=r,a=o;else{e=r,a=0,m=65;break e}if(s=(0|(m=0|i[r+20>>2]))==0|(0|m)==(0|(r=0|i[r+16+(l>>>31<<2)>>2]))?s:m,r)l<<=1;else{r=s,m=61;break}}else r=0,e=0,m=61;while(0)if((0|m)==61){if((0|r)==0&(0|e)==0){if(!(e=((e=2<<u)|0-e)&n)){d=c;break}o=(d=(e&0-e)+-1|0)>>>12&16,d>>>=o,s=d>>>5&8,d>>>=s,l=d>>>2&4,d>>>=l,u=d>>>1&2,d>>>=u,e=0,r=0|i[28212+((s|o|l|u|(r=d>>>1&1))+(d>>>r)<<2)>>2]}r?m=65:(l=e,o=a)}if((0|m)==65)for(s=r;;)if(a=(r=(d=(-8&i[s+4>>2])-c|0)>>>0<a>>>0)?d:a,e=r?s:e,(r=0|i[s+16>>2])||(r=0|i[s+20>>2]),r)s=r;else{l=e,o=a;break}if(((0|l)!=0?o>>>0<((0|i[6979])-c|0)>>>0:0)?(h=l+c|0)>>>0>l>>>0:0){s=0|i[l+24>>2],t=0|i[l+12>>2];do if((0|t)==(0|l)){if(!(t=0|i[(e=l+20|0)>>2])&&!(t=0|i[(e=l+16|0)>>2])){t=0;break}for(;;)if(r=0|i[(a=t+20|0)>>2])t=r,e=a;else if(r=0|i[(a=t+16|0)>>2])t=r,e=a;else break;i[e>>2]=0}else _=0|i[l+8>>2],i[_+12>>2]=t,i[t+8>>2]=_;while(0)do if(s){if(r=28212+((e=0|i[l+28>>2])<<2)|0,(0|l)==(0|i[r>>2])){if(i[r>>2]=t,!t){n&=~(1<<e),i[6978]=n;break}}else if(i[((0|i[(_=s+16|0)>>2])==(0|l)?_:s+20|0)>>2]=t,!t)break;i[t+24>>2]=s,0|(e=0|i[l+16>>2])&&(i[t+16>>2]=e,i[e+24>>2]=t),(e=0|i[l+20>>2])&&(i[t+20>>2]=e,i[e+24>>2]=t)}while(0)t:do if(o>>>0<16)_=o+c|0,i[l+4>>2]=3|_,i[(_=l+_+4|0)>>2]=1|i[_>>2];else{if(i[l+4>>2]=3|c,i[h+4>>2]=1|o,i[h+o>>2]=o,t=o>>>3,o>>>0<256){r=27948+(t<<1<<2)|0,(e=0|i[6977])&(t=1<<t)?t=0|i[(e=r+8|0)>>2]:(i[6977]=e|t,t=r,e=r+8|0),i[e>>2]=h,i[t+12>>2]=h,i[h+8>>2]=t,i[h+12>>2]=r;break}if((t=o>>>8)?o>>>0>0xffffff?r=31:(x=(t+1048320|0)>>>16&8,v=((_=t<<x)+520192|0)>>>16&4,_<<=v,r=o>>>((r=14-(v|x|(r=(_+245760|0)>>>16&2))+(_<<r>>>15)|0)+7|0)&1|r<<1):r=0,t=28212+(r<<2)|0,i[h+28>>2]=r,i[(e=h+16|0)+4>>2]=0,i[e>>2]=0,!(n&(e=1<<r))){i[6978]=n|e,i[t>>2]=h,i[h+24>>2]=t,i[h+12>>2]=h,i[h+8>>2]=h;break}t=0|i[t>>2];u:do if((-8&i[t+4>>2])!=(0|o)){for(n=o<<((0|r)==31?0:25-(r>>>1)|0);e=0|i[(r=t+16+(n>>>31<<2)|0)>>2];){if((-8&i[e+4>>2])==(0|o)){t=e;break u}n<<=1,t=e}i[r>>2]=h,i[h+24>>2]=t,i[h+12>>2]=h,i[h+8>>2]=h;break t}while(0)_=0|i[(x=t+8|0)>>2],i[_+12>>2]=h,i[x>>2]=h,i[h+8>>2]=_,i[h+12>>2]=t,i[h+24>>2]=0}while(0)return _=l+8|0,I=b,0|_}d=c}else d=c;else d=-1;while(0)if((r=0|i[6979])>>>0>=d>>>0)return t=r-d|0,e=0|i[6982],t>>>0>15?(_=e+d|0,i[6982]=_,i[6979]=t,i[_+4>>2]=1|t,i[e+r>>2]=t,i[e+4>>2]=3|d):(i[6979]=0,i[6982]=0,i[e+4>>2]=3|r,i[(_=e+r+4|0)>>2]=1|i[_>>2]),_=e+8|0,I=b,0|_;if((o=0|i[6980])>>>0>d>>>0)return v=o-d|0,i[6980]=v,x=(_=0|i[6983])+d|0,i[6983]=x,i[x+4>>2]=1|v,i[_+4>>2]=3|d,_=_+8|0,I=b,0|_;if(0|i[7095]?e=0|i[7097]:(i[7097]=4096,i[7096]=4096,i[7098]=-1,i[7099]=-1,i[7100]=0,i[7088]=0,i[7095]=-16&A^0x55555558,e=4096),l=d+48|0,(c=(s=e+(u=d+47|0)|0)&(a=0-e|0))>>>0<=d>>>0||(0|(e=0|i[7087])?(A=(h=0|i[7085])+c|0)>>>0<=h>>>0|A>>>0>e>>>0:0))return _=0,I=b,0|_;c:do if(4&i[7088])t=0,m=143;else{r=0|i[6983];h:do if(r){for(n=28356;!((A=0|i[n>>2])>>>0<=r>>>0)||!((A+(0|i[n+4>>2])|0)>>>0>r>>>0);)if(e=0|i[n+8>>2])n=e;else{m=128;break h}if((t=s-o&a)>>>0<0x7fffffff)if((0|(e=0|tU(0|t)))==((0|i[n>>2])+(0|i[n+4>>2])|0)){if((0|e)!=-1){o=t,s=e,m=145;break c}}else n=e,m=136;else t=0}else m=128;while(0)do if((0|m)==128)if((0|(r=0|tU(0)))!=-1?(t=r,f=(t=(((f=(p=0|i[7096])+-1|0)&t)==0?0:(f+t&0-p)-t|0)+c|0)+(p=0|i[7085])|0,t>>>0>d>>>0&t>>>0<0x7fffffff):0){if(0|(A=0|i[7087])?f>>>0<=p>>>0|f>>>0>A>>>0:0){t=0;break}if((0|(e=0|tU(0|t)))==(0|r)){o=t,s=r,m=145;break c}n=e,m=136}else t=0;while(0)do if((0|m)==136){if(r=0-t|0,!(t>>>0<0x7fffffff&(0|n)!=-1&l>>>0>t>>>0))if((0|n)==-1){t=0;break}else{o=t,s=n,m=145;break c}if((e=u-t+(e=0|i[7097])&0-e)>>>0>=0x7fffffff){o=t,s=n,m=145;break c}if((0|tU(0|e))==-1){tU(0|r),t=0;break}o=e+t|0,s=n,m=145;break c}while(0)i[7088]=4|i[7088],m=143}while(0)if((((0|m)==143?c>>>0<0x7fffffff:0)?(v=0|tU(0|c),y=(g=(f=0|tU(0))-v|0)>>>0>(d+40|0)>>>0,!((0|v)==-1|1^y|(0|v)!=-1&(0|f)!=-1&v>>>0<f>>>0^1)):0)&&(o=y?g:t,s=v,m=145),(0|m)==145){t=(0|i[7085])+o|0,i[7085]=t,t>>>0>(0|i[7086])>>>0&&(i[7086]=t),u=0|i[6983];d:do if(u){for(t=28356;;){if((0|s)==((e=0|i[t>>2])+(r=0|i[t+4>>2])|0)){m=154;break}if(n=0|i[t+8>>2])t=n;else break}if(((0|m)==154?(x=t+4|0,(8&i[t+12>>2])==0):0)?s>>>0>u>>>0&e>>>0<=u>>>0:0){i[x>>2]=r+o,_=(0|i[6980])+o|0,v=(7&(v=u+8|0))==0?0:0-v&7,x=u+v|0,v=_-v|0,i[6983]=x,i[6980]=v,i[x+4>>2]=1|v,i[u+_+4>>2]=40,i[6984]=i[7099];break}for(s>>>0<(0|i[6981])>>>0&&(i[6981]=s),r=s+o|0,t=28356;;){if((0|i[t>>2])==(0|r)){m=162;break}if(e=0|i[t+8>>2])t=e;else break}if((0|m)==162?(8&i[t+12>>2])==0:0){i[t>>2]=s,i[(h=t+4|0)>>2]=(0|i[h>>2])+o,h=s+8|0,h=s+((7&h)==0?0:0-h&7)|0,t=r+8|0,t=r+((7&t)==0?0:0-t&7)|0,c=h+d|0,l=t-h-d|0,i[h+4>>2]=3|d;A:do if((0|u)==(0|t))_=(0|i[6980])+l|0,i[6980]=_,i[6983]=c,i[c+4>>2]=1|_;else{if((0|i[6982])==(0|t)){_=(0|i[6979])+l|0,i[6979]=_,i[6982]=c,i[c+4>>2]=1|_,i[c+_>>2]=_;break}if((3&(e=0|i[t+4>>2]))==1){o=-8&e,n=e>>>3;p:do{if(e>>>0<256){if(e=0|i[t+8>>2],(0|(r=0|i[t+12>>2]))==(0|e)){i[6977]=i[6977]&~(1<<n);break}i[e+12>>2]=r,i[r+8>>2]=e;break}s=0|i[t+24>>2],e=0|i[t+12>>2];do if((0|e)==(0|t)){if(e=0|i[(n=(r=t+16|0)+4|0)>>2])r=n;else if(!(e=0|i[r>>2])){e=0;break}for(;;)if(n=0|i[(a=e+20|0)>>2])e=n,r=a;else if(n=0|i[(a=e+16|0)>>2])e=n,r=a;else break;i[r>>2]=0}else _=0|i[t+8>>2],i[_+12>>2]=e,i[e+8>>2]=_;while(0)if(!s)break;n=28212+((r=0|i[t+28>>2])<<2)|0;do if((0|i[n>>2])!=(0|t)){if(i[((0|i[(_=s+16|0)>>2])==(0|t)?_:s+20|0)>>2]=e,!e)break p}else{if(i[n>>2]=e,0|e)break;i[6978]=i[6978]&~(1<<r);break p}while(0)if(i[e+24>>2]=s,0|(n=0|i[(r=t+16|0)>>2])&&(i[e+16>>2]=n,i[n+24>>2]=e),!(r=0|i[r+4>>2]))break;i[e+20>>2]=r,i[r+24>>2]=e}while(0)t=t+o|0,a=o+l|0}else a=l;if(i[(t=t+4|0)>>2]=-2&i[t>>2],i[c+4>>2]=1|a,i[c+a>>2]=a,t=a>>>3,a>>>0<256){r=27948+(t<<1<<2)|0,(e=0|i[6977])&(t=1<<t)?t=0|i[(e=r+8|0)>>2]:(i[6977]=e|t,t=r,e=r+8|0),i[e>>2]=c,i[t+12>>2]=c,i[c+8>>2]=t,i[c+12>>2]=r;break}t=a>>>8;do if(t){if(a>>>0>0xffffff){n=31;break}x=(t+1048320|0)>>>16&8,v=((_=t<<x)+520192|0)>>>16&4,_<<=v,n=a>>>((n=14-(v|x|(n=(_+245760|0)>>>16&2))+(_<<n>>>15)|0)+7|0)&1|n<<1}else n=0;while(0)if(t=28212+(n<<2)|0,i[c+28>>2]=n,i[(e=c+16|0)+4>>2]=0,i[e>>2]=0,!((e=0|i[6978])&(r=1<<n))){i[6978]=e|r,i[t>>2]=c,i[c+24>>2]=t,i[c+12>>2]=c,i[c+8>>2]=c;break}t=0|i[t>>2];f:do if((-8&i[t+4>>2])!=(0|a)){for(n=a<<((0|n)==31?0:25-(n>>>1)|0);e=0|i[(r=t+16+(n>>>31<<2)|0)>>2];){if((-8&i[e+4>>2])==(0|a)){t=e;break f}n<<=1,t=e}i[r>>2]=c,i[c+24>>2]=t,i[c+12>>2]=c,i[c+8>>2]=c;break A}while(0)_=0|i[(x=t+8|0)>>2],i[_+12>>2]=c,i[x>>2]=c,i[c+8>>2]=_,i[c+12>>2]=t,i[c+24>>2]=0}while(0)return _=h+8|0,I=b,0|_}for(t=28356;!((e=0|i[t>>2])>>>0<=u>>>0)||!((_=e+(0|i[t+4>>2])|0)>>>0>u>>>0);)t=0|i[t+8>>2];e=(a=_+-47|0)+8|0,t=(e=(e=a+((7&e)==0?0:0-e&7)|0)>>>0<(a=u+16|0)>>>0?u:e)+8|0,r=o+-40|0,v=(7&(v=s+8|0))==0?0:0-v&7,x=s+v|0,v=r-v|0,i[6983]=x,i[6980]=v,i[x+4>>2]=1|v,i[s+r+4>>2]=40,i[6984]=i[7099],i[(r=e+4|0)>>2]=27,i[t>>2]=i[7089],i[t+4>>2]=i[7090],i[t+8>>2]=i[7091],i[t+12>>2]=i[7092],i[7089]=s,i[7090]=o,i[7092]=0,i[7091]=t,t=e+24|0;do x=t,i[(t=t+4|0)>>2]=7;while((x+8|0)>>>0<_>>>0)if((0|e)!=(0|u)){if(s=e-u|0,i[r>>2]=-2&i[r>>2],i[u+4>>2]=1|s,i[e>>2]=s,t=s>>>3,s>>>0<256){r=27948+(t<<1<<2)|0,(e=0|i[6977])&(t=1<<t)?t=0|i[(e=r+8|0)>>2]:(i[6977]=e|t,t=r,e=r+8|0),i[e>>2]=u,i[t+12>>2]=u,i[u+8>>2]=t,i[u+12>>2]=r;break}if((t=s>>>8)?s>>>0>0xffffff?n=31:(x=(t+1048320|0)>>>16&8,v=((_=t<<x)+520192|0)>>>16&4,_<<=v,n=s>>>((n=14-(v|x|(n=(_+245760|0)>>>16&2))+(_<<n>>>15)|0)+7|0)&1|n<<1):n=0,r=28212+(n<<2)|0,i[u+28>>2]=n,i[u+20>>2]=0,i[a>>2]=0,!((t=0|i[6978])&(e=1<<n))){i[6978]=t|e,i[r>>2]=u,i[u+24>>2]=r,i[u+12>>2]=u,i[u+8>>2]=u;break}t=0|i[r>>2];m:do if((-8&i[t+4>>2])!=(0|s)){for(n=s<<((0|n)==31?0:25-(n>>>1)|0);e=0|i[(r=t+16+(n>>>31<<2)|0)>>2];){if((-8&i[e+4>>2])==(0|s)){t=e;break m}n<<=1,t=e}i[r>>2]=u,i[u+24>>2]=t,i[u+12>>2]=u,i[u+8>>2]=u;break d}while(0)_=0|i[(x=t+8|0)>>2],i[_+12>>2]=u,i[x>>2]=u,i[u+8>>2]=_,i[u+12>>2]=t,i[u+24>>2]=0}}else(0|(_=0|i[6981]))==0|s>>>0<_>>>0&&(i[6981]=s),i[7089]=s,i[7090]=o,i[7092]=0,i[6986]=i[7095],i[6985]=-1,i[6990]=27948,i[6989]=27948,i[6992]=27956,i[6991]=27956,i[6994]=27964,i[6993]=27964,i[6996]=27972,i[6995]=27972,i[6998]=27980,i[6997]=27980,i[7e3]=27988,i[6999]=27988,i[7002]=27996,i[7001]=27996,i[7004]=28004,i[7003]=28004,i[7006]=28012,i[7005]=28012,i[7008]=28020,i[7007]=28020,i[7010]=28028,i[7009]=28028,i[7012]=28036,i[7011]=28036,i[7014]=28044,i[7013]=28044,i[7016]=28052,i[7015]=28052,i[7018]=28060,i[7017]=28060,i[7020]=28068,i[7019]=28068,i[7022]=28076,i[7021]=28076,i[7024]=28084,i[7023]=28084,i[7026]=28092,i[7025]=28092,i[7028]=28100,i[7027]=28100,i[7030]=28108,i[7029]=28108,i[7032]=28116,i[7031]=28116,i[7034]=28124,i[7033]=28124,i[7036]=28132,i[7035]=28132,i[7038]=28140,i[7037]=28140,i[7040]=28148,i[7039]=28148,i[7042]=28156,i[7041]=28156,i[7044]=28164,i[7043]=28164,i[7046]=28172,i[7045]=28172,i[7048]=28180,i[7047]=28180,i[7050]=28188,i[7049]=28188,i[7052]=28196,i[7051]=28196,_=o+-40|0,v=(7&(v=s+8|0))==0?0:0-v&7,x=s+v|0,v=_-v|0,i[6983]=x,i[6980]=v,i[x+4>>2]=1|v,i[s+_+4>>2]=40,i[6984]=i[7099];while(0)if((t=0|i[6980])>>>0>d>>>0)return v=t-d|0,i[6980]=v,x=(_=0|i[6983])+d|0,i[6983]=x,i[x+4>>2]=1|v,i[_+4>>2]=3|d,_=_+8|0,I=b,0|_}return i[(_=27904)>>2]=12,_=0,I=b,0|_}function tg(e){var t=0,r=0,n=0,a=0,s=0,o=0,l=0,u=0;if(e|=0){r=e+-8|0,a=0|i[6981],u=r+(t=-8&(e=0|i[e+-4>>2]))|0;do if(1&e)l=r,o=r;else{if(n=0|i[r>>2],!(3&e)||(o=r+(0-n)|0,s=n+t|0,o>>>0<a>>>0))return;if((0|i[6982])==(0|o)){if((3&(t=0|i[(e=u+4|0)>>2]))!=3){l=o,t=s;break}i[6979]=s,i[e>>2]=-2&t,i[o+4>>2]=1|s,i[o+s>>2]=s;return}if(r=n>>>3,n>>>0<256){if(e=0|i[o+8>>2],(0|(t=0|i[o+12>>2]))==(0|e)){i[6977]=i[6977]&~(1<<r),l=o,t=s;break}i[e+12>>2]=t,i[t+8>>2]=e,l=o,t=s;break}a=0|i[o+24>>2],e=0|i[o+12>>2];do if((0|e)==(0|o)){if(e=0|i[(r=(t=o+16|0)+4|0)>>2])t=r;else if(!(e=0|i[t>>2])){e=0;break}for(;;)if(r=0|i[(n=e+20|0)>>2])e=r,t=n;else if(r=0|i[(n=e+16|0)>>2])e=r,t=n;else break;i[t>>2]=0}else l=0|i[o+8>>2],i[l+12>>2]=e,i[e+8>>2]=l;while(0)if(a){if(r=28212+((t=0|i[o+28>>2])<<2)|0,(0|i[r>>2])==(0|o)){if(i[r>>2]=e,!e){i[6978]=i[6978]&~(1<<t),l=o,t=s;break}}else if(i[((0|i[(l=a+16|0)>>2])==(0|o)?l:a+20|0)>>2]=e,!e){l=o,t=s;break}i[e+24>>2]=a,0|(r=0|i[(t=o+16|0)>>2])&&(i[e+16>>2]=r,i[r+24>>2]=e),(t=0|i[t+4>>2])&&(i[e+20>>2]=t,i[t+24>>2]=e),l=o,t=s}else l=o,t=s}while(0)if(!(o>>>0>=u>>>0)&&1&(n=0|i[(e=u+4|0)>>2])){if(2&n)i[e>>2]=-2&n,i[l+4>>2]=1|t,i[o+t>>2]=t,a=t;else{if((0|i[6983])==(0|u)){if(u=(0|i[6980])+t|0,i[6980]=u,i[6983]=l,i[l+4>>2]=1|u,(0|l)!=(0|i[6982]))return;i[6982]=0,i[6979]=0;return}if((0|i[6982])==(0|u)){u=(0|i[6979])+t|0,i[6979]=u,i[6982]=o,i[l+4>>2]=1|u,i[o+u>>2]=u;return}a=(-8&n)+t|0,r=n>>>3;do{if(n>>>0<256){if(t=0|i[u+8>>2],(0|(e=0|i[u+12>>2]))==(0|t)){i[6977]=i[6977]&~(1<<r);break}i[t+12>>2]=e,i[e+8>>2]=t;break}s=0|i[u+24>>2],e=0|i[u+12>>2];do if((0|e)==(0|u)){if(e=0|i[(r=(t=u+16|0)+4|0)>>2])t=r;else if(!(e=0|i[t>>2])){r=0;break}for(;;)if(r=0|i[(n=e+20|0)>>2])e=r,t=n;else if(r=0|i[(n=e+16|0)>>2])e=r,t=n;else break;i[t>>2]=0,r=e}else r=0|i[u+8>>2],i[r+12>>2]=e,i[e+8>>2]=r,r=e;while(0)if(0|s){if(t=28212+((e=0|i[u+28>>2])<<2)|0,(0|i[t>>2])==(0|u)){if(i[t>>2]=r,!r){i[6978]=i[6978]&~(1<<e);break}}else if(i[((0|i[(n=s+16|0)>>2])==(0|u)?n:s+20|0)>>2]=r,!r)break;i[r+24>>2]=s,0|(t=0|i[(e=u+16|0)>>2])&&(i[r+16>>2]=t,i[t+24>>2]=r),0|(e=0|i[e+4>>2])&&(i[r+20>>2]=e,i[e+24>>2]=r)}}while(0)if(i[l+4>>2]=1|a,i[o+a>>2]=a,(0|l)==(0|i[6982])){i[6979]=a;return}}if(e=a>>>3,a>>>0<256){r=27948+(e<<1<<2)|0,(t=0|i[6977])&(e=1<<e)?e=0|i[(t=r+8|0)>>2]:(i[6977]=t|e,e=r,t=r+8|0),i[t>>2]=l,i[e+12>>2]=l,i[l+8>>2]=e,i[l+12>>2]=r;return}(e=a>>>8)?a>>>0>0xffffff?n=31:(o=(e+1048320|0)>>>16&8,s=((u=e<<o)+520192|0)>>>16&4,u<<=s,n=a>>>((n=14-(s|o|(n=(u+245760|0)>>>16&2))+(u<<n>>>15)|0)+7|0)&1|n<<1):n=0,e=28212+(n<<2)|0,i[l+28>>2]=n,i[l+20>>2]=0,i[l+16>>2]=0,t=0|i[6978],r=1<<n;e:do if(t&r){e=0|i[e>>2];t:do if((-8&i[e+4>>2])!=(0|a)){for(n=a<<((0|n)==31?0:25-(n>>>1)|0);t=0|i[(r=e+16+(n>>>31<<2)|0)>>2];){if((-8&i[t+4>>2])==(0|a)){e=t;break t}n<<=1,e=t}i[r>>2]=l,i[l+24>>2]=e,i[l+12>>2]=l,i[l+8>>2]=l;break e}while(0)u=0|i[(o=e+8|0)>>2],i[u+12>>2]=l,i[o>>2]=l,i[l+8>>2]=u,i[l+12>>2]=e,i[l+24>>2]=0}else i[6978]=t|r,i[e>>2]=l,i[l+24>>2]=e,i[l+12>>2]=l,i[l+8>>2]=l;while(0)if(u=(0|i[6985])+-1|0,i[6985]=u,!(0|u)){for(e=28364;;)if(e=0|i[e>>2])e=e+8|0;else break;i[6985]=-1}}}}function ty(e,t){t|=0;var r=0;return(e|=0)?(r=0|x(t,e),(t|e)>>>0>65535&&(r=((r>>>0)/(e>>>0)|0)==(0|t)?r:-1)):r=0,(e=0|tm(r))&&3&i[e+-4>>2]&&tB(0|e,0,0|r),0|e}function tv(e,t,r,n){return e|=0,r|=0,T((t|=0)+(n|=0)+((r=e+r>>>0)>>>0<e>>>0|0)>>>0),0|r}function tx(e,t,r,n){return e|=0,t|=0,r|=0,n|=0,T(0|(n=t-n-(r>>>0>e>>>0|0)>>>0)),e-r>>>0}function t_(e){return((e|=0)?31-(0|S(e^e-1))|0:32)|0}function tb(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0;if(h=e,c=u=t,o=r,l=A=n,!c)return(s=(0|a)!=0,l)?(s&&(i[a>>2]=0|e,i[a+4>>2]=0&t),a=0,T(0|(A=0))):(s&&(i[a>>2]=(h>>>0)%(o>>>0),i[a+4>>2]=0),A=0,a=(h>>>0)/(o>>>0)>>>0,T(0|A)),0|a;s=(0|l)==0;do{if(o){if(!s){if((s=(0|S(0|l))-(0|S(0|c))|0)>>>0<=31){d=s+1|0,l=31-s|0,t=s-31>>31,o=d,e=h>>>(d>>>0)&t|c<<l,t=c>>>(d>>>0)&t,s=0,l=h<<l;break}if(!a)return a=0,T(0|(A=0)),0|a;return i[a>>2]=0|e,i[a+4>>2]=u|0&t,a=0,T(0|(A=0)),0|a}if((s=o-1|0)&o){f=64-(l=(0|S(0|o))+33-(0|S(0|c))|0)|0,u=(d=32-l|0)>>31,t=(p=l-32|0)>>31,o=l,e=d-1>>31&c>>>(p>>>0)|(c<<d|h>>>(l>>>0))&t,t&=c>>>(l>>>0),s=h<<f&u,l=(c<<f|h>>>(p>>>0))&u|h<<d&l-33>>31;break}if(0|a&&(i[a>>2]=s&h,i[a+4>>2]=0),(0|o)==1)return p=u|0&t,f=0|e,T(0|p),0|f;return p=c>>>((f=0|t_(0|o))>>>0),f=c<<32-f|h>>>(f>>>0),T(0|p),0|f}if(s)return 0|a&&(i[a>>2]=(c>>>0)%(o>>>0),i[a+4>>2]=0),p=0,f=(c>>>0)/(o>>>0)>>>0,T(0|p),0|f;if(!h)return 0|a&&(i[a>>2]=0,i[a+4>>2]=(c>>>0)%(l>>>0)),p=0,f=(c>>>0)/(l>>>0)>>>0,T(0|p),0|f;if(!((s=l-1|0)&l))return 0|a&&(i[a>>2]=0|e,i[a+4>>2]=s&c|0&t),p=0,f=c>>>((0|t_(0|l))>>>0),T(0|p),0|f;if((s=(0|S(0|l))-(0|S(0|c))|0)>>>0<=30){t=s+1|0,l=31-s|0,o=t,e=c<<l|h>>>(t>>>0),t=c>>>(t>>>0),s=0,l=h<<l;break}if(!a)return f=0,T(0|(p=0)),0|f;return i[a>>2]=0|e,i[a+4>>2]=u|0&t,f=0,T(0|(p=0)),0|f}while(0)if(o){c=0|tv(0|(d=0|r),0|(h=A|0&n),-1,-1),r=0|w(),u=l,l=0;do n=u,u=s>>>31|u<<1,s=l|s<<1,tx(0|c,0|r,0|(n=e<<1|n>>>31),0|(A=e>>>31|t<<1)),l=1&(p=(f=0|w())>>31|((0|f)<0?-1:0)<<1),e=0|tx(0|n,0|A,p&d,(((0|f)<0?-1:0)>>31|((0|f)<0?-1:0)<<1)&h),t=0|w(),o=o-1|0;while((0|o)!=0)c=u,u=0}else c=l,u=0,l=0;return o=0,0|a&&(i[a>>2]=e,i[a+4>>2]=t),p=(0|s)>>>31|(c|o)<<1|(o<<1|s>>>31)&0|u,f=s<<1&-2|l,T(0|p),0|f}function tS(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var i=0,a=0,s=0,o=0,l=0,u=0;return u=t>>31|((0|t)<0?-1:0)<<1,l=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1,a=n>>31|((0|n)<0?-1:0)<<1,i=((0|n)<0?-1:0)>>31|((0|n)<0?-1:0)<<1,o=0|tx(u^e,l^t,0|u,0|l),s=0|w(),e=a^u,t=i^l,0|tx((0|tb(o,s,0|tx(a^r,i^n,0|a,0|i),0|w(),0))^e,(0|w())^t,0|e,0|t)}function tT(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var i,a,s,o,l,u,c=0,h=0;return c=e,h=r,r=0|(i=0|c,a=0|h,s=0,o=0,l=0,u=0,u=65535&i,i=((s=0|x(l=65535&a,u))>>>16)+(0|x(l,o=i>>>16))|0,a=0|x(l=a>>>16,u),T((i>>>16)+(0|x(l,o))+(((65535&i)+a|0)>>>16)|0),i+a<<16|65535&s),e=0|w(),T((0|x(t,h))+(0|x(n,c))+e|0&e),0|r}function tw(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0;return a=I,I=I+16|0,l=0|a,o=t>>31|((0|t)<0?-1:0)<<1,s=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1,c=n>>31|((0|n)<0?-1:0)<<1,u=((0|n)<0?-1:0)>>31|((0|n)<0?-1:0)<<1,tb(e=0|tx(o^e,s^t,0|o,0|s),t=0|w(),0|tx(c^r,u^n,0|c,0|u),0|w(),l),n=0|tx(i[l>>2]^o,i[l+4>>2]^s,0|o,0|s),r=0|w(),I=a,T(0|r),0|n}function tM(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0;return s=I,I=I+16|0,tb(e,t,r,n,a=0|s),I=s,T(0|i[a+4>>2]),0|i[a>>2]}function tE(e,t,r){return(e|=0,t|=0,(0|(r|=0))<32)?(T(t>>r),e>>>r|(t&(1<<r)-1)<<32-r):(T(((0|t)<0?-1:0)|0),t>>r-32)}function tR(e,t,r){return(e|=0,t|=0,(0|(r|=0))<32)?(T(t>>>r),e>>>r|(t&(1<<r)-1)<<32-r):(T(0),t>>>r-32)}function tC(e,t,r){return(e|=0,t|=0,(0|(r|=0))<32)?(T(t<<r|(e&(1<<r)-1<<32-r)>>>32-r),e<<r):(T(e<<r-32),0)}function tN(e,t,r){return e|=0,t|=0,(0|(t=0|S(t)))==32&&(t=t+(0|S(e))|0),T(0),0|t}function tP(e,t){return(t*=1,(e*=1)!=e)?+t:t!=t?+e:+b(+e,+t)}function tI(e,t){return(t*=1,(e*=1)!=e)?+t:t!=t?+e:+_(+e,+t)}function tL(e){return(e*=1)>=0?+l(e+.5):+v(e-.5)}function tD(e,t,r){e|=0,t|=0;var a=0,s=0,o=0;if((0|(r|=0))>=8192)return C(0|e,0|t,0|r),0|e;if(o=0|e,s=e+r|0,(3&e)==(3&t)){for(;3&e;){if(!r)return 0|o;n[0|e]=0|n[0|t],e=e+1|0,t=t+1|0,r=r-1|0}for(a=(r=-4&s)-64|0;(0|e)<=(0|a);)i[e>>2]=i[t>>2],i[e+4>>2]=i[t+4>>2],i[e+8>>2]=i[t+8>>2],i[e+12>>2]=i[t+12>>2],i[e+16>>2]=i[t+16>>2],i[e+20>>2]=i[t+20>>2],i[e+24>>2]=i[t+24>>2],i[e+28>>2]=i[t+28>>2],i[e+32>>2]=i[t+32>>2],i[e+36>>2]=i[t+36>>2],i[e+40>>2]=i[t+40>>2],i[e+44>>2]=i[t+44>>2],i[e+48>>2]=i[t+48>>2],i[e+52>>2]=i[t+52>>2],i[e+56>>2]=i[t+56>>2],i[e+60>>2]=i[t+60>>2],e=e+64|0,t=t+64|0;for(;(0|e)<(0|r);)i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0}else for(r=s-4|0;(0|e)<(0|r);)n[0|e]=0|n[0|t],n[e+1|0]=0|n[t+1|0],n[e+2|0]=0|n[t+2|0],n[e+3|0]=0|n[t+3|0],e=e+4|0,t=t+4|0;for(;(0|e)<(0|s);)n[0|e]=0|n[0|t],e=e+1|0,t=t+1|0;return 0|o}function tB(e,t,r){e|=0,t|=0,r|=0;var a=0,s=0,o=0,l=0;if(o=e+r|0,t&=255,(0|r)>=67){for(;3&e;)n[0|e]=t,e=e+1|0;for(a=-4&o,l=t|t<<8|t<<16|t<<24,s=a-64|0;(0|e)<=(0|s);)i[e>>2]=l,i[e+4>>2]=l,i[e+8>>2]=l,i[e+12>>2]=l,i[e+16>>2]=l,i[e+20>>2]=l,i[e+24>>2]=l,i[e+28>>2]=l,i[e+32>>2]=l,i[e+36>>2]=l,i[e+40>>2]=l,i[e+44>>2]=l,i[e+48>>2]=l,i[e+52>>2]=l,i[e+56>>2]=l,i[e+60>>2]=l,e=e+64|0;for(;(0|e)<(0|a);)i[e>>2]=l,e=e+4|0}for(;(0|e)<(0|o);)n[0|e]=t,e=e+1|0;return o-r|0}function tF(e){return(e*=1)>=0?+l(e+.5):+v(e-.5)}function tU(e){e|=0;var t=0,r=0,n=0;return(n=0|R(),t=(r=0|i[o>>2])+e|0,(0|e)>0&(0|t)<(0|r)|(0|t)<0)?(P(0|t),E(12),-1):(0|t)>(0|n)&&!(0|N(0|t))?(E(12),-1):(i[o>>2]=t,0|r)}return{___divdi3:tS,___muldi3:tT,___remdi3:tw,___uremdi3:tM,_areNeighborCells:function(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0;if(d=I,I=I+64|0,h=d,l=d+56|0,!(!0&(0x78000000&t)==0x8000000&(!0&(0x78000000&n)==0x8000000)))return a=5,I=d,0|a;if((0|e)==(0|r)&(0|t)==(0|n))return i[a>>2]=0,a=0,I=d,0|a;if(o=0|tR(0|e,0|t,52),w(),o&=15,c=0|tR(0|r,0|n,52),w(),(0|o)!=(15&c))return a=12,I=d,0|a;if(s=o+-1|0,o>>>0>1){eE(e,t,s,h),eE(r,n,s,l),u=0|i[(c=h)>>2],c=0|i[c+4>>2];e:do if((0|u)==(0|i[l>>2])?(0|c)==(0|i[l+4>>2]):0){s=0|tR(0|e,0|t,0|(o=(15^o)*3|0)),w(),s&=7,o=0|tR(0|r,0|n,0|o),w(),o&=7;do if((0|s)==0|(0|o)==0)i[a>>2]=1,s=0;else if((0|s)==7)s=5;else{if((0|s)==1|(0|o)==1?0|eC(u,c):0){s=5;break}if((0|i[15536+(s<<2)>>2])!=(0|o)?(0|i[15568+(s<<2)>>2])!=(0|o):0)break e;i[a>>2]=1,s=0}while(0)return a=s,I=d,0|a}while(0)}o=(s=h)+56|0;do i[s>>2]=0,s=s+4|0;while((0|s)<(0|o))return L(e,t,1,h),s=(((((((0|i[(t=h)>>2])==(0|r)?(0|i[t+4>>2])==(0|n):0)?0:!((0|i[(t=h+8|0)>>2])==(0|r)?(0|i[t+4>>2])==(0|n):0))?!((0|i[(t=h+16|0)>>2])==(0|r)?(0|i[t+4>>2])==(0|n):0):0)?!((0|i[(t=h+24|0)>>2])==(0|r)?(0|i[t+4>>2])==(0|n):0):0)?!((0|i[(t=h+32|0)>>2])==(0|r)?(0|i[t+4>>2])==(0|n):0):0)?!((0|i[(t=h+40|0)>>2])==(0|r)?(0|i[t+4>>2])==(0|n):0):0)?((0|i[(s=h+48|0)>>2])==(0|r)?(0|i[s+4>>2])==(0|n):0)&1:1,i[a>>2]=s,a=0,I=d,0|a},_bitshift64Ashr:tE,_bitshift64Lshr:tR,_bitshift64Shl:tC,_calloc:ty,_cellAreaKm2:function(e,t,r){return e|=0,t|=0,r|=0,0|(e=0|e$(e,t,r))||(a[r>>3]=6371.007180918475*a[r>>3]*6371.007180918475),0|e},_cellAreaM2:function(e,t,r){return e|=0,t|=0,r|=0,0|(e=0|e$(e,t,r))||(a[r>>3]=6371.007180918475*a[r>>3]*6371007180.918475),0|e},_cellAreaRads2:e$,_cellToBoundary:eV,_cellToCenterChild:eP,_cellToChildPos:function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0;if(v=I,I=I+16|0,g=v,y=0|tR(0|e,0|t,52),w(),y&=15,r>>>0>15)return y=4,I=v,0|y;if((0|y)<(0|r))return y=12,I=v,0|y;if((0|y)!=(0|r))if(s=0|tC(0|r,0,52)|e,l=0|w()|-0xf00001&t,(0|y)>(0|r)){u=r;do m=0|tC(7,0,(14-u|0)*3|0),u=u+1|0,s|=m,l=0|w()|l;while((0|u)<(0|y))m=s}else m=s;else m=e,l=t;f=0|tR(0|m,0|l,45),w();e:do if(0|V(127&f)){if(u=0|tR(0|m,0|l,52),w(),0|(u&=15))for(s=1;;){if(!(((f=0|tC(7,0,(15-s|0)*3|0))&m)==0&((0|w())&l)==0)){c=33;break e}if(s>>>0<u>>>0)s=s+1|0;else break}if(i[(f=n)>>2]=0,i[f+4>>2]=0,(0|y)>(0|r)){for(f=-0xf00001&t,p=y;;){if(A=p,(p=p+-1|0)>>>0>15|(0|y)<(0|p)){c=19;break}if((0|y)!=(0|p))if(s=0|tC(0|p,0,52)|e,u=0|w()|f,(0|y)<(0|A))d=s;else{c=p;do d=0|tC(7,0,(14-c|0)*3|0),c=c+1|0,s|=d,u=0|w()|u;while((0|c)<(0|y))d=s}else d=e,u=t;if(h=0|tR(0|d,0|u,45),w(),0|V(127&h)){h=0|tR(0|d,0|u,52),w(),h&=15;t:do if(h)for(c=1;;){if(s=0|tR(0|d,0|u,(15-c|0)*3|0),w(),0|(s&=7))break t;if(c>>>0<h>>>0)c=c+1|0;else{s=0;break}}else s=0;while(0)s=(0|s)==0&1}else s=0;if(u=0|tR(0|e,0|t,(15-A|0)*3|0),w(),(0|(u&=7))==7||(0|u)==1&(s=(0|s)!=0)){a=5,c=42;break}if(0|(d=u+(((0|u)!=0&s)<<31>>31)|0)&&(c=0|e4(7,0,c=y-A|0,((0|c)<0)<<31>>31),h=0|w(),s?(s=0|tS(0|(s=0|tv(0|(s=0|tT(0|c,0|h,5,0)),0|w(),-5,-1)),0|w(),6,0),s=0|tv(0|s,0|w(),1,0),u=0|w()):(s=c,u=h),A=0|tv(0|s,0|u,0|(A=0|tT(0|c,0|h,0|(A=d+-1|0),((0|A)<0)<<31>>31)),0|w()),h=0|tv(0|A,0|(d=0|w()),0|i[(h=n)>>2],0|i[h+4>>2]),d=0|w(),i[(A=n)>>2]=h,i[A+4>>2]=d),(0|p)<=(0|r)){c=37;break}}if((0|c)==19)M(27795,27122,1276,27158);else if((0|c)==37){a=0|i[(o=n)+4>>2],o=0|i[o>>2];break}else if((0|c)==42)return I=v,0|a}else a=0,o=0}else c=33;while(0)u:do if((0|c)==33){if(i[(f=n)>>2]=0,i[f+4>>2]=0,(0|y)>(0|r)){for(s=y;;){if(a=0|tR(0|e,0|t,(15-s|0)*3|0),w(),(0|(a&=7))==7){a=5;break}if(a=0|tT(0|(o=0|e4(7,0,o=y-s|0,((0|o)<0)<<31>>31)),0|w(),0|a,0),o=0|w(),o=0|tv(0|i[(f=n)>>2],0|i[f+4>>2],0|a,0|o),a=0|w(),i[(f=n)>>2]=o,i[f+4>>2]=a,(0|(s=s+-1|0))<=(0|r))break u}return I=v,0|a}a=0,o=0}while(0)return(0|eR(m,l,y,g)&&M(27795,27122,1236,27173),((0|a)>-1|(0|a)==-1&o>>>0>0xffffffff)&((0|(g=0|i[(y=g)+4>>2]))>(0|a)|((0|g)==(0|a)?(0|i[y>>2])>>>0>o>>>0:0)))?(y=0,I=v,0|y):(M(27795,27122,1316,27158),0)},_cellToChildren:function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0;if(o=I,I=I+16|0,eG(s=o,e,t,r),(0|(e=0|i[(t=s)>>2]))==0&(0|(t=0|i[t+4>>2]))==0)return I=o,0;a=0,r=0;do i[(l=n+(a<<3)|0)>>2]=e,i[l+4>>2]=t,a=0|tv(0|a,0|r,1,0),r=0|w(),ej(s),e=0|i[(l=s)>>2],t=0|i[l+4>>2];while(!((0|e)==0&(0|t)==0))return I=o,0},_cellToChildrenSize:eR,_cellToLatLng:ez,_cellToLocalIj:function(e,t,r,n,a,s){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0;var o,l,u,c=0,h=0;return(h=I,I=I+16|0,c=h,a)?e=15:(e=0|e2(e,t,r,n,c))||(o=0|c,l=0|s,u=0,u=0|i[o+8>>2],i[l>>2]=(0|i[o>>2])-u,i[l+4>>2]=(0|i[o+4>>2])-u,e=0),I=h,0|e},_cellToParent:eE,_cellToVertex:tc,_cellToVertexes:function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0;return(s=(0|eC(e,t))==0,a=(0|(n=0|tc(e,t,0,r)))==0,s)?!a||0|(n=0|tc(e,t,1,r+8|0))||0|(n=0|tc(e,t,2,r+16|0))||0|(n=0|tc(e,t,3,r+24|0))||(n=0|tc(e,t,4,r+32|0))?0|(s=n):0|tc(e,t,5,r+40|0):!a||0|(n=0|tc(e,t,1,r+8|0))||0|(n=0|tc(e,t,2,r+16|0))||0|(n=0|tc(e,t,3,r+24|0))||0|(n=0|tc(e,t,4,r+32|0))?0|(s=n):(i[(s=r+40|0)>>2]=0,i[s+4>>2]=0,0|(s=0))},_cellsToDirectedEdge:function(e,t,r,n,a){return(e|=0,t|=0,r|=0,n|=0,a|=0,(0|(r=0|k(e,t,r,n)))==7)?0|(a=11):(n=0|tC(0|r,0,56),t=-0x7f000001&t|(0|w())|0x10000000,i[a>>2]=e|n,i[a+4>>2]=t,0|(a=0))},_cellsToLinkedMultiPolygon:function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0;if(o=I,I=I+32|0,n=o,0|(e=0|function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0,c=0,d=0,A=0,p=0;if(p=I,I=I+176|0,d=p,(0|t)<1)return th(r,0,0),A=0,I=p,0|A;for(c=0|tR(0|i[(c=e)>>2],0|i[c+4>>2],52),w(),th(r,(0|t)>6?t:6,15&c),c=0;!(0|(n=0|eV(0|i[(n=e+(c<<3)|0)>>2],0|i[n+4>>2],d)));){if((0|(n=0|i[d>>2]))>0){l=0;do o=d+8+(l<<4)|0,(s=0|function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0;if(s=~~(u(+(h(10,+(15-(0|i[e+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3])))%(0|i[e+4>>2]))>>>0,!(s=0|i[(0|i[e>>2])+(s<<2)>>2]))return 0|(r=0);if(!r){for(e=s;;){if(0|eX(e,t)){n=10;break}if(!(e=0|i[e+32>>2])){e=0,n=10;break}}if((0|n)==10)return 0|e}for(e=s;;){if(0|eX(e,t)?0|eX(e+16|0,r):0){n=10;break}if(!(e=0|i[e+32>>2])){e=0,n=10;break}}return(0|n)==10?0|e:0}(r,n=d+8+(((0|(l=l+1|0))%(0|n)|0)<<4)|0,o))?tp(r,s):function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0;(o=0|tm(40))||M(27872,27842,98,27885),i[o>>2]=i[t>>2],i[o+4>>2]=i[t+4>>2],i[o+8>>2]=i[t+8>>2],i[o+12>>2]=i[t+12>>2],i[(s=o+16|0)>>2]=i[r>>2],i[s+4>>2]=i[r+4>>2],i[s+8>>2]=i[r+8>>2],i[s+12>>2]=i[r+12>>2],i[o+32>>2]=0,s=~~(u(+(h(10,+(15-(0|i[e+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3])))%(0|i[e+4>>2]))>>>0,s=(0|i[e>>2])+(s<<2)|0,n=0|i[s>>2];do{if(n){for(;!(0|eX(n,t))||!(0|eX(n+16|0,r));)if(n=(0|(s=0|i[n+32>>2]))==0?n:s,!(0|i[n+32>>2])){l=10;break}if((0|l)==10){i[n+32>>2]=o;break}return tg(o),0|(l=n)}i[s>>2]=o}while(0)i[(l=e+8|0)>>2]=(0|i[l>>2])+1,l=o}(r,o,n),n=0|i[d>>2];while((0|l)<(0|n))}if((0|(c=c+1|0))>=(0|t)){n=0,A=13;break}}return(0|A)==13?(I=p,0|n):(td(r),A=n,I=p,0|A)}(e,t,s=o+16|0)))return r=e,I=o,0|r;if(i[r>>2]=0,i[r+4>>2]=0,i[r+8>>2]=0,0|(e=0|tA(s)))do{t=0|function(e){e|=0;var t=0,r=0,n=0;return((t=0|ty(1,12))||M(27280,27235,49,27293),0|(n=0|i[(r=e+4|0)>>2]))?i[(n=n+8|0)>>2]=t:(0|i[e>>2]&&M(27310,27235,61,27333),i[(n=e)>>2]=t),i[r>>2]=t,0|t}(r);do(function(e,t){e|=0,t|=0;var r=0,n=0;((n=0|tm(24))||M(27347,27235,78,27361),i[n>>2]=i[t>>2],i[n+4>>2]=i[t+4>>2],i[n+8>>2]=i[t+8>>2],i[n+12>>2]=i[t+12>>2],i[n+16>>2]=0,0|(r=0|i[(t=e+4|0)>>2]))?i[r+16>>2]=n:(0|i[e>>2]&&M(27376,27235,82,27361),i[e>>2]=n),i[t>>2]=n})(t,e),l=e+16|0,i[n>>2]=i[l>>2],i[n+4>>2]=i[l+4>>2],i[n+8>>2]=i[l+8>>2],i[n+12>>2]=i[l+12>>2],tp(s,e),e=0|function(e,t){e|=0,t|=0;var r=0;if(r=~~(u(+(h(10,+(15-(0|i[e+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3])))%(0|i[e+4>>2]))>>>0,!(e=0|i[(0|i[e>>2])+(r<<2)>>2]))return 0|(r=0);for(;;){if(0|eX(e,t)){t=5;break}if(!(e=0|i[e+32>>2])){e=0,t=5;break}}return(0|t)==5?0|e:0}(s,n);while((0|e)!=0)e=0|tA(s)}while((0|e)!=0)return(td(s),e=0|function(e){e|=0;var t=0,r=0,n=0,s=0,o=0,l=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,w=0,E=0,R=0,C=0,N=0,P=0,I=0,L=0,D=0,B=0,F=0;if(0|i[(s=e+8|0)>>2])return 0|(F=1);if(!(n=0|i[e>>2]))return 0|(F=0);t=n,r=0;do r=r+1|0,t=0|i[t+8>>2];while((0|t)!=0)if(r>>>0<2)return 0|(F=0);(D=0|tm(r<<2))||M(27396,27235,317,27415),(L=0|tm(r<<5))||M(27437,27235,321,27415),i[e>>2]=0,i[(w=e+4|0)>>2]=0,i[s>>2]=0,r=0,I=0,T=0,p=0;e:for(;;){if(A=0|i[n>>2]){o=0,l=A;do{if(h=+a[l+8>>3],t=l,+u(+(h-(c=+a[(s=(d=(0|(l=0|i[l+16>>2]))==0)?A:l)+8>>3])))>3.141592653589793){F=14;break}o+=(c-h)*(+a[t>>3]+ +a[s>>3])}while(!d)if((0|F)==14){F=0,o=0,t=A;do S=+a[t+8>>3],b=+a[(N=(0|(N=0|i[(P=t+16|0)>>2]))==0?A:N)+8>>3],o+=(+a[t>>3]+ +a[N>>3])*((b<0?b+6.283185307179586:b)-(S<0?S+6.283185307179586:S)),t=0|i[((0|t)==0?n:P)>>2];while((0|t)!=0)}o>0?(i[D+(I<<2)>>2]=n,I=I+1|0,s=T,t=p):F=19}else F=19;if((0|F)==19){F=0;do if(r){if(0|i[(t=r+8|0)>>2]){F=21;break e}if(!(r=0|ty(1,12))){F=23;break e}i[t>>2]=r,s=r+4|0,l=r,t=p}else if(p){s=w,l=p+8|0,t=n,r=e;break}else if(0|i[e>>2]){F=27;break e}else{s=w,l=e,t=n,r=e;break}while(0)if(i[l>>2]=n,i[s>>2]=n,l=L+(T<<5)|0,d=0|i[n>>2]){for(a[(A=L+(T<<5)+8|0)>>3]=17976931348623157e292,a[(p=L+(T<<5)+24|0)>>3]=17976931348623157e292,a[l>>3]=-17976931348623157e292,a[(f=L+(T<<5)+16|0)>>3]=-17976931348623157e292,x=17976931348623157e292,_=-17976931348623157e292,s=0,m=d,h=17976931348623157e292,y=17976931348623157e292,v=-17976931348623157e292,c=-17976931348623157e292;o=+a[m>>3],S=+a[m+8>>3],b=+a[((g=(0|(m=0|i[m+16>>2]))==0)?d:m)+8>>3],o<h&&(a[A>>3]=o,h=o),S<y&&(a[p>>3]=S,y=S),o>v?a[l>>3]=o:o=v,S>c&&(a[f>>3]=S,c=S),x=S>0&S<x?S:x,_=S<0&S>_?S:_,s|=+u(+(S-b))>3.141592653589793,!g;)v=o;s&&(a[f>>3]=_,a[p>>3]=x)}else i[l>>2]=0,i[l+4>>2]=0,i[l+8>>2]=0,i[l+12>>2]=0,i[l+16>>2]=0,i[l+20>>2]=0,i[l+24>>2]=0,i[l+28>>2]=0;s=T+1|0}if(n=0|i[(P=n+8|0)>>2],i[P>>2]=0,n)T=s,p=t;else{F=45;break}}if((0|F)==21)M(27213,27235,35,27247);else if((0|F)==23)M(27267,27235,37,27247);else if((0|F)==27)M(27310,27235,61,27333);else if((0|F)==45){t:do if((0|I)>0){for(P=(0|s)==0,C=s<<2,N=(0|e)==0,R=0,t=0;;){if(E=0|i[D+(R<<2)>>2],P)F=73;else{if(!(T=0|tm(C))){F=50;break}if(!(w=0|tm(C))){F=52;break}u:do if(N)r=0;else{for(s=0,r=0,l=e;;)if(n=L+(s<<5)|0,0|e1(0|i[l>>2],n,0|i[E>>2])?(i[T+(r<<2)>>2]=l,i[w+(r<<2)>>2]=n,g=r+1|0):g=r,l=0|i[l+8>>2])s=s+1|0,r=g;else break;if((0|g)>0)if(n=0|i[T>>2],(0|g)==1)r=n;else for(f=0,m=-1,r=n,p=n;;){for(d=0|i[p>>2],n=0,l=0;A=(0|(s=0|i[i[T+(l<<2)>>2]>>2]))==(0|d)?n:n+((0|e1(s,0|i[w+(l<<2)>>2],0|i[d>>2]))&1)|0,(0|(l=l+1|0))!=(0|g);)n=A;if(r=(s=(0|A)>(0|m))?p:r,(0|(n=f+1|0))==(0|g))break u;f=n,m=s?A:m,p=0|i[T+(n<<2)>>2]}else r=0}while(0)if(tg(T),tg(w),r){if(n=0|i[(s=r+4|0)>>2])r=n+8|0;else if(0|i[r>>2]){F=70;break}i[r>>2]=E,i[s>>2]=E}else F=73}if((0|F)==73){if(F=0,0|(t=0|i[E>>2]))do w=t,t=0|i[t+16>>2],tg(w);while((0|t)!=0)tg(E),t=1}if((0|(R=R+1|0))>=(0|I)){B=t;break t}}(0|F)==50?M(27452,27235,249,27471):(0|F)==52?M(27490,27235,252,27471):(0|F)==70&&M(27310,27235,61,27333)}else B=0;while(0)return tg(D),tg(L),0|(F=B)}return 0}(r))?(e0(r),l=e):l=0,I=o,0|l},_childPosToCell:function(e,t,r,n,a,s){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0;var o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0;if(d=I,I=I+16|0,o=d,a>>>0>15)return s=4,I=d,0|s;if(l=0|tR(0|r,0|n,52),w(),(0|(l&=15))>(0|a))return s=12,I=d,0|s;if(0|eR(r,n,a,o)&&M(27795,27122,1236,27173),!(((0|t)>-1|(0|t)==-1&e>>>0>0xffffffff)&((0|(c=0|i[(h=o)+4>>2]))>(0|t)|((0|c)==(0|t)?(0|i[h>>2])>>>0>e>>>0:0))))return s=2,I=d,0|s;h=a-l|0,a=0|tC(0|a,0,52),u=0|w()|-0xf00001&n,i[(c=s)>>2]=a|r,i[c+4>>2]=u,c=0|tR(0|r,0|n,45),w();e:do if(0|V(127&c)){if(0|l)for(o=1;;){if(!(((c=0|tC(7,0,(15-o|0)*3|0))&r)==0&((0|w())&n)==0))break e;if(o>>>0<l>>>0)o=o+1|0;else break}if((0|h)<1)return s=0,I=d,0|s;for(c=15^l,n=-1,u=1,o=1;;){l=0|e4(7,0,l=h-u|0,((0|l)<0)<<31>>31),r=0|w();do{if(o){if(o=0|tS(0|(o=0|tv(0|(o=0|tT(0|l,0|r,5,0)),0|w(),-5,-1)),0|w(),6,0),(0|t)>(0|(a=0|w()))|(0|t)==(0|a)&e>>>0>o>>>0){t=0|tx(0|(t=0|tv(0|e,0|t,-1,-1)),0|w(),0|o,0|a),o=0|w(),f=0|i[(A=s)>>2],A=0|i[A+4>>2],p=0|tC(7,0,0|(m=(c+n|0)*3|0)),A&=~(0|w()),m=0|tC(0|(a=0|tv(0|(n=0|tS(0|t,0|o,0|l,0|r)),0|(e=0|w()),2,0)),0|w(),0|m),A=0|w()|A,i[(a=s)>>2]=m|f&~p,i[a+4>>2]=A,e=0|tx(0|t,0|o,0|(e=0|tT(0|n,0|e,0|l,0|r)),0|w()),o=0,t=0|w();break}p=0|i[(m=s)>>2],m=0|i[m+4>>2],f=0|tC(7,0,(c+n|0)*3|0),m&=~(0|w()),i[(o=s)>>2]=p&~f,i[o+4>>2]=m,o=1;break}a=0|i[(p=s)>>2],p=0|i[p+4>>2],A=0|tC(7,0,0|(n=(c+n|0)*3|0)),p&=~(0|w()),n=0|tC(0|(m=0|tS(0|e,0|t,0|l,0|r)),0|(o=0|w()),0|n),p=0|w()|p,i[(f=s)>>2]=n|a&~A,i[f+4>>2]=p,e=0|tx(0|e,0|t,0|(o=0|tT(0|m,0|o,0|l,0|r)),0|w()),o=0,t=0|w()}while(0)if((0|h)>(0|u))n=~u,u=u+1|0;else{t=0;break}}return I=d,0|t}while(0)if((0|h)<1)return m=0,I=d,0|m;for(a=15^l,o=1;;){if(f=0|e4(7,0,f=h-o|0,((0|f)<0)<<31>>31),m=0|w(),r=0|i[(u=s)>>2],u=0|i[u+4>>2],n=0|tC(7,0,0|(l=(a-o|0)*3|0)),u&=~(0|w()),l=0|tC(0|(A=0|tS(0|e,0|t,0|f,0|m)),0|(p=0|w()),0|l),u=0|w()|u,i[(c=s)>>2]=l|r&~n,i[c+4>>2]=u,e=0|tx(0|e,0|t,0|(m=0|tT(0|A,0|p,0|f,0|m)),0|w()),t=0|w(),(0|h)<=(0|o)){t=0;break}o=o+1|0}return I=d,0|t},_compactCells:function(e,t,r,n){e|=0,t|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,E=0,R=0,C=0,N=0,P=0,I=0;if((0|(r|=0))==0&(0|(n|=0))==0)return 0|(I=0);if(s=0|i[(a=e)>>2],!0&(0xf00000&(a=0|i[a+4>>2]))==0){if(!((0|n)>0|(0|n)==0&r>>>0>0)||(i[(I=t)>>2]=s,i[I+4>>2]=a,(0|r)==1&(0|n)==0))return 0|(I=0);a=1,s=0;do P=0|i[(N=e+(a<<3)|0)+4>>2],i[(I=t+(a<<3)|0)>>2]=i[N>>2],i[I+4>>2]=P,a=0|tv(0|a,0|s,1,0),s=0|w();while((0|s)<(0|n)|(0|s)==(0|n)&a>>>0<r>>>0)return 0|(a=0)}if(!(P=0|tm(C=r<<3)))return 0|(I=13);if(tD(0|P,0|e,0|C),!(N=0|ty(r,8)))return tg(P),0|(I=13);e:for(;;){E=0|tR(0|(c=0|i[(a=P)>>2]),0|(a=0|i[a+4>>2]),52),w(),E&=15,R=E+-1|0,T=(0|E)!=0,S=(0|n)>0|(0|n)==0&r>>>0>0;t:do if(T&S){if(v=0|tC(0|R,0,52),x=0|w(),R>>>0>15){if(!((0|c)==0&(0|a)==0)){I=16;break e}for(s=0,e=0;;){if(s=0|tv(0|s,0|e,1,0),!((0|(e=0|w()))<(0|n)|(0|e)==(0|n)&s>>>0<r>>>0))break t;if(!((0|(b=0|i[(o=P+(s<<3)|0)>>2]))==0&(0|(o=0|i[o+4>>2]))==0)){a=o,I=16;break e}}}for(l=c,e=a,s=0,o=0;;){if(!((0|l)==0&(0|e)==0)){if(!(!0&(0x7000000&e)==0)){I=21;break e}if(h=0|tR(0|l,0|e,52),w(),(0|(h&=15))<(0|R)){a=12,I=27;break e}if((0|h)!=(0|R)&&(l|=v,e=-0xf00001&e|x,h>>>0>=E>>>0)){u=R;do b=0|tC(7,0,(14-u|0)*3|0),u=u+1|0,l|=b,e=0|w()|e;while(u>>>0<h>>>0)}if(A=0|tM(0|l,0|e,0|r,0|n),p=0|w(),!((0|(d=0|i[(h=u=N+(A<<3)|0)>>2]))==0&(0|(h=0|i[h+4>>2]))==0)){g=0,y=0;do{if((0|g)>(0|n)|(0|g)==(0|n)&y>>>0>r>>>0){I=31;break e}if((0|d)==(0|l)&(-0x7000001&h)==(0|e)){f=0|tR(0|d,0|h,56),w(),f&=7,m=f+1|0,b=0|tR(0|d,0|h,45),w();u:do if(0|V(127&b)){if(d=0|tR(0|d,0|h,52),w(),!(d&=15)){h=6;break}for(h=1;;){if(!(((b=0|tC(7,0,(15-h|0)*3|0))&l)==0&((0|w())&e)==0)){h=7;break u}if(h>>>0<d>>>0)h=h+1|0;else{h=6;break}}}else h=7;while(0)if((f+2|0)>>>0>h>>>0){I=41;break e}b=0|tC(0|m,0,56),e=0|w()|-0x7000001&e,i[(_=u)>>2]=0,i[_+4>>2]=0,l|=b}else A=0|tw(0|(A=0|tv(0|A,0|p,1,0)),0|w(),0|r,0|n),p=0|w();y=0|tv(0|y,0|g,1,0),g=0|w(),d=0|i[(h=u=N+(A<<3)|0)>>2],h=0|i[h+4>>2]}while(!((0|d)==0&(0|h)==0))}i[(b=u)>>2]=l,i[b+4>>2]=e}if(s=0|tv(0|s,0|o,1,0),!((0|(o=0|w()))<(0|n)|(0|o)==(0|n)&s>>>0<r>>>0))break t;l=0|i[(e=P+(s<<3)|0)>>2],e=0|i[e+4>>2]}}while(0)if(b=0|tv(0|r,0|n,5,0),(_=0|w())>>>0<0|(0|_)==0&b>>>0<11){I=85;break}if(b=0|tS(0|r,0|n,6,0),w(),!(b=0|ty(b,8))){I=48;break}do if(S){for(m=0,e=0,f=0,g=0;;){if((0|(s=0|i[(o=h=N+(m<<3)|0)>>2]))==0&(0|(o=0|i[o+4>>2]))==0)_=f;else{d=0|tR(0|s,0|o,56),w(),d&=7,l=d+1|0,A=-0x7000001&o,_=0|tR(0|s,0|o,45),w();c:do if(0|V(127&_)){if(p=0|tR(0|s,0|o,52),w(),0|(p&=15))for(u=1;;){if(!((s&(_=0|tC(7,0,(15-u|0)*3|0)))==0&(A&(0|w()))==0))break c;if(u>>>0<p>>>0)u=u+1|0;else break}s|=o=0|tC(0|l,0,56),o=0|w()|A,i[(l=h)>>2]=s,i[l+4>>2]=o,l=d+2|0}while(0)(0|l)==7?(i[(_=b+(e<<3)|0)>>2]=s,i[_+4>>2]=-0x7000001&o,e=0|tv(0|e,0|f,1,0),_=0|w()):_=f}if(m=0|tv(0|m,0|g,1,0),(0|(g=0|w()))<(0|n)|(0|g)==(0|n)&m>>>0<r>>>0)f=_;else break}if(S){if(y=R>>>0>15,v=0|tC(0|R,0,52),x=0|w(),!T){for(s=0,u=0,l=0,o=0;(0|c)==0&(0|a)==0||(i[(R=t+(s<<3)|0)>>2]=c,i[R+4>>2]=a,s=0|tv(0|s,0|u,1,0),u=0|w()),l=0|tv(0|l,0|o,1,0),(0|(o=0|w()))<(0|n)|(0|o)==(0|n)&l>>>0<r>>>0;)c=0|i[(a=P+(l<<3)|0)>>2],a=0|i[a+4>>2];a=_;break}for(s=0,u=0,o=0,l=0;;){do if(!((0|c)==0&(0|a)==0)){if(p=0|tR(0|c,0|a,52),w(),y|(0|(p&=15))<(0|R)){I=80;break e}if((0|p)!=(0|R)){if(h=c|v,d=-0xf00001&a|x,p>>>0>=E>>>0){A=R;do T=0|tC(7,0,(14-A|0)*3|0),A=A+1|0,h|=T,d=0|w()|d;while(A>>>0<p>>>0)}}else h=c,d=a;f=0|tM(0|h,0|d,0|r,0|n),A=0,p=0,g=0|w();do{if((0|A)>(0|n)|(0|A)==(0|n)&p>>>0>r>>>0){I=81;break e}if((-0x7000001&(m=0|i[(T=N+(f<<3)|0)+4>>2]))==(0|d)?(0|i[T>>2])==(0|h):0){I=65;break}f=0|tw(0|(T=0|tv(0|f,0|g,1,0)),0|w(),0|r,0|n),g=0|w(),p=0|tv(0|p,0|A,1,0),A=0|w(),T=N+(f<<3)|0}while(!((0|i[T>>2])==(0|h)?(0|i[T+4>>2])==(0|d):0))if((0|I)==65?(I=0,!0&(0x7000000&m)==0x6000000):0)break;i[(T=t+(s<<3)|0)>>2]=c,i[T+4>>2]=a,s=0|tv(0|s,0|u,1,0),u=0|w()}while(0)if(o=0|tv(0|o,0|l,1,0),!((0|(l=0|w()))<(0|n)|(0|l)==(0|n)&o>>>0<r>>>0))break;c=0|i[(a=P+(o<<3)|0)>>2],a=0|i[a+4>>2]}a=_}else s=0,a=_}else s=0,e=0,a=0;while(0)if(tB(0|N,0,0|C),tD(0|P,0|b,e<<3),tg(b),(0|e)==0&(0|a)==0){I=89;break}t=t+(s<<3)|0,n=a,r=e}if((0|I)==16)!0&(0x7000000&a)==0?(a=4,I=27):I=21;else if((0|I)==31)M(27795,27122,529,27132);else{if((0|I)==41)return tg(P),tg(N),0|(I=10);if((0|I)==48)return tg(P),tg(N),0|(I=13);(0|I)==80?M(27795,27122,620,27132):(0|I)==81?M(27795,27122,632,27132):(0|I)==85&&(tD(0|t,0|P,r<<3),I=89)}return(0|I)==21?(tg(P),tg(N),0|(I=5)):(0|I)==27?(tg(P),tg(N),0|(I=a)):(0|I)==89?(tg(P),tg(N),0|(I=0)):0},_destroyLinkedMultiPolygon:e0,_directedEdgeToBoundary:eg,_directedEdgeToCells:function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0;return(a=I,I=I+16|0,n=a,!0&(0x78000000&t)==0x10000000)?(s=-0x7f000001&t|0x8000000,i[(o=r)>>2]=e,i[o+4>>2]=s,i[n>>2]=0,t=0|tR(0|e,0|t,56),w(),n=0|U(e,s,7&t,n,r+8|0)):n=6,I=a,0|n},_edgeLengthKm:function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0,u=0,h=0,p=0,f=0;if(u=I,I=I+176|0,0|(e=0|eg(e,t,l=u)))return l=e,o=6371.007180918475*a[r>>3],a[r>>3]=o,I=u,0|l;if(a[r>>3]=0,(0|(e=0|i[l>>2]))<=1)return l=0,o=0,a[r>>3]=o,I=u,0|l;t=e+-1|0,e=0,n=+a[l+8>>3],s=+a[l+16>>3],o=0;do e=e+1|0,p=n,f=+A(+(((n=+a[l+8+(e<<4)>>3])-p)*.5)),h=s,o+=2*y(+c(+(h=f*f+(h=+A(+(((s=+a[l+8+(e<<4)+8>>3])-h)*.5)))*(d(+p)*d(+n)*h))),+c(+(1-h)));while((0|e)!=(0|t))return a[r>>3]=o,l=0,f=6371.007180918475*o,a[r>>3]=f,I=u,0|l},_edgeLengthM:function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0,u=0,h=0,p=0,f=0;if(u=I,I=I+176|0,0|(e=0|eg(e,t,l=u)))return l=e,o=6371.007180918475*a[r>>3]*1e3,a[r>>3]=o,I=u,0|l;if(a[r>>3]=0,(0|(e=0|i[l>>2]))<=1)return l=0,o=0,a[r>>3]=o,I=u,0|l;t=e+-1|0,e=0,n=+a[l+8>>3],s=+a[l+16>>3],o=0;do e=e+1|0,p=n,f=+A(+(((n=+a[l+8+(e<<4)>>3])-p)*.5)),h=s,o+=2*y(+c(+(h=f*f+(h=+A(+(((s=+a[l+8+(e<<4)+8>>3])-h)*.5)))*(d(+p)*d(+n)*h))),+c(+(1-h)));while((0|e)!=(0|t))return a[r>>3]=o,l=0,f=6371.007180918475*o*1e3,a[r>>3]=f,I=u,0|l},_edgeLengthRads:function(e,t,r){e|=0,t|=0,r|=0;var n=0,s=0,o=0,l=0,u=0,h=0,p=0,f=0;if(u=I,I=I+176|0,0|(e=0|eg(e,t,l=u)))return l=e,I=u,0|l;if(a[r>>3]=0,(0|(e=0|i[l>>2]))<=1)return l=0,I=u,0|l;t=e+-1|0,e=0,n=+a[l+8>>3],s=+a[l+16>>3],o=0;do e=e+1|0,p=n,f=+A(+(((n=+a[l+8+(e<<4)>>3])-p)*.5)),h=s,o+=2*y(+c(+(h=f*f+(h=+A(+(((s=+a[l+8+(e<<4)+8>>3])-h)*.5)))*(d(+n)*d(+p)*h))),+c(+(1-h)));while((0|e)<(0|t))return a[r>>3]=o,l=0,I=u,0|l},_emscripten_replace_memory:function(e){return n=new Int8Array(e),new Uint8Array(e),i=new Int32Array(e),new Float32Array(e),a=new Float64Array(e),r=e,!0},_free:tg,_getBaseCellNumber:eT,_getDirectedEdgeDestination:function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0;return(a=I,I=I+16|0,i[(n=a)>>2]=0,!0&(0x78000000&t)==0x10000000)?(s=0|tR(0|e,0|t,56),w(),n=0|U(e,-0x7f000001&t|0x8000000,7&s,n,r)):n=6,I=a,0|n},_getDirectedEdgeOrigin:function(e,t,r){return(e|=0,r|=0,!0&(0x78000000&(t|=0))==0x10000000)?(i[r>>2]=e,i[r+4>>2]=-0x7f000001&t|0x8000000,0|(r=0)):0|(r=6)},_getHexagonAreaAvgKm2:eK,_getHexagonAreaAvgM2:function(e,t){return(t|=0,(e|=0)>>>0>15)?0|(t=4):(a[t>>3]=+a[20784+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgKm:function(e,t){return(t|=0,(e|=0)>>>0>15)?0|(t=4):(a[t>>3]=+a[20912+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgM:function(e,t){return(t|=0,(e|=0)>>>0>15)?0|(t=4):(a[t>>3]=+a[21040+(e<<3)>>3],0|(t=0))},_getIcosahedronFaces:function e(t,r,n){t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0;A=I,I=I+128|0,h=A+112|0,o=A+96|0,d=A,s=0|tR(0|t,0|r,52),w(),u=15&s,i[h>>2]=u,l=0|tR(0|t,0|r,45),w(),l&=127;e:do if(0|V(l)){if(0|u)for(a=1;;){if(!(((c=0|tC(7,0,(15-a|0)*3|0))&t)==0&((0|w())&r)==0)){s=0;break e}if(a>>>0<u>>>0)a=a+1|0;else break}if(!(1&s))return c=0|tC(u+1|0,0,52),d=0|w()|-0xf00001&r,d=0|e((c|t)&~(h=0|tC(7,0,(14-u|0)*3|0)),d&~(0|w()),n),I=A,0|d;s=1}else s=0;while(0)if(!(a=0|ek(t,r,o))){s?(ex(o,h,d),c=5):(eS(o,h,d),c=6);t:do if(0|V(l))if(u)for(a=1;;){if(!(((l=0|tC(7,0,(15-a|0)*3|0))&t)==0&((0|w())&r)==0)){t=2;break t}if(a>>>0<u>>>0)a=a+1|0;else{t=5;break}}else t=5;else t=2;while(0)tB(0|n,-1,t<<2);u:do if(s)for(o=0;;){if(!function(e,t){e|=0,t|=0;var r=0;do r=0|e_(e,t,0,1);while((0|r)==2)}(l=d+(o<<4)|0,0|i[h>>2]),l=0|i[l>>2],(0|(u=0|i[n>>2]))==-1|(0|u)==(0|l))a=n;else{s=0;do{if((s=s+1|0)>>>0>=t>>>0){a=1;break u}u=0|i[(a=n+(s<<2)|0)>>2]}while(!((0|u)==-1|(0|u)==(0|l)))}if(i[a>>2]=l,(o=o+1|0)>>>0>=c>>>0){a=0;break}}else for(o=0;;){if(e_(l=d+(o<<4)|0,0|i[h>>2],0,1),l=0|i[l>>2],(0|(u=0|i[n>>2]))==-1|(0|u)==(0|l))a=n;else{s=0;do{if((s=s+1|0)>>>0>=t>>>0){a=1;break u}u=0|i[(a=n+(s<<2)|0)>>2]}while(!((0|u)==-1|(0|u)==(0|l)))}if(i[a>>2]=l,(o=o+1|0)>>>0>=c>>>0){a=0;break}}while(0)}return d=a,I=A,0|d},_getNumCells:eZ,_getPentagons:eq,_getRes0Cells:function(e){e|=0;var t=0,r=0,n=0;t=0;do tC(0|t,0,45),n=0|w()|0x8001fff,i[(r=e+(t<<3)|0)>>2]=-1,i[r+4>>2]=n,t=t+1|0;while((0|t)!=122)return 0},_getResolution:function(e,t){return e|=0,t|=0,t=0|tR(0|e,0|t,52),w(),15&t},_greatCircleDistanceKm:eY,_greatCircleDistanceM:function(e,t){e|=0,t|=0;var r=0,n=0,i=0,s=0;return+(2*y(+c(+(r=(s=+A(+(((i=+a[t>>3])-(n=+a[e>>3]))*.5)))*s+(r=+A(+((a[t+8>>3]-a[e+8>>3])*.5)))*(d(+i)*d(+n)*r))),+c(+(1-r)))*6371007.180918475)},_greatCircleDistanceRads:function(e,t){e|=0,t|=0;var r=0,n=0,i=0,s=0;return+(2*y(+c(+(r=(s=+A(+(((i=+a[t>>3])-(n=+a[e>>3]))*.5)))*s+(r=+A(+((a[t+8>>3]-a[e+8>>3])*.5)))*(d(+i)*d(+n)*r))),+c(+(1-r))))},_gridDisk:L,_gridDiskDistances:D,_gridDistance:function(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0;return(u=I,I=I+32|0,o=u+12|0,l=u,0|(s=0|e2(e,t,e,t,o)))?l=s:0|(e=0|e2(e,t,r,n,l))?l=e:(o=0|ef(o,l),i[(l=a)>>2]=o,i[l+4>>2]=((0|o)<0)<<31>>31,l=0),I=u,0|l},_gridPathCells:function(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,E=0,R=0;if(E=I,I=I+48|0,S=E+24|0,o=E+12|0,T=E,!(s=0|e2(e,t,e,t,S))&&!(s=0|e2(e,t,r,n,o))){b=((0|(_=0|ef(S,o)))<0)<<31>>31,i[S>>2]=0,i[S+4>>2]=0,i[S+8>>2]=0,i[o>>2]=0,i[o+4>>2]=0,i[o+8>>2]=0,0|e2(e,t,e,t,S)&&M(27795,27538,692,27747),0|e2(e,t,r,n,o)&&M(27795,27538,697,27747),em(S),em(o),d=(0|_)==0?0:1/(0|_),r=0|i[S>>2],g=d*((0|i[o>>2])-r|0),n=0|i[(y=S+4|0)>>2],v=d*((0|i[o+4>>2])-n|0),s=0|i[(x=S+8|0)>>2],d*=(0|i[o+8>>2])-s|0,i[T>>2]=r,i[(A=T+4|0)>>2]=n,i[(p=T+8|0)>>2]=s;e:do if((0|_)<0)s=0;else for(f=0,m=0;;){R=g*(c=+(m>>>0)+0x100000000*(0|f))+ +(0|r),l=v*c+ +(0|n),c=d*c+ +(0|s),r=~~tL(+R),o=~~tL(+l),s=~~tL(+c),R=+u(+((0|r)-R)),l=+u(+((0|o)-l)),c=+u(+((0|s)-c));do if(R>l&R>c)r=0-(o+s)|0,n=o;else{if(h=0-r|0,l>c){n=h-s|0;break}n=o,s=h-o|0;break}while(0)if(i[T>>2]=r,i[A>>2]=n,i[p>>2]=s,!function(e){e|=0;var t=0,r=0,n=0,a=0,s=0,o=0,l=0;t=0-(r=0|i[e>>2])|0,i[e>>2]=t,i[(o=e+8|0)>>2]=0,a=(n=0|i[(l=e+4|0)>>2])+r|0,(0|r)>0?(i[l>>2]=a,i[o>>2]=r,i[e>>2]=0,t=0,n=a):r=0,(0|n)<0?(s=t-n|0,i[e>>2]=s,r=r-n|0,i[o>>2]=r,i[l>>2]=0,a=s-r|0,t=0-r|0,(0|r)<0?(i[e>>2]=a,i[l>>2]=t,i[o>>2]=0,n=t,r=0):(n=0,a=s)):a=t,(0|(t=(0|r)<(0|(t=(0|n)<(0|a)?n:a))?r:t))<=0||(i[e>>2]=a-t,i[l>>2]=n-t,i[o>>2]=r-t)}(T),0|(s=0|e3(e,t,T,a+(m<<3)|0)))break e;if(!((0|f)<(0|b)|(0|f)==(0|b)&m>>>0<_>>>0)){s=0;break e}r=0|tv(0|m,0|f,1,0),f=n=0|w(),m=r,r=0|i[S>>2],n=0|i[y>>2],s=0|i[x>>2]}while(0)}return T=s,I=E,0|T},_gridPathCellsSize:function(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0;return(u=I,I=I+32|0,o=u+12|0,l=u,(s=0|e2(e,t,e,t,o))||(s=0|e2(e,t,r,n,l)))?(l=s,I=u,0|l):(n=0|tv(0|(n=0|ef(o,l)),((0|n)<0)<<31>>31,1,0),o=0|w(),i[(l=a)>>2]=n,i[l+4>>2]=o,l=0,I=u,0|l)},_gridRing:function(e,t,r,n){return 0|O(e|=0,t|=0,r|=0,n|=0)?(tB(0|n,0,48*r|0),0|(n=0|function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0;if(d=I,I=I+16|0,o=d,!r)return i[n>>2]=e,i[n+4>>2]=t,n=0,I=d,0|n;do if((0|r)>=0){if((0|r)>0xd2461d){if(0|(a=0|eZ(15,o)))break;a=0|i[(s=o)>>2],s=0|i[s+4>>2]}else a=((0|r)<0)<<31>>31,h=0|tT(0|r,0|a,3,0),a=0|tT(0|h,0|(s=0|w()),0|(a=0|tv(0|r,0|a,1,0)),0|w()),a=0|tv(0|a,0|w(),1,0),s=0|w(),i[(h=o)>>2]=a,i[h+4>>2]=s;if(c=0|ty(a,8)){if(!(h=0|ty(a,4))){tg(c),a=13;break}if(0|(a=0|F(e,t,r,c,h,a,s,0))){tg(c),tg(h);break}if(t=0|i[o>>2],(0|(o=0|i[o+4>>2]))>0|(0|o)==0&t>>>0>0){a=0,l=0,u=0;do((0|(s=0|i[(e=c+(l<<3)|0)>>2]))==0&(0|(e=0|i[e+4>>2]))==0?0:(0|i[h+(l<<2)>>2])==(0|r))&&(i[(A=n+(a<<3)|0)>>2]=s,i[A+4>>2]=e,a=a+1|0),l=0|tv(0|l,0|u,1,0),u=0|w();while((0|u)<(0|o)|(0|u)==(0|o)&l>>>0<t>>>0)}tg(c),tg(h),a=0}else a=13}else a=2;while(0)return A=a,I=d,0|A}(e,t,r,n))):0|(n=0)},_gridRingUnsafe:O,_i64Add:tv,_i64Subtract:tx,_isPentagon:eC,_isResClassIII:function(e,t){return e|=0,t|=0,t=0|tR(0|e,0|t,52),w(),1&t},_isValidCell:ew,_isValidDirectedEdge:function(e,t){e|=0,t|=0;var r=0;switch(r=0|tR(0|e,0|t,56),w(),7&r){case 0:case 7:return 0|(r=0)}return(r=-0x7f000001&t|0x8000000,!(!0&(0x78000000&t)==0x10000000)||!0&(0x7000000&t)==0x1000000&(0|eC(e,r))!=0)?0|(r=0):0|(r=0|ew(e,r))},_isValidVertex:function(e,t){e|=0,t|=0;var r=0,n=0,a=0,s=0;return(a=I,I=I+16|0,r=a,!0&(0x78000000&t)==0x20000000&&0|ew(e,n=-0x7f000001&t|0x8000000))?(s=0|tR(0|e,0|t,56),w(),n=(s=(0|tc(e,n,7&s,r))==0)&((0|i[(n=r)>>2])==(0|e)?(0|i[n+4>>2])==(0|t):0)&1):n=0,I=a,0|n},_latLngToCell:eU,_llvm_ctlz_i64:tN,_llvm_maxnum_f64:tP,_llvm_minnum_f64:tI,_llvm_round_f64:tL,_localIjToCell:function(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s,o,l,u,c,h,d,A,p=0,f=0;return f=I,I=I+16|0,p=f,n?r=15:(r=0|(s=0|r,o=0|p,l=0,u=0,c=0,h=0,d=0,A=0,(u=0|i[s>>2],i[o>>2]=u,c=0|i[s+4>>2],i[(d=o+4|0)>>2]=c,i[(A=o+8|0)>>2]=0,s=(l=(0|c)<(0|u))?u:c,(0|(l=l?c:u))<0&&(((0|l)==-0x80000000?1:(0|s)>0?(0x7fffffff-s|0)<(0|l):(-0x80000000-s|0)>(0|l))||((0|s)>-1?(-0x80000000|s)>=(0|l):(-0x80000000^s)<(0|l))))?0|(o=1):(s=c-u|0,(0|u)<0?(l=0-u|0,i[d>>2]=s,i[A>>2]=l,i[o>>2]=0,u=0):(s=c,l=0),(0|s)<0&&(u=u-s|0,i[o>>2]=u,l=l-s|0,i[A>>2]=l,i[d>>2]=0,s=0),h=u-l|0,c=s-l|0,(0|l)<0?(i[o>>2]=h,i[d>>2]=c,i[A>>2]=0,s=c,c=h,l=0):c=u,(0|(u=(0|l)<(0|(u=(0|s)<(0|c)?s:c))?l:u))<=0||(i[o>>2]=c-u,i[d>>2]=s-u,i[A>>2]=l-u),0|(o=0))))||(r=0|e3(e,t,p,a)),I=f,0|r},_malloc:tm,_maxFaceCount:function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0;if(a=0|tR(0|e,0|t,45),w(),!(0|V(127&a)))return a=2,i[r>>2]=a,0;if(a=0|tR(0|e,0|t,52),w(),!(a&=15))return a=5,i[r>>2]=a,0;for(n=1;;){if(!(((0|tC(7,0,(15-n|0)*3|0))&e)==0&((0|w())&t)==0)){n=2,e=6;break}if(n>>>0<a>>>0)n=n+1|0;else{n=5,e=6;break}}return(0|e)==6&&(i[r>>2]=n),0},_maxGridDiskSize:function(e,t){t|=0;var r=0,n=0,a=0;return(0|(e|=0))<0?0|(t=2):(0|e)>0xd2461d?0|(t=0|eZ(15,t)):(r=((0|e)<0)<<31>>31,a=0|tT(0|e,0|r,3,0),r=0|tT(0|a,0|(n=0|w()),0|(r=0|tv(0|e,0|r,1,0)),0|w()),r=0|tv(0|r,0|w(),1,0),e=0|w(),i[t>>2]=r,i[t+4>>2]=e,0|(t=0))},_maxPolygonToCellsSize:function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0;if(l=I,I=I+48|0,a=l+16|0,s=l+8|0,o=l,0|(r=0|te(r)))return o=r,I=l,0|o;if(u=0|i[(c=e)+4>>2],i[(r=s)>>2]=i[c>>2],i[r+4>>2]=u,e9(s,a),!(r=0|J(a,t,o))){if(t=0|i[s>>2],(0|(s=0|i[e+8>>2]))>0){a=0|i[e+12>>2],r=0;do t=(0|i[a+(r<<3)>>2])+t|0,r=r+1|0;while((0|r)<(0|s))}a=0|i[(r=o)>>2],(0|(r=0|i[r+4>>2]))<(0|(s=((0|t)<0)<<31>>31))|(0|r)==(0|s)&a>>>0<t>>>0?(i[(r=o)>>2]=t,i[r+4>>2]=s,r=s):t=a,u=0|tv(0|t,0|r,12,0),c=0|w(),i[(r=o)>>2]=u,i[r+4>>2]=c,i[(r=n)>>2]=u,i[r+4>>2]=c,r=0}return c=r,I=l,0|c},_maxPolygonToCellsSizeExperimental:function(e,t,r,s){e|=0,t|=0,r|=0,s|=0;var o,l=0,c=0,h=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0;if(g=I,I=I+48|0,p=g+32|0,A=g+40|0,f=g,!(0|i[e>>2]))return i[(m=s)>>2]=0,i[m+4>>2]=0,m=0,I=g,0|m;eM(p,0,0,0),l=0|i[(h=p)>>2],h=0|i[h+4>>2];do if(t>>>0>15)i[(m=f)>>2]=0,i[m+4>>2]=0,i[f+8>>2]=4,i[f+12>>2]=-1,m=f+16|0,r=f+29|0,i[m>>2]=0,i[m+4>>2]=0,i[m+8>>2]=0,n[m+12|0]=0,n[0|r]=0|n[0|A],n[r+1|0]=0|n[A+1|0],n[r+2|0]=0|n[A+2|0],r=4,m=9;else{if(0|(r=0|te(r))){i[(p=f)>>2]=0,i[p+4>>2]=0,i[f+8>>2]=r,i[f+12>>2]=-1,p=f+16|0,m=f+29|0,i[p>>2]=0,i[p+4>>2]=0,i[p+8>>2]=0,n[p+12|0]=0,n[0|m]=0|n[0|A],n[m+1|0]=0|n[A+1|0],n[m+2|0]=0|n[A+2|0],m=9;break}if(!(r=0|ty((0|i[e+8>>2])+1|0,32))){i[(m=f)>>2]=0,i[m+4>>2]=0,i[f+8>>2]=13,i[f+12>>2]=-1,m=f+16|0,r=f+29|0,i[m>>2]=0,i[m+4>>2]=0,i[m+8>>2]=0,n[m+12|0]=0,n[0|r]=0|n[0|A],n[r+1|0]=0|n[A+1|0],n[r+2|0]=0|n[A+2|0],r=13,m=9;break}tt(e,r),i[(v=f)>>2]=l,i[v+4>>2]=h,i[(h=f+8|0)>>2]=0,i[f+12>>2]=t,i[f+20>>2]=e,i[f+24>>2]=r,n[f+28|0]=0,n[0|(l=f+29|0)]=0|n[0|A],n[l+1|0]=0|n[A+1|0],n[l+2|0]=0|n[A+2|0],i[f+16>>2]=3,c=(y=(a[(o=0|r)>>3]-a[o+8>>3])*function(e){e|=0;var t=0,r=0,n=0;return t=(n=+a[e+16>>3])-(r=+a[e+24>>3]),+(n<r?t+6.283185307179586:t)}(r))/d(+tI(+(c=+u(+a[r>>3])),+u(+a[r+8>>3])))*40589732.49931477,r=0|i[(l=f+12|0)>>2];e:do if((0|r)>0)do{if(eK(r+-1|0,p),!(c/a[p>>3]>10))break e;r=(v=0|i[l>>2])+-1|0,i[l>>2]=r}while((0|v)>1)while(0)if(e6(f),i[(l=s)>>2]=0,i[l+4>>2]=0,!((0|(r=0|i[(l=f)>>2]))==0&(0|(l=0|i[l+4>>2]))==0))do eR(r,l,t,p),A=p,A=0|tv(0|i[(e=s)>>2],0|i[e+4>>2],0|i[A>>2],0|i[A+4>>2]),e=0|w(),i[(v=s)>>2]=A,i[v+4>>2]=e,e6(f),r=0|i[(v=f)>>2],l=0|i[v+4>>2];while(!((0|r)==0&(0|l)==0))r=0|i[h>>2]}while(0)return v=r,I=g,0|v},_memcpy:tD,_memset:tB,_originToDirectedEdges:function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0;return a=(0|eC(e,t))==0,t&=-0x7f000001,i[(n=r)>>2]=a?e:0,i[n+4>>2]=a?0x11000000|t:0,i[(n=r+8|0)>>2]=e,i[n+4>>2]=0x12000000|t,i[(n=r+16|0)>>2]=e,i[n+4>>2]=0x13000000|t,i[(n=r+24|0)>>2]=e,i[n+4>>2]=0x14000000|t,i[(n=r+32|0)>>2]=e,i[n+4>>2]=0x15000000|t,i[(r=r+40|0)>>2]=e,i[r+4>>2]=0x16000000|t,0},_pentagonCount:function(){return 12},_polygonToCells:function(e,t,r,n){e|=0,t|=0,r|=0,n|=0;var a=0,s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,S=0,T=0,M=0,E=0,R=0,C=0,N=0,P=0,L=0,D=0,U=0,O=0,k=0;if(k=I,I=I+112|0,L=k+80|0,u=k+72|0,D=k,U=k+56|0,0|(a=0|te(r)))return O=a,I=k,0|O;if(!(O=0|tm((i[(c=e+8|0)>>2]<<5)+32|0)))return O=13,I=k,0|O;if(tt(e,O),!(a=0|te(r))){if(P=0|i[(N=e)+4>>2],i[(a=u)>>2]=i[N>>2],i[a+4>>2]=P,e9(u,L),a=0|J(L,t,D))N=0,P=0;else{if(a=0|i[u>>2],(0|(s=0|i[c>>2]))>0){o=0|i[e+12>>2],r=0;do a=(0|i[o+(r<<3)>>2])+a|0,r=r+1|0;while((0|r)!=(0|s))r=a}else r=a;s=0|i[(a=D)>>2],(0|(a=0|i[a+4>>2]))<(0|(o=((0|r)<0)<<31>>31))|(0|a)==(0|o)&s>>>0<r>>>0?(i[(a=D)>>2]=r,i[a+4>>2]=o,a=o):r=s,N=0|tv(0|r,0|a,12,0),P=0|w(),i[(a=D)>>2]=N,i[a+4>>2]=P,a=0}if(!a){if(!(r=0|ty(N,8)))return tg(O),O=13,I=k,0|O;if(!(l=0|ty(N,8)))return tg(O),tg(r),O=13,I=k,0|O;i[(R=L)>>2]=0,i[R+4>>2]=0,C=0|i[(R=e)+4>>2],i[(a=u)>>2]=i[R>>2],i[a+4>>2]=C,a=0|z(u,N,P,t,L,r,l);e:do if(a)tg(r),tg(l),tg(O);else{t:do if((0|i[c>>2])>0){for(o=e+12|0,s=0;a=0|z((0|i[o>>2])+(s<<3)|0,N,P,t,L,r,l),s=s+1|0,!(0|a);)if((0|s)>=(0|i[c>>2]))break t;tg(r),tg(l),tg(O);break e}while(0)(0|P)>0|(0|P)==0&N>>>0>0&&tB(0|l,0,N<<3),R=0|i[(C=L)+4>>2];u:do{if((0|R)>0|(0|R)==0&(0|i[C>>2])>>>0>0){T=r,M=l,E=r,R=l,C=r,a=r,_=r,b=l,S=l,r=l;c:for(;;){for(g=0,y=0,v=0,x=0,s=0,o=0;;){u=(l=D)+56|0;do i[l>>2]=0,l=l+4|0;while((0|l)<(0|u))if(0|B(c=0|i[(t=T+(g<<3)|0)>>2],t=0|i[t+4>>2],1,D,0)){u=(l=D)+56|0;do i[l>>2]=0,l=l+4|0;while((0|l)<(0|u))0|(l=0|ty(7,4))&&(F(c,t,1,D,l,7,0,0),tg(l))}for(m=0;;){p=0|i[(f=D+(m<<3)|0)>>2],f=0|i[f+4>>2];h:do if((0|p)==0&(0|f)==0)l=s,u=o;else{if(h=0|tM(0|p,0|f,0|N,0|P),c=0|w(),!((0|(u=0|i[(t=l=n+(h<<3)|0)>>2]))==0&(0|(t=0|i[t+4>>2]))==0)){d=0,A=0;do{if((0|d)>(0|P)|(0|d)==(0|P)&A>>>0>N>>>0)break c;if((0|u)==(0|p)&(0|t)==(0|f)){l=s,u=o;break h}h=0|tw(0|(l=0|tv(0|h,0|c,1,0)),0|w(),0|N,0|P),c=0|w(),A=0|tv(0|A,0|d,1,0),d=0|w(),u=0|i[(t=l=n+(h<<3)|0)>>2],t=0|i[t+4>>2]}while(!((0|u)==0&(0|t)==0))}if((0|p)==0&(0|f)==0){l=s,u=o;break}ez(p,f,U),0|tr(e,O,U)&&(A=0|tv(0|s,0|o,1,0),o=0|w(),i[(d=l)>>2]=p,i[d+4>>2]=f,i[(s=M+(s<<3)|0)>>2]=p,i[s+4>>2]=f,s=A),l=s,u=o}while(0)if((m=m+1|0)>>>0>=7)break;s=l,o=u}if(g=0|tv(0|g,0|y,1,0),y=0|w(),v=0|tv(0|v,0|x,1,0),x=0|w(),s=0|i[(o=L)>>2],(0|x)<(0|(o=0|i[o+4>>2]))|(0|x)==(0|o)&v>>>0<s>>>0)s=l,o=u;else break}if((0|o)>0|(0|o)==0&s>>>0>0){s=0,o=0;do i[(x=T+(s<<3)|0)>>2]=0,i[x+4>>2]=0,s=0|tv(0|s,0|o,1,0),o=0|w(),v=0|i[(x=L)+4>>2];while((0|o)<(0|v)|((0|o)==(0|v)?s>>>0<(0|i[x>>2])>>>0:0))}if(i[(x=L)>>2]=l,i[x+4>>2]=u,(0|u)>0|(0|u)==0&l>>>0>0)m=r,g=S,y=C,v=b,x=M,r=_,S=a,b=E,_=m,a=g,C=R,R=y,E=v,M=T,T=x;else break u}tg(E),tg(R),tg(O),a=1;break e}a=l}while(0)tg(O),tg(r),tg(a),a=0}while(0)return O=a,I=k,0|O}}return tg(O),O=a,I=k,0|O},_polygonToCellsExperimental:function(e,t,r,a,s,o){e|=0,t|=0,r|=0,a|=0,s|=0,o|=0;var l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0,g=0,y=0;y=I,I=I+160|0,A=y+80|0,u=y+64|0,p=y+112|0,g=y,function(e,t,r,a){e|=0,t|=0,r|=0,a|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0;h=I,I=I+48|0,l=h+32|0,o=h+40|0,u=h,eM(l,0,0,0),c=0|i[l>>2],l=0|i[l+4>>2];do{if(r>>>0<=15){if(0|(s=0|te(a))){i[(a=u)>>2]=0,i[a+4>>2]=0,i[u+8>>2]=s,i[u+12>>2]=-1,a=u+16|0,c=u+29|0,i[a>>2]=0,i[a+4>>2]=0,i[a+8>>2]=0,n[a+12|0]=0,n[0|c]=0|n[0|o],n[c+1|0]=0|n[o+1|0],n[c+2|0]=0|n[o+2|0];break}if(s=0|ty((0|i[t+8>>2])+1|0,32)){tt(t,s),i[(d=u)>>2]=c,i[d+4>>2]=l,i[u+8>>2]=0,i[u+12>>2]=r,i[u+16>>2]=a,i[u+20>>2]=t,i[u+24>>2]=s,n[u+28|0]=0,n[0|(c=u+29|0)]=0|n[0|o],n[c+1|0]=0|n[o+1|0],n[c+2|0]=0|n[o+2|0];break}i[(a=u)>>2]=0,i[a+4>>2]=0,i[u+8>>2]=13,i[u+12>>2]=-1,a=u+16|0,c=u+29|0,i[a>>2]=0,i[a+4>>2]=0,i[a+8>>2]=0,n[a+12|0]=0,n[0|c]=0|n[0|o],n[c+1|0]=0|n[o+1|0],n[c+2|0]=0|n[o+2|0];break}i[(c=u)>>2]=0,i[c+4>>2]=0,i[u+8>>2]=4,i[u+12>>2]=-1,c=u+16|0,d=u+29|0,i[c>>2]=0,i[c+4>>2]=0,i[c+8>>2]=0,n[c+12|0]=0,n[0|d]=0|n[0|o],n[d+1|0]=0|n[o+1|0],n[d+2|0]=0|n[o+2|0]}while(0)e6(u),i[e>>2]=i[u>>2],i[e+4>>2]=i[u+4>>2],i[e+8>>2]=i[u+8>>2],i[e+12>>2]=i[u+12>>2],i[e+16>>2]=i[u+16>>2],i[e+20>>2]=i[u+20>>2],i[e+24>>2]=i[u+24>>2],i[e+28>>2]=i[u+28>>2],I=h}(A,e,t,r),eG(u,0|i[(h=A)>>2],0|i[h+4>>2],t),c=0|i[(h=u)>>2],h=0|i[h+4>>2],l=0|i[A+8>>2],i[(f=p+4|0)>>2]=i[A>>2],i[f+4>>2]=i[A+4>>2],i[f+8>>2]=i[A+8>>2],i[f+12>>2]=i[A+12>>2],i[f+16>>2]=i[A+16>>2],i[f+20>>2]=i[A+20>>2],i[f+24>>2]=i[A+24>>2],i[f+28>>2]=i[A+28>>2],i[(f=g)>>2]=c,i[f+4>>2]=h,i[(f=g+8|0)>>2]=l,e=g+12|0,t=p,r=e+36|0;do i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0;while((0|e)<(0|r))if(i[(p=g+48|0)>>2]=i[u>>2],i[p+4>>2]=i[u+4>>2],i[p+8>>2]=i[u+8>>2],i[p+12>>2]=i[u+12>>2],(0|c)==0&(0|h)==0)return g=l,I=y,0|g;r=g+16|0,d=g+24|0,A=g+28|0,l=0,u=0,t=c,e=h;do{if(!((0|l)<(0|s)|(0|l)==(0|s)&u>>>0<a>>>0)){m=4;break}if(h=u,u=0|tv(0|u,0|l,1,0),l=0|w(),i[(h=o+(h<<3)|0)>>2]=t,i[h+4>>2]=e,ej(p),(0|(t=0|i[(e=p)>>2]))==0&(0|(e=0|i[e+4>>2]))==0){if(e6(r),(0|(e=0|i[(t=r)>>2]))==0&(0|(t=0|i[t+4>>2]))==0){m=10;break}eH(e,t,0|i[A>>2],p),t=0|i[(e=p)>>2],e=0|i[e+4>>2]}i[(h=g)>>2]=t,i[h+4>>2]=e}while(!((0|t)==0&(0|e)==0))return(0|m)==4?(0|(t=0|i[(e=g+40|0)>>2])&&tg(t),i[(m=g+16|0)>>2]=0,i[m+4>>2]=0,i[d>>2]=0,i[g+36>>2]=0,i[A>>2]=-1,i[g+32>>2]=0,i[e>>2]=0,eH(0,0,0,p),i[g>>2]=0,i[g+4>>2]=0,i[f>>2]=0,g=14):((0|m)==10&&(i[g>>2]=0,i[g+4>>2]=0,i[f>>2]=i[d>>2]),g=0|i[f>>2]),I=y,0|g},_readInt64AsDoubleFromPointer:function(e){return+(+((0|i[(e|=0)>>2])>>>0)+0x100000000*(0|i[e+4>>2]))},_res0CellCount:function(){return 122},_round:tF,_sbrk:tU,_sizeOfCellBoundary:function(){return 168},_sizeOfCoordIJ:function(){return 8},_sizeOfGeoLoop:function(){return 8},_sizeOfGeoPolygon:function(){return 16},_sizeOfH3Index:function(){return 8},_sizeOfLatLng:function(){return 16},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompactCells:function(e,t,r,n,a,s,o){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,o|=0;var l=0,u=0,c=0,h=0,d=0,A=0,p=0,f=0,m=0;if(m=I,I=I+16|0,f=m,!((0|r)>0|(0|r)==0&t>>>0>0))return f=0,I=m,0|f;if((0|o)>=16)return f=12,I=m,0|f;A=0,p=0,d=0,l=0;e:for(;;){if(h=0|tR(0|(u=0|i[(c=e+(A<<3)|0)>>2]),0|(c=0|i[c+4>>2]),52),w(),(15&h)>(0|o)){l=12,u=11;break}if(eG(f,u,c,o),(0|(c=0|i[(h=f)>>2]))==0&(0|(h=0|i[h+4>>2]))==0)u=d;else{u=d;do{if(!((0|l)<(0|s)|(0|l)==(0|s)&u>>>0<a>>>0)){u=10;break e}i[(d=n+(u<<3)|0)>>2]=c,i[d+4>>2]=h,u=0|tv(0|u,0|l,1,0),l=0|w(),ej(f),c=0|i[(d=f)>>2],h=0|i[d+4>>2]}while(!((0|c)==0&(0|h)==0))}if(A=0|tv(0|A,0|p,1,0),(0|(p=0|w()))<(0|r)|(0|p)==(0|r)&A>>>0<t>>>0)d=u;else{l=0,u=11;break}}return(0|u)==10?(f=14,I=m,0|f):(0|u)==11?(I=m,0|l):0},_uncompactCellsSize:function(e,t,r,n,a){e|=0,t|=0,r|=0,n|=0,a|=0;var s=0,o=0,l=0,u=0,c=0,h=0,d=0,A=0;A=I,I=I+16|0,d=A;e:do{if((0|r)>0|(0|r)==0&t>>>0>0){for(c=0,o=0,s=0,h=0;;){if(!((0|(l=0|i[(u=e+(c<<3)|0)>>2]))==0&(0|(u=0|i[u+4>>2]))==0)&&(u=(0|eR(l,u,n,d))==0,o=0|tv(0|i[(l=d)>>2],0|i[l+4>>2],0|o,0|s),s=0|w(),!u)){s=12;break}if(c=0|tv(0|c,0|h,1,0),!((0|(h=0|w()))<(0|r)|(0|h)==(0|r)&c>>>0<t>>>0))break e}return I=A,0|s}o=0,s=0}while(0)return i[a>>2]=o,i[a+4>>2]=s,a=0,I=A,0|a},_vertexToLatLng:function(e,t,r){e|=0,t|=0,r|=0;var n=0,a=0,s=0,o=0,l=0,u=0;return(u=I,I=I+192|0,a=u,s=u+168|0,o=0|tR(0|e,0|t,56),w(),o&=7,0|(n=0|ek(e,l=-0x7f000001&t|0x8000000,s)))?l=n:(t=0|tR(0|e,0|t,52),w(),t&=15,0|eC(e,l)?ev(s,t,o,1,a):eb(s,t,o,1,a),l=a+8|0,i[r>>2]=i[l>>2],i[r+4>>2]=i[l+4>>2],i[r+8>>2]=i[l+8>>2],i[r+12>>2]=i[l+12>>2],l=0),I=u,0|l},establishStackSpace:function(e,t){e|=0,I=e},stackAlloc:function(e){e|=0;var t=0;return t=I,I=(I=I+e|0)+15&-16,0|t},stackRestore:function(e){e|=0,I=e},stackSave:function(){return 0|I}}}({Math:Math,Int8Array:Int8Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Float32Array:Float32Array,Float64Array:Float64Array},{a:ei,b:function(e){v=e},c:function(){return v},d:function(e,t,r,n){ei("Assertion failed: "+S(e)+", at: "+[t?S(t):"unknown filename",r,n?S(n):"unknown function"])},e:function(e){return A.___errno_location&&(o[A.___errno_location()>>2]=e),e},f:G,g:function(e,t,r){a.set(a.subarray(t,t+r),e)},h:function(e){var t=G();if(e>0x7f000000)return!1;for(var r=Math.max(t,0x1000000);r<e;)r=r<=0x20000000?T(2*r,0x1000000):Math.min(T((3*r+0x80000000)/4,0x1000000),0x7f000000);return!!H(r)},i:function(e){ei("OOM")},j:function(e){return e},k:V,l:H,m:q,n:function(){var e=q();return A.extraStackTrace&&(e+="\n"+A.extraStackTrace()),V(e)},o:28624,p:28608},n);A.___divdi3=X.___divdi3,A.___muldi3=X.___muldi3,A.___remdi3=X.___remdi3,A.___uremdi3=X.___uremdi3,A._areNeighborCells=X._areNeighborCells,A._bitshift64Ashr=X._bitshift64Ashr,A._bitshift64Lshr=X._bitshift64Lshr,A._bitshift64Shl=X._bitshift64Shl,A._calloc=X._calloc,A._cellAreaKm2=X._cellAreaKm2,A._cellAreaM2=X._cellAreaM2,A._cellAreaRads2=X._cellAreaRads2,A._cellToBoundary=X._cellToBoundary,A._cellToCenterChild=X._cellToCenterChild,A._cellToChildPos=X._cellToChildPos,A._cellToChildren=X._cellToChildren,A._cellToChildrenSize=X._cellToChildrenSize,A._cellToLatLng=X._cellToLatLng,A._cellToLocalIj=X._cellToLocalIj,A._cellToParent=X._cellToParent,A._cellToVertex=X._cellToVertex,A._cellToVertexes=X._cellToVertexes,A._cellsToDirectedEdge=X._cellsToDirectedEdge,A._cellsToLinkedMultiPolygon=X._cellsToLinkedMultiPolygon,A._childPosToCell=X._childPosToCell,A._compactCells=X._compactCells,A._destroyLinkedMultiPolygon=X._destroyLinkedMultiPolygon,A._directedEdgeToBoundary=X._directedEdgeToBoundary,A._directedEdgeToCells=X._directedEdgeToCells,A._edgeLengthKm=X._edgeLengthKm,A._edgeLengthM=X._edgeLengthM,A._edgeLengthRads=X._edgeLengthRads;var Q=A._emscripten_replace_memory=X._emscripten_replace_memory;A._free=X._free,A._getBaseCellNumber=X._getBaseCellNumber,A._getDirectedEdgeDestination=X._getDirectedEdgeDestination,A._getDirectedEdgeOrigin=X._getDirectedEdgeOrigin,A._getHexagonAreaAvgKm2=X._getHexagonAreaAvgKm2,A._getHexagonAreaAvgM2=X._getHexagonAreaAvgM2,A._getHexagonEdgeLengthAvgKm=X._getHexagonEdgeLengthAvgKm,A._getHexagonEdgeLengthAvgM=X._getHexagonEdgeLengthAvgM,A._getIcosahedronFaces=X._getIcosahedronFaces,A._getNumCells=X._getNumCells,A._getPentagons=X._getPentagons,A._getRes0Cells=X._getRes0Cells,A._getResolution=X._getResolution,A._greatCircleDistanceKm=X._greatCircleDistanceKm,A._greatCircleDistanceM=X._greatCircleDistanceM,A._greatCircleDistanceRads=X._greatCircleDistanceRads,A._gridDisk=X._gridDisk,A._gridDiskDistances=X._gridDiskDistances,A._gridDistance=X._gridDistance,A._gridPathCells=X._gridPathCells,A._gridPathCellsSize=X._gridPathCellsSize,A._gridRing=X._gridRing,A._gridRingUnsafe=X._gridRingUnsafe,A._i64Add=X._i64Add,A._i64Subtract=X._i64Subtract,A._isPentagon=X._isPentagon,A._isResClassIII=X._isResClassIII,A._isValidCell=X._isValidCell,A._isValidDirectedEdge=X._isValidDirectedEdge,A._isValidVertex=X._isValidVertex,A._latLngToCell=X._latLngToCell,A._llvm_ctlz_i64=X._llvm_ctlz_i64,A._llvm_maxnum_f64=X._llvm_maxnum_f64,A._llvm_minnum_f64=X._llvm_minnum_f64,A._llvm_round_f64=X._llvm_round_f64,A._localIjToCell=X._localIjToCell,A._malloc=X._malloc,A._maxFaceCount=X._maxFaceCount,A._maxGridDiskSize=X._maxGridDiskSize,A._maxPolygonToCellsSize=X._maxPolygonToCellsSize,A._maxPolygonToCellsSizeExperimental=X._maxPolygonToCellsSizeExperimental,A._memcpy=X._memcpy,A._memset=X._memset,A._originToDirectedEdges=X._originToDirectedEdges,A._pentagonCount=X._pentagonCount,A._polygonToCells=X._polygonToCells,A._polygonToCellsExperimental=X._polygonToCellsExperimental,A._readInt64AsDoubleFromPointer=X._readInt64AsDoubleFromPointer,A._res0CellCount=X._res0CellCount,A._round=X._round,A._sbrk=X._sbrk,A._sizeOfCellBoundary=X._sizeOfCellBoundary,A._sizeOfCoordIJ=X._sizeOfCoordIJ,A._sizeOfGeoLoop=X._sizeOfGeoLoop,A._sizeOfGeoPolygon=X._sizeOfGeoPolygon,A._sizeOfH3Index=X._sizeOfH3Index,A._sizeOfLatLng=X._sizeOfLatLng,A._sizeOfLinkedGeoPolygon=X._sizeOfLinkedGeoPolygon,A._uncompactCells=X._uncompactCells,A._uncompactCellsSize=X._uncompactCellsSize,A._vertexToLatLng=X._vertexToLatLng,A.establishStackSpace=X.establishStackSpace;var Y=A.stackAlloc=X.stackAlloc,K=A.stackRestore=X.stackRestore,Z=A.stackSave=X.stackSave;if(A.asm=X,A.cwrap=function(e,t,r,n){var s=(r=r||[]).every(function(e){return"number"===e});return"string"!==t&&s&&!n?_(e):function(){return function(e,t,r,n,s){var o,l={string:function(e){var t=0;if(null!=e&&0!==e){var r=(e.length<<2)+1;!function(e,t,r){var n=a,i=t;if(r>0){for(var s=i+r-1,o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l>=55296&&l<=57343&&(l=65536+((1023&l)<<10)|1023&e.charCodeAt(++o)),l<=127){if(i>=s)break;n[i++]=l}else if(l<=2047){if(i+1>=s)break;n[i++]=192|l>>6,n[i++]=128|63&l}else if(l<=65535){if(i+2>=s)break;n[i++]=224|l>>12,n[i++]=128|l>>6&63,n[i++]=128|63&l}else{if(i+3>=s)break;n[i++]=240|l>>18,n[i++]=128|l>>12&63,n[i++]=128|l>>6&63,n[i++]=128|63&l}}n[i]=0}}(e,t=Y(r),r)}return t},array:function(e){var t,r,n=Y(e.length);return t=e,r=n,i.set(t,r),n}},u=_(e),c=[],h=0;if(n)for(var d=0;d<n.length;d++){var A=l[r[d]];A?(0===h&&(h=Z()),c[d]=A(n[d])):c[d]=n[d]}var p=u.apply(null,c);return o=p,p="string"===t?S(o):"boolean"===t?!!o:o,0!==h&&K(h),p}(e,t,r,arguments,0)}},A.setValue=function(e,t,r,n){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":i[0|e]=t;break;case"i16":s[e>>1]=t;break;case"i32":o[e>>2]=t;break;case"i64":h=[t>>>0,+I(c=t)>=1?c>0?(0|B(+D(c/0x100000000),0xffffffff))>>>0:~~L((c-(~~c>>>0))/0x100000000)>>>0:0],o[e>>2]=h[0],o[e+4>>2]=h[1];break;case"float":l[e>>2]=t;break;case"double":u[e>>3]=t;break;default:ei("invalid type for setValue: "+r)}},A.getValue=function(e,t,r){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return i[0|e];case"i16":return s[e>>1];case"i32":case"i64":return o[e>>2];case"float":return l[e>>2];case"double":return u[e>>3];default:ei("invalid type for getValue: "+t)}return null},O){z(O)||(J=O,O=A.locateFile?A.locateFile(J,m):m+J),F++,A.monitorRunDependencies&&A.monitorRunDependencies(F);var J,$=function(e){e.byteLength&&(e=new Uint8Array(e)),a.set(e,8),A.memoryInitializerRequest&&delete A.memoryInitializerRequest.response;if(F--,A.monitorRunDependencies&&A.monitorRunDependencies(F),0==F&&U){var t=U;U=null,t()}},ee=function(){r(O,$,function(){throw"could not load memory initializer "+O})},et=W(O);if(et)$(et.buffer);else if(A.memoryInitializerRequest){var er=function(){var e=A.memoryInitializerRequest,t=e.response;if(200!==e.status&&0!==e.status){var r=W(A.memoryInitializerRequestURL);if(r)t=r.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+O),ee();return}}$(t)};A.memoryInitializerRequest.response?setTimeout(er,0):A.memoryInitializerRequest.addEventListener("load",er)}else ee()}function en(e){if(e=e||f,!(F>0)){if(A.preRun)for("function"==typeof A.preRun&&(A.preRun=[A.preRun]);A.preRun.length;){var t;t=A.preRun.shift(),R.unshift(t)}E(R),F>0||(A.setStatus?(A.setStatus("Running..."),setTimeout(function(){setTimeout(function(){A.setStatus("")},1),r()},1)):r())}function r(){if(!d&&(d=!0,!x)){if(E(C),E(N),A.onRuntimeInitialized&&A.onRuntimeInitialized(),A.postRun)for("function"==typeof A.postRun&&(A.postRun=[A.postRun]);A.postRun.length;){var e;e=A.postRun.shift(),P.unshift(e)}E(P)}}}function ei(e){throw A.onAbort&&A.onAbort(e),g(e+=""),y(e),x=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(U=function e(){d||en(),d||(U=e)},A.run=en,A.abort=ei,A.preInit)for("function"==typeof A.preInit&&(A.preInit=[A.preInit]);A.preInit.length>0;)A.preInit.pop()();return en(),e}("object"==typeof gM?gM:{}),gE="number",gR={};gR[0]="Success",gR[1]="The operation failed but a more specific error is not available",gR[2]="Argument was outside of acceptable range",gR[3]="Latitude or longitude arguments were outside of acceptable range",gR[4]="Resolution argument was outside of acceptable range",gR[5]="Cell argument was not valid",gR[6]="Directed edge argument was not valid",gR[7]="Undirected edge argument was not valid",gR[8]="Vertex argument was not valid",gR[9]="Pentagon distortion was encountered",gR[10]="Duplicate input",gR[11]="Cell arguments were not neighbors",gR[12]="Cell arguments had incompatible resolutions",gR[13]="Memory allocation failed",gR[14]="Bounds of provided memory were insufficient",gR[15]="Mode or flags argument was not valid";var gC={};function gN(e,t,r){var n=r&&"value"in r,i=Error((e[t]||"Unknown error")+" (code: "+t+(n?", value: "+r.value:"")+")");return i.code=t,i}function gP(e,t){var r=2==arguments.length?{value:t}:{};return gN(gR,e,r)}function gI(e,t){var r=2==arguments.length?{value:t}:{};return gN(gC,e,r)}function gL(e){if(0!==e)throw gP(e)}gC[1e3]="Unknown unit",gC[1001]="Array length out of bounds",gC[1002]="Got unexpected null value for H3 index";var gD={};[["sizeOfH3Index",gE],["sizeOfLatLng",gE],["sizeOfCellBoundary",gE],["sizeOfGeoLoop",gE],["sizeOfGeoPolygon",gE],["sizeOfLinkedGeoPolygon",gE],["sizeOfCoordIJ",gE],["readInt64AsDoubleFromPointer",gE],["isValidCell",gE,[gE,gE]],["latLngToCell",gE,[gE,gE,gE,gE]],["cellToLatLng",gE,[gE,gE,gE]],["cellToBoundary",gE,[gE,gE,gE]],["maxGridDiskSize",gE,[gE,gE]],["gridDisk",gE,[gE,gE,gE,gE]],["gridDiskDistances",gE,[gE,gE,gE,gE,gE]],["gridRing",gE,[gE,gE,gE,gE]],["gridRingUnsafe",gE,[gE,gE,gE,gE]],["maxPolygonToCellsSize",gE,[gE,gE,gE,gE]],["polygonToCells",gE,[gE,gE,gE,gE]],["maxPolygonToCellsSizeExperimental",gE,[gE,gE,gE,gE]],["polygonToCellsExperimental",gE,[gE,gE,gE,gE,gE,gE]],["cellsToLinkedMultiPolygon",gE,[gE,gE,gE]],["destroyLinkedMultiPolygon",null,[gE]],["compactCells",gE,[gE,gE,gE,gE]],["uncompactCells",gE,[gE,gE,gE,gE,gE,gE]],["uncompactCellsSize",gE,[gE,gE,gE,gE,gE]],["isPentagon",gE,[gE,gE]],["isResClassIII",gE,[gE,gE]],["getBaseCellNumber",gE,[gE,gE]],["getResolution",gE,[gE,gE]],["maxFaceCount",gE,[gE,gE,gE]],["getIcosahedronFaces",gE,[gE,gE,gE]],["cellToParent",gE,[gE,gE,gE,gE]],["cellToChildren",gE,[gE,gE,gE,gE]],["cellToCenterChild",gE,[gE,gE,gE,gE]],["cellToChildrenSize",gE,[gE,gE,gE,gE]],["cellToChildPos",gE,[gE,gE,gE,gE]],["childPosToCell",gE,[gE,gE,gE,gE,gE,gE]],["areNeighborCells",gE,[gE,gE,gE,gE,gE]],["cellsToDirectedEdge",gE,[gE,gE,gE,gE,gE]],["getDirectedEdgeOrigin",gE,[gE,gE,gE]],["getDirectedEdgeDestination",gE,[gE,gE,gE]],["isValidDirectedEdge",gE,[gE,gE]],["directedEdgeToCells",gE,[gE,gE,gE]],["originToDirectedEdges",gE,[gE,gE,gE]],["directedEdgeToBoundary",gE,[gE,gE,gE]],["gridDistance",gE,[gE,gE,gE,gE,gE]],["gridPathCells",gE,[gE,gE,gE,gE,gE]],["gridPathCellsSize",gE,[gE,gE,gE,gE,gE]],["cellToLocalIj",gE,[gE,gE,gE,gE,gE,gE]],["localIjToCell",gE,[gE,gE,gE,gE,gE]],["getHexagonAreaAvgM2",gE,[gE,gE]],["getHexagonAreaAvgKm2",gE,[gE,gE]],["getHexagonEdgeLengthAvgM",gE,[gE,gE]],["getHexagonEdgeLengthAvgKm",gE,[gE,gE]],["greatCircleDistanceM",gE,[gE,gE]],["greatCircleDistanceKm",gE,[gE,gE]],["greatCircleDistanceRads",gE,[gE,gE]],["cellAreaM2",gE,[gE,gE,gE]],["cellAreaKm2",gE,[gE,gE,gE]],["cellAreaRads2",gE,[gE,gE,gE]],["edgeLengthM",gE,[gE,gE,gE]],["edgeLengthKm",gE,[gE,gE,gE]],["edgeLengthRads",gE,[gE,gE,gE]],["getNumCells",gE,[gE,gE]],["getRes0Cells",gE,[gE]],["res0CellCount",gE],["getPentagons",gE,[gE,gE]],["pentagonCount",gE],["cellToVertex",gE,[gE,gE,gE,gE]],["cellToVertexes",gE,[gE,gE,gE]],["vertexToLatLng",gE,[gE,gE,gE]],["isValidVertex",gE,[gE,gE]]].forEach(function(e){gD[e[0]]=gM.cwrap.apply(gM,e)});var gB=gD.sizeOfH3Index(),gF=gD.sizeOfLatLng(),gU=gD.sizeOfCellBoundary(),gO=gD.sizeOfGeoPolygon(),gk=gD.sizeOfGeoLoop();gD.sizeOfLinkedGeoPolygon(),gD.sizeOfCoordIJ();var gz=/[^0-9a-fA-F]/;function gV(e){if(Array.isArray(e)&&2===e.length&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if("string"!=typeof e||gz.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),16);return[parseInt(e.substring(e.length-8),16),t]}function gq(e){if(e>=0)return e.toString(16);var t=gG(8,(e&=0x7fffffff).toString(16));return(parseInt(t[0],16)+8).toString(16)+t.substring(1)}function gG(e,t){for(var r=e-t.length,n="",i=0;i<r;i++)n+="0";return n+t}function gH(e,t,r){for(var n=e.length,i=gM._calloc(n,gF),a=+!!r,s=+!r,o=0;o<2*n;o+=2)gM.HEAPF64.set([e[o/2][a],e[o/2][s]].map(gJ),i/8+o);return gM.HEAPU32.set([n,i],t/4),t}function gj(e,t){void 0===t&&(t=0);var r=gM.getValue(e+gB*t,"i32"),n=gM.getValue(e+gB*t+4,"i32");return n?gq(n)+gG(8,gq(r)):null}function gW(e){return 180*gM.getValue(e,"double")/Math.PI}function gX(e){return[gW(e),gW(e+8)]}function gQ(e){return[gW(e+8),gW(e)]}function gY(e){var t=gM._malloc(gF),r=gV(e),n=r[0],i=r[1];try{return gL(gD.cellToLatLng(n,i,t)),gX(t)}finally{gM._free(t)}}function gK(e,t){var r=gM._malloc(gU),n=gV(e),i=n[0],a=n[1];try{return gL(gD.cellToBoundary(i,a,r)),function(e,t,r){for(var n=gM.getValue(e,"i32"),i=e+8,a=[],s=t?gQ:gX,o=0;o<2*n;o+=2)a.push(s(i+8*o));return r&&a.push(a[0]),a}(r,t,t)}finally{gM._free(r)}}function gZ(e,t,r){if(!function(e){if("number"!=typeof e||e<0||e>15||Math.floor(e)!==e)throw gP(4,e)}(t),r=!!r,0===e.length||0===e[0].length)return[];var n=function(e,t){var r,n=e.length-1,i=gM._calloc(gO),a=0+gk;if(gH(e[0],i+0,t),n>0){r=gM._calloc(n,gk);for(var s=0;s<n;s++)gH(e[s+1],r+gk*s,t)}return gM.setValue(i+a,n,"i32"),gM.setValue(i+(a+4),r,"i32"),i}("number"==typeof e[0][0]?[e]:e,r),i=gM._malloc(8);try{gL(gD.maxPolygonToCellsSize(n,t,0,i));var a=function(e){if(e>0xffffffff)throw gI(1001,e);return e}(gD.readInt64AsDoubleFromPointer(i)),s=gM._calloc(a,gB);try{gL(gD.polygonToCells(n,t,0,s));for(var o=[],l=0;l<a;l++){var u=gj(s,l);null!==u&&o.push(u)}return o}finally{gM._free(s)}}finally{gM._free(i);var c=0+gk;gM._free(gM.getValue(n+0+4,"i8*"));var h=gM.getValue(n+c,"i32");if(h>0){for(var d=gM.getValue(n+(c+4),"i32"),A=0;A<h;A++)gM._free(gM.getValue(d+gk*A+4,"i8*"));gM._free(d)}gM._free(n)}}function gJ(e){return e*Math.PI/180}let g$=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],g0=new WeakMap;class g1{firstInitialization(e){return!1===this.renderObjects.has(e)&&(this.getRenderObjectData(e),!0)}needsVelocity(e){let t=e.getMRT();return null!==t&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(void 0===t){let{geometry:r,material:n,object:i}=e;if(t={material:this.getMaterialData(n),geometry:{id:r.id,attributes:this.getAttributesData(r.attributes),indexVersion:r.index?r.index.version:null,drawRange:{start:r.drawRange.start,count:r.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),null!==e.bundle&&(t.version=e.bundle.version),t.material.transmission>0){let{width:r,height:n}=e.context;t.bufferWidth=r,t.bufferHeight=n}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){let t={};for(let r in e){let n=e[r];t[r]={version:n.version}}return t}containsNode(e){let t=e.material;for(let e in t)if(t[e]&&t[e].isNode)return!0;return null!==e.renderer.overrideNodes.modelViewMatrix||null!==e.renderer.overrideNodes.modelNormalViewMatrix}getMaterialData(e){let t={};for(let r of this.refreshUniforms){let n=e[r];null!=n&&("object"==typeof n&&void 0!==n.clone?!0===n.isTexture?t[r]={id:n.id,version:n.version}:t[r]=n.clone():t[r]=n)}return t}equals(e,t){let{object:r,material:n,geometry:i}=e,a=this.getRenderObjectData(e);if(!0!==a.worldMatrix.equals(r.matrixWorld))return a.worldMatrix.copy(r.matrixWorld),!1;let s=a.material;for(let e in s){let t=s[e],r=n[e];if(void 0!==t.equals){if(!1===t.equals(r))return t.copy(r),!1}else if(!0===r.isTexture){if(t.id!==r.id||t.version!==r.version)return t.id=r.id,t.version=r.version,!1}else if(t!==r)return s[e]=r,!1}if(s.transmission>0){let{width:t,height:r}=e.context;if(a.bufferWidth!==t||a.bufferHeight!==r)return a.bufferWidth=t,a.bufferHeight=r,!1}let o=a.geometry,l=i.attributes,u=o.attributes,c=Object.keys(u),h=Object.keys(l);if(o.id!==i.id)return o.id=i.id,!1;if(c.length!==h.length)return a.geometry.attributes=this.getAttributesData(l),!1;for(let e of c){let t=u[e],r=l[e];if(void 0===r)return delete u[e],!1;if(t.version!==r.version)return t.version=r.version,!1}let d=i.index,A=o.indexVersion,p=d?d.version:null;if(A!==p)return o.indexVersion=p,!1;if(o.drawRange.start!==i.drawRange.start||o.drawRange.count!==i.drawRange.count)return o.drawRange.start=i.drawRange.start,o.drawRange.count=i.drawRange.count,!1;if(a.morphTargetInfluences){let e=!1;for(let t=0;t<a.morphTargetInfluences.length;t++)a.morphTargetInfluences[t]!==r.morphTargetInfluences[t]&&(e=!0);if(e)return!0}if(a.lights){for(let e=0;e<t.length;e++)if(a.lights[e].map!==t[e].map)return!1}return a.center&&!1===a.center.equals(r.center)?a.center.copy(r.center):null!==e.bundle&&(a.version=e.bundle.version),!0}getLightsData(e){let t=[];for(let r of e)!0===r.isSpotLight&&null!==r.map&&t.push({map:r.map.version});return t}getLights(e,t){if(g0.has(e)){let r=g0.get(e);if(r.renderId===t)return r.lightsData}let r=this.getLightsData(e.getLights());return g0.set(e,{renderId:t,lightsData:r}),r}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;let{renderId:r}=t;if(this.renderId!==r)return this.renderId=r,!0;let n=!0===e.object.static,i=null!==e.bundle&&!0===e.bundle.static&&this.getRenderObjectData(e).version===e.bundle.version;if(n||i)return!1;let a=this.getLights(e.lightsNode,r);return!0!==this.equals(e,a)}constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=!0===e.object.isSkinnedMesh,this.refreshUniforms=g$,this.renderId=0}}function g2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0xdeadbeef^t,n=0x41c6ce57^t;if(e instanceof Array)for(let t=0,i;t<e.length;t++)r=Math.imul(r^(i=e[t]),0x9e3779b1),n=Math.imul(n^i,0x5f356495);else for(let t=0,i;t<e.length;t++)r=Math.imul(r^(i=e.charCodeAt(t)),0x9e3779b1),n=Math.imul(n^i,0x5f356495);return r=Math.imul(r^r>>>16,0x85ebca6b)^Math.imul(n^n>>>13,0xc2b2ae35),0x100000000*(2097151&(n=Math.imul(n^n>>>16,0x85ebca6b)^Math.imul(r^r>>>13,0xc2b2ae35)))+(r>>>0)}let g3=e=>g2(e),g4=e=>g2(e),g5=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return g2(t)};function g6(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];for(let{property:n,childNode:i}of(!0===e.isNode&&r.push(e.id),g7(e)))r.push(g2(n.slice(0,-4)),i.getCacheKey(t));return g2(r)}function*g7(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let r of Object.getOwnPropertyNames(e)){if(!0===r.startsWith("_"))continue;let n=e[r];if(!0===Array.isArray(n))for(let e=0;e<n.length;e++){let i=n[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:r,index:e,childNode:i})}else if(n&&!0===n.isNode)yield{property:r,childNode:n};else if(n&&Object.getPrototypeOf(n)===Object.prototype)for(let e in n){if(!0===e.startsWith("_"))continue;let i=n[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:r,index:e,childNode:i})}}}let g8=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),g9=new WeakMap;function ye(e){if(/[iu]?vec\d/.test(e))return e.startsWith("ivec")?Int32Array:e.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(e)||/float/.test(e))return Float32Array;if(/uint/.test(e))return Uint32Array;if(/int/.test(e))return Int32Array;throw Error("THREE.NodeUtils: Unsupported type: ".concat(e))}function yt(e){return/float|int|uint/.test(e)?1:/vec2/.test(e)?2:/vec3/.test(e)?3:/vec4/.test(e)||/mat2/.test(e)?4:/mat3/.test(e)?9:/mat4/.test(e)?16:void console.error("THREE.TSL: Unsupported type:",e)}function yr(e){if(null==e)return null;let t=typeof e;if(!0===e.isNode)return"node";if("number"===t)return"float";if("boolean"===t)return"bool";if("string"===t)return"string";if("function"===t)return"shader";else if(!0===e.isVector2)return"vec2";else if(!0===e.isVector3)return"vec3";else if(!0===e.isVector4)return"vec4";else if(!0===e.isMatrix2)return"mat2";else if(!0===e.isMatrix3)return"mat3";else if(!0===e.isMatrix4)return"mat4";else if(!0===e.isColor)return"color";else if(e instanceof ArrayBuffer)return"ArrayBuffer";return null}function yn(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let i=e?e.slice(-4):void 0;if(1===r.length&&("vec2"===i?r=[r[0],r[0]]:"vec3"===i?r=[r[0],r[0],r[0]]:"vec4"===i&&(r=[r[0],r[0],r[0],r[0]])),"color"===e)return new t6(...r);if("vec2"===i)return new ey(...r);if("vec3"===i)return new ex(...r);if("vec4"===i)return new eH(...r);if("mat2"===i)return new oO(...r);else if("mat3"===i)return new eS(...r);else if("mat4"===i)return new tp(...r);else if("bool"===e)return r[0]||!1;else if("float"===e||"int"===e||"uint"===e)return r[0]||0;else if("string"===e)return r[0]||"";else if("ArrayBuffer"===e)return ys(r[0]);return null}function yi(e){let t=g9.get(e);return void 0===t&&(t={},g9.set(e,t)),t}function ya(e){let t="",r=new Uint8Array(e);for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return btoa(t)}function ys(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0)).buffer}let yo={VERTEX:"vertex",FRAGMENT:"fragment"},yl={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},yu={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},yc=["fragment","vertex"],yh=["setup","analyze","generate"],yd=[...yc,"compute"],yA=["x","y","z","w"],yp={analyze:"setup",generate:"analyze"},yf=0;class ym extends es{static get type(){return"Node"}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,yl.FRAME)}onRenderUpdate(e){return this.onUpdate(e,yl.RENDER)}onObjectUpdate(e){return this.onUpdate(e,yl.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(let{childNode:e}of g7(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){for(let t of(e(this),this.getChildren()))t.traverse(e)}getCacheKey(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!0===(e=e||this.version!==this._cacheKeyVersion)||null===this._cacheKey)&&(this._cacheKey=g5(g6(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){let t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){let t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){let t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){let t=e.getNodeProperties(this),r=0;for(let e of this.getChildren())t["node"+r++]=e;return t.outputNode||null}analyze(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.increaseUsage(this);if(!0===this.parents){let r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(1===r)for(let t of Object.values(e.getNodeProperties(this)))t&&!0===t.isNode&&t.build(e,this)}generate(e,t){let{outputNode:r}=e.getNodeProperties(this);if(r&&!0===r.isNode)return r.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getShared(e);if(this!==r)return r.build(e,t);let n=e.getDataFromNode(this);n.buildStages=n.buildStages||{},n.buildStages[e.buildStage]=!0;let i=yp[e.buildStage];if(i&&!0!==n.buildStages[i]){let t=e.getBuildStage();e.setBuildStage(i),this.build(e),e.setBuildStage(t)}e.addNode(this),e.addChain(this);let a=null,s=e.getBuildStage();if("setup"===s){this.updateReference(e);let t=e.getNodeProperties(this);if(!0!==t.initialized){for(let r of(t.initialized=!0,t.outputNode=this.setup(e)||t.outputNode||null,Object.values(t)))if(r&&!0===r.isNode){if(!0===r.parents){let t=e.getNodeProperties(r);t.parents=t.parents||[],t.parents.push(this)}r.build(e)}}a=t.outputNode}else if("analyze"===s)this.analyze(e,t);else if("generate"===s){if(1===this.generate.length){let r=this.getNodeType(e),n=e.getDataFromNode(this);void 0===(a=n.snippet)?void 0===n.generated?(n.generated=!0,n.snippet=a=this.generate(e)||""):(console.warn("THREE.Node: Recursion detected.",this),a="/* Recursion detected. */"):void 0!==n.flowCodes&&void 0!==e.context.nodeBlock&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),a=e.format(a,r,t)}else a=this.generate(e,t)||"";""===a&&null!==t&&"void"!==t&&"OutputType"!==t&&(console.error('THREE.TSL: Invalid generated code, expected a "'.concat(t,'".')),a=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),a}getSerializeChildren(){return g7(this)}serialize(e){let t=this.getSerializeChildren(),r={};for(let{property:n,index:i,childNode:a}of t)void 0!==i?(void 0===r[n]&&(r[n]=Number.isInteger(i)?[]:{}),r[n][i]=a.toJSON(e.meta).uuid):r[n]=a.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(void 0!==e.inputNodes){let t=e.meta.nodes;for(let r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){let n=[];for(let i of e.inputNodes[r])n.push(t[i]);this[r]=n}else if("object"==typeof e.inputNodes[r]){let n={};for(let i in e.inputNodes[r]){let a=e.inputNodes[r][i];n[i]=t[a]}this[r]=n}else{let n=e.inputNodes[r];this[r]=t[n]}}}toJSON(e){let{uuid:t,type:r}=this,n=void 0===e||"string"==typeof e;n&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];function a(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}if(void 0===i&&(i={uuid:t,type:r,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},!0!==n&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta),n){let t=a(e.textures),r=a(e.images),n=a(e.nodes);t.length>0&&(i.textures=t),r.length>0&&(i.images=r),n.length>0&&(i.nodes=n)}return i}constructor(e=null){super(),this.nodeType=e,this.updateType=yl.NONE,this.updateBeforeType=yl.NONE,this.updateAfterType=yl.NONE,this.uuid=eg.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:yf++})}}class yg extends ym{static get type(){return"ArrayElementNode"}getNodeType(e){return this.node.getElementType(e)}generate(e){let t=this.indexNode.getNodeType(e),r=this.node.build(e),n=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return"".concat(r,"[ ").concat(n," ]")}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}}class yy extends ym{static get type(){return"ConvertNode"}getNodeType(e){let t=this.node.getNodeType(e),r=null;for(let n of this.convertTo.split("|"))(null===r||e.getTypeLength(t)===e.getTypeLength(n))&&(r=n);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){let r=this.node,n=this.getNodeType(e),i=r.build(e,n);return e.format(i,n,t)}constructor(e,t){super(),this.node=e,this.convertTo=t}}class yv extends ym{static get type(){return"TempNode"}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){let r=e.getVectorType(this.getNodeType(e,t)),n=e.getDataFromNode(this);if(void 0!==n.propertyName)return e.format(n.propertyName,r,t);if("void"!==r&&"void"!==t&&this.hasDependencies(e)){let i=super.build(e,r),a=e.getVarFromNode(this,null,r),s=e.getPropertyName(a);return e.addLineFlowCode("".concat(s," = ").concat(i),this),n.snippet=i,n.propertyName=s,e.format(n.propertyName,r,t)}}return super.build(e,t)}constructor(e=null){super(e),this.isTempNode=!0}}class yx extends yv{static get type(){return"JoinNode"}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){let r=this.getNodeType(e),n=e.getTypeLength(r),i=this.nodes,a=e.getComponentType(r),s=[],o=0;for(let t of i){let i;if(o>=n){console.error("THREE.TSL: Length of parameters exceeds maximum length of function '".concat(r,"()' type."));break}let l=t.getNodeType(e),u=e.getTypeLength(l);if(o+u>n&&(console.error("THREE.TSL: Length of '".concat(r,"()' data exceeds maximum length of output type.")),u=n-o,l=e.getTypeFromLength(u)),o+=u,i=t.build(e,l),e.getComponentType(l)!==a){let t=e.getTypeFromLength(u,a);i=e.format(i,l,t)}s.push(i)}let l="".concat(e.getType(r),"( ").concat(s.join(", ")," )");return e.format(l,r,t)}constructor(e=[],t=null){super(t),this.nodes=e}}let y_=yA.join("");class yb extends ym{static get type(){return"SplitNode"}getVectorLength(){let e=this.components.length;for(let t of this.components)e=Math.max(yA.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){let r=this.node,n=e.getTypeLength(r.getNodeType(e)),i=null;if(n>1){let a=null;this.getVectorLength()>=n&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));let s=r.build(e,a);i=this.components.length===n&&this.components===y_.slice(0,this.components.length)?e.format(s,a,t):e.format("".concat(s,".").concat(this.components),this.getNodeType(e),t)}else i=r.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}}class yS extends yv{static get type(){return"SetNode"}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){let{sourceNode:t,components:r,targetNode:n}=this,i=this.getNodeType(e),a=e.getComponentType(n.getNodeType(e)),s=e.getTypeFromLength(r.length,a),o=n.build(e,s),l=t.build(e,i),u=e.getTypeLength(i),c=[];for(let e=0;e<u;e++){let t=yA[e];t===r[0]?(c.push(o),e+=r.length-1):c.push(l+"."+t)}return"".concat(e.getType(i),"( ").concat(c.join(", ")," )")}constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}}class yT extends yv{static get type(){return"FlipNode"}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){let{components:t,sourceNode:r}=this,n=this.getNodeType(e),i=r.build(e),a=e.getVarFromNode(this),s=e.getPropertyName(a);e.addLineFlowCode(s+" = "+i,this);let o=e.getTypeLength(n),l=[],u=0;for(let e=0;e<o;e++){let r=yA[e];r===t[u]?(l.push("1.0 - "+s+"."+r),u++):l.push(s+"."+r)}return"".concat(e.getType(n),"( ").concat(l.join(", ")," )")}constructor(e,t){super(),this.sourceNode=e,this.components=t}}class yw extends ym{static get type(){return"InputNode"}getNodeType(){return null===this.nodeType?yr(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=yr(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=ya(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?yn(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}}let yM=/float|u?int/;class yE extends yw{static get type(){return"ConstNode"}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){let r=this.getNodeType(e);return yM.test(r)&&yM.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),r,t)}constructor(e,t=null){super(e,t),this.isConstNode=!0}}class yR extends ym{static get type(){return"MemberNode"}hasMember(e){return(!this.structNode.isMemberNode||!1!==this.structNode.hasMember(e))&&"void"!==this.structNode.getMemberType(e,this.property)}getNodeType(e){return!1===this.hasMember(e)?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(!1===this.hasMember(e))return"float";let r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}generate(e){if(!1===this.hasMember(e)){console.warn('THREE.TSL: Member "'.concat(this.property,'" does not exist in struct.'));let t=this.getNodeType(e);return e.generateConst(t)}return this.structNode.build(e)+"."+this.property}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}}let yC=null,yN=new Map;function yP(e,t){if(yN.has(e))return void console.warn("THREE.TSL: Redefinition of method chaining '".concat(e,"'."));if("function"!=typeof t)throw Error("THREE.TSL: Node element ".concat(e," is not a function"));yN.set(e,t),"assign"!==e&&(ym.prototype[e]=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.isStackNode?this.add(t(...r)):t(this,...r)},ym.prototype[e+"Assign"]=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.isStackNode?this.assign(r[0],t(...r)):this.assign(t(this,...r))})}let yI=e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w").split("").sort().join("");ym.prototype.assign=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!0!==this.isStackNode)return null!==yC?yC.assign(this,...t):console.error("THREE.TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{let e=yN.get("assign");return this.add(e(...t))}},ym.prototype.toVarIntent=function(){return this},ym.prototype.get=function(e){return new yR(this,e)};let yL={};function yD(e,t,r){yL[e]=yL[t]=yL[r]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new yb(this,e),this._cache[e]=t),t},set(t){this[e].assign(y4(t))}};let n=e.toUpperCase(),i=t.toUpperCase(),a=r.toUpperCase();ym.prototype["set"+n]=ym.prototype["set"+i]=ym.prototype["set"+a]=function(t){return new yS(this,yI(e),y4(t))},ym.prototype["flip"+n]=ym.prototype["flip"+i]=ym.prototype["flip"+a]=function(){return new yT(this,yI(e))}}let yB=["x","y","z","w"],yF=["r","g","b","a"],yU=["s","t","p","q"];for(let e=0;e<4;e++){let t=yB[e],r=yF[e],n=yU[e];yD(t,r,n);for(let i=0;i<4;i++){t=yB[e]+yB[i],yD(t,r=yF[e]+yF[i],n=yU[e]+yU[i]);for(let a=0;a<4;a++){t=yB[e]+yB[i]+yB[a],yD(t,r=yF[e]+yF[i]+yF[a],n=yU[e]+yU[i]+yU[a]);for(let s=0;s<4;s++)t=yB[e]+yB[i]+yB[a]+yB[s],yD(t,r=yF[e]+yF[i]+yF[a]+yF[s],n=yU[e]+yU[i]+yU[a]+yU[s])}}}for(let e=0;e<32;e++)yL[e]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new yg(this,new yE(e,"uint")),this._cache[e]=t),t},set(t){this[e].assign(y4(t))}};Object.defineProperties(ym.prototype,yL);let yO=new WeakMap,yk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=yr(e);if("node"===r);else if(null===t&&("float"===r||"boolean"===r)||r&&"shader"!==r&&"string"!==r)return y4(y$(e,t));else if("shader"===r)return e.isFn?e:vn(e);return e},yz=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(let r in e)e[r]=y4(e[r],t);return e},yV=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.length;for(let n=0;n<r;n++)e[n]=y4(e[n],t);return e},yq=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;function i(e){return null!==n?(e=y4(Object.assign(e,n)),!0===n.intent&&(e=e.toVarIntent())):e=y4(e),e}let a,s=t,o,l;function u(t){let r;return(r=s?/[a-z]/i.test(s)?s+"()":s:e.type,void 0!==o&&t.length<o)?(console.error('THREE.TSL: "'.concat(r,'" parameter length is less than minimum required.')),t.concat(Array(o-t.length).fill(0))):void 0!==l&&t.length>l?(console.error('THREE.TSL: "'.concat(r,'" parameter length exceeds limit.')),t.slice(0,l)):t}return null===t?a=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return i(new e(...y7(u(r))))}:null!==r?(r=y4(r),a=function(){for(var n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];return i(new e(t,...y7(u(a)),r))}):a=function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];return i(new e(t,...y7(u(n))))},a.setParameterLength=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 1===t.length?o=l=t[0]:2===t.length&&([o,l]=t),a},a.setName=e=>(s=e,a),a},yG=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return y4(new e(...y7(r)))};class yH extends ym{getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){var t,r;let{shaderNode:n,rawInputs:i}=this,a=e.getNodeProperties(n),s=e.getClosestSubBuild(n.subBuilds)||"",o=s||"default";if(a[o])return a[o];let l=e.subBuildFn;e.subBuildFn=s;let u=null;if(n.layout){let r=yO.get(e.constructor);void 0===r&&(r=new WeakMap,yO.set(e.constructor,r));let a=r.get(n);void 0===a&&(a=y4(e.buildFunctionNode(n)),r.set(n,a)),e.addInclude(a);let s=i?(y6(t=i),t[0]&&(t[0].isNode||Object.getPrototypeOf(t[0])!==Object.prototype)?[...t]:t[0]):null;u=y4(a.call(s))}else{let t,a=new Proxy(e,{get:(e,t,r)=>Symbol.iterator===t?function*(){yield}:Reflect.get(e,t,r)}),s=i?(t=0,y6(r=i),new Proxy(r,{get:(e,n,i)=>{let a;if("length"===n)return r.length;if(Symbol.iterator===n)a=function*(){for(let e of r)yield y4(e)};else{if(r.length>0)if(Object.getPrototypeOf(r[0])===Object.prototype){let e=r[0];a=void 0===e[n]?e[t++]:Reflect.get(e,n,i)}else r[0]instanceof ym&&(a=void 0===r[n]?r[t++]:Reflect.get(r,n,i));else a=Reflect.get(e,n,i);a=y4(a)}return a}})):null,o=Array.isArray(i)?i.length>0:null!==i,l=n.jsFunc;u=y4(o||l.length>1?l(s,a):l(a))}return e.subBuildFn=l,n.once&&(a[o]=u),u}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){let t=e.getNodeProperties(this),r=e.getSubBuildOutput(this);return t[r]=t[r]||this.setupOutput(e),t[r].subBuild=e.getClosestSubBuild(this),t[r]}build(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=null,n=e.getBuildStage(),i=e.getNodeProperties(this),a=e.getSubBuildOutput(this),s=this.getOutputNode(e);if("setup"===n){let t=e.getSubBuildProperty("initialized",this);if(!0!==i[t]&&(i[t]=!0,i[a]=this.getOutputNode(e),i[a].build(e),this.shaderNode.subBuilds))for(let t of e.chaining){let r=e.getDataFromNode(t,"any");for(let e of(r.subBuilds=r.subBuilds||new Set,this.shaderNode.subBuilds))r.subBuilds.add(e)}r=i[a]}else"analyze"===n?s.build(e,t):"generate"===n&&(r=s.build(e,t)||"");return r}constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}}class yj extends ym{setLayout(e){return this.layout=e,this}call(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return y4(new yH(this,e))}setup(){return this.call()}constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}}let yW=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],yX=new Map;for(let e of[!1,!0])yX.set(e,new yE(e));let yQ=new Map;for(let e of[0,1,2,3])yQ.set(e,new yE(e,"uint"));let yY=new Map([...yQ].map(e=>new yE(e.value,"int")));for(let e of[-1,-2])yY.set(e,new yE(e,"int"));let yK=new Map([...yY].map(e=>new yE(e.value)));for(let e of yW)yK.set(e,new yE(e));for(let e of yW)yK.set(-e,new yE(-e));let yZ={bool:yX,uint:yQ,ints:yY,float:yK},yJ=new Map([...yX,...yK]),y$=(e,t)=>yJ.has(e)?yJ.get(e):!0===e.isNode?e:new yE(e,t),y0=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];for(let t of n)if(void 0===t)return console.error('THREE.TSL: Invalid parameter for the type "'.concat(e,'".')),y4(new yE(0,e));if((0===n.length||!["bool","float","int","uint"].includes(e)&&n.every(e=>{let t=typeof e;return"object"!==t&&"function"!==t}))&&(n=[yn(e,...n)]),1===n.length&&null!==t&&t.has(n[0]))return y5(t.get(n[0]));if(1===n.length){let t=y$(n[0],e);return t.nodeType===e?y5(t):y5(new yy(t,e))}return y5(new yx(n.map(e=>y$(e)),e))}},y1=e=>"object"==typeof e&&null!==e?e.value:e,y2=e=>null!=e?e.nodeType||e.convertTo||("string"==typeof e?e:null):null;function y3(e,t){return new yj(e,t)}let y4=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return yk(e,t)},y5=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return y4(e,t).toVarIntent()},y6=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new yz(e,t)},y7=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new yV(e,t)},y8=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new yq(e,t,r,n)},y9=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new yG(e,...r)},ve=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new yq(e,t,r,{intent:!0,...n})},vt=0;class vr extends ym{setLayout(e){let t=this.shaderNode.nodeType;if("object"!=typeof e.inputs){let r={name:"fn"+vt++,type:t,inputs:[]};for(let t in e)"return"!==t&&r.inputs.push({name:t,type:e[t]});e=r}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=this.shaderNode.call(t);return"void"===this.shaderNode.nodeType&&n.toStack(),n.toVarIntent()}once(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){let t=this.getNodeType(e);return console.error('THREE.TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(t)}constructor(e,t=null){super();let r=null;null!==t&&("object"==typeof t?r=t.return:("string"==typeof t?r=t:console.error("THREE.TSL: Invalid layout type."),t=null)),this.shaderNode=new y3(e,r),null!==t&&this.setLayout(t),this.isFn=!0}}function vn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new vr(e,t);return new Proxy(()=>{},{apply:(e,t,n)=>r.call(...n),get:(e,t,n)=>Reflect.get(r,t,n),set:(e,t,n,i)=>Reflect.set(r,t,n,i)})}let vi=e=>{yC=e},va=()=>yC,vs=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return yC.If(...t)};function vo(e){return yC&&yC.add(e),e}yP("toStack",vo);let vl=new y0("color"),vu=new y0("float",yZ.float),vc=new y0("int",yZ.ints),vh=new y0("uint",yZ.uint),vd=new y0("bool",yZ.bool),vA=new y0("vec2"),vp=new y0("ivec2"),vf=new y0("uvec2"),vm=new y0("bvec2"),vg=new y0("vec3"),vy=new y0("ivec3"),vv=new y0("uvec3"),vx=new y0("bvec3"),v_=new y0("vec4"),vb=new y0("ivec4"),vS=new y0("uvec4"),vT=new y0("bvec4"),vw=new y0("mat2"),vM=new y0("mat3"),vE=new y0("mat4");yP("toColor",vl),yP("toFloat",vu),yP("toInt",vc),yP("toUint",vh),yP("toBool",vd),yP("toVec2",vA),yP("toIVec2",vp),yP("toUVec2",vf),yP("toBVec2",vm),yP("toVec3",vg),yP("toIVec3",vy),yP("toUVec3",vv),yP("toBVec3",vx),yP("toVec4",v_),yP("toIVec4",vb),yP("toUVec4",vS),yP("toBVec4",vT),yP("toMat2",vw),yP("toMat3",vM),yP("toMat4",vE);let vR=y8(yg).setParameterLength(2),vC=(e,t)=>y4(new yy(y4(e),t));yP("element",vR),yP("convert",vC),yP("append",e=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),vo(e)));class vN extends ym{static get type(){return"PropertyNode"}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name)).needsInterpolation=!0:t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}constructor(e,t=null,r=!1){super(e),this.name=t,this.varying=r,this.isPropertyNode=!0,this.global=!0}}let vP=(e,t)=>y4(new vN(e,t)),vI=(e,t)=>y4(new vN(e,t,!0)),vL=y9(vN,"vec4","DiffuseColor"),vD=y9(vN,"vec3","EmissiveColor"),vB=y9(vN,"float","Roughness"),vF=y9(vN,"float","Metalness"),vU=y9(vN,"float","Clearcoat"),vO=y9(vN,"float","ClearcoatRoughness"),vk=y9(vN,"vec3","Sheen"),vz=y9(vN,"float","SheenRoughness"),vV=y9(vN,"float","Iridescence"),vq=y9(vN,"float","IridescenceIOR"),vG=y9(vN,"float","IridescenceThickness"),vH=y9(vN,"float","AlphaT"),vj=y9(vN,"float","Anisotropy"),vW=y9(vN,"vec3","AnisotropyT"),vX=y9(vN,"vec3","AnisotropyB"),vQ=y9(vN,"color","SpecularColor"),vY=y9(vN,"float","SpecularF90"),vK=y9(vN,"float","Shininess"),vZ=y9(vN,"vec4","Output"),vJ=y9(vN,"float","dashSize"),v$=y9(vN,"float","gapSize"),v0=y9(vN,"float","pointWidth"),v1=y9(vN,"float","IOR"),v2=y9(vN,"float","Transmission"),v3=y9(vN,"float","Thickness"),v4=y9(vN,"float","AttenuationDistance"),v5=y9(vN,"color","AttenuationColor"),v6=y9(vN,"float","Dispersion");class v7 extends ym{static get type(){return"UniformGroupNode"}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}constructor(e,t=!1,r=1){super("string"),this.name=e,this.shared=t,this.order=r,this.isUniformGroup=!0}}let v8=e=>new v7(e),v9=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new v7(e,!0,t)},xe=v9("frame"),xt=v9("render"),xr=v8("object");class xn extends yw{static get type(){return"UniformNode"}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(t=>{let r=e(t,this);void 0!==r&&(this.value=r)},t)}getInputType(e){let t=super.getInputType(e);return"bool"===t&&(t="uint"),t}generate(e,t){let r=this.getNodeType(e),n=this.getUniformHash(e),i=e.getNodeFromHash(n);void 0===i&&(e.setHashNode(this,n),i=this);let a=i.getInputType(e),s=e.getUniformFromNode(i,a,e.shaderStage,this.name||e.context.nodeName),o=e.getPropertyName(s);void 0!==e.context.nodeName&&delete e.context.nodeName;let l=o;if("bool"===r){let t=e.getDataFromNode(this),n=t.propertyName;if(void 0===n){let i=e.getVarFromNode(this,null,"bool");t.propertyName=n=e.getPropertyName(i),l=e.format(o,a,r),e.addLineFlowCode("".concat(n," = ").concat(l),this)}l=n}return e.format(l,r,t)}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=xr}}let xi=(e,t)=>{let r=y2(t||e);return r===e&&(e=yn(r)),y4(new xn(e=e&&!0===e.isNode?e.node&&e.node.value||e.value:e,r))};class xa extends yv{static get type(){return"ArrayNode"}getArrayCount(){return this.count}getNodeType(e){return null===this.nodeType&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){let t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}constructor(e,t,r=null){super(e),this.count=t,this.values=r,this.isArrayNode=!0}}let xs=function(){let e;for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(1===r.length){let t=r[0];e=new xa(null,t.length,t)}else e=new xa(r[0],r[1]);return y4(e)};yP("toArray",(e,t)=>xs(Array(t).fill(e)));let xo=y8(class extends yv{static get type(){return"AssignNode"}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){let{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){let r=e.getTypeLength(t.node.getNodeType(e));return yA.join("").slice(0,r)!==t.components}return!1}setup(e){let{targetNode:t,sourceNode:r}=this,n=t.getScope();e.getNodeProperties(n).assign=!0;let i=e.getNodeProperties(this);i.sourceNode=r,i.targetNode=t.context({assign:!0})}generate(e,t){let r,{targetNode:n,sourceNode:i}=e.getNodeProperties(this),a=this.needsSplitAssign(e),s=n.build(e),o=n.getNodeType(e),l=i.build(e,o),u=i.getNodeType(e),c=e.getDataFromNode(this);if(!0===c.initialized)"void"!==t&&(r=s);else if(a){let i=e.getVarFromNode(this,null,o),a=e.getPropertyName(i);e.addLineFlowCode("".concat(a," = ").concat(l),this);let u=n.node,c=u.node.context({assign:!0}).build(e);for(let t=0;t<u.components.length;t++){let r=u.components[t];e.addLineFlowCode("".concat(c,".").concat(r," = ").concat(a,"[ ").concat(t," ]"),this)}"void"!==t&&(r=s)}else r="".concat(s," = ").concat(l),("void"===t||"void"===u)&&(e.addLineFlowCode(r,this),"void"!==t&&(r=s));return c.initialized=!0,e.format(r,o,t)}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}}).setParameterLength(2);yP("assign",xo);class xl extends yv{static get type(){return"FunctionCallNode"}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){let t=[],r=this.functionNode,n=r.getInputs(e),i=this.parameters,a=(t,r)=>{let n=r.type;return"pointer"===n?"&"+t.build(e):t.build(e,n)};if(Array.isArray(i)){if(i.length>n.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=n.length;else if(i.length<n.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<n.length;)i.push(vu(0));for(let e=0;e<i.length;e++)t.push(a(i[e],n[e]))}else for(let e of n){let r=i[e.name];void 0!==r?t.push(a(r,e)):(console.error("THREE.TSL: Input '".concat(e.name,"' not found in 'Fn()'.")),t.push(a(vu(0),e)))}let s=r.build(e,"property");return"".concat(s,"( ").concat(t.join(", ")," )")}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}}let xu=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r=r.length>1||r[0]&&!0===r[0].isNode?y7(r):y6(r[0]),y4(new xl(y4(e),r))};yP("call",xu);let xc={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class xh extends yv{static get type(){return"OperatorNode"}getOperatorMethod(e,t){return e.getMethod(xc[this.op],t)}getNodeType(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.op,n=this.aNode,i=this.bNode,a=n.getNodeType(e),s=i?i.getNodeType(e):null;if("void"===a||"void"===s)return t||"void";if("%"===r)return a;if("~"===r||"&"===r||"|"===r||"^"===r||">>"===r||"<<"===r)return e.getIntegerType(a);if("!"===r||"&&"===r||"||"===r||"^^"===r)return"bool";if("=="===r||"!="===r||"<"===r||">"===r||"<="===r||">="===r){let t=Math.max(e.getTypeLength(a),e.getTypeLength(s));return t>1?"bvec".concat(t):"bool"}else{if(e.isMatrix(a)){if("float"===s)return a;else if(e.isVector(s))return e.getVectorFromMatrix(a);else if(e.isMatrix(s))return a}else if(e.isMatrix(s)){if("float"===a)return s;else if(e.isVector(a))return e.getVectorFromMatrix(s)}return e.getTypeLength(s)>e.getTypeLength(a)?s:a}}generate(e,t){let r=this.op,{aNode:n,bNode:i}=this,a=this.getNodeType(e,t),s=null,o=null;"void"!==a?(s=n.getNodeType(e),o=i?i.getNodeType(e):null,"<"===r||">"===r||"<="===r||">="===r||"=="===r||"!="===r?e.isVector(s)?o=s:e.isVector(o)?s=o:s!==o&&(s=o="float"):">>"===r||"<<"===r?(s=a,o=e.changeComponentType(o,"uint")):"%"===r?(s=a,o=e.isInteger(s)&&e.isInteger(o)?o:s):e.isMatrix(s)?"float"===o?o="float":e.isVector(o)?o=e.getVectorFromMatrix(s):e.isMatrix(o)||(s=o=a):s=e.isMatrix(o)?"float"===s?"float":e.isVector(s)?e.getVectorFromMatrix(o):o=a:o=a):s=o=a;let l=n.build(e,s),u=i?i.build(e,o):null,c=e.getFunctionOperator(r);if("void"!==t){let n=2e3===e.renderer.coordinateSystem;if("=="===r||"!="===r||"<"===r||">"===r||"<="===r||">="===r)if(!n)return e.format("( ".concat(l," ").concat(r," ").concat(u," )"),a,t);else if(e.isVector(s))return e.format("".concat(this.getOperatorMethod(e,t),"( ").concat(l,", ").concat(u," )"),a,t);else return e.format("( ".concat(l," ").concat(r," ").concat(u," )"),a,t);if("%"===r)if(e.isInteger(o))return e.format("( ".concat(l," % ").concat(u," )"),a,t);else return e.format("".concat(this.getOperatorMethod(e,a),"( ").concat(l,", ").concat(u," )"),a,t);{if("!"===r||"~"===r)return e.format("(".concat(r).concat(l,")"),s,t);if(c)return e.format("".concat(c,"( ").concat(l,", ").concat(u," )"),a,t);if(e.isMatrix(s)&&"float"===o)return e.format("( ".concat(u," ").concat(r," ").concat(l," )"),a,t);if("float"===s&&e.isMatrix(o))return e.format("".concat(l," ").concat(r," ").concat(u),a,t);let i="( ".concat(l," ").concat(r," ").concat(u," )");return!n&&"bool"===a&&e.isVector(s)&&e.isVector(o)&&(i="all".concat(i)),e.format(i,a,t)}}if("void"!==s)if(c)return e.format("".concat(c,"( ").concat(l,", ").concat(u," )"),a,t);else if(e.isMatrix(s)&&"float"===o)return e.format("".concat(u," ").concat(r," ").concat(l),a,t);else return e.format("".concat(l," ").concat(r," ").concat(u),a,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}constructor(e,t,r,...n){if(super(),n.length>0){let i=new xh(e,t,r);for(let t=0;t<n.length-1;t++)i=new xh(e,i,n[t]);t=i,r=n[n.length-1]}this.op=e,this.aNode=t,this.bNode=r,this.isOperatorNode=!0}}let xd=ve(xh,"+").setParameterLength(2,1/0).setName("add"),xA=ve(xh,"-").setParameterLength(2,1/0).setName("sub"),xp=ve(xh,"*").setParameterLength(2,1/0).setName("mul"),xf=ve(xh,"/").setParameterLength(2,1/0).setName("div"),xm=ve(xh,"%").setParameterLength(2).setName("mod"),xg=ve(xh,"==").setParameterLength(2).setName("equal"),xy=ve(xh,"!=").setParameterLength(2).setName("notEqual"),xv=ve(xh,"<").setParameterLength(2).setName("lessThan"),xx=ve(xh,">").setParameterLength(2).setName("greaterThan"),x_=ve(xh,"<=").setParameterLength(2).setName("lessThanEqual"),xb=ve(xh,">=").setParameterLength(2).setName("greaterThanEqual"),xS=ve(xh,"&&").setParameterLength(2,1/0).setName("and"),xT=ve(xh,"||").setParameterLength(2,1/0).setName("or"),xw=ve(xh,"!").setParameterLength(1).setName("not"),xM=ve(xh,"^^").setParameterLength(2).setName("xor"),xE=ve(xh,"&").setParameterLength(2).setName("bitAnd"),xR=ve(xh,"~").setParameterLength(2).setName("bitNot"),xC=ve(xh,"|").setParameterLength(2).setName("bitOr"),xN=ve(xh,"^").setParameterLength(2).setName("bitXor"),xP=ve(xh,"<<").setParameterLength(2).setName("shiftLeft"),xI=ve(xh,">>").setParameterLength(2).setName("shiftRight"),xL=vn(e=>{let[t]=e;return t.addAssign(1),t}),xD=vn(e=>{let[t]=e;return t.subAssign(1),t}),xB=vn(e=>{let[t]=e,r=vc(t).toConst();return t.addAssign(1),r}),xF=vn(e=>{let[t]=e,r=vc(t).toConst();return t.subAssign(1),r});yP("add",xd),yP("sub",xA),yP("mul",xp),yP("div",xf),yP("mod",xm),yP("equal",xg),yP("notEqual",xy),yP("lessThan",xv),yP("greaterThan",xx),yP("lessThanEqual",x_),yP("greaterThanEqual",xb),yP("and",xS),yP("or",xT),yP("not",xw),yP("xor",xM),yP("bitAnd",xE),yP("bitNot",xR),yP("bitOr",xC),yP("bitXor",xN),yP("shiftLeft",xP),yP("shiftRight",xI),yP("incrementBefore",xL),yP("decrementBefore",xD),yP("increment",xB),yP("decrement",xF);let xU=(e,t)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),xm(vc(e),vc(t)));yP("modInt",xU);class xO extends yv{static get type(){return"MathNode"}getInputType(e){let t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,n=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(r)?0:e.getTypeLength(r),s=e.isMatrix(n)?0:e.getTypeLength(n);if(i>a&&i>s);else if(a>s)return r;else if(s>i)return n;return t}getNodeType(e){let t=this.method;return t===xO.LENGTH||t===xO.DISTANCE||t===xO.DOT?"float":t===xO.CROSS?"vec3":t===xO.ALL||t===xO.ANY?"bool":t===xO.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){let{aNode:t,bNode:r,method:n}=this,i=null;if(n===xO.ONE_MINUS)i=xA(1,t);else if(n===xO.RECIPROCAL)i=xf(1,t);else if(n===xO.DIFFERENCE)i=x9(xA(t,r));else if(n===xO.TRANSFORM_DIRECTION){let n=t,a=r;e.isMatrix(n.getNodeType(e))?a=v_(vg(a),0):n=v_(vg(n),0),i=x1(xp(n,a).xyz)}return null!==i?i:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method,n=this.getNodeType(e),i=this.getInputType(e),a=this.aNode,s=this.bNode,o=this.cNode,l=e.renderer.coordinateSystem;if(r===xO.NEGATE)return e.format("( - "+a.build(e,i)+" )",n,t);{let u=[];return r===xO.CROSS?u.push(a.build(e,n),s.build(e,n)):2e3===l&&r===xO.STEP?u.push(a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":i),s.build(e,i)):2e3===l&&(r===xO.MIN||r===xO.MAX)?u.push(a.build(e,i),s.build(e,1===e.getTypeLength(s.getNodeType(e))?"float":i)):r===xO.REFRACT?u.push(a.build(e,i),s.build(e,i),o.build(e,"float")):r===xO.MIX?u.push(a.build(e,i),s.build(e,i),o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":i)):(2001===l&&r===xO.ATAN&&null!==s&&(r="atan2"),"fragment"!==e.shaderStage&&(r===xO.DFDX||r===xO.DFDY)&&(console.warn("THREE.TSL: '".concat(r,"' is not supported in the ").concat(e.shaderStage," stage.")),r="/*"+r+"*/"),u.push(a.build(e,i)),null!==s&&u.push(s.build(e,i)),null!==o&&u.push(o.build(e,i))),e.format("".concat(e.getMethod(r,n),"( ").concat(u.join(", ")," )"),n,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}constructor(e,t,r=null,n=null){if(super(),(e===xO.MAX||e===xO.MIN)&&arguments.length>3){let i=new xO(e,t,r);for(let t=2;t<arguments.length-1;t++)i=new xO(e,i,arguments[t]);t=i,r=arguments[arguments.length-1],n=null}this.method=e,this.aNode=t,this.bNode=r,this.cNode=n,this.isMathNode=!0}}xO.ALL="all",xO.ANY="any",xO.RADIANS="radians",xO.DEGREES="degrees",xO.EXP="exp",xO.EXP2="exp2",xO.LOG="log",xO.LOG2="log2",xO.SQRT="sqrt",xO.INVERSE_SQRT="inversesqrt",xO.FLOOR="floor",xO.CEIL="ceil",xO.NORMALIZE="normalize",xO.FRACT="fract",xO.SIN="sin",xO.COS="cos",xO.TAN="tan",xO.ASIN="asin",xO.ACOS="acos",xO.ATAN="atan",xO.ABS="abs",xO.SIGN="sign",xO.LENGTH="length",xO.NEGATE="negate",xO.ONE_MINUS="oneMinus",xO.DFDX="dFdx",xO.DFDY="dFdy",xO.ROUND="round",xO.RECIPROCAL="reciprocal",xO.TRUNC="trunc",xO.FWIDTH="fwidth",xO.TRANSPOSE="transpose",xO.DETERMINANT="determinant",xO.INVERSE="inverse",xO.EQUALS="equals",xO.MIN="min",xO.MAX="max",xO.STEP="step",xO.REFLECT="reflect",xO.DISTANCE="distance",xO.DIFFERENCE="difference",xO.DOT="dot",xO.CROSS="cross",xO.POW="pow",xO.TRANSFORM_DIRECTION="transformDirection",xO.MIX="mix",xO.CLAMP="clamp",xO.REFRACT="refract",xO.SMOOTHSTEP="smoothstep",xO.FACEFORWARD="faceforward";let xk=vu(1e-6),xz=vu(1e6),xV=vu(Math.PI),xq=vu(2*Math.PI),xG=ve(xO,xO.ALL).setParameterLength(1),xH=ve(xO,xO.ANY).setParameterLength(1),xj=ve(xO,xO.RADIANS).setParameterLength(1),xW=ve(xO,xO.DEGREES).setParameterLength(1),xX=ve(xO,xO.EXP).setParameterLength(1),xQ=ve(xO,xO.EXP2).setParameterLength(1),xY=ve(xO,xO.LOG).setParameterLength(1),xK=ve(xO,xO.LOG2).setParameterLength(1),xZ=ve(xO,xO.SQRT).setParameterLength(1),xJ=ve(xO,xO.INVERSE_SQRT).setParameterLength(1),x$=ve(xO,xO.FLOOR).setParameterLength(1),x0=ve(xO,xO.CEIL).setParameterLength(1),x1=ve(xO,xO.NORMALIZE).setParameterLength(1),x2=ve(xO,xO.FRACT).setParameterLength(1),x3=ve(xO,xO.SIN).setParameterLength(1),x4=ve(xO,xO.COS).setParameterLength(1),x5=ve(xO,xO.TAN).setParameterLength(1),x6=ve(xO,xO.ASIN).setParameterLength(1),x7=ve(xO,xO.ACOS).setParameterLength(1),x8=ve(xO,xO.ATAN).setParameterLength(1,2),x9=ve(xO,xO.ABS).setParameterLength(1),_e=ve(xO,xO.SIGN).setParameterLength(1),_t=ve(xO,xO.LENGTH).setParameterLength(1),_r=ve(xO,xO.NEGATE).setParameterLength(1),_n=ve(xO,xO.ONE_MINUS).setParameterLength(1),_i=ve(xO,xO.DFDX).setParameterLength(1),_a=ve(xO,xO.DFDY).setParameterLength(1),_s=ve(xO,xO.ROUND).setParameterLength(1),_o=ve(xO,xO.RECIPROCAL).setParameterLength(1),_l=ve(xO,xO.TRUNC).setParameterLength(1),_u=ve(xO,xO.FWIDTH).setParameterLength(1),_c=ve(xO,xO.TRANSPOSE).setParameterLength(1),_h=ve(xO,xO.DETERMINANT).setParameterLength(1),_d=ve(xO,xO.INVERSE).setParameterLength(1),_A=(e,t)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),xg(e,t)),_p=ve(xO,xO.MIN).setParameterLength(2,1/0),_f=ve(xO,xO.MAX).setParameterLength(2,1/0),_m=ve(xO,xO.STEP).setParameterLength(2),_g=ve(xO,xO.REFLECT).setParameterLength(2),_y=ve(xO,xO.DISTANCE).setParameterLength(2),_v=ve(xO,xO.DIFFERENCE).setParameterLength(2),_x=ve(xO,xO.DOT).setParameterLength(2),__=ve(xO,xO.CROSS).setParameterLength(2),_b=ve(xO,xO.POW).setParameterLength(2),_S=e=>xp(e,e),_T=e=>xp(e,e,e),_w=e=>xp(e,e,e,e),_M=ve(xO,xO.TRANSFORM_DIRECTION).setParameterLength(2),_E=e=>xp(_e(e),_b(x9(e),1/3)),_R=e=>_x(e,e),_C=ve(xO,xO.MIX).setParameterLength(3),_N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return y4(new xO(xO.CLAMP,y4(e),y4(t),y4(r)))},_P=e=>_N(e),_I=ve(xO,xO.REFRACT).setParameterLength(3),_L=ve(xO,xO.SMOOTHSTEP).setParameterLength(3),_D=ve(xO,xO.FACEFORWARD).setParameterLength(3),_B=vn(e=>{let[t]=e;return x2(x3(xm(_x(t.xy,vA(12.9898,78.233)),xV)).mul(43758.5453))}),_F=(e,t,r)=>_C(t,r,e),_U=(e,t,r)=>_L(t,r,e),_O=(e,t)=>_m(t,e),_k=(e,t)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),x8(e,t));yP("all",xG),yP("any",xH),yP("equals",_A),yP("radians",xj),yP("degrees",xW),yP("exp",xX),yP("exp2",xQ),yP("log",xY),yP("log2",xK),yP("sqrt",xZ),yP("inverseSqrt",xJ),yP("floor",x$),yP("ceil",x0),yP("normalize",x1),yP("fract",x2),yP("sin",x3),yP("cos",x4),yP("tan",x5),yP("asin",x6),yP("acos",x7),yP("atan",x8),yP("abs",x9),yP("sign",_e),yP("length",_t),yP("lengthSq",_R),yP("negate",_r),yP("oneMinus",_n),yP("dFdx",_i),yP("dFdy",_a),yP("round",_s),yP("reciprocal",_o),yP("trunc",_l),yP("fwidth",_u),yP("atan2",_k),yP("min",_p),yP("max",_f),yP("step",_O),yP("reflect",_g),yP("distance",_y),yP("dot",_x),yP("cross",__),yP("pow",_b),yP("pow2",_S),yP("pow3",_T),yP("pow4",_w),yP("transformDirection",_M),yP("mix",_F),yP("clamp",_N),yP("refract",_I),yP("smoothstep",_U),yP("faceForward",_D),yP("difference",_v),yP("saturate",_P),yP("cbrt",_E),yP("transpose",_c),yP("determinant",_h),yP("inverse",_d),yP("rand",_B);let _z=y8(class extends ym{static get type(){return"ConditionalNode"}getNodeType(e){let{ifNode:t,elseNode:r}=e.getNodeProperties(this);if(void 0===t)return e.flowBuildStage(this,"setup"),this.getNodeType(e);let n=t.getNodeType(e);if(null!==r){let t=r.getNodeType(e);if(e.getTypeLength(t)>e.getTypeLength(n))return t}return n}setup(e){let t=this.condNode.cache(),r=this.ifNode.cache(),n=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(r).parentNodeBlock=i,null!==n&&(e.getDataFromNode(n).parentNodeBlock=i);let a=e.context.uniformFlow,s=e.getNodeProperties(this);s.condNode=t,s.ifNode=a?r:r.context({nodeBlock:r}),s.elseNode=n?a?n:n.context({nodeBlock:n}):null}generate(e,t){let r=this.getNodeType(e),n=e.getDataFromNode(this);if(void 0!==n.nodeProperty)return n.nodeProperty;let{condNode:i,ifNode:a,elseNode:s}=e.getNodeProperties(this),o=e.currentFunctionNode,l="void"!==t,u=l?vP(r).build(e):"";n.nodeProperty=u;let c=i.build(e,"bool");if(e.context.uniformFlow&&null!==s){let n=a.build(e,r),i=s.build(e,r),o=e.getTernary(c,n,i);return e.format(o,r,t)}e.addFlowCode("\n".concat(e.tab,"if ( ").concat(c," ) {\n\n")).addFlowTab();let h=a.build(e,r);if(h&&(l?h=u+" = "+h+";":(h="return "+h+";",null===o&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),h="// "+h))),e.removeFlowTab().addFlowCode(e.tab+"	"+h+"\n\n"+e.tab+"}"),null!==s){e.addFlowCode(" else {\n\n").addFlowTab();let t=s.build(e,r);t&&(l?t=u+" = "+t+";":(t="return "+t+";",null===o&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),t="// "+t))),e.removeFlowTab().addFlowCode(e.tab+"	"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(u,r,t)}constructor(e,t,r=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=r}}).setParameterLength(2,3);yP("select",_z);class _V extends ym{static get type(){return"ContextNode"}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){let t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){let t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){let r=e.getContext();e.setContext({...e.context,...this.value});let n=this.node.build(e,t);return e.setContext(r),n}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}}let _q=y8(_V).setParameterLength(1,2),_G=e=>_q(e,{uniformFlow:!0}),_H=(e,t)=>_q(e,{nodeName:t});function _j(e,t){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),_H(e,t)}yP("context",_q),yP("label",_j),yP("uniformFlow",_G),yP("setName",_H);class _W extends ym{static get type(){return"VarNode"}setIntent(e){return this.intent=e,this}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}build(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return!0===this.intent&&!0!==t[0].getNodeProperties(this).assign?this.node.build(...t):super.build(...t)}generate(e){let{node:t,name:r,readOnly:n}=this,{renderer:i}=e,a=!0===i.backend.isWebGPUBackend,s=!1,o=!1;n&&(s=e.isDeterministic(t),o=a?n:s);let l=e.getVectorType(this.getNodeType(e)),u=t.build(e,l),c=e.getVarFromNode(this,r,l,void 0,o),h=e.getPropertyName(c),d=h;if(o)if(a)d=s?"const ".concat(h):"let ".concat(h);else{let r=t.getArrayCount(e);d="const ".concat(e.getVar(c.type,h,r))}return e.addLineFlowCode("".concat(d," = ").concat(u),this),h}constructor(e,t=null,r=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=r,this.parents=!0,this.intent=!1}}let _X=y8(_W),_Q=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _X(e,t).toStack()},_Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _X(e,t,!0).toStack()},_K=e=>null===va()?e:_X(e).setIntent(!0).toStack();yP("toVar",_Q),yP("toConst",_Y),yP("toVarIntent",_K);class _Z extends ym{static get type(){return"SubBuild"}getNodeType(e){if(null!==this.nodeType)return this.nodeType;e.addSubBuild(this.name);let t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.addSubBuild(this.name);let i=this.node.build(e,...r);return e.removeSubBuild(),i}constructor(e,t,r=null){super(r),this.node=e,this.name=t,this.isSubBuildNode=!0}}let _J=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return y4(new _Z(y4(e),t,r))},_$=y8(class extends ym{static get type(){return"VaryingNode"}setInterpolation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){let t=e.getNodeProperties(this),r=t.varying;if(void 0===r){let n=this.name,i=this.getNodeType(e),a=this.interpolationType,s=this.interpolationSampling;t.varying=r=e.getVaryingFromNode(this,n,i,a,s),t.node=_J(this.node,"VERTEX")}return r.needsInterpolation||(r.needsInterpolation="fragment"===e.shaderStage),r}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(yo.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(yo.VERTEX,this.node)}generate(e){let t=e.getSubBuildProperty("property",e.currentStack),r=e.getNodeProperties(this),n=this.setupVarying(e);if(void 0===r[t]){let i=this.getNodeType(e),a=e.getPropertyName(n,yo.VERTEX);e.flowNodeFromShaderStage(yo.VERTEX,r.node,i,a),r[t]=a}return e.getPropertyName(n)}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}}).setParameterLength(1,2),_0=e=>_$(e);yP("toVarying",_$),yP("toVertexStage",_0),yP("varying",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),_$(...t)}),yP("vertexStage",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),_$(...t)});let _1=vn(e=>{let[t]=e,r=t.mul(.9478672986).add(.0521327014).pow(2.4);return _C(r,t.mul(.0773993808),t.lessThanEqual(.04045))}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),_2=vn(e=>{let[t]=e,r=t.pow(.41666).mul(1.055).sub(.055);return _C(r,t.mul(12.92),t.lessThanEqual(.0031308))}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),_3="WorkingColorSpace";class _4 extends yv{static get type(){return"ColorSpaceNode"}resolveColorSpace(e,t){return t===_3?eD.workingColorSpace:"OutputColorSpace"===t?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){let{colorNode:t}=this,r=this.resolveColorSpace(e,this.source),n=this.resolveColorSpace(e,this.target),i=t;return!1!==eD.enabled&&r!==n&&r&&n&&(eD.getTransfer(r)===et&&(i=v_(_1(i.rgb),i.a)),eD.getPrimaries(r)!==eD.getPrimaries(n)&&(i=v_(vM(eD._getMatrix(new eS,r,n)).mul(i.rgb),i.a)),eD.getTransfer(n)===et&&(i=v_(_2(i.rgb),i.a))),i}constructor(e,t,r){super("vec4"),this.colorNode=e,this.source=t,this.target=r}}let _5=(e,t)=>y4(new _4(y4(e),_3,t)),_6=(e,t)=>y4(new _4(y4(e),t,_3));yP("workingToColorSpace",_5),yP("colorSpaceToWorking",_6);let _7=class extends yg{static get type(){return"ReferenceElementNode"}getNodeType(){return this.referenceNode.uniformType}generate(e){let t=super.generate(e),r=this.referenceNode.getNodeType(),n=this.getNodeType();return e.format(t,r,n)}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}};class _8 extends ym{static get type(){return"ReferenceBaseNode"}setGroup(e){return this.group=e,this}element(e){return y4(new _7(this,y4(e)))}setNodeType(e){let t=xi(null,e);null!==this.group&&t.setGroup(this.group),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference,{properties:t}=this,r=e[t[0]];for(let e=1;e<t.length;e++)r=r[t[e]];return r}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);let e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}constructor(e,t,r=null,n=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=n,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.updateType=yl.OBJECT}}class _9 extends _8{static get type(){return"RendererReferenceNode"}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}constructor(e,t,r=null){super(e,t,r),this.renderer=r,this.setGroup(xt)}}let be=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return y4(new _9(e,t,r))};class bt extends yv{static get type(){return"ToneMappingNode"}customCacheKey(){return g5(this.toneMapping)}setup(e){let t=this.colorNode||e.context.color,r=this.toneMapping;if(0===r)return t;let n=null,i=e.renderer.library.getToneMappingFunction(r);return null!==i?n=v_(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",r),n=t),n}constructor(e,t=bn,r=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=r}}let br=(e,t,r)=>y4(new bt(e,y4(t),y4(r))),bn=be("toneMappingExposure","float");yP("toneMapping",(e,t,r)=>br(t,r,e));class bi extends yw{static get type(){return"BufferAttributeNode"}getHash(e){if(0===this.bufferStride&&0===this.bufferOffset){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;let t=this.getNodeType(e),r=this.value,n=e.getTypeLength(t),i=this.bufferStride||n,a=this.bufferOffset,s=!0===r.isInterleavedBuffer?r:new r5(r,i),o=new r7(s,n,a);s.setUsage(this.usage),this.attribute=o,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){let t=this.getNodeType(e),r=e.getBufferAttributeFromNode(this,t),n=e.getPropertyName(r),i=null;return"vertex"===e.shaderStage||"compute"===e.shaderStage?(this.name=n,i=n):i=_$(this).build(e,t),i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}constructor(e,t=null,r=0,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=r,this.bufferOffset=n,this.usage=35044,this.instanced=!1,this.attribute=null,this.global=!0,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}}let ba=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return y4(new bi(e,t,r,n))},bs=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return ba(e,t,r,n).setUsage(35048)},bo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return ba(e,t,r,n).setInstanced(!0)},bl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return bs(e,t,r,n).setInstanced(!0)};yP("toAttribute",e=>ba(e.value));class bu extends ym{static get type(){return"ComputeNode"}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore(e){let{renderer:t}=e;t.compute(this)}setup(e){let t=this.computeNode.build(e);return t&&(e.getNodeProperties(this).outputComputeNode=t.outputNode,t.outputNode=null),t}generate(e,t){let{shaderStage:r}=e;if("compute"===r){let t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t,this)}else{let r=e.getNodeProperties(this).outputComputeNode;if(r)return r.build(e,t)}}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=yl.OBJECT,this.onInitFunction=null}}let bc=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[64];(0===t.length||t.length>3)&&console.error("THREE.TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let e=0;e<t.length;e++){let r=t[e];("number"!=typeof r||r<=0||!Number.isInteger(r))&&console.error("THREE.TSL: compute() workgroupSize element at index [ ".concat(e," ] must be a positive integer"))}for(;t.length<3;)t.push(1);return y4(new bu(y4(e),t))},bh=(e,t,r)=>bc(e,r).setCount(t);yP("compute",bh),yP("computeKernel",bc);class bd extends ym{static get type(){return"CacheNode"}getNodeType(e){let t=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);let n=this.node.getNodeType(e);return e.setCache(t),n}build(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let i=e.getCache(),a=e.getCacheFromNode(this,this.parent);e.setCache(a);let s=this.node.build(e,...r);return e.setCache(i),s}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}}let bA=(e,t)=>y4(new bd(y4(e),t));yP("cache",bA);let bp=y8(class extends ym{static get type(){return"BypassNode"}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){let t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t,this),this.outputNode.build(e)}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}}).setParameterLength(2);yP("bypass",bp);class bf extends ym{static get type(){return"RemapNode"}setup(){let{node:e,inLowNode:t,inHighNode:r,outLowNode:n,outHighNode:i,doClamp:a}=this,s=e.sub(t).div(r.sub(t));return!0===a&&(s=s.clamp()),s.mul(i.sub(n)).add(n)}constructor(e,t,r,n=vu(0),i=vu(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=r,this.outLowNode=n,this.outHighNode=i,this.doClamp=!0}}let bm=y8(bf,null,null,{doClamp:!1}).setParameterLength(3,5),bg=y8(bf).setParameterLength(3,5);yP("remap",bm),yP("remapClamp",bg);class by extends ym{static get type(){return"ExpressionNode"}generate(e,t){let r=this.getNodeType(e),n=this.snippet;if("void"!==r)return e.format(n,r,t);e.addLineFlowCode(n,this)}constructor(e="",t="void"){super(t),this.snippet=e}}let bv=y8(by).setParameterLength(1,2),bx=e=>(e?_z(e,bv("discard")):bv("discard")).toStack();yP("discard",bx);class b_ extends yv{static get type(){return"RenderOutputNode"}setup(e){let{context:t}=e,r=this.colorNode||t.color,n=(null!==this.toneMapping?this.toneMapping:t.toneMapping)||0,i=(null!==this.outputColorSpace?this.outputColorSpace:t.outputColorSpace)||"";return 0!==n&&(r=r.toneMapping(n)),""!==i&&i!==eD.workingColorSpace&&(r=r.workingToColorSpace(i)),r}constructor(e,t,r){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=r,this.isRenderOutputNode=!0}}let bb=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return y4(new b_(y4(e),t,r))};yP("renderOutput",bb);class bS extends yv{static get type(){return"DebugNode"}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){let t=this.callback,r=this.node.build(e),n="--- TSL debug - "+e.shaderStage+" shader ---",i="-".repeat(n.length),a="";return a+="// #"+n+"#\n"+e.flow.code.replace(/^\t/mg,"")+"\n"+("/* ... */ "+r)+" /* ... */\n"+("// #"+i)+"#\n",null!==t?t(e,a):console.log(a),r}constructor(e,t=null){super(),this.node=e,this.callback=t}}let bT=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return y4(new bS(y4(e),t)).toStack()};yP("debug",bT);class bw extends ym{static get type(){return"AttributeNode"}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(null===t){let r=this.getAttributeName(e);if(e.hasGeometryAttribute(r)){let n=e.geometry.getAttribute(r);t=e.getTypeFromAttribute(n)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){let t=this.getAttributeName(e),r=this.getNodeType(e);if(!0!==e.hasGeometryAttribute(t))return console.warn('AttributeNode: Vertex attribute "'.concat(t,'" not found on geometry.')),e.generateConst(r);{let n=e.geometry.getAttribute(t),i=e.getTypeFromAttribute(n),a=e.getAttribute(t,i);return"vertex"===e.shaderStage?e.format(a.name,i,r):_$(this).build(e,r)}}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}}let bM=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return y4(new bw(e,t))},bE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return bM("uv"+(e>0?e:""),"vec2")},bR=y8(class extends ym{static get type(){return"TextureSizeNode"}generate(e,t){let r=this.textureNode.build(e,"property"),n=null===this.levelNode?"0":this.levelNode.build(e,"int");return e.format("".concat(e.getMethod("textureDimensions"),"( ").concat(r,", ").concat(n," )"),this.getNodeType(e),t)}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}}).setParameterLength(1,2),bC=y8(class extends xn{static get type(){return"MaxMipLevelNode"}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){let e=this.texture,t=e.images,r=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(r&&void 0!==r.width){let{width:e,height:t}=r;this.value=Math.log2(Math.max(e,t))}}constructor(e){super(0),this._textureNode=e,this.updateType=yl.FRAME}}).setParameterLength(1),bN=new eG;class bP extends xn{static get type(){return"TextureNode"}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":1014===this.value.type?"uvec4":1013===this.value.type?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return bE(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return null===this._matrixUniform&&(this._matrixUniform=xi(this.value.matrix)),this._matrixUniform.mul(vg(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?yl.OBJECT:yl.NONE,this}setupUV(e,t){let r=this.value;return e.isFlipY()&&(r.image instanceof ImageBitmap&&!0===r.flipY||!0===r.isRenderTargetTexture||!0===r.isFramebufferTexture||!0===r.isDepthTexture)&&(t=this.sampler?t.flipY():t.setY(vc(bR(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){let t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;let r=this.value;if(!r||!0!==r.isTexture)throw Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let n=this.uvNode;(null===n||!0===e.context.forceUVContext)&&e.context.getUV&&(n=e.context.getUV(this,e)),n||(n=this.getDefaultUV()),!0===this.updateMatrix&&(n=this.getTransformedUV(n)),n=this.setupUV(e,n);let i=this.levelNode;null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=n,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,r,n,i,a,s,o,l){let u=this.value;return n?e.generateTextureLevel(u,t,r,n,a,l):i?e.generateTextureBias(u,t,r,i,a,l):o?e.generateTextureGrad(u,t,r,o,a,l):s?e.generateTextureCompare(u,t,r,s,a,l):!1===this.sampler?e.generateTextureLoad(u,t,r,a,l):e.generateTexture(u,t,r,a,l)}generate(e,t){let r=this.value,n=e.getNodeProperties(this),i=super.generate(e,"property");if(/^sampler/.test(t))return i+"_sampler";{if(e.isReference(t))return i;let a=e.getDataFromNode(this),s=a.propertyName;if(void 0===s){let{uvNode:t,levelNode:r,biasNode:o,compareNode:l,depthNode:u,gradNode:c,offsetNode:h}=n,d=this.generateUV(e,t),A=r?r.build(e,"float"):null,p=o?o.build(e,"float"):null,f=u?u.build(e,"int"):null,m=l?l.build(e,"float"):null,g=c?[c[0].build(e,"vec2"),c[1].build(e,"vec2")]:null,y=h?this.generateOffset(e,h):null,v=e.getVarFromNode(this);s=e.getPropertyName(v);let x=this.generateSnippet(e,i,d,A,p,f,m,g,y);e.addLineFlowCode("".concat(s," = ").concat(x),this),a.snippet=x,a.propertyName=s}let o=s,l=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(o=_6(bv(o,l),r.colorSpace).setup(e).build(e,l)),e.format(o,l,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){let t=this.clone();return t.uvNode=y4(e),t.referenceNode=this.getBase(),y4(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){let t=this.clone();t.biasNode=y4(e).mul(bC(t)),t.referenceNode=this.getBase();let r=t.value;return!1===t.generateMipmaps&&(r&&!1===r.generateMipmaps||1003===r.minFilter||1003===r.magFilter)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),y4(t)}level(e){let t=this.clone();return t.levelNode=y4(e),t.referenceNode=this.getBase(),y4(t)}size(e){return bR(this,e)}bias(e){let t=this.clone();return t.biasNode=y4(e),t.referenceNode=this.getBase(),y4(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){let t=this.clone();return t.compareNode=y4(e),t.referenceNode=this.getBase(),y4(t)}grad(e,t){let r=this.clone();return r.gradNode=[y4(e),y4(t)],r.referenceNode=this.getBase(),y4(r)}depth(e){let t=this.clone();return t.depthNode=y4(e),t.referenceNode=this.getBase(),y4(t)}offset(e){let t=this.clone();return t.offsetNode=y4(e),t.referenceNode=this.getBase(),y4(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){let e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){let e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}constructor(e=bN,t=null,r=null,n=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=r,this.biasNode=n,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=yl.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(null===t)}}let bI=y8(bP).setParameterLength(1,4).setName("texture"),bL=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bN,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t&&!0===t.isTextureNode?((e=y4(t.clone())).referenceNode=t.getBase(),null!==r&&(e.uvNode=y4(r)),null!==n&&(e.levelNode=y4(n)),null!==i&&(e.biasNode=y4(i))):e=bI(t,r,n,i),e},bD=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return bL(...t).setSampler(!1)};class bB extends xn{static get type(){return"BufferNode"}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}constructor(e,t,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=r}}let bF=(e,t,r)=>y4(new bB(e,t,r));class bU extends yg{static get type(){return"UniformArrayElementNode"}generate(e){let t=super.generate(e),r=this.getNodeType(),n=this.node.getPaddedType();return e.format(t,n,r)}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}}class bO extends bB{static get type(){return"UniformArrayNode"}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){let e=this.elementType,t="vec4";return"mat2"===e?t="mat2":!0===/mat/.test(e)?t="mat4":"i"===e.charAt(0)?t="ivec4":"u"===e.charAt(0)&&(t="uvec4"),t}update(){let{array:e,value:t}=this,r=this.elementType;if("float"===r||"int"===r||"uint"===r)for(let r=0;r<e.length;r++)t[4*r]=e[r];else if("color"===r)for(let r=0;r<e.length;r++){let n=4*r,i=e[r];t[n]=i.r,t[n+1]=i.g,t[n+2]=i.b||0}else if("mat2"===r)for(let r=0;r<e.length;r++){let n=4*r,i=e[r];t[n]=i.elements[0],t[n+1]=i.elements[1],t[n+2]=i.elements[2],t[n+3]=i.elements[3]}else if("mat3"===r)for(let r=0;r<e.length;r++){let n=16*r,i=e[r];t[n]=i.elements[0],t[n+1]=i.elements[1],t[n+2]=i.elements[2],t[n+4]=i.elements[3],t[n+5]=i.elements[4],t[n+6]=i.elements[5],t[n+8]=i.elements[6],t[n+9]=i.elements[7],t[n+10]=i.elements[8],t[n+15]=1}else if("mat4"===r)for(let r=0;r<e.length;r++){let n=16*r,i=e[r];for(let e=0;e<i.elements.length;e++)t[n+e]=i.elements[e]}else for(let r=0;r<e.length;r++){let n=4*r,i=e[r];t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z||0,t[n+3]=i.w||0}}setup(e){let t=this.array.length,r=this.elementType,n=Float32Array,i=this.paddedType,a=e.getTypeLength(i);return"i"===r.charAt(0)&&(n=Int32Array),"u"===r.charAt(0)&&(n=Uint32Array),this.value=new n(t*a),this.bufferCount=t,this.bufferType=i,super.setup(e)}element(e){return y4(new bU(this,y4(e)))}constructor(e,t=null){super(null),this.array=e,this.elementType=null===t?yr(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=yl.RENDER,this.isArrayBufferNode=!0}}let bk=(e,t)=>y4(new bO(e,t)),bz=y8(class extends ym{generate(){return this.name}constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}}).setParameterLength(1);class bV extends ym{static get type(){return"ScreenNode"}getNodeType(){return this.scope===bV.DPR?"float":this.scope===bV.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=yl.NONE;return(this.scope===bV.SIZE||this.scope===bV.VIEWPORT||this.scope===bV.DPR)&&(e=yl.RENDER),this.updateType=e,e}update(e){let{renderer:t}=e,r=t.getRenderTarget();this.scope===bV.VIEWPORT?null!==r?o.copy(r.viewport):(t.getViewport(o),o.multiplyScalar(t.getPixelRatio())):this.scope===bV.DPR?this._output.value=t.getPixelRatio():null!==r?(s.width=r.width,s.height=r.height):t.getDrawingBufferSize(s)}setup(){let e=this.scope,t=null;return t=e===bV.SIZE?xi(s||(s=new ey)):e===bV.VIEWPORT?xi(o||(o=new eH)):e===bV.DPR?xi(1):vA(bj.div(bH)),this._output=t,t}generate(e){if(this.scope===bV.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){let r=e.getNodeProperties(bH).outputNode.build(e);t="".concat(e.getType("vec2"),"( ").concat(t,".x, ").concat(r,".y - ").concat(t,".y )")}return t}return super.generate(e)}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}}bV.COORDINATE="coordinate",bV.VIEWPORT="viewport",bV.SIZE="size",bV.UV="uv",bV.DPR="dpr";let bq=y9(bV,bV.DPR),bG=y9(bV,bV.UV),bH=y9(bV,bV.SIZE),bj=y9(bV,bV.COORDINATE),bW=y9(bV,bV.VIEWPORT),bX=bW.zw,bQ=bj.sub(bW.xy),bY=bQ.div(bX),bK=vn(()=>(console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),bH),"vec2").once()(),bZ=xi(0,"uint").setName("u_cameraIndex").setGroup(v9("cameraIndex")).toVarying("v_cameraIndex"),bJ=xi("float").setName("cameraNear").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.near}),b$=xi("float").setName("cameraFar").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.far}),b0=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t of r.cameras)e.push(t.projectionMatrix);t=bk(e).setGroup(xt).setName("cameraProjectionMatrices").element(r.isMultiViewCamera?bz("gl_ViewID_OVR"):bZ).toConst("cameraProjectionMatrix")}else t=xi("mat4").setName("cameraProjectionMatrix").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.projectionMatrix});return t}).once()(),b1=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t of r.cameras)e.push(t.projectionMatrixInverse);t=bk(e).setGroup(xt).setName("cameraProjectionMatricesInverse").element(r.isMultiViewCamera?bz("gl_ViewID_OVR"):bZ).toConst("cameraProjectionMatrixInverse")}else t=xi("mat4").setName("cameraProjectionMatrixInverse").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.projectionMatrixInverse});return t}).once()(),b2=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t of r.cameras)e.push(t.matrixWorldInverse);t=bk(e).setGroup(xt).setName("cameraViewMatrices").element(r.isMultiViewCamera?bz("gl_ViewID_OVR"):bZ).toConst("cameraViewMatrix")}else t=xi("mat4").setName("cameraViewMatrix").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.matrixWorldInverse});return t}).once()(),b3=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t of r.cameras)e.push(t.matrixWorld);t=bk(e).setGroup(xt).setName("cameraWorldMatrices").element(r.isMultiViewCamera?bz("gl_ViewID_OVR"):bZ).toConst("cameraWorldMatrix")}else t=xi("mat4").setName("cameraWorldMatrix").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.matrixWorld});return t}).once()(),b4=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t of r.cameras)e.push(t.normalMatrix);t=bk(e).setGroup(xt).setName("cameraNormalMatrices").element(r.isMultiViewCamera?bz("gl_ViewID_OVR"):bZ).toConst("cameraNormalMatrix")}else t=xi("mat3").setName("cameraNormalMatrix").setGroup(xt).onRenderUpdate(e=>{let{camera:t}=e;return t.normalMatrix});return t}).once()(),b5=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t=0,n=r.cameras.length;t<n;t++)e.push(new ex);t=bk(e).setGroup(xt).setName("cameraPositions").onRenderUpdate((e,t)=>{let{camera:r}=e,n=r.cameras,i=t.array;for(let e=0,t=n.length;e<t;e++)i[e].setFromMatrixPosition(n[e].matrixWorld)}).element(r.isMultiViewCamera?bz("gl_ViewID_OVR"):bZ).toConst("cameraPosition")}else t=xi(new ex).setName("cameraPosition").setGroup(xt).onRenderUpdate((e,t)=>{let{camera:r}=e;return t.value.setFromMatrixPosition(r.matrixWorld)});return t}).once()(),b6=vn(e=>{let t,{camera:r}=e;if(r.isArrayCamera&&r.cameras.length>0){let e=[];for(let t of r.cameras)e.push(t.viewport);t=bk(e,"vec4").setGroup(xt).setName("cameraViewports").element(bZ).toConst("cameraViewport")}else t=v_(0,0,bH.x,bH.y).toConst("cameraViewport");return t}).once()(),b7=new ta;class b8 extends ym{static get type(){return"Object3DNode"}getNodeType(){let e=this.scope;return e===b8.WORLD_MATRIX?"mat4":e===b8.POSITION||e===b8.VIEW_POSITION||e===b8.DIRECTION||e===b8.SCALE?"vec3":e===b8.RADIUS?"float":void 0}update(e){let t=this.object3d,r=this.uniformNode,n=this.scope;if(n===b8.WORLD_MATRIX)r.value=t.matrixWorld;else if(n===b8.POSITION)r.value=r.value||new ex,r.value.setFromMatrixPosition(t.matrixWorld);else if(n===b8.SCALE)r.value=r.value||new ex,r.value.setFromMatrixScale(t.matrixWorld);else if(n===b8.DIRECTION)r.value=r.value||new ex,t.getWorldDirection(r.value);else if(n===b8.VIEW_POSITION){let n=e.camera;r.value=r.value||new ex,r.value.setFromMatrixPosition(t.matrixWorld),r.value.applyMatrix4(n.matrixWorldInverse)}else if(n===b8.RADIUS){let n=e.object.geometry;null===n.boundingSphere&&n.computeBoundingSphere(),b7.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),r.value=b7.radius}}generate(e){let t=this.scope;return t===b8.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===b8.POSITION||t===b8.VIEW_POSITION||t===b8.DIRECTION||t===b8.SCALE?this.uniformNode.nodeType="vec3":t===b8.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=yl.OBJECT,this.uniformNode=new xn(null)}}b8.WORLD_MATRIX="worldMatrix",b8.POSITION="position",b8.SCALE="scale",b8.VIEW_POSITION="viewPosition",b8.DIRECTION="direction",b8.RADIUS="radius";let b9=y8(b8,b8.DIRECTION).setParameterLength(1),Se=y8(b8,b8.WORLD_MATRIX).setParameterLength(1),St=y8(b8,b8.POSITION).setParameterLength(1),Sr=y8(b8,b8.SCALE).setParameterLength(1),Sn=y8(b8,b8.VIEW_POSITION).setParameterLength(1),Si=y8(b8,b8.RADIUS).setParameterLength(1);class Sa extends b8{static get type(){return"ModelNode"}update(e){this.object3d=e.object,super.update(e)}constructor(e){super(e)}}let Ss=y9(Sa,Sa.DIRECTION),So=y9(Sa,Sa.WORLD_MATRIX),Sl=y9(Sa,Sa.POSITION),Su=y9(Sa,Sa.SCALE),Sc=y9(Sa,Sa.VIEW_POSITION),Sh=y9(Sa,Sa.RADIUS),Sd=xi(new eS).onObjectUpdate((e,t)=>{let{object:r}=e;return t.value.getNormalMatrix(r.matrixWorld)}),SA=xi(new tp).onObjectUpdate((e,t)=>{let{object:r}=e;return t.value.copy(r.matrixWorld).invert()}),Sp=vn(e=>e.renderer.overrideNodes.modelViewMatrix||Sf).once()().toVar("modelViewMatrix"),Sf=b2.mul(So),Sm=vn(e=>(e.context.isHighPrecisionModelViewMatrix=!0,xi("mat4").onObjectUpdate(e=>{let{object:t,camera:r}=e;return t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld)}))).once()().toVar("highpModelViewMatrix"),Sg=vn(e=>{let t=e.context.isHighPrecisionModelViewMatrix;return xi("mat3").onObjectUpdate(e=>{let{object:r,camera:n}=e;return!0!==t&&r.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,r.matrixWorld),r.normalMatrix.getNormalMatrix(r.modelViewMatrix)})}).once()().toVar("highpModelNormalViewMatrix"),Sy=bM("position","vec3"),Sv=Sy.toVarying("positionLocal"),Sx=Sy.toVarying("positionPrevious"),S_=vn(e=>So.mul(Sv).xyz.toVarying(e.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),Sb=vn(()=>Sv.transformDirection(So).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),SS=vn(e=>e.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),ST=SS.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection"),Sw=y9(class extends ym{static get type(){return"FrontFacingNode"}generate(e){if("fragment"!==e.shaderStage)return"true";let{material:t}=e;return 1===t.side?"false":e.getFrontFacing()}constructor(){super("bool"),this.isFrontFacingNode=!0}}),SM=vu(Sw).mul(2).sub(1),SE=vn((e,t)=>{let[r]=e,{material:n}=t,i=n.side;return 1===i?r=r.mul(-1):2===i&&(r=r.mul(SM)),r}),SR=bM("normal","vec3"),SC=vn(e=>!1===e.geometry.hasAttribute("normal")?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),vg(0,1,0)):SR,"vec3").once()().toVar("normalLocal"),SN=SS.dFdx().cross(SS.dFdy()).normalize().toVar("normalFlat"),SP=vn(e=>!0===e.material.flatShading?SN:SU(SC).toVarying("v_normalViewGeometry").normalize(),"vec3").once()().toVar("normalViewGeometry"),SI=vn(e=>{let t=SP.transformDirection(b2);return!0!==e.material.flatShading&&(t=t.toVarying("v_normalWorldGeometry")),t.normalize().toVar("normalWorldGeometry")},"vec3").once()(),SL=vn(e=>{let t,{subBuildFn:r,material:n,context:i}=e;return"NORMAL"===r||"VERTEX"===r?(t=SP,!0!==n.flatShading&&(t=SE(t))):t=i.setupNormal().context({getUV:null}),t},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),SD=SL.transformDirection(b2).toVar("normalWorld"),SB=vn(e=>{let{subBuildFn:t,context:r}=e;return"NORMAL"===t||"VERTEX"===t?SL:r.setupClearcoatNormal().context({getUV:null})},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),SF=vn(e=>{let[t,r=So]=e,n=vM(r),i=t.div(vg(n[0].dot(n[0]),n[1].dot(n[1]),n[2].dot(n[2])));return n.mul(i).xyz}),SU=vn((e,t)=>{let[r]=e,n=t.renderer.overrideNodes.modelNormalViewMatrix;if(null!==n)return n.transformDirection(r);let i=Sd.mul(r);return b2.transformDirection(i)}),SO=vn(()=>(console.warn('THREE.TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),SL)).once(["NORMAL","VERTEX"])(),Sk=vn(()=>(console.warn('THREE.TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),SD)).once(["NORMAL","VERTEX"])(),Sz=vn(()=>(console.warn('THREE.TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),SB)).once(["NORMAL","VERTEX"])(),SV=new tT,Sq=new tp,SG=xi(0).onReference(e=>{let{material:t}=e;return t}).onObjectUpdate(e=>{let{material:t}=e;return t.refractionRatio}),SH=xi(1).onReference(e=>{let{material:t}=e;return t}).onObjectUpdate(function(e){let{material:t,scene:r}=e;return t.envMap?t.envMapIntensity:r.environmentIntensity}),Sj=xi(new tp).onReference(function(e){return e.material}).onObjectUpdate(function(e){let{material:t,scene:r}=e,n=null!==r.environment&&null===t.envMap?r.environmentRotation:t.envMapRotation;return n?(SV.copy(n),Sq.makeRotationFromEuler(SV)):Sq.identity(),Sq}),SW=ST.negate().reflect(SL),SX=ST.negate().refract(SL,SG),SQ=SW.transformDirection(b2).toVar("reflectVector"),SY=SX.transformDirection(b2).toVar("reflectVector"),SK=new rZ,SZ=y8(class extends bP{static get type(){return"CubeTextureNode"}getInputType(){return"cubeTexture"}getDefaultUV(){let e=this.value;return 301===e.mapping?SQ:302===e.mapping?SY:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),vg(0,0,0))}setUpdateMatrix(){}setupUV(e,t){let r=this.value;return 2001!==e.renderer.coordinateSystem&&r.isRenderTargetTexture||(t=vg(t.x.negate(),t.yz)),Sj.mul(t)}generateUV(e,t){return t.build(e,"vec3")}constructor(e,t=null,r=null,n=null){super(e,t,r,n),this.isCubeTextureNode=!0}}).setParameterLength(1,4).setName("cubeTexture"),SJ=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SK,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t&&!0===t.isCubeTextureNode?((e=y4(t.clone())).referenceNode=t,null!==r&&(e.uvNode=y4(r)),null!==n&&(e.levelNode=y4(n)),null!==i&&(e.biasNode=y4(i))):e=SZ(t,r,n,i),e};class S$ extends yg{static get type(){return"ReferenceElementNode"}getNodeType(){return this.referenceNode.uniformType}generate(e){let t=super.generate(e),r=this.referenceNode.getNodeType(),n=this.getNodeType();return e.format(t,r,n)}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}}class S0 extends ym{static get type(){return"ReferenceNode"}element(e){return y4(new S$(this,y4(e)))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;t=null!==this.count?bF(null,e,this.count):Array.isArray(this.getValueFromReference())?bk(null,e):"texture"===e?bL(null):"cubeTexture"===e?SJ(null):xi(null,e),null!==this.group&&t.setGroup(this.group),null!==this.name&&t.setName(this.name),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference,{properties:t}=this,r=e[t[0]];for(let e=1;e<t.length;e++)r=r[t[e]];return r}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);let e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}constructor(e,t,r=null,n=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=n,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.name=null,this.updateType=yl.OBJECT}}let S1=(e,t,r)=>y4(new S0(e,t,r)),S2=(e,t,r,n)=>y4(new S0(e,t,n,r));class S3 extends S0{static get type(){return"MaterialReferenceNode"}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}constructor(e,t,r=null){super(e,t,r),this.material=r,this.isMaterialReferenceNode=!0}}let S4=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return y4(new S3(e,t,r))},S5=bE(),S6=SS.dFdx(),S7=SS.dFdy(),S8=S5.dFdx(),S9=S5.dFdy(),Te=S7.cross(SL),Tt=SL.cross(S6),Tr=Te.mul(S8.x).add(Tt.mul(S9.x)),Tn=Te.mul(S8.y).add(Tt.mul(S9.y)),Ti=Tr.dot(Tr).max(Tn.dot(Tn)),Ta=Ti.equal(0).select(0,Ti.inverseSqrt()),Ts=Tr.mul(Ta).toVar("tangentViewFrame"),To=Tn.mul(Ta).toVar("bitangentViewFrame"),Tl=vn(e=>(!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),bM("tangent","vec4")))(),Tu=Tl.xyz.toVar("tangentLocal"),Tc=vn(e=>{let t,{subBuildFn:r,geometry:n,material:i}=e;return t="VERTEX"===r||n.hasAttribute("tangent")?Sp.mul(v_(Tu,0)).xyz.toVarying("v_tangentView").normalize():Ts,!0!==i.flatShading&&(t=SE(t)),t},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),Th=Tc.transformDirection(b2).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),Td=vn((e,t)=>{let[r,n]=e,{subBuildFn:i,material:a}=t,s=r.mul(Tl.w).xyz;return"NORMAL"===i&&!0!==a.flatShading&&(s=s.toVarying(n)),s}).once(["NORMAL"]),TA=Td(SR.cross(Tl),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),Tp=Td(SC.cross(Tu),"v_bitangentLocal").normalize().toVar("bitangentLocal"),Tf=vn(e=>{let t,{subBuildFn:r,geometry:n,material:i}=e;return t="VERTEX"===r||n.hasAttribute("tangent")?Td(SL.cross(Tc),"v_bitangentView").normalize():To,!0!==i.flatShading&&(t=SE(t)),t},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),Tm=Td(SD.cross(Th),"v_bitangentWorld").normalize().toVar("bitangentWorld"),Tg=vM(Tc,Tf,SL).toVar("TBNViewMatrix"),Ty=ST.mul(Tg),Tv=vn(()=>{let e=vX.cross(ST);return _C(e=e.cross(vX).normalize(),SL,vj.mul(vB.oneMinus()).oneMinus().pow2().pow2()).normalize()}).once()(),Tx=y8(class extends yv{static get type(){return"NormalMapNode"}setup(e){let{material:t}=e,{normalMapType:r,scaleNode:n}=this,i=this.node.mul(2).sub(1);if(null!==n){let e=n;!0===t.flatShading&&(e=SE(e)),i=vg(i.xy.mul(e),i.z)}let a=null;return 1===r?a=SU(i):0===r?a=Tg.mul(i).normalize():(console.error("THREE.NodeMaterial: Unsupported normal map type: ".concat(r)),a=SL),a}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=0}}).setParameterLength(1,2),T_=vn(e=>{let{textureNode:t,bumpScale:r}=e,n=e=>t.cache().context({getUV:t=>e(t.uvNode||bE()),forceUVContext:!0}),i=vu(n(e=>e));return vA(vu(n(e=>e.add(e.dFdx()))).sub(i),vu(n(e=>e.add(e.dFdy()))).sub(i)).mul(r)}),Tb=vn(e=>{let{surf_pos:t,surf_norm:r,dHdxy:n}=e,i=t.dFdx().normalize(),a=t.dFdy().normalize().cross(r),s=r.cross(i),o=i.dot(a).mul(SM),l=o.sign().mul(n.x.mul(a).add(n.y.mul(s)));return o.abs().mul(r).sub(l).normalize()}),TS=y8(class extends yv{static get type(){return"BumpMapNode"}setup(){let e=null!==this.scaleNode?this.scaleNode:1;return Tb({surf_pos:SS,surf_norm:SL,dHdxy:T_({textureNode:this.textureNode,bumpScale:e})})}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}}).setParameterLength(1,2),TT=new Map;class Tw extends ym{static get type(){return"MaterialNode"}getCache(e,t){let r=TT.get(e);return void 0===r&&(r=S4(e,t),TT.set(e,r)),r}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){let t=e.context.material,r=this.scope,n=null;if(r===Tw.COLOR){let e=void 0!==t.color?this.getColor(r):vg();n=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(r===Tw.OPACITY){let e=this.getFloat(r);n=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(r===Tw.SPECULAR_STRENGTH)n=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:vu(1);else if(r===Tw.SPECULAR_INTENSITY){let e=this.getFloat(r);n=t.specularIntensityMap&&!0===t.specularIntensityMap.isTexture?e.mul(this.getTexture(r).a):e}else if(r===Tw.SPECULAR_COLOR){let e=this.getColor(r);n=t.specularColorMap&&!0===t.specularColorMap.isTexture?e.mul(this.getTexture(r).rgb):e}else if(r===Tw.ROUGHNESS){let e=this.getFloat(r);n=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(r).g):e}else if(r===Tw.METALNESS){let e=this.getFloat(r);n=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(r).b):e}else if(r===Tw.EMISSIVE){let e=this.getFloat("emissiveIntensity"),i=this.getColor(r).mul(e);n=t.emissiveMap&&!0===t.emissiveMap.isTexture?i.mul(this.getTexture(r)):i}else if(r===Tw.NORMAL)t.normalMap?(n=Tx(this.getTexture("normal"),this.getCache("normalScale","vec2"))).normalMapType=t.normalMapType:n=t.bumpMap?TS(this.getTexture("bump").r,this.getFloat("bumpScale")):SL;else if(r===Tw.CLEARCOAT){let e=this.getFloat(r);n=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(r).r):e}else if(r===Tw.CLEARCOAT_ROUGHNESS){let e=this.getFloat(r);n=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(r).r):e}else if(r===Tw.CLEARCOAT_NORMAL)n=t.clearcoatNormalMap?Tx(this.getTexture(r),this.getCache(r+"Scale","vec2")):SL;else if(r===Tw.SHEEN){let e=this.getColor("sheenColor").mul(this.getFloat("sheen"));n=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(r===Tw.SHEEN_ROUGHNESS){let e=this.getFloat(r);n=(n=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(r).a):e).clamp(.07,1)}else if(r===Tw.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){let e=this.getTexture(r);n=vw(T9.x,T9.y,T9.y.negate(),T9.x).mul(e.rg.mul(2).sub(vA(1)).normalize().mul(e.b))}else n=T9;else if(r===Tw.IRIDESCENCE_THICKNESS){let e=S1("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){let i=S1("0","float",t.iridescenceThicknessRange);n=e.sub(i).mul(this.getTexture(r).g).add(i)}else n=e}else if(r===Tw.TRANSMISSION){let e=this.getFloat(r);n=t.transmissionMap?e.mul(this.getTexture(r).r):e}else if(r===Tw.THICKNESS){let e=this.getFloat(r);n=t.thicknessMap?e.mul(this.getTexture(r).g):e}else if(r===Tw.IOR)n=this.getFloat(r);else if(r===Tw.LIGHT_MAP)n=this.getTexture(r).rgb.mul(this.getFloat("lightMapIntensity"));else if(r===Tw.AO)n=this.getTexture(r).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(r===Tw.LINE_DASH_OFFSET)n=t.dashOffset?this.getFloat(r):vu(0);else{let t=this.getNodeType(e);n=this.getCache(r,t)}return n}constructor(e){super(),this.scope=e}}Tw.ALPHA_TEST="alphaTest",Tw.COLOR="color",Tw.OPACITY="opacity",Tw.SHININESS="shininess",Tw.SPECULAR="specular",Tw.SPECULAR_STRENGTH="specularStrength",Tw.SPECULAR_INTENSITY="specularIntensity",Tw.SPECULAR_COLOR="specularColor",Tw.REFLECTIVITY="reflectivity",Tw.ROUGHNESS="roughness",Tw.METALNESS="metalness",Tw.NORMAL="normal",Tw.CLEARCOAT="clearcoat",Tw.CLEARCOAT_ROUGHNESS="clearcoatRoughness",Tw.CLEARCOAT_NORMAL="clearcoatNormal",Tw.EMISSIVE="emissive",Tw.ROTATION="rotation",Tw.SHEEN="sheen",Tw.SHEEN_ROUGHNESS="sheenRoughness",Tw.ANISOTROPY="anisotropy",Tw.IRIDESCENCE="iridescence",Tw.IRIDESCENCE_IOR="iridescenceIOR",Tw.IRIDESCENCE_THICKNESS="iridescenceThickness",Tw.IOR="ior",Tw.TRANSMISSION="transmission",Tw.THICKNESS="thickness",Tw.ATTENUATION_DISTANCE="attenuationDistance",Tw.ATTENUATION_COLOR="attenuationColor",Tw.LINE_SCALE="scale",Tw.LINE_DASH_SIZE="dashSize",Tw.LINE_GAP_SIZE="gapSize",Tw.LINE_WIDTH="linewidth",Tw.LINE_DASH_OFFSET="dashOffset",Tw.POINT_SIZE="size",Tw.DISPERSION="dispersion",Tw.LIGHT_MAP="light",Tw.AO="ao";let TM=y9(Tw,Tw.ALPHA_TEST),TE=y9(Tw,Tw.COLOR),TR=y9(Tw,Tw.SHININESS),TC=y9(Tw,Tw.EMISSIVE),TN=y9(Tw,Tw.OPACITY),TP=y9(Tw,Tw.SPECULAR),TI=y9(Tw,Tw.SPECULAR_INTENSITY),TL=y9(Tw,Tw.SPECULAR_COLOR),TD=y9(Tw,Tw.SPECULAR_STRENGTH),TB=y9(Tw,Tw.REFLECTIVITY),TF=y9(Tw,Tw.ROUGHNESS),TU=y9(Tw,Tw.METALNESS),TO=y9(Tw,Tw.NORMAL),Tk=y9(Tw,Tw.CLEARCOAT),Tz=y9(Tw,Tw.CLEARCOAT_ROUGHNESS),TV=y9(Tw,Tw.CLEARCOAT_NORMAL),Tq=y9(Tw,Tw.ROTATION),TG=y9(Tw,Tw.SHEEN),TH=y9(Tw,Tw.SHEEN_ROUGHNESS),Tj=y9(Tw,Tw.ANISOTROPY),TW=y9(Tw,Tw.IRIDESCENCE),TX=y9(Tw,Tw.IRIDESCENCE_IOR),TQ=y9(Tw,Tw.IRIDESCENCE_THICKNESS),TY=y9(Tw,Tw.TRANSMISSION),TK=y9(Tw,Tw.THICKNESS),TZ=y9(Tw,Tw.IOR),TJ=y9(Tw,Tw.ATTENUATION_DISTANCE),T$=y9(Tw,Tw.ATTENUATION_COLOR),T0=y9(Tw,Tw.LINE_SCALE),T1=y9(Tw,Tw.LINE_DASH_SIZE),T2=y9(Tw,Tw.LINE_GAP_SIZE),T3=y9(Tw,Tw.LINE_WIDTH),T4=y9(Tw,Tw.LINE_DASH_OFFSET),T5=y9(Tw,Tw.POINT_SIZE),T6=y9(Tw,Tw.DISPERSION),T7=y9(Tw,Tw.LIGHT_MAP),T8=y9(Tw,Tw.AO),T9=xi(new ey).onReference(function(e){return e.material}).onRenderUpdate(function(e){let{material:t}=e;this.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation))}),we=vn(e=>e.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class wt extends ym{static get type(){return"IndexNode"}generate(e){let t,r=this.getNodeType(e),n=this.scope;if(n===wt.VERTEX)t=e.getVertexIndex();else if(n===wt.INSTANCE)t=e.getInstanceIndex();else if(n===wt.DRAW)t=e.getDrawIndex();else if(n===wt.INVOCATION_LOCAL)t=e.getInvocationLocalIndex();else if(n===wt.INVOCATION_SUBGROUP)t=e.getInvocationSubgroupIndex();else if(n===wt.SUBGROUP)t=e.getSubgroupIndex();else throw Error("THREE.IndexNode: Unknown scope: "+n);return"vertex"===e.shaderStage||"compute"===e.shaderStage?t:_$(this).build(e,r)}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}}wt.VERTEX="vertex",wt.INSTANCE="instance",wt.SUBGROUP="subgroup",wt.INVOCATION_LOCAL="invocationLocal",wt.INVOCATION_SUBGROUP="invocationSubgroup",wt.DRAW="draw";let wr=y9(wt,wt.VERTEX),wn=y9(wt,wt.INSTANCE),wi=y9(wt,wt.SUBGROUP),wa=y9(wt,wt.INVOCATION_SUBGROUP),ws=y9(wt,wt.INVOCATION_LOCAL),wo=y9(wt,wt.DRAW);class wl extends ym{static get type(){return"InstanceNode"}setup(e){let{instanceMatrix:t,instanceColor:r}=this,{count:n}=t,{instanceMatrixNode:i,instanceColorNode:a}=this;if(null===i){if(n<=1e3)i=bF(t.array,"mat4",Math.max(n,1)).element(wn);else{let e=new oR(t.array,16,1);this.buffer=e;let r=35048===t.usage?bl:bo;i=vE(r(e,"vec4",16,0),r(e,"vec4",16,4),r(e,"vec4",16,8),r(e,"vec4",16,12))}this.instanceMatrixNode=i}if(r&&null===a){let e=new nP(r.array,3),t=35048===r.usage?bl:bo;this.bufferColor=e,a=vg(t(e,"vec3",3,0)),this.instanceColorNode=a}let s=i.mul(Sv).xyz;if(Sv.assign(s),e.hasGeometryAttribute("normal")){let e=SF(SC,i);SC.assign(e)}null!==this.instanceColorNode&&vI("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){35048!==this.instanceMatrix.usage&&null!==this.buffer&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&35048!==this.instanceColor.usage&&null!==this.bufferColor&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}constructor(e,t,r=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=r,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=yl.FRAME,this.buffer=null,this.bufferColor=null}}let wu=y8(wl).setParameterLength(2,3),wc=y8(class extends wl{static get type(){return"InstancedMeshNode"}constructor(e){let{count:t,instanceMatrix:r,instanceColor:n}=e;super(t,r,n),this.instancedMesh=e}}).setParameterLength(1),wh=y8(class extends ym{static get type(){return"BatchNode"}setup(e){null===this.batchingIdNode&&(null===e.getDrawIndex()?this.batchingIdNode=wn:this.batchingIdNode=wo);let t=vn(e=>{let[t]=e,r=vc(bR(bD(this.batchMesh._indirectTexture),0).x),n=vc(t).mod(r),i=vc(t).div(r);return bD(this.batchMesh._indirectTexture,vp(n,i)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(vc(this.batchingIdNode)),r=this.batchMesh._matricesTexture,n=vc(bR(bD(r),0).x),i=vu(t).mul(4).toInt().toVar(),a=i.mod(n),s=i.div(n),o=vE(bD(r,vp(a,s)),bD(r,vp(a.add(1),s)),bD(r,vp(a.add(2),s)),bD(r,vp(a.add(3),s))),l=this.batchMesh._colorsTexture;if(null!==l){let e=vn(e=>{let[t]=e,r=vc(bR(bD(l),0).x);return bD(l,vp(t.mod(r),t.div(r))).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(t);vI("vec3","vBatchColor").assign(e)}let u=vM(o);Sv.assign(o.mul(Sv));let c=SC.div(vg(u[0].dot(u[0]),u[1].dot(u[1]),u[2].dot(u[2]))),h=u.mul(c).xyz;SC.assign(h),e.hasGeometryAttribute("tangent")&&Tu.mulAssign(u)}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}}).setParameterLength(1),wd=y8(class extends yg{static get type(){return"StorageArrayElementNode"}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){let r=this.storageBufferNode.structTypeNode;return r?r.getMemberType(e,t):"void"}setup(e){return!1===e.isAvailable("storageBuffer")&&!0===this.node.isPBO&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let r,n=e.context.assign;if(r=!1===e.isAvailable("storageBuffer")?!0===this.node.isPBO&&!0!==n&&(this.node.value.isInstancedBufferAttribute||"compute"!==e.shaderStage)?e.generatePBO(this):this.node.build(e):super.generate(e),!0!==n){let n=this.getNodeType(e);r=e.format(r,n,t)}return r}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}}).setParameterLength(2);class wA extends bB{static get type(){return"StorageBufferNode"}getHash(e){if(0===this.bufferCount){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return wd(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(yu.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return null===this._attribute&&(this._attribute=ba(this.value),this._varying=_$(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(null!==this.structTypeNode)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);let{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return null!==this.structTypeNode?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(null!==this.structTypeNode&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);let{attribute:t,varying:r}=this.getAttributeData(),n=r.build(e);return e.registerTransform(n,t),n}constructor(e,t=null,r=0){let n,i=null;if(t&&t.isStruct)n="struct",i=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(r=e.count);else if(null===t&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)){var a;a=e.itemSize,n=g8.get(a),r=e.count}else n=t;super(e,n,r),this.isStorageBufferNode=!0,this.structTypeNode=i,this.access=yu.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,!0!==e.isStorageBufferAttribute&&!0!==e.isStorageInstancedBufferAttribute&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}}let wp=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return y4(new wA(e,t,r))},wf=new WeakMap;class wm extends ym{static get type(){return"SkinningNode"}getSkinnedPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.boneMatricesNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.positionNode,{skinIndexNode:r,skinWeightNode:n,bindMatrixNode:i,bindMatrixInverseNode:a}=this,s=e.element(r.x),o=e.element(r.y),l=e.element(r.z),u=e.element(r.w),c=i.mul(t),h=xd(s.mul(n.x).mul(c),o.mul(n.y).mul(c),l.mul(n.z).mul(c),u.mul(n.w).mul(c));return a.mul(h).xyz}getSkinnedNormal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.boneMatricesNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:SC,{skinIndexNode:r,skinWeightNode:n,bindMatrixNode:i,bindMatrixInverseNode:a}=this,s=e.element(r.x),o=e.element(r.y),l=e.element(r.z),u=e.element(r.w),c=xd(n.x.mul(s),n.y.mul(o),n.z.mul(l),n.w.mul(u));return(c=a.mul(c).mul(i)).transformDirection(t).xyz}getPreviousSkinnedPosition(e){let t=e.object;return null===this.previousBoneMatricesNode&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=S2("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,Sx)}needsPreviousBoneMatrices(e){let t=e.renderer.getMRT();return t&&t.has("velocity")||!0===yi(e.object).useVelocity}setup(e){this.needsPreviousBoneMatrices(e)&&Sx.assign(this.getPreviousSkinnedPosition(e));let t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){let t=this.getSkinnedNormal();SC.assign(t),e.hasGeometryAttribute("tangent")&&Tu.assign(t)}return t}generate(e,t){if("void"!==t)return super.generate(e,t)}update(e){let t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;wf.get(t)!==e.frameId&&(wf.set(t,e.frameId),null!==this.previousBoneMatricesNode&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=yl.OBJECT,this.skinIndexNode=bM("skinIndex","uvec4"),this.skinWeightNode=bM("skinWeight","vec4"),this.bindMatrixNode=S1("bindMatrix","mat4"),this.bindMatrixInverseNode=S1("bindMatrixInverse","mat4"),this.boneMatricesNode=S2("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Sv,this.toPositionNode=Sv,this.previousBoneMatricesNode=null}}let wg=e=>y4(new wm(e));class wy extends ym{static get type(){return"LoopNode"}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){let t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;let r={};for(let e=0,t=this.params.length-1;e<t;e++){let t=this.params[e],n=!0!==t.isNode&&t.name||this.getVarName(e),i=!0!==t.isNode&&t.type||"int";r[n]=bv(n,i)}let n=e.addStack();t.returnsNode=this.params[this.params.length-1](r,e),t.stackNode=n;let i=this.params[0];return!0!==i.isNode&&"function"==typeof i.update&&(t.updateNode=vn(this.params[0].update)(r)),e.removeStack(),t}getNodeType(e){let{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){let t=this.getProperties(e),r=this.params,n=t.stackNode;for(let n=0,i=r.length-1;n<i;n++){let i,a=r[n],s=!1,o=null,l=null,u=null,c=null,h=null,d=null;if(a.isNode?"bool"===a.getNodeType(e)?(s=!0,c="bool",l=a.build(e,c)):(c="int",u=this.getVarName(n),o="0",l=a.build(e,c),h="<"):(c=a.type||"int",u=a.name||this.getVarName(n),o=a.start,l=a.end,h=a.condition,d=a.update,"number"==typeof o?o=e.generateConst(c,o):o&&o.isNode&&(o=o.build(e,c)),"number"==typeof l?l=e.generateConst(c,l):l&&l.isNode&&(l=l.build(e,c)),void 0!==o&&void 0===l?(o+=" - 1",l="0",h=">="):void 0!==l&&void 0===o&&(o="0",h="<"),void 0===h&&(h=Number(o)>Number(l)?">=":"<")),s)i="while ( ".concat(l," )");else{let r,n=o,a=l,s=()=>h.includes("<")?"+=":"-=";if(null!=d)switch(typeof d){case"function":r=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":r=u+" "+s()+" "+e.generateConst(c,d);break;case"string":r=u+" "+d;break;default:d.isNode?r=u+" "+s()+" "+d.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),r="break /* invalid update */")}else r=u+" "+(d="int"===c||"uint"===c?h.includes("<")?"++":"--":s()+" 1.");let A=e.getVar(c,u)+" = "+n,p=u+" "+h+" "+a;i="for ( ".concat(A,"; ").concat(p,"; ").concat(r," )")}e.addFlowCode((0===n?"\n":"")+e.tab+i+" {\n\n").addFlowTab()}let i=n.build(e,"void"),a=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+i);for(let t=0,r=this.params.length-1;t<r;t++)e.addFlowCode((0===t?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),a}constructor(e=[]){super(),this.params=e}}let wv=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return y4(new wy(y7(t,"int"))).toStack()},wx=()=>bv("break").toStack(),w_=new WeakMap,wb=new eH,wS=vn(e=>{let{bufferMap:t,influence:r,stride:n,width:i,depth:a,offset:s}=e,o=vc(wr).mul(n).add(s),l=o.div(i);return bD(t,vp(o.sub(l.mul(i)),l)).depth(a).xyz.mul(r)}),wT=y8(class extends ym{static get type(){return"MorphNode"}setup(e){let{geometry:t}=e,r=void 0!==t.morphAttributes.position,n=t.hasAttribute("normal")&&void 0!==t.morphAttributes.normal,i=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,a=void 0!==i?i.length:0,{texture:s,stride:o,size:l}=function(e){let t=void 0!==e.morphAttributes.position,r=void 0!==e.morphAttributes.normal,n=void 0!==e.morphAttributes.color,i=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,a=void 0!==i?i.length:0,s=w_.get(e);if(void 0===s||s.count!==a){void 0!==s&&s.texture.dispose();let i=e.morphAttributes.position||[],o=e.morphAttributes.normal||[],l=e.morphAttributes.color||[],u=0;!0===t&&(u=1),!0===r&&(u=2),!0===n&&(u=3);let c=e.attributes.position.count*u,h=1;c>4096&&(h=Math.ceil(c/4096),c=4096);let d=new Float32Array(c*h*4*a),A=new eX(d,c,h,a);A.type=1015,A.needsUpdate=!0;let p=4*u;for(let e=0;e<a;e++){let a=i[e],s=o[e],u=l[e],A=c*h*4*e;for(let e=0;e<a.count;e++){let i=e*p;!0===t&&(wb.fromBufferAttribute(a,e),d[A+i+0]=wb.x,d[A+i+1]=wb.y,d[A+i+2]=wb.z,d[A+i+3]=0),!0===r&&(wb.fromBufferAttribute(s,e),d[A+i+4]=wb.x,d[A+i+5]=wb.y,d[A+i+6]=wb.z,d[A+i+7]=0),!0===n&&(wb.fromBufferAttribute(u,e),d[A+i+8]=wb.x,d[A+i+9]=wb.y,d[A+i+10]=wb.z,d[A+i+11]=4===u.itemSize?wb.w:1)}}s={count:a,texture:A,stride:u,size:new ey(c,h)},w_.set(e,s),e.addEventListener("dispose",function t(){A.dispose(),w_.delete(e),e.removeEventListener("dispose",t)})}return s}(t);!0===r&&Sv.mulAssign(this.morphBaseInfluence),!0===n&&SC.mulAssign(this.morphBaseInfluence);let u=vc(l.width);wv(a,e=>{let{i:t}=e,i=vu(0).toVar();this.mesh.count>1&&null!==this.mesh.morphTexture&&void 0!==this.mesh.morphTexture?i.assign(bD(this.mesh.morphTexture,vp(vc(t).add(1),vc(wn))).r):i.assign(S1("morphTargetInfluences","float").element(t).toVar()),vs(i.notEqual(0),()=>{!0===r&&Sv.addAssign(wS({bufferMap:s,influence:i,stride:o,width:u,depth:t,offset:vc(0)})),!0===n&&SC.addAssign(wS({bufferMap:s,influence:i,stride:o,width:u,depth:t,offset:vc(1)}))})})}update(){let e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((e,t)=>e+t,0)}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=xi(1),this.updateType=yl.OBJECT}}).setParameterLength(1);class ww extends ym{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class wM extends ww{static get type(){return"AONode"}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}constructor(e=null){super(),this.aoNode=e}}let wE=y8(class extends _V{static get type(){return"LightingContextNode"}getContext(){let{backdropNode:e,backdropAlphaNode:t}=this,r=vg().toVar("directDiffuse"),n=vg().toVar("directSpecular"),i=vg().toVar("indirectDiffuse"),a=vg().toVar("indirectSpecular");return{radiance:vg().toVar("radiance"),irradiance:vg().toVar("irradiance"),iblIrradiance:vg().toVar("iblIrradiance"),ambientOcclusion:vu(1).toVar("ambientOcclusion"),reflectedLight:{directDiffuse:r,directSpecular:n,indirectDiffuse:i,indirectSpecular:a},backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}constructor(e,t=null,r=null,n=null){super(e),this.lightingModel=t,this.backdropNode=r,this.backdropAlphaNode=n,this._value=null}});class wR extends ww{static get type(){return"IrradianceNode"}setup(e){e.context.irradiance.addAssign(this.node)}constructor(e){super(),this.node=e}}let wC=new ey;class wN extends bP{static get type(){return"ViewportTextureNode"}getTextureForReference(){let e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.referenceNode?(e=this.referenceNode.defaultFramebuffer,t=this.referenceNode._cacheTextures):(e=this.defaultFramebuffer,t=this._cacheTextures),null===r)return e;if(!1===t.has(r)){let n=e.clone();t.set(r,n)}return t.get(r)}updateReference(e){let t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){let t=e.renderer,r=t.getRenderTarget();null===r?t.getDrawingBufferSize(wC):wC.set(r.width,r.height);let n=this.getTextureForReference(r);(n.image.width!==wC.width||n.image.height!==wC.height)&&(n.image.width=wC.width,n.image.height=wC.height,n.needsUpdate=!0);let i=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=i}clone(){let e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}constructor(e=bG,t=null,r=null){let n=null;null===r?((n=new iC).minFilter=1008,r=n):n=r,super(r,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=n,this.isOutputTextureNode=!0,this.updateBeforeType=yl.FRAME,this._cacheTextures=new WeakMap}}let wP=y8(wN).setParameterLength(0,3),wI=y8(wN,null,null,{generateMipmaps:!0}).setParameterLength(0,3),wL=null,wD=y8(class extends wN{static get type(){return"ViewportDepthTextureNode"}getTextureForReference(){return wL}constructor(e=bG,t=null){null===wL&&(wL=new iD),super(e,t,wL)}}).setParameterLength(0,2);class wB extends ym{static get type(){return"ViewportDepthNode"}generate(e){let{scope:t}=this;return t===wB.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup(e){let{camera:t}=e,{scope:r}=this,n=this.valueNode,i=null;return r===wB.DEPTH_BASE?null!==n&&(i=wz().assign(n)):r===wB.DEPTH?i=t.isPerspectiveCamera?wU(SS.z,bJ,b$):wF(SS.z,bJ,b$):r===wB.LINEAR_DEPTH&&(i=null!==n?t.isPerspectiveCamera?wF(wO(n,bJ,b$),bJ,b$):n:wF(SS.z,bJ,b$)),i}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}}wB.DEPTH_BASE="depthBase",wB.DEPTH="depth",wB.LINEAR_DEPTH="linearDepth";let wF=(e,t,r)=>e.add(t).div(t.sub(r)),wU=(e,t,r)=>t.add(e).mul(r).div(r.sub(t).mul(e)),wO=(e,t,r)=>t.mul(r).div(r.sub(t).mul(e).sub(r)),wk=(e,t,r)=>{t=t.max(1e-6).toVar();let n=xK(e.negate().div(t)),i=xK(r.div(t));return n.div(i)},wz=y8(wB,wB.DEPTH_BASE),wV=y9(wB,wB.DEPTH),wq=y8(wB,wB.LINEAR_DEPTH).setParameterLength(0,1),wG=wq(wD());wV.assign=e=>wz(e);class wH extends ym{static get type(){return"ClippingNode"}setup(e){super.setup(e);let{intersectionPlanes:t,unionPlanes:r}=e.clippingContext;return(this.hardwareClipping=e.material.hardwareClipping,this.scope===wH.ALPHA_TO_COVERAGE)?this.setupAlphaToCoverage(t,r):this.scope===wH.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(t,r)}setupAlphaToCoverage(e,t){return vn(()=>{let r=vu().toVar("distanceToPlane"),n=vu().toVar("distanceToGradient"),i=vu(1).toVar("clipOpacity"),a=t.length;if(!1===this.hardwareClipping&&a>0){let e=bk(t).setGroup(xt);wv(a,t=>{let{i:a}=t,s=e.element(a);r.assign(SS.dot(s.xyz).negate().add(s.w)),n.assign(r.fwidth().div(2)),i.mulAssign(_L(n.negate(),n,r))})}let s=e.length;if(s>0){let t=bk(e).setGroup(xt),a=vu(1).toVar("intersectionClipOpacity");wv(s,e=>{let{i:i}=e,s=t.element(i);r.assign(SS.dot(s.xyz).negate().add(s.w)),n.assign(r.fwidth().div(2)),a.mulAssign(_L(n.negate(),n,r).oneMinus())}),i.mulAssign(a.oneMinus())}vL.a.mulAssign(i),vL.a.equal(0).discard()})()}setupDefault(e,t){return vn(()=>{let r=t.length;if(!1===this.hardwareClipping&&r>0){let e=bk(t).setGroup(xt);wv(r,t=>{let{i:r}=t,n=e.element(r);SS.dot(n.xyz).greaterThan(n.w).discard()})}let n=e.length;if(n>0){let t=bk(e).setGroup(xt),r=vd(!0).toVar("clipped");wv(n,e=>{let{i:n}=e,i=t.element(n);r.assign(SS.dot(i.xyz).greaterThan(i.w).and(r))}),r.discard()}})()}setupHardwareClipping(e,t){let r=e.length;return t.enableHardwareClipping(r),vn(()=>{let n=bk(e).setGroup(xt),i=bz(t.getClipDistance());wv(r,e=>{let{i:t}=e,r=n.element(t),a=SS.dot(r.xyz).sub(r.w).negate();i.element(t).assign(a)})})()}constructor(e=wH.DEFAULT){super(),this.scope=e}}wH.ALPHA_TO_COVERAGE="alphaToCoverage",wH.DEFAULT="default",wH.HARDWARE="hardware";let wj=vn(e=>{let[t]=e;return x2(xp(1e4,x3(xp(17,t.x).add(xp(.1,t.y)))).mul(xd(.1,x9(x3(xp(13,t.y).add(t.x))))))}),wW=vn(e=>{let[t]=e;return wj(vA(wj(t.xy),t.z))}),wX=vn(e=>{let[t]=e,r=_f(_t(_i(t.xyz)),_t(_a(t.xyz))),n=vu(1).div(vu(.05).mul(r)).toVar("pixScale"),i=vA(xQ(x$(xK(n))),xQ(x0(xK(n)))),a=vA(wW(x$(i.x.mul(t.xyz))),wW(x$(i.y.mul(t.xyz)))),s=x2(xK(n)),o=xd(xp(s.oneMinus(),a.x),xp(s,a.y)),l=_p(s,s.oneMinus()),u=vg(o.mul(o).div(xp(2,l).mul(xA(1,l))),o.sub(xp(.5,l)).div(xA(1,l)),xA(1,xA(1,o).mul(xA(1,o)).div(xp(2,l).mul(xA(1,l)))));return _N(o.lessThan(l.oneMinus()).select(o.lessThan(l).select(u.x,u.y),u.z),1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class wQ extends bw{static get type(){return"VertexColorNode"}getAttributeName(){let e=this.index;return"color"+(e>0?e:"")}generate(e){let t=this.getAttributeName(e);return!0===e.hasGeometryAttribute(t)?super.generate(e):e.generateConst(this.nodeType,new eH(1,1,1,1))}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}}let wY=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return y4(new wQ(e))},wK=vn(e=>{let[t,r]=e;return _p(1,t.oneMinus().div(r)).oneMinus()}).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),wZ=vn(e=>{let[t,r]=e;return _p(t.div(r.oneMinus()),1)}).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),wJ=vn(e=>{let[t,r]=e;return t.oneMinus().mul(r.oneMinus()).oneMinus()}).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),w$=vn(e=>{let[t,r]=e;return _C(t.mul(2).mul(r),t.oneMinus().mul(2).mul(r.oneMinus()).oneMinus(),_m(.5,t))}).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),w0=vn(e=>{let[t,r]=e,n=r.a.add(t.a.mul(r.a.oneMinus()));return v_(r.rgb.mul(r.a).add(t.rgb.mul(t.a).mul(r.a.oneMinus())).div(n),n)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),w1=vn(e=>{let[t]=e;return v_(t.rgb.mul(t.a),t.a)},{color:"vec4",return:"vec4"}),w2=vn(e=>{let[t]=e;return vs(t.a.equal(0),()=>v_(0)),v_(t.rgb.div(t.a),t.a)},{color:"vec4",return:"vec4"});class w3 extends t9{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}customProgramCacheKey(){return this.type+g6(this)}build(e){this.setup(e)}setupObserver(e){return new g1(e)}setup(e){let t;e.context.setupNormal=()=>_J(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);let r=e.renderer,n=r.getRenderTarget();e.addStack();let i=_J(this.setupVertex(e),"VERTEX"),a=this.vertexNode||i;e.stack.outputNode=a,this.setupHardwareClipping(e),null!==this.geometryNode&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let s=this.setupClipping(e);if((!0===this.depthWrite||!0===this.depthTest)&&(null!==n?!0===n.depthBuffer&&this.setupDepth(e):!0===r.depth&&this.setupDepth(e)),null===this.fragmentNode){this.setupDiffuseColor(e),this.setupVariants(e);let i=this.setupLighting(e);null!==s&&e.stack.add(s);let a=v_(i,vL.a).max(0);t=this.setupOutput(e,a),vZ.assign(t);let o=null!==this.outputNode;if(o&&(t=this.outputNode),null!==n){let e=r.getMRT(),n=this.mrtNode;null!==e?(o&&vZ.assign(t),t=e,null!==n&&(t=e.merge(n))):null!==n&&(t=n)}}else{let r=this.fragmentNode;!0!==r.isOutputStructNode&&(r=v_(r)),t=this.setupOutput(e,r)}e.stack.outputNode=t,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(null===e.clippingContext)return null;let{unionPlanes:t,intersectionPlanes:r}=e.clippingContext,n=null;if(t.length>0||r.length>0){let t=e.renderer.samples;this.alphaToCoverage&&t>1?n=y4(new wH(wH.ALPHA_TO_COVERAGE)):e.stack.add(y4(new wH))}return n}setupHardwareClipping(e){if(this.hardwareClipping=!1,null===e.clippingContext)return;let t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(y4(new wH(wH.HARDWARE))),this.hardwareClipping=!0)}setupDepth(e){let{renderer:t,camera:r}=e,n=this.depthNode;if(null===n){let e=t.getMRT();e&&e.has("depth")?n=e.get("depth"):!0===t.logarithmicDepthBuffer&&(n=r.isPerspectiveCamera?wk(SS.z,bJ,b$):wF(SS.z,bJ,b$))}null!==n&&wV.assign(n).toStack()}setupPositionView(){return Sp.mul(Sv).xyz}setupModelViewProjection(){return b0.mul(SS)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),we}setupPosition(e){let{object:t,geometry:r}=e;if((r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color)&&wT(t).toStack(),!0===t.isSkinnedMesh&&wg(t).toStack(),this.displacementMap){let e=S4("displacementMap","texture"),t=S4("displacementScale","float"),r=S4("displacementBias","float");Sv.addAssign(SC.normalize().mul(e.x.mul(t).add(r)))}return t.isBatchedMesh&&wh(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&wc(t).toStack(),null!==this.positionNode&&Sv.assign(_J(this.positionNode,"POSITION","vec3")),Sv}setupDiffuseColor(e){let{object:t,geometry:r}=e;null!==this.maskNode&&vd(this.maskNode).not().discard();let n=this.colorNode?v_(this.colorNode):TE;!0===this.vertexColors&&r.hasAttribute("color")&&(n=n.mul(wY())),t.instanceColor&&(n=vI("vec3","vInstanceColor").mul(n)),t.isBatchedMesh&&t._colorsTexture&&(n=vI("vec3","vBatchColor").mul(n)),vL.assign(n);let i=this.opacityNode?vu(this.opacityNode):TN;vL.a.assign(vL.a.mul(i));let a=null;(null!==this.alphaTestNode||this.alphaTest>0)&&(a=null!==this.alphaTestNode?vu(this.alphaTestNode):TM,vL.a.lessThanEqual(a).discard()),!0===this.alphaHash&&vL.a.lessThan(wX(Sv)).discard(),!1===this.transparent&&1===this.blending&&!1===this.alphaToCoverage?vL.a.assign(1):null===a&&vL.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return!0===this.lights?vg(0):vL.rgb}setupNormal(){return this.normalNode?vg(this.normalNode):TO}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?S4("envMap","cubeTexture"):S4("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new wR(T7)),t}setupLights(e){let t=[],r=this.setupEnvironment(e);r&&r.isLightingNode&&t.push(r);let n=this.setupLightMap(e);if(n&&n.isLightingNode&&t.push(n),null!==this.aoNode||e.material.aoMap){let e=null!==this.aoNode?this.aoNode:T8;t.push(new wM(e))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){let{material:t}=e,{backdropNode:r,backdropAlphaNode:n,emissiveNode:i}=this,a=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null,s=this.setupOutgoingLight(e);return a&&a.getScope().hasLights?s=wE(a,this.setupLightingModel(e)||null,r,n):null!==r&&(s=vg(null!==n?_C(s,r,n):r)),(i&&!0===i.isNode||t.emissive&&!0===t.emissive.isColor)&&(vD.assign(vg(i||TC)),s=s.add(vD)),s}setupFog(e,t){let r=e.fogNode;return r&&(vZ.assign(t),t=v_(r.toVar())),t}setupPremultipliedAlpha(e,t){return w1(t)}setupOutput(e,t){return!0===this.fog&&(t=this.setupFog(e,t)),!0===this.premultipliedAlpha&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(let t in e){let r=e[t];void 0===this[t]&&(this[t]=r,r&&r.clone&&(this[t]=r.clone()))}let t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(let e in t)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,e)&&void 0!==t[e].get&&Object.defineProperty(this.constructor.prototype,e,t[e])}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{},nodes:{}});let r=t9.prototype.toJSON.call(this,e),n=g7(this);for(let{property:t,childNode:i}of(r.inputNodes={},n))r.inputNodes[t]=i.toJSON(e).uuid;function i(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}if(t){let t=i(e.textures),n=i(e.images),a=i(e.nodes);t.length>0&&(r.textures=t),n.length>0&&(r.images=n),a.length>0&&(r.nodes=a)}return r}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}}let w4=new ia;class w5 extends w3{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(w4),this.setValues(e)}}let w6=new a$;class w7 extends w3{static get type(){return"LineDashedNodeMaterial"}setupVariants(){let e=this.offsetNode?vu(this.offsetNode):T4,t=this.dashScaleNode?vu(this.dashScaleNode):T0,r=this.dashSizeNode?vu(this.dashSizeNode):T1,n=this.gapSizeNode?vu(this.gapSizeNode):T2;vJ.assign(r),v$.assign(n);let i=_$(bM("lineDistance").mul(t));(e?i.add(e):i).mod(vJ.add(v$)).greaterThan(vJ).discard()}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(w6),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}}let w8=null,w9=y8(class extends wN{static get type(){return"ViewportSharedTextureNode"}getTextureForReference(){return w8}updateReference(){return this}constructor(e=bG,t=null){null===w8&&(w8=new iC),super(e,t,w8)}}).setParameterLength(0,2),Me=e=>y4(e).mul(.5).add(.5),Mt=new aQ;class Mr extends w3{static get type(){return"MeshNormalNodeMaterial"}setupDiffuseColor(){let e=this.opacityNode?vu(this.opacityNode):TN;vL.assign(_6(v_(Me(SL),e),J))}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Mt),this.setValues(e)}}let Mn=vn(e=>{let[t=Sb]=e;return vA(t.z.atan(t.x).mul(1/(2*Math.PI)).add(.5),t.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5))});class Mi extends rJ{fromEquirectangularTexture(e,t){let r=t.minFilter,n=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i=new rk(5,5,5),a=Mn(Sb),s=new w3;s.colorNode=bL(t,a,0),s.side=1,s.blending=0;let o=new rU(i,s),l=new r4;l.add(o),1008===t.minFilter&&(t.minFilter=1006);let u=new rK(1,10,this),c=e.getMRT();return e.setMRT(null),u.update(e,l),e.setMRT(c),t.minFilter=r,t.currentGenerateMipmaps=n,o.geometry.dispose(),o.material.dispose(),this}constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}}let Ma=new WeakMap;function Ms(e){let t=e.target;t.removeEventListener("dispose",Ms);let r=Ma.get(t);void 0!==r&&(Ma.delete(t),r.dispose())}function Mo(e,t){303===t?e.mapping=301:304===t&&(e.mapping=302)}let Ml=y8(class extends yv{static get type(){return"CubeMapNode"}updateBefore(e){let{renderer:t,material:r}=e,n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){let e=n.isTextureNode?n.value:r[n.property];if(e&&e.isTexture){let r=e.mapping;if(303===r||304===r){if(Ma.has(e)){let t=Ma.get(e);Mo(t,e.mapping),this._cubeTexture=t}else{var i;let r=e.image;if(null!=(i=r)&&i.height>0){let n=new Mi(r.height);n.fromEquirectangularTexture(t,e),Mo(n.texture,e.mapping),this._cubeTexture=n.texture,Ma.set(e,n.texture),e.addEventListener("dispose",Ms)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=SJ(null);let t=new rZ;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=yl.RENDER}}).setParameterLength(1);class Mu extends ww{static get type(){return"BasicEnvironmentNode"}setup(e){e.context.environment=Ml(this.envNode)}constructor(e=null){super(),this.envNode=e}}class Mc extends ww{static get type(){return"BasicLightMapNode"}setup(e){let t=vu(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}constructor(e=null){super(),this.lightMapNode=e}}class Mh{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class Md extends Mh{indirect(e){let{context:t}=e,r=t.ambientOcclusion,n=t.reflectedLight,i=t.irradianceLightMap;n.indirectDiffuse.assign(v_(0)),i?n.indirectDiffuse.addAssign(i):n.indirectDiffuse.addAssign(v_(1,1,1,0)),n.indirectDiffuse.mulAssign(r),n.indirectDiffuse.mulAssign(vL.rgb)}finish(e){let{material:t,context:r}=e,n=r.outgoingLight,i=e.context.environment;if(i)switch(t.combine){case 0:n.rgb.assign(_C(n.rgb,n.rgb.mul(i.rgb),TD.mul(TB)));break;case 1:n.rgb.assign(_C(n.rgb,i.rgb,TD.mul(TB)));break;case 2:n.rgb.addAssign(i.rgb.mul(TD.mul(TB)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine)}}constructor(){super()}}let MA=new re;class Mp extends w3{static get type(){return"MeshBasicNodeMaterial"}setupNormal(){return SE(SP)}setupEnvironment(e){let t=super.setupEnvironment(e);return t?new Mu(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Mc(T7)),t}setupOutgoingLight(){return vL.rgb}setupLightingModel(){return new Md}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(MA),this.setValues(e)}}let Mf=vn(e=>{let{f0:t,f90:r,dotVH:n}=e,i=n.mul(-5.55473).sub(6.98316).mul(n).exp2();return t.mul(i.oneMinus()).add(r.mul(i))}),Mm=vn(e=>e.diffuseColor.mul(1/Math.PI)),Mg=vn(e=>{let{dotNH:t}=e;return vK.mul(vu(.5)).add(1).mul(vu(1/Math.PI)).mul(t.pow(vK))}),My=vn(e=>{let{lightDirection:t}=e,r=t.add(ST).normalize(),n=SL.dot(r).clamp(),i=Mf({f0:vQ,f90:1,dotVH:ST.dot(r).clamp()}),a=vu(.25),s=Mg({dotNH:n});return i.mul(a).mul(s)});class Mv extends Md{direct(e){let{lightDirection:t,lightColor:r,reflectedLight:n}=e,i=SL.dot(t).clamp().mul(r);n.directDiffuse.addAssign(i.mul(Mm({diffuseColor:vL.rgb}))),!0===this.specular&&n.directSpecular.addAssign(i.mul(My({lightDirection:t})).mul(TD))}indirect(e){let{ambientOcclusion:t,irradiance:r,reflectedLight:n}=e.context;n.indirectDiffuse.addAssign(r.mul(Mm({diffuseColor:vL}))),n.indirectDiffuse.mulAssign(t)}constructor(e=!0){super(),this.specular=e}}let Mx=new aY;class M_ extends w3{static get type(){return"MeshLambertNodeMaterial"}setupEnvironment(e){let t=super.setupEnvironment(e);return t?new Mu(t):null}setupLightingModel(){return new Mv(!1)}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Mx),this.setValues(e)}}let Mb=new aW;class MS extends w3{static get type(){return"MeshPhongNodeMaterial"}setupEnvironment(e){let t=super.setupEnvironment(e);return t?new Mu(t):null}setupLightingModel(){return new Mv}setupVariants(){let e=(this.shininessNode?vu(this.shininessNode):TR).max(1e-4);vK.assign(e);let t=this.specularNode||TP;vQ.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(Mb),this.setValues(e)}}let MT=vn(e=>{if(!1===e.geometry.hasAttribute("normal"))return vu(0);let t=SP.dFdx().abs().max(SP.dFdy().abs());return t.x.max(t.y).max(t.z)}),Mw=vn(e=>{let{roughness:t}=e,r=MT(),n=t.max(.0525);return(n=n.add(r)).min(1)}),MM=vn(e=>{let{alpha:t,dotNL:r,dotNV:n}=e,i=t.pow2(),a=r.mul(i.add(i.oneMinus().mul(n.pow2())).sqrt()),s=n.mul(i.add(i.oneMinus().mul(r.pow2())).sqrt());return xf(.5,a.add(s).max(xk))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),ME=vn(e=>{let{alphaT:t,alphaB:r,dotTV:n,dotBV:i,dotTL:a,dotBL:s,dotNV:o,dotNL:l}=e,u=l.mul(vg(t.mul(n),r.mul(i),o).length()),c=o.mul(vg(t.mul(a),r.mul(s),l).length());return xf(.5,u.add(c)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),MR=vn(e=>{let{alpha:t,dotNH:r}=e,n=t.pow2(),i=r.pow2().mul(n.oneMinus()).oneMinus();return n.div(i.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),MC=vu(1/Math.PI),MN=vn(e=>{let{alphaT:t,alphaB:r,dotNH:n,dotTH:i,dotBH:a}=e,s=t.mul(r),o=vg(r.mul(i),t.mul(a),s.mul(n)),l=o.dot(o),u=s.div(l);return MC.mul(s.mul(u.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),MP=vn(e=>{let t,r,{lightDirection:n,f0:i,f90:a,roughness:s,f:o,normalView:l=SL,USE_IRIDESCENCE:u,USE_ANISOTROPY:c}=e,h=s.pow2(),d=n.add(ST).normalize(),A=l.dot(n).clamp(),p=l.dot(ST).clamp(),f=l.dot(d).clamp(),m=Mf({f0:i,f90:a,dotVH:ST.dot(d).clamp()});if(y1(u)&&(m=vV.mix(m,o)),y1(c)){let e=vW.dot(n),i=vW.dot(ST),a=vW.dot(d),s=vX.dot(n),o=vX.dot(ST),l=vX.dot(d);t=ME({alphaT:vH,alphaB:h,dotTV:i,dotBV:o,dotTL:e,dotBL:s,dotNV:p,dotNL:A}),r=MN({alphaT:vH,alphaB:h,dotNH:f,dotTH:a,dotBH:l})}else t=MM({alpha:h,dotNL:A,dotNV:p}),r=MR({alpha:h,dotNH:f});return m.mul(t).mul(r)}),MI=vn(e=>{let{roughness:t,dotNV:r}=e,n=v_(-1,-.0275,-.572,.022),i=v_(1,.0425,1.04,-.04),a=t.mul(n).add(i),s=a.x.mul(a.x).min(r.mul(-9.28).exp2()).mul(a.x).add(a.y);return vA(-1.04,1.04).mul(s).add(a.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),ML=vn(e=>{let{dotNV:t,specularColor:r,specularF90:n,roughness:i}=e,a=MI({dotNV:t,roughness:i});return r.mul(a.x).add(n.mul(a.y))}),MD=vn(e=>{let{f:t,f90:r,dotVH:n}=e,i=n.oneMinus().saturate(),a=i.mul(i),s=i.mul(a,a).clamp(0,.9999);return t.sub(vg(r).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),MB=vn(e=>{let{roughness:t,dotNH:r}=e,n=t.pow2(),i=vu(1).div(n),a=r.pow2().oneMinus().max(.0078125);return vu(2).add(i).mul(a.pow(i.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),MF=vn(e=>{let{dotNV:t,dotNL:r}=e;return vu(1).div(vu(4).mul(r.add(t).sub(r.mul(t))))}).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),MU=vn(e=>{let{lightDirection:t}=e,r=t.add(ST).normalize(),n=SL.dot(t).clamp(),i=SL.dot(ST).clamp(),a=MB({roughness:vz,dotNH:SL.dot(r).clamp()}),s=MF({dotNV:i,dotNL:n});return vk.mul(a).mul(s)}),MO=vn(e=>{let{N:t,V:r,roughness:n}=e,i=vA(n,t.dot(r).saturate().oneMinus().sqrt());return i.assign(i.mul(.984375).add(.0078125)),i}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),Mk=vn(e=>{let{f:t}=e,r=t.length();return _f(r.mul(r).add(t.z).div(r.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),Mz=vn(e=>{let{v1:t,v2:r}=e,n=t.dot(r),i=n.abs().toVar(),a=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),s=i.add(4.1616724).mul(i).add(3.417594).toVar(),o=a.div(s),l=n.greaterThan(0).select(o,_f(n.mul(n).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return t.cross(r).mul(l)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),MV=vn(e=>{let{N:t,V:r,P:n,mInv:i,p0:a,p1:s,p2:o,p3:l}=e,u=s.sub(a).toVar(),c=l.sub(a).toVar(),h=u.cross(c),d=vg().toVar();return vs(h.dot(n.sub(a)).greaterThanEqual(0),()=>{let e=r.sub(t.mul(r.dot(t))).normalize(),u=t.cross(e).negate(),c=i.mul(vM(e,u,t).transpose()).toVar(),h=c.mul(a.sub(n)).normalize().toVar(),A=c.mul(s.sub(n)).normalize().toVar(),p=c.mul(o.sub(n)).normalize().toVar(),f=c.mul(l.sub(n)).normalize().toVar(),m=vg(0).toVar();m.addAssign(Mz({v1:h,v2:A})),m.addAssign(Mz({v1:A,v2:p})),m.addAssign(Mz({v1:p,v2:f})),m.addAssign(Mz({v1:f,v2:h})),d.assign(vg(Mk({f:m})))}),d}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Mq=1/6,MG=e=>xp(Mq,xp(e,xp(e,e.negate().add(3)).sub(3)).add(1)),MH=e=>xp(Mq,xp(e,xp(e,xp(3,e).sub(6))).add(4)),Mj=e=>xp(Mq,xp(e,xp(e,xp(-3,e).add(3)).add(3)).add(1)),MW=e=>xp(Mq,_b(e,3)),MX=e=>MG(e).add(MH(e)),MQ=e=>Mj(e).add(MW(e)),MY=e=>xd(-1,MH(e).div(MG(e).add(MH(e)))),MK=e=>xd(1,MW(e).div(Mj(e).add(MW(e)))),MZ=(e,t,r)=>{let n=xp(e.uvNode,t.zw).add(.5),i=x$(n),a=x2(n),s=MX(a.x),o=MQ(a.x),l=MY(a.x),u=MK(a.x),c=MY(a.y),h=MK(a.y),d=vA(i.x.add(l),i.y.add(c)).sub(.5).mul(t.xy),A=vA(i.x.add(u),i.y.add(c)).sub(.5).mul(t.xy),p=vA(i.x.add(l),i.y.add(h)).sub(.5).mul(t.xy),f=vA(i.x.add(u),i.y.add(h)).sub(.5).mul(t.xy),m=MX(a.y).mul(xd(s.mul(e.sample(d).level(r)),o.mul(e.sample(A).level(r)))),g=MQ(a.y).mul(xd(s.mul(e.sample(p).level(r)),o.mul(e.sample(f).level(r))));return m.add(g)},MJ=vn(e=>{let[t,r]=e,n=vA(t.size(vc(r))),i=vA(t.size(vc(r.add(1)))),a=xf(1,n),s=xf(1,i),o=MZ(t,v_(a,n),x$(r)),l=MZ(t,v_(s,i),x0(r));return x2(r).mix(o,l)}),M$=vn(e=>{let[t,r]=e,n=r.mul(bC(t));return MJ(t,n)}),M0=vn(e=>{let[t,r,n,i,a]=e,s=vg(_I(r.negate(),x1(t),xf(1,i))),o=vg(_t(a[0].xyz),_t(a[1].xyz),_t(a[2].xyz));return x1(s).mul(n.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),M1=vn(e=>{let[t,r]=e;return t.mul(_N(r.mul(2).sub(2),0,1))}).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),M2=wI(),M3=wI(),M4=vn((e,t)=>{let[r,n,i]=e,{material:a}=t;return MJ((1===a.side?M2:M3).sample(r),xK(bH.x).mul(M1(n,i)))}),M5=vn(e=>{let[t,r,n]=e;return vs(n.notEqual(0),()=>xX(xY(r).negate().div(n).negate().mul(t))),vg(1)}).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),M6=vn(e=>{let t,r,[n,i,a,s,o,l,u,c,h,d,A,p,f,m,g]=e;if(g){t=v_().toVar(),r=vg().toVar();let e=A.sub(1).mul(g.mul(.025)),o=vg(A.sub(e),A,A.add(e));wv({start:0,end:3},e=>{let{i:l}=e,A=o.element(l),g=M0(n,i,p,A,c),y=u.add(g),v=d.mul(h.mul(v_(y,1))),x=vA(v.xy.div(v.w)).toVar();x.addAssign(1),x.divAssign(2),x.assign(vA(x.x,x.y.oneMinus()));let _=M4(x,a,A);t.element(l).assign(_.element(l)),t.a.addAssign(_.a),r.element(l).assign(s.element(l).mul(M5(_t(g),f,m).element(l)))}),t.a.divAssign(3)}else{let e=M0(n,i,p,A,c),o=u.add(e),l=d.mul(h.mul(v_(o,1))),g=vA(l.xy.div(l.w)).toVar();g.addAssign(1),g.divAssign(2),g.assign(vA(g.x,g.y.oneMinus())),t=M4(g,a,A),r=s.mul(M5(_t(e),f,m))}let y=r.rgb.mul(t.rgb),v=vg(ML({dotNV:n.dot(i).clamp(),specularColor:o,specularF90:l,roughness:a})),x=r.r.add(r.g,r.b).div(3);return v_(v.oneMinus().mul(y),t.a.oneMinus().mul(x).oneMinus())}),M7=vM(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),M8=(e,t)=>e.sub(t).div(e.add(t)).pow2(),M9=vn(e=>{let{outsideIOR:t,eta2:r,cosTheta1:n,thinFilmThickness:i,baseF0:a}=e,s=_C(t,r,_L(0,.03,i)),o=t.div(s).pow2().mul(n.pow2().oneMinus()).oneMinus();vs(o.lessThan(0),()=>vg(1));let l=o.sqrt(),u=Mf({f0:M8(s,t),f90:1,dotVH:n}),c=u.oneMinus(),h=s.lessThan(t).select(Math.PI,0),d=vu(Math.PI).sub(h),A=(e=>{let t=e.sqrt();return vg(1).add(t).div(vg(1).sub(t))})(a.clamp(0,.9999)),p=Mf({f0:M8(A,s.toVec3()),f90:1,dotVH:l}),f=vg(A.x.lessThan(s).select(Math.PI,0),A.y.lessThan(s).select(Math.PI,0),A.z.lessThan(s).select(Math.PI,0)),m=s.mul(i,l,2),g=vg(d).add(f),y=u.mul(p).clamp(1e-5,.9999),v=y.sqrt(),x=c.pow2().mul(p).div(vg(1).sub(y)),_=u.add(x).toVar(),b=x.sub(c).toVar();return wv({start:1,end:2,condition:"<=",name:"m"},e=>{let{m:t}=e;b.mulAssign(v);let r=((e,t)=>{let r=e.mul(2*Math.PI*1e-9),n=vg(54856e-17,44201e-17,52481e-17),i=vg(1681e3,1795300,2208400),a=vg(43278e5,93046e5,66121e5),s=vu(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(r.mul(2239900).add(t.x).cos()).mul(r.pow2().mul(-45282e5).exp()),o=n.mul(a.mul(2*Math.PI).sqrt()).mul(i.mul(r).add(t).cos()).mul(r.pow2().negate().mul(a).exp());return o=vg(o.x.add(s),o.y,o.z).div(10685e-11),M7.mul(o)})(vu(t).mul(m),vu(t).mul(g)).mul(2);_.addAssign(b.mul(r))}),_.max(vg(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),Ee=vn(e=>{let{normal:t,viewDir:r,roughness:n}=e,i=t.dot(r).saturate(),a=n.pow2(),s=_z(n.lessThan(.25),vu(-339.2).mul(a).add(vu(161.4).mul(n)).sub(25.9),vu(-8.48).mul(a).add(vu(14.3).mul(n)).sub(9.95)),o=_z(n.lessThan(.25),vu(44).mul(a).sub(vu(23.7).mul(n)).add(3.26),vu(1.97).mul(a).sub(vu(3.27).mul(n)).add(.72));return _z(n.lessThan(.25),0,vu(.1).mul(n).sub(.025)).add(s.mul(i).add(o).exp()).mul(1/Math.PI).saturate()}),Et=vg(.04),Er=vu(1);class En extends Mh{start(e){if(!0===this.clearcoat&&(this.clearcoatRadiance=vg().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=vg().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=vg().toVar("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=vg().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=vg().toVar("sheenSpecularIndirect")),!0===this.iridescence){let e=SL.dot(ST).clamp();this.iridescenceFresnel=M9({outsideIOR:vu(1),eta2:vq,cosTheta1:e,thinFilmThickness:vG,baseF0:vQ}),this.iridescenceF0=MD({f:this.iridescenceFresnel,f90:1,dotVH:e})}if(!0===this.transmission){let t=b5.sub(S_).normalize(),r=e.context;r.backdrop=M6(SD,t,vB,vL,vQ,vY,S_,So,b2,b0,v1,v3,v5,v4,this.dispersion?v6:null),r.backdropAlpha=v2,vL.a.mulAssign(_C(1,r.backdrop.a,v2))}super.start(e)}computeMultiscattering(e,t,r){let n=MI({roughness:vB,dotNV:SL.dot(ST).clamp()}),i=(this.iridescenceF0?vV.mix(vQ,this.iridescenceF0):vQ).mul(n.x).add(r.mul(n.y)),a=n.x.add(n.y).oneMinus(),s=vQ.add(vQ.oneMinus().mul(.047619)),o=i.mul(s).div(a.mul(s).oneMinus());e.addAssign(i),t.addAssign(o.mul(a))}direct(e){let{lightDirection:t,lightColor:r,reflectedLight:n}=e,i=SL.dot(t).clamp().mul(r);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(i.mul(MU({lightDirection:t}))),!0===this.clearcoat){let e=SB.dot(t).clamp().mul(r);this.clearcoatSpecularDirect.addAssign(e.mul(MP({lightDirection:t,f0:Et,f90:Er,roughness:vO,normalView:SB})))}n.directDiffuse.addAssign(i.mul(Mm({diffuseColor:vL.rgb}))),n.directSpecular.addAssign(i.mul(MP({lightDirection:t,f0:vQ,f90:1,roughness:vB,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea(e){let{lightColor:t,lightPosition:r,halfWidth:n,halfHeight:i,reflectedLight:a,ltc_1:s,ltc_2:o}=e,l=r.add(n).sub(i),u=r.sub(n).sub(i),c=r.sub(n).add(i),h=r.add(n).add(i),d=SS.toVar(),A=MO({N:SL,V:ST,roughness:vB}),p=s.sample(A).toVar(),f=o.sample(A).toVar(),m=vM(vg(p.x,0,p.y),vg(0,1,0),vg(p.z,0,p.w)).toVar(),g=vQ.mul(f.x).add(vQ.oneMinus().mul(f.y)).toVar();a.directSpecular.addAssign(t.mul(g).mul(MV({N:SL,V:ST,P:d,mInv:m,p0:l,p1:u,p2:c,p3:h}))),a.directDiffuse.addAssign(t.mul(vL).mul(MV({N:SL,V:ST,P:d,mInv:vM(1,0,0,0,1,0,0,0,1),p0:l,p1:u,p2:c,p3:h})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){let{irradiance:t,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(t.mul(Mm({diffuseColor:vL})))}indirectSpecular(e){let{radiance:t,iblIrradiance:r,reflectedLight:n}=e.context;if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(r.mul(vk,Ee({normal:SL,viewDir:ST,roughness:vz}))),!0===this.clearcoat){let e=ML({dotNV:SB.dot(ST).clamp(),specularColor:Et,specularF90:Er,roughness:vO});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(e))}let i=vg().toVar("singleScattering"),a=vg().toVar("multiScattering"),s=r.mul(1/Math.PI);this.computeMultiscattering(i,a,vY);let o=i.add(a),l=vL.mul(o.r.max(o.g).max(o.b).oneMinus());n.indirectSpecular.addAssign(t.mul(i)),n.indirectSpecular.addAssign(a.mul(s)),n.indirectDiffuse.addAssign(l.mul(s))}ambientOcclusion(e){let{ambientOcclusion:t,reflectedLight:r}=e.context,n=SL.dot(ST).clamp().add(t),i=vB.mul(-16).oneMinus().negate().exp2(),a=t.sub(n.pow(i).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(t),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(t),r.indirectDiffuse.mulAssign(t),r.indirectSpecular.mulAssign(a)}finish(e){let{context:t}=e,{outgoingLight:r}=t;if(!0===this.clearcoat){let e=Mf({dotVH:SB.dot(ST).clamp(),f0:Et,f90:Er}),t=r.mul(vU.mul(e).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(vU));r.assign(t)}if(!0===this.sheen){let e=vk.r.max(vk.g).max(vk.b).mul(.157).oneMinus(),t=r.mul(e).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);r.assign(t)}}constructor(e=!1,t=!1,r=!1,n=!1,i=!1,a=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=r,this.anisotropy=n,this.transmission=i,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}}let Ei=vu(1),Ea=vu(-2),Es=vu(.8),Eo=vu(-1),El=vu(.4),Eu=vu(2),Ec=vu(.305),Eh=vu(3),Ed=vu(.21),EA=vu(4),Ep=vu(4),Ef=vu(16),Em=vn(e=>{let[t]=e,r=vg(x9(t)).toVar(),n=vu(-1).toVar();return vs(r.x.greaterThan(r.z),()=>{vs(r.x.greaterThan(r.y),()=>{n.assign(_z(t.x.greaterThan(0),0,3))}).Else(()=>{n.assign(_z(t.y.greaterThan(0),1,4))})}).Else(()=>{vs(r.z.greaterThan(r.y),()=>{n.assign(_z(t.z.greaterThan(0),2,5))}).Else(()=>{n.assign(_z(t.y.greaterThan(0),1,4))})}),n}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),Eg=vn(e=>{let[t,r]=e,n=vA().toVar();return vs(r.equal(0),()=>{n.assign(vA(t.z,t.y).div(x9(t.x)))}).ElseIf(r.equal(1),()=>{n.assign(vA(t.x.negate(),t.z.negate()).div(x9(t.y)))}).ElseIf(r.equal(2),()=>{n.assign(vA(t.x.negate(),t.y).div(x9(t.z)))}).ElseIf(r.equal(3),()=>{n.assign(vA(t.z.negate(),t.y).div(x9(t.x)))}).ElseIf(r.equal(4),()=>{n.assign(vA(t.x.negate(),t.z).div(x9(t.y)))}).Else(()=>{n.assign(vA(t.x,t.y).div(x9(t.z)))}),xp(.5,n.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),Ey=vn(e=>{let[t]=e,r=vu(0).toVar();return vs(t.greaterThanEqual(Es),()=>{r.assign(Ei.sub(t).mul(Eo.sub(Ea)).div(Ei.sub(Es)).add(Ea))}).ElseIf(t.greaterThanEqual(El),()=>{r.assign(Es.sub(t).mul(Eu.sub(Eo)).div(Es.sub(El)).add(Eo))}).ElseIf(t.greaterThanEqual(Ec),()=>{r.assign(El.sub(t).mul(Eh.sub(Eu)).div(El.sub(Ec)).add(Eu))}).ElseIf(t.greaterThanEqual(Ed),()=>{r.assign(Ec.sub(t).mul(EA.sub(Eh)).div(Ec.sub(Ed)).add(Eh))}).Else(()=>{r.assign(vu(-2).mul(xK(xp(1.16,t))))}),r}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),Ev=vn(e=>{let[t,r]=e,n=t.toVar();n.assign(xp(2,n).sub(1));let i=vg(n,1).toVar();return vs(r.equal(0),()=>{i.assign(i.zyx)}).ElseIf(r.equal(1),()=>{i.assign(i.xzy),i.xz.mulAssign(-1)}).ElseIf(r.equal(2),()=>{i.x.mulAssign(-1)}).ElseIf(r.equal(3),()=>{i.assign(i.zyx),i.xz.mulAssign(-1)}).ElseIf(r.equal(4),()=>{i.assign(i.xzy),i.xy.mulAssign(-1)}).ElseIf(r.equal(5),()=>{i.z.mulAssign(-1)}),i}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),Ex=vn(e=>{let[t,r,n,i,a,s]=e,o=vu(n),l=vg(r),u=_N(Ey(o),Ea,s),c=x2(u),h=x$(u),d=vg(E_(t,l,h,i,a,s)).toVar();return vs(c.notEqual(0),()=>{let e=vg(E_(t,l,h.add(1),i,a,s)).toVar();d.assign(_C(d,e,c))}),d}),E_=vn(e=>{let[t,r,n,i,a,s]=e,o=vu(n).toVar(),l=vg(r),u=vu(Em(l)).toVar(),c=vu(_f(Ep.sub(o),0)).toVar();o.assign(_f(o,Ep));let h=vu(xQ(o)).toVar(),d=vA(Eg(l,u).mul(h.sub(2)).add(1)).toVar();return vs(u.greaterThan(2),()=>{d.y.addAssign(h),u.subAssign(3)}),d.x.addAssign(u.mul(h)),d.x.addAssign(c.mul(xp(3,Ef))),d.y.addAssign(xp(4,xQ(s).sub(h))),d.x.mulAssign(i),d.y.mulAssign(a),t.sample(d).grad(vA(),vA())}),Eb=vn(e=>{let{envMap:t,mipInt:r,outputDirection:n,theta:i,axis:a,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l}=e,u=x4(i);return E_(t,n.mul(u).add(a.cross(n).mul(x3(i))).add(a.mul(a.dot(n).mul(u.oneMinus()))),r,s,o,l)}),ES=vn(e=>{let{n:t,latitudinal:r,poleAxis:n,outputDirection:i,weights:a,samples:s,dTheta:o,mipInt:l,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}=e,A=vg(_z(r,n,__(n,i))).toVar();vs(A.equal(vg(0)),()=>{A.assign(vg(i.z,0,i.x.negate()))}),A.assign(x1(A));let p=vg().toVar();return p.addAssign(a.element(0).mul(Eb({theta:0,axis:A,outputDirection:i,mipInt:l,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),wv({start:vc(1),end:t},e=>{let{i:t}=e;vs(t.greaterThanEqual(s),()=>{wx()});let r=vu(o.mul(vu(t))).toVar();p.addAssign(a.element(t).mul(Eb({theta:r.mul(-1),axis:A,outputDirection:i,mipInt:l,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),p.addAssign(a.element(t).mul(Eb({theta:r,axis:A,outputDirection:i,mipInt:l,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d})))}),v_(p,1)}),ET=[.125,.215,.35,.446,.526,.582],Ew=new sF(-1,1,1,-1,0,1),EM=new rY(90,1),EE=new t6,ER=null,EC=0,EN=0,EP=(1+Math.sqrt(5))/2,EI=1/EP,EL=[new ex(-EP,EI,0),new ex(EP,EI,0),new ex(-EI,0,EP),new ex(EI,0,EP),new ex(0,EP,-EI),new ex(0,EP,EI),new ex(-1,1,-1),new ex(1,1,-1),new ex(-1,1,1),new ex(1,1,1)],ED=new ex,EB=new WeakMap,EF=[3,1,5,0,4,2],EU=Ev(bE(),bM("faceIndex")).normalize(),EO=vg(EU.x,EU.y,EU.z);class Ek{get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{size:a=256,position:s=ED,renderTarget:o=null}=i;if(this._setSize(a),!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");let a=o||this._allocateTarget();return i.renderTarget=a,this.fromSceneAsync(e,t,r,n,i),a}ER=this._renderer.getRenderTarget(),EC=this._renderer.getActiveCubeFace(),EN=this._renderer.getActiveMipmapLevel();let l=o||this._allocateTarget();return l.depthBuffer=!0,this._init(l),this._sceneToCubeUV(e,r,n,l,s),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}async fromSceneAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return!1===this._hasInitialized&&await this._renderer.init(),this.fromScene(e,t,r,n,i)}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);let r=t||this._allocateTarget();return this.fromEquirectangularAsync(e,r),r}return this._fromTexture(e,t)}async fromEquirectangularAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return!1===this._hasInitialized&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);let r=t||this._allocateTarget();return this.fromCubemapAsync(e,t),r}return this._fromTexture(e,t)}async fromCubemapAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return!1===this._hasInitialized&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=EG(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=EH(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){301===e.mapping||302===e.mapping?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ER,EC,EN),e.scissorTest=!1,EV(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),ER=this._renderer.getRenderTarget(),EC=this._renderer.getActiveCubeFace(),EN=this._renderer.getActiveMipmapLevel();let r=t||this._allocateTarget();return this._init(r),this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTarget(){return Ez(3*Math.max(this._cubeSize,112),4*this._cubeSize)}_init(e){if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Ez(e.width,e.height);let{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=function(e){let t=[],r=[],n=[],i=[],a=e,s=e-4+1+ET.length;for(let o=0;o<s;o++){let s=Math.pow(2,a);r.push(s);let l=1/s;o>e-4?l=ET[o-e+4-1]:0===o&&(l=0),n.push(l);let u=1/(s-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],A=new Float32Array(108),p=new Float32Array(72),f=new Float32Array(36);for(let e=0;e<6;e++){let t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0],i=EF[e];A.set(n,18*i),p.set(d,12*i);let a=[i,i,i,i,i,i];f.set(a,6*i)}let m=new rw;m.setAttribute("position",new rl(A,3)),m.setAttribute("uv",new rl(p,2)),m.setAttribute("faceIndex",new rl(f,1)),t.push(m),i.push(new rU(m,null)),a>4&&a--}return{lodPlanes:t,sizeLods:r,sigmas:n,lodMeshes:i}}(t)),this._blurMaterial=function(e,t,r){let n=bk(Array(20).fill(0)),i=xi(new ex(0,1,0)),a=xi(0),s=vu(20),o=xi(0),l=xi(1),u=bL(null),c=xi(0),h=vu(1/t),d={n:s,latitudinal:o,weights:n,poleAxis:i,outputDirection:EO,dTheta:a,samples:l,envMap:u,mipInt:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:vu(1/r),CUBEUV_MAX_MIP:vu(e)},A=Eq("blur");return A.fragmentNode=ES({...d,latitudinal:o.equal(1)}),EB.set(A,d),A}(t,e.width,e.height)}}async _compileMaterial(e){let t=new rU(this._lodPlanes[0],e);await this._renderer.compile(t,Ew)}_sceneToCubeUV(e,t,r,n,i){EM.near=t,EM.far=r;let a=[1,1,1,1,-1,1],s=[1,-1,1,-1,1,-1],o=this._renderer,l=o.autoClear;o.getClearColor(EE),o.autoClear=!1;let u=this._backgroundBox;if(null===u){let e=new re({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});u=new rU(new rk,e)}let c=!1,h=e.background;h?h.isColor&&(u.material.color.copy(h),e.background=null,c=!0):(u.material.color.copy(EE),c=!0),o.setRenderTarget(n),o.clear(),c&&o.render(u,EM);for(let t=0;t<6;t++){let r=t%3;0===r?(EM.up.set(0,a[t],0),EM.position.set(i.x,i.y,i.z),EM.lookAt(i.x+s[t],i.y,i.z)):1===r?(EM.up.set(0,0,a[t]),EM.position.set(i.x,i.y,i.z),EM.lookAt(i.x,i.y+s[t],i.z)):(EM.up.set(0,a[t],0),EM.position.set(i.x,i.y,i.z),EM.lookAt(i.x,i.y,i.z+s[t]));let l=this._cubeSize;EV(n,r*l,t>2?l:0,l,l),o.render(e,EM)}o.autoClear=l,e.background=h}_textureToCubeUV(e,t){let r=this._renderer,n=301===e.mapping||302===e.mapping;n?null===this._cubemapMaterial&&(this._cubemapMaterial=EG(e)):null===this._equirectMaterial&&(this._equirectMaterial=EH(e));let i=n?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;let a=this._lodMeshes[0];a.material=i;let s=this._cubeSize;EV(t,0,0,3*s,2*s),r.setRenderTarget(t),r.render(a,Ew)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;let n=this._lodPlanes.length;for(let t=1;t<n;t++){let r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=EL[(n-t-1)%EL.length];this._blur(e,t-1,t,r,i)}t.autoClear=r}_blur(e,t,r,n,i){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,n,"latitudinal",i),this._halfBlur(a,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,a,s){let o=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");let u=this._lodMeshes[n];u.material=l;let c=EB.get(l),h=this._sizeLods[r]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,A=i/d,p=isFinite(i)?1+Math.floor(3*A):20;p>20&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(20));let f=[],m=0;for(let e=0;e<20;++e){let t=e/A,r=Math.exp(-t*t/2);f.push(r),0===e?m+=r:e<p&&(m+=2*r)}for(let e=0;e<f.length;e++)f[e]=f[e]/m;e.texture.frame=(e.texture.frame||0)+1,c.envMap.value=e.texture,c.samples.value=p,c.weights.array=f,c.latitudinal.value=+("latitudinal"===a),s&&(c.poleAxis.value=s);let{_lodMax:g}=this;c.dTheta.value=d,c.mipInt.value=g-r;let y=this._sizeLods[n],v=4*(this._cubeSize-y);EV(t,3*y*(n>g-4?n-g+4:0),v,3*y,2*y),o.setRenderTarget(t),o.render(u,Ew)}constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}}function Ez(e,t){let r=new ej(e,t,{magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,colorSpace:$});return r.texture.mapping=306,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function EV(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function Eq(e){let t=new w3;return t.depthTest=!1,t.depthWrite=!1,t.blending=0,t.name="PMREM_".concat(e),t}function EG(e){let t=Eq("cubemap");return t.fragmentNode=SJ(e,EO),t}function EH(e){let t=Eq("equirect");return t.fragmentNode=bL(e,Mn(EO),0),t}let Ej=new WeakMap,EW=y8(class extends yv{static get type(){return"PMREMNode"}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){let t=function(e){let t=Math.log2(e)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:1/e,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem,r=t?t.pmremVersion:-1,n=this._value;r!==n.pmremVersion&&null!==(t=!0===n.isPMREMTexture?n:function(e,t,r){var n,i;let a,s=(n=t,void 0===(a=Ej.get(n))&&(a=new WeakMap,Ej.set(n,a)),a),o=s.get(e);if((void 0!==o?o.pmremVersion:-1)!==e.pmremVersion){let t=e.image;if(e.isCubeTexture)if(!function(e){if(null==e)return!1;let t=0;for(let r=0;r<6;r++)void 0!==e[r]&&t++;return 6===t}(t))return null;else o=r.fromCubemap(e,o);else{if(!(null!=(i=t)&&i.height>0))return null;o=r.fromEquirectangular(e,o)}o.pmremVersion=e.pmremVersion,s.set(e,o)}return o.texture}(n,e.renderer,this._generator))&&(this._pmrem=t,this.updateFromTexture(t))}setup(e){null===this._generator&&(this._generator=new Ek(e.renderer)),this.updateBefore(e);let t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this)),t=Sj.mul(vg(t.x,t.y.negate(),t.z));let r=this.levelNode;return null===r&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),Ex(this._texture,t,r,this._width,this._height,this._maxMip)}dispose(){super.dispose(),null!==this._generator&&this._generator.dispose()}constructor(e,t=null,r=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=r,this._generator=null;let n=new eG;n.isRenderTargetTexture=!0,this._texture=bL(n),this._width=xi(0),this._height=xi(0),this._maxMip=xi(0),this.updateBeforeType=yl.RENDER}}).setParameterLength(1,3),EX=new WeakMap;class EQ extends ww{static get type(){return"EnvironmentNode"}setup(e){let{material:t}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){let e=r.isTextureNode?r.value:t[r.property],n=EX.get(e);void 0===n&&(n=EW(e),EX.set(e,n)),r=n}let n=!0===t.useAnisotropy||t.anisotropy>0?Tv:SL,i=r.context(EY(vB,n)).mul(SH),a=r.context(EK(SD)).mul(Math.PI).mul(SH),s=bA(i),o=bA(a);e.context.radiance.addAssign(s),e.context.iblIrradiance.addAssign(o);let l=e.context.lightingModel.clearcoatRadiance;if(l){let e=bA(r.context(EY(vO,SB)).mul(SH));l.addAssign(e)}}constructor(e=null){super(),this.envNode=e}}let EY=(e,t)=>{let r=null;return{getUV:()=>(null===r&&(r=ST.negate().reflect(t),r=(r=e.mul(e).mix(r,t).normalize()).transformDirection(b2)),r),getTextureLevel:()=>e}},EK=e=>({getUV:()=>e,getTextureLevel:()=>vu(1)}),EZ=new aH;class EJ extends w3{static get type(){return"MeshStandardNodeMaterial"}setupEnvironment(e){let t=super.setupEnvironment(e);return null===t&&e.environmentNode&&(t=e.environmentNode),t?new EQ(t):null}setupLightingModel(){return new En}setupSpecular(){let e=_C(vg(.04),vL.rgb,vF);vQ.assign(e),vY.assign(1)}setupVariants(){let e=this.metalnessNode?vu(this.metalnessNode):TU;vF.assign(e);let t=this.roughnessNode?vu(this.roughnessNode):TF;t=Mw({roughness:t}),vB.assign(t),this.setupSpecular(),vL.assign(v_(vL.rgb.mul(e.oneMinus()),vL.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(EZ),this.setValues(e)}}let E$=new aj;class E0 extends EJ{static get type(){return"MeshPhysicalNodeMaterial"}get useClearcoat(){return this.clearcoat>0||null!==this.clearcoatNode}get useIridescence(){return this.iridescence>0||null!==this.iridescenceNode}get useSheen(){return this.sheen>0||null!==this.sheenNode}get useAnisotropy(){return this.anisotropy>0||null!==this.anisotropyNode}get useTransmission(){return this.transmission>0||null!==this.transmissionNode}get useDispersion(){return this.dispersion>0||null!==this.dispersionNode}setupSpecular(){let e=this.iorNode?vu(this.iorNode):TZ;v1.assign(e),vQ.assign(_C(_p(_S(v1.sub(1).div(v1.add(1))).mul(TL),vg(1)).mul(TI),vL.rgb,vF)),vY.assign(_C(TI,1,vF))}setupLightingModel(){return new En(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){let e=this.clearcoatNode?vu(this.clearcoatNode):Tk,t=this.clearcoatRoughnessNode?vu(this.clearcoatRoughnessNode):Tz;vU.assign(e),vO.assign(Mw({roughness:t}))}if(this.useSheen){let e=this.sheenNode?vg(this.sheenNode):TG,t=this.sheenRoughnessNode?vu(this.sheenRoughnessNode):TH;vk.assign(e),vz.assign(t)}if(this.useIridescence){let e=this.iridescenceNode?vu(this.iridescenceNode):TW,t=this.iridescenceIORNode?vu(this.iridescenceIORNode):TX,r=this.iridescenceThicknessNode?vu(this.iridescenceThicknessNode):TQ;vV.assign(e),vq.assign(t),vG.assign(r)}if(this.useAnisotropy){let e=(this.anisotropyNode?vA(this.anisotropyNode):Tj).toVar();vj.assign(e.length()),vs(vj.equal(0),()=>{e.assign(vA(1,0))}).Else(()=>{e.divAssign(vA(vj)),vj.assign(vj.saturate())}),vH.assign(vj.pow2().mix(vB.pow2(),1)),vW.assign(Tg[0].mul(e.x).add(Tg[1].mul(e.y))),vX.assign(Tg[1].mul(e.x).sub(Tg[0].mul(e.y)))}if(this.useTransmission){let e=this.transmissionNode?vu(this.transmissionNode):TY,t=this.thicknessNode?vu(this.thicknessNode):TK,r=this.attenuationDistanceNode?vu(this.attenuationDistanceNode):TJ,n=this.attenuationColorNode?vg(this.attenuationColorNode):T$;if(v2.assign(e),v3.assign(t),v4.assign(r),v5.assign(n),this.useDispersion){let e=this.dispersionNode?vu(this.dispersionNode):T6;v6.assign(e)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?vg(this.clearcoatNormalNode):TV}setup(e){e.context.setupClearcoatNormal=()=>_J(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(E$),this.setValues(e)}}let E1=vn(e=>{let{normal:t,lightDirection:r,builder:n}=e,i=vA(t.dot(r).mul(.5).add(.5),0);if(n.material.gradientMap)return vg(S4("gradientMap","texture").context({getUV:()=>i}).r);{let e=i.fwidth().mul(.5);return _C(vg(.7),vg(1),_L(vu(.7).sub(e.x),vu(.7).add(e.x),i.x))}});class E2 extends Mh{direct(e,t){let{lightDirection:r,lightColor:n,reflectedLight:i}=e,a=E1({normal:SR,lightDirection:r,builder:t}).mul(n);i.directDiffuse.addAssign(a.mul(Mm({diffuseColor:vL.rgb})))}indirect(e){let{ambientOcclusion:t,irradiance:r,reflectedLight:n}=e.context;n.indirectDiffuse.addAssign(r.mul(Mm({diffuseColor:vL}))),n.indirectDiffuse.mulAssign(t)}}let E3=new aX;class E4 extends w3{static get type(){return"MeshToonNodeMaterial"}setupLightingModel(){return new E2}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(E3),this.setValues(e)}}let E5=vn(()=>{let e=vg(ST.z,0,ST.x.negate()).normalize(),t=ST.cross(e);return vA(e.dot(SL),t.dot(SL)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),E6=new aJ;class E7 extends w3{static get type(){return"MeshMatcapNodeMaterial"}setupVariants(e){let t;t=e.material.matcap?S4("matcap","texture").context({getUV:()=>E5}):vg(_C(.2,.8,E5.y)),vL.rgb.mulAssign(t.rgb)}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(E6),this.setValues(e)}}let E8=y8(class extends yv{static get type(){return"RotateNode"}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){let{rotationNode:t,positionNode:r}=this;if("vec2"===this.getNodeType(e)){let e=t.cos(),n=t.sin();return vw(e,n,n.negate(),e).mul(r)}{let e=vE(v_(1,0,0,0),v_(0,x4(t.x),x3(t.x).negate(),0),v_(0,x3(t.x),x4(t.x),0),v_(0,0,0,1)),n=vE(v_(x4(t.y),0,x3(t.y),0),v_(0,1,0,0),v_(x3(t.y).negate(),0,x4(t.y),0),v_(0,0,0,1)),i=vE(v_(x4(t.z),x3(t.z).negate(),0,0),v_(x3(t.z),x4(t.z),0,0),v_(0,0,1,0),v_(0,0,0,1));return e.mul(n).mul(i).mul(v_(r,1)).xyz}}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}}).setParameterLength(2),E9=new r8;class Re extends w3{static get type(){return"SpriteNodeMaterial"}setupPositionView(e){let{object:t,camera:r}=e,{positionNode:n,rotationNode:i,scaleNode:a,sizeAttenuation:s}=this,o=Sp.mul(vg(n||0)),l=vA(So[0].xyz.length(),So[1].xyz.length());null!==a&&(l=l.mul(vA(a))),r.isPerspectiveCamera&&!1===s&&(l=l.mul(o.z.negate()));let u=Sy.xy;if(t.center&&!0===t.center.isVector2){let e=y4(new _8("center","vec2",t));u=u.sub(e.sub(.5))}let c=E8(u=u.mul(l),vu(i||Tq));return v_(o.xy.add(c),o.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(E9),this.setValues(e)}}let Rt=new ix,Rr=new ey;class Rn extends Re{static get type(){return"PointsNodeMaterial"}setupPositionView(){let{positionNode:e}=this;return Sp.mul(vg(e||Sv)).xyz}setupVertexSprite(e){let{material:t,camera:r}=e,{rotationNode:n,scaleNode:i,sizeNode:a,sizeAttenuation:s}=this,o=super.setupVertex(e);if(!0!==t.isNodeMaterial)return o;let l=null!==a?vA(a):T5;l=l.mul(bq),r.isPerspectiveCamera&&!0===s&&(l=l.mul(Ri.div(SS.z.negate()))),i&&i.isNode&&(l=l.mul(vA(i)));let u=Sy.xy;return n&&n.isNode&&(u=E8(u,vu(n))),u=(u=(u=u.mul(l)).div(bX.div(2))).mul(o.w),o=o.add(v_(u,0,0))}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(Rt),this.setValues(e)}}let Ri=xi(1).onFrameUpdate(function(e){let{renderer:t}=e,r=t.getSize(Rr);this.value=.5*r.y});class Ra extends Mh{direct(e){let{lightNode:t}=e;null!==t.shadowNode&&this.shadowNode.mulAssign(t.shadowNode)}finish(e){let{context:t}=e;vL.a.mulAssign(this.shadowNode.oneMinus()),t.outgoingLight.rgb.assign(vL.rgb)}constructor(){super(),this.shadowNode=vu(1).toVar("shadowMask")}}let Rs=new aq;class Ro extends w3{static get type(){return"ShadowNodeMaterial"}setupLightingModel(){return new Ra}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Rs),this.setValues(e)}}vP("vec3"),vP("vec3"),vP("vec3");class Rl{start(){let e=(t,r)=>{this._requestId=this._context.requestAnimationFrame(e),!0===this.info.autoReset&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,null!==this._animationLoop&&this._animationLoop(t,r)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}constructor(e,t){this.nodes=e,this.info=t,this._context="undefined"!=typeof self?self:null,this._animationLoop=null,this._requestId=null}}class Ru{get(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(void 0===(t=t.get(e[r])))return;return t.get(e[e.length-1])}set(e,t){let r=this.weakMap;for(let t=0;t<e.length-1;t++){let n=e[t];!1===r.has(n)&&r.set(n,new WeakMap),r=r.get(n)}return r.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(void 0===(t=t.get(e[r])))return!1;return t.delete(e[e.length-1])}constructor(){this.weakMap=new WeakMap}}let Rc=0;class Rh{updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return null!==this.clippingContext&&this.clippingContext.cacheKey!==this.clippingContextCacheKey&&(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return!0===this.material.hardwareClipping?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(let t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(null!==this.attributes)return this.attributes;let e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,r=[],n=new Set,i={};for(let a of e){let e;if(a.node&&a.node.attribute?e=a.node.attribute:(e=t.getAttribute(a.name),i[a.name]=e.version),void 0===e)continue;r.push(e);let s=e.isInterleavedBufferAttribute?e.data:e;n.add(s)}return this.attributes=r,this.attributesId=i,this.vertexBuffers=Array.from(n.values()),r}getVertexBuffers(){return null===this.vertexBuffers&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){let{object:e,material:t,geometry:r,group:n,drawRange:i}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),s=this.getIndex(),o=null!==s,l=1;if(!0===r.isInstancedBufferGeometry?l=r.instanceCount:void 0!==e.count&&(l=Math.max(0,e.count)),0===l)return null;if(a.instanceCount=l,!0===e.isBatchedMesh)return a;let u=1;!0!==t.wireframe||e.isPoints||e.isLineSegments||e.isLine||e.isLineLoop||(u=2);let c=i.start*u,h=(i.start+i.count)*u;null!==n&&(c=Math.max(c,n.start*u),h=Math.min(h,(n.start+n.count)*u));let d=r.attributes.position,A=1/0;o?A=s.count:null!=d&&(A=d.count),c=Math.max(c,0);let p=(h=Math.min(h,A))-c;return p<0||p===1/0?null:(a.vertexCount=p,a.firstVertex=c,a)}getGeometryCacheKey(){let{geometry:e}=this,t="";for(let r of Object.keys(e.attributes).sort()){let n=e.attributes[r];t+=r+",",n.data&&(t+=n.data.stride+","),n.offset&&(t+=n.offset+","),n.itemSize&&(t+=n.itemSize+","),n.normalized&&(t+="n,")}for(let r of Object.keys(e.morphAttributes).sort()){let n=e.morphAttributes[r];t+="morph-"+r+",";for(let e=0,r=n.length;e<r;e++)t+=n[e].id+","}return e.index&&(t+="index,"),t}getMaterialCacheKey(){let{object:e,material:t,renderer:r}=this,n=t.customProgramCacheKey();for(let e of function(e){let t=Object.keys(e),r=Object.getPrototypeOf(e);for(;r;){let e=Object.getOwnPropertyDescriptors(r);for(let r in e)if(void 0!==e[r]){let n=e[r];n&&"function"==typeof n.get&&t.push(r)}r=Object.getPrototypeOf(r)}return t}(t)){let i;if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(e))continue;let a=t[e];if(null!==a){let e=typeof a;"number"===e?i=0!==a?"1":"0":"object"===e?(i="{",a.isTexture&&(i+=a.mapping,!0===r.backend.isWebGPUBackend&&(i+=a.magFilter,i+=a.minFilter,i+=a.wrapS,i+=a.wrapT,i+=a.wrapR)),i+="}"):i=String(a)}else i=String(a);n+=i+","}return n+=this.clippingContextCacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",null!==e._colorsTexture&&(n+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1)&&(n+=e.uuid+","),g3(n+=e.receiveShadow+",")}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(null!==this.attributes){let e=this.attributesId;for(let t in e){let r=this.geometry.getAttribute(t);if(void 0===r||e[t]!==r.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return!0!==this.material.isShadowPassMaterial&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=g5(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=g5(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}constructor(e,t,r,n,i,a,s,o,l,u){this.id=Rc++,this._nodes=e,this._geometries=t,this.renderer=r,this.object=n,this.material=i,this.scene=a,this.camera=s,this.lightsNode=o,this.context=l,this.geometry=n.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=u,this.clippingContextCacheKey=null!==u?u.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}}let Rd=[];class RA{get(e,t,r,n,i,a,s,o){let l=this.getChainMap(o);Rd[0]=e,Rd[1]=t,Rd[2]=a,Rd[3]=i;let u=l.get(Rd);return void 0===u?(u=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,r,n,i,a,s,o),l.set(Rd,u)):(u.updateClipping(s),u.needsGeometryUpdate&&u.setGeometry(e.geometry),(u.version!==t.version||u.needsUpdate)&&(u.initialCacheKey!==u.getCacheKey()?(u.dispose(),u=this.get(e,t,r,n,i,a,s,o)):u.version=t.version)),Rd.length=0,u}getChainMap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.chainMaps[e]||(this.chainMaps[e]=new Ru)}dispose(){this.chainMaps={}}createRenderObject(e,t,r,n,i,a,s,o,l,u,c){let h=this.getChainMap(c),d=new Rh(e,t,r,n,i,a,s,o,l,u);return d.onDispose=()=>{this.pipelines.delete(d),this.bindings.delete(d),this.nodes.delete(d),h.delete(d.getChainArray())},d}constructor(e,t,r,n,i,a){this.renderer=e,this.nodes=t,this.geometries=r,this.pipelines=n,this.bindings=i,this.info=a,this.chainMaps={}}}class Rp{get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}constructor(){this.data=new WeakMap}}let Rf={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4};class Rm extends Rp{delete(e){let t=super.delete(e);return null!==t&&this.backend.destroyAttribute(e),t}update(e,t){let r=this.get(e);if(void 0===r.version)t===Rf.VERTEX?this.backend.createAttribute(e):t===Rf.INDEX?this.backend.createIndexAttribute(e):t===Rf.STORAGE?this.backend.createStorageAttribute(e):t===Rf.INDIRECT&&this.backend.createIndirectStorageAttribute(e),r.version=this._getBufferAttribute(e).version;else{let t=this._getBufferAttribute(e);(r.version<t.version||35048===t.usage)&&(this.backend.updateAttribute(e),r.version=t.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}constructor(e){super(),this.backend=e}}function Rg(e){return null!==e.index?e.index.version:e.attributes.position.version}function Ry(e){let t=[],r=e.index,n=e.attributes.position;if(null!==r){let e=r.array;for(let r=0,n=e.length;r<n;r+=3){let n=e[r+0],i=e[r+1],a=e[r+2];t.push(n,i,i,a,a,n)}}else{let e=n.array;for(let r=0,n=e.length/3-1;r<n;r+=3){let e=r+0,n=r+1,i=r+2;t.push(e,n,n,i,i,e)}}let i=new(ew(t)?rf:rA)(t,1);return i.version=Rg(e),i}class Rv extends Rp{has(e){let t=e.geometry;return super.has(t)&&!0===this.get(t).initialized}updateForRender(e){!1===this.has(e)&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){let t=e.geometry;this.get(t).initialized=!0,this.info.memory.geometries++;let r=()=>{this.info.memory.geometries--;let n=t.index,i=e.getAttributes();for(let e of(null!==n&&this.attributes.delete(n),i))this.attributes.delete(e);let a=this.wireframes.get(t);void 0!==a&&this.attributes.delete(a),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){for(let t of e.getAttributes())t.isStorageBufferAttribute||t.isStorageInstancedBufferAttribute?this.updateAttribute(t,Rf.STORAGE):this.updateAttribute(t,Rf.VERTEX);let t=this.getIndex(e);null!==t&&this.updateAttribute(t,Rf.INDEX);let r=e.geometry.indirect;null!==r&&this.updateAttribute(r,Rf.INDIRECT)}updateAttribute(e,t){let r=this.info.render.calls;e.isInterleavedBufferAttribute?void 0===this.attributeCall.get(e)?(this.attributes.update(e,t),this.attributeCall.set(e,r)):this.attributeCall.get(e.data)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e.data,r),this.attributeCall.set(e,r)):this.attributeCall.get(e)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e,r))}getIndirect(e){return e.geometry.indirect}getIndex(e){let{geometry:t,material:r}=e,n=t.index;if(!0===r.wireframe){let e=this.wireframes,r=e.get(t);void 0===r?(r=Ry(t),e.set(t,r)):r.version!==Rg(t)&&(this.attributes.delete(r),r=Ry(t),e.set(t,r)),n=r}return n}constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}}class Rx{update(e,t,r){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=t/3*r:e.isPoints?this.render.points+=r*t:e.isLineSegments?this.render.lines+=t/2*r:e.isLine?this.render.lines+=r*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}}class R_{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Rb extends R_{constructor(e,t,r){super(e),this.vertexProgram=t,this.fragmentProgram=r}}class RS extends R_{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let RT=0;class Rw{constructor(e,t,r,n=null,i=null){this.id=RT++,this.code=e,this.stage=t,this.name=r,this.transforms=n,this.attributes=i,this.usedTimes=0}}class RM extends Rp{getForCompute(e,t){let{backend:r}=this,n=this.get(e);if(this._needsComputeUpdate(e)){let i=n.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);let a=this.nodes.getForCompute(e),s=this.programs.compute.get(a.computeShader);void 0===s&&(i&&0===i.computeProgram.usedTimes&&this._releaseProgram(i.computeProgram),s=new Rw(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,s),r.createProgram(s));let o=this._getComputeCacheKey(e,s),l=this.caches.get(o);void 0===l&&(i&&0===i.usedTimes&&this._releasePipeline(i),l=this._getComputePipeline(e,s,o,t)),l.usedTimes++,s.usedTimes++,n.version=e.version,n.pipeline=l}return n.pipeline}getForRender(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{backend:r}=this,n=this.get(e);if(this._needsRenderUpdate(e)){let i=n.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);let a=e.getNodeBuilderState(),s=e.material?e.material.name:"",o=this.programs.vertex.get(a.vertexShader);void 0===o&&(i&&0===i.vertexProgram.usedTimes&&this._releaseProgram(i.vertexProgram),o=new Rw(a.vertexShader,"vertex",s),this.programs.vertex.set(a.vertexShader,o),r.createProgram(o));let l=this.programs.fragment.get(a.fragmentShader);void 0===l&&(i&&0===i.fragmentProgram.usedTimes&&this._releaseProgram(i.fragmentProgram),l=new Rw(a.fragmentShader,"fragment",s),this.programs.fragment.set(a.fragmentShader,l),r.createProgram(l));let u=this._getRenderCacheKey(e,o,l),c=this.caches.get(u);void 0===c?(i&&0===i.usedTimes&&this._releasePipeline(i),c=this._getRenderPipeline(e,o,l,u,t)):e.pipeline=c,c.usedTimes++,o.usedTimes++,l.usedTimes++,n.pipeline=c}return n.pipeline}delete(e){let t=this.get(e).pipeline;return t&&(t.usedTimes--,0===t.usedTimes&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,0===t.computeProgram.usedTimes&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,0===t.vertexProgram.usedTimes&&this._releaseProgram(t.vertexProgram),0===t.fragmentProgram.usedTimes&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,r,n){r=r||this._getComputeCacheKey(e,t);let i=this.caches.get(r);return void 0===i&&(i=new RS(r,t),this.caches.set(r,i),this.backend.createComputePipeline(i,n)),i}_getRenderPipeline(e,t,r,n,i){n=n||this._getRenderCacheKey(e,t,r);let a=this.caches.get(n);return void 0===a&&(a=new Rb(n,t,r),this.caches.set(n,a),e.pipeline=a,this.backend.createRenderPipeline(e,i)),a}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,r){return t.id+","+r.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){let t=e.code,r=e.stage;this.programs[r].delete(t)}_needsComputeUpdate(e){let t=this.get(e);return void 0===t.pipeline||t.version!==e.version}_needsRenderUpdate(e){return void 0===this.get(e).pipeline||this.backend.needsRenderUpdate(e)}constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}}class RE extends Rp{getForRender(e){let t=e.getBindings();for(let e of t){let r=this.get(e);void 0===r.bindGroup&&(this._init(e),this.backend.createBindings(e,t,0),r.bindGroup=e)}return t}getForCompute(e){let t=this.nodes.getForCompute(e).bindings;for(let e of t){let r=this.get(e);void 0===r.bindGroup&&(this._init(e),this.backend.createBindings(e,t,0),r.bindGroup=e)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(let t of e)this._update(t,e)}_init(e){for(let t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){let e=t.attribute,r=e.isIndirectStorageBufferAttribute?Rf.INDIRECT:Rf.STORAGE;this.attributes.update(e,r)}}_update(e,t){let{backend:r}=this,n=!1,i=!0,a=0,s=0;for(let t of e.bindings)if(!t.isNodeUniformsGroup||!1!==this.nodes.updateGroup(t)){if(t.isStorageBuffer){let e=t.attribute,r=e.isIndirectStorageBufferAttribute?Rf.INDIRECT:Rf.STORAGE;this.attributes.update(e,r)}if(t.isUniformBuffer)t.update()&&r.updateBinding(t);else if(t.isSampledTexture){let e=t.update(),o=t.texture,l=this.textures.get(o);if(e&&(this.textures.updateTexture(o),t.generation!==l.generation&&(t.generation=l.generation,n=!0,i=!1)),void 0!==r.get(o).externalTexture||l.isDefaultTexture?i=!1:(a=10*a+o.id,s+=o.version),!0===o.isStorageTexture){let e=this.get(o);!0===t.store?e.needsMipmap=!0:this.textures.needsMipmaps(o)&&!0===e.needsMipmap&&(this.backend.generateMipmaps(o),e.needsMipmap=!1)}}else t.isSampler&&t.update()}!0===n&&this.backend.updateBindings(e,t,i?a:0,s)}constructor(e,t,r,n,i,a){super(),this.backend=e,this.textures=r,this.pipelines=i,this.attributes=n,this.nodes=t,this.info=a,this.pipelines.bindings=this}}function RR(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?e.z-t.z:e.id-t.id}function RC(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function RN(e){return(e.transmission>0||e.transmissionNode)&&2===e.side&&!1===e.forceSinglePass}class RP{begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,r,n,i,a,s){let o=this.renderItems[this.renderItemsIndex];return void 0===o?(o={id:e.id,object:e,geometry:t,material:r,groupOrder:n,renderOrder:e.renderOrder,z:i,group:a,clippingContext:s},this.renderItems[this.renderItemsIndex]=o):(o.id=e.id,o.object=e,o.geometry=t,o.material=r,o.groupOrder=n,o.renderOrder=e.renderOrder,o.z=i,o.group=a,o.clippingContext=s),this.renderItemsIndex++,o}push(e,t,r,n,i,a,s){let o=this.getNextRenderItem(e,t,r,n,i,a,s);!0===e.occlusionTest&&this.occlusionQueryCount++,!0===r.transparent||r.transmission>0?(RN(r)&&this.transparentDoublePass.push(o),this.transparent.push(o)):this.opaque.push(o)}unshift(e,t,r,n,i,a,s){let o=this.getNextRenderItem(e,t,r,n,i,a,s);!0===r.transparent||r.transmission>0?(RN(r)&&this.transparentDoublePass.unshift(o),this.transparent.unshift(o)):this.opaque.unshift(o)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||RR),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||RC),this.transparent.length>1&&this.transparent.sort(t||RC)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){let t=this.renderItems[e];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.groupOrder=null,t.renderOrder=null,t.z=null,t.group=null,t.clippingContext=null}}constructor(e,t,r){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,r),this.lightsArray=[],this.scene=t,this.camera=r,this.occlusionQueryCount=0}}let RI=[];class RL{get(e,t){let r=this.lists;RI[0]=e,RI[1]=t;let n=r.get(RI);return void 0===n&&(n=new RP(this.lighting,e,t),r.set(RI,n)),RI.length=0,n}dispose(){this.lists=new Ru}constructor(e){this.lighting=e,this.lists=new Ru}}let RD=0;class RB{getCacheKey(){return RF(this)}constructor(){this.id=RD++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new eH,this.scissor=!1,this.scissorValue=new eH,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}}function RF(e){let{textures:t,activeCubeFace:r,activeMipmapLevel:n}=e,i=[r,n];for(let e of t)i.push(e.id);return g4(i)}let RU=[],RO=new r4,Rk=new rj;class Rz{get(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(RU[0]=e,RU[1]=t,null===n)r="default";else{let e=n.texture.format,t=n.textures.length;r="".concat(t,":").concat(e,":").concat(n.samples,":").concat(n.depthBuffer,":").concat(n.stencilBuffer)}let i=this._getChainMap(r),a=i.get(RU);return void 0===a&&(a=new RB,i.set(RU,a)),RU.length=0,null!==n&&(a.sampleCount=0===n.samples?1:n.samples),a}getForClear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.get(RO,Rk,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Ru)}dispose(){this.chainMaps={}}constructor(){this.chainMaps={}}}let RV=new ex;class Rq extends Rp{updateRenderTarget(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.get(e),n=0===e.samples?1:e.samples,i=r.depthTextureMips||(r.depthTextureMips={}),a=e.textures,s=this.getSize(a[0]),o=s.width>>t,l=s.height>>t,u=e.depthTexture||i[t],c=!0===e.depthBuffer||!0===e.stencilBuffer,h=!1;void 0===u&&c&&((u=new iD).format=e.stencilBuffer?1027:1026,u.type=e.stencilBuffer?1020:1014,u.image.width=o,u.image.height=l,u.image.depth=s.depth,u.isArrayTexture=!0===e.multiview&&s.depth>1,i[t]=u),(r.width!==s.width||s.height!==r.height)&&(h=!0,u&&(u.needsUpdate=!0,u.image.width=o,u.image.height=l,u.image.depth=u.isArrayTexture?u.image.depth:1)),r.width=s.width,r.height=s.height,r.textures=a,r.depthTexture=u||null,r.depth=e.depthBuffer,r.stencil=e.stencilBuffer,r.renderTarget=e,r.sampleCount!==n&&(h=!0,u&&(u.needsUpdate=!0),r.sampleCount=n);let d={sampleCount:n};if(!0!==e.isXRRenderTarget){for(let e=0;e<a.length;e++){let t=a[e];h&&(t.needsUpdate=!0),this.updateTexture(t,d)}u&&this.updateTexture(u,d)}if(!0!==r.initialized){r.initialized=!0;let t=()=>{e.removeEventListener("dispose",t);for(let e=0;e<a.length;e++)this._destroyTexture(a[e]);u&&this._destroyTexture(u),this.delete(e),this.backend.delete(e)};e.addEventListener("dispose",t)}}updateTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.get(e);if(!0===r.initialized&&r.version===e.version)return;let n=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(n&&!0===r.initialized&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){let t=this.renderer.getRenderTarget();t?e.type=t.texture.type:e.type=1009}let{width:a,height:s,depth:o}=this.getSize(e);if(t.width=a,t.height=s,t.depth=o,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,a,s):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,n||!0===e.isStorageTexture||!0===e.isExternalTexture)i.createSampler(e),i.createTexture(e,t),r.generation=e.version;else if(!0!==r.initialized&&i.createSampler(e),e.version>0){let n=e.image;if(void 0===n)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(!1===n.complete)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){let r=[];for(let t of e.images)r.push(t);t.images=r}else t.image=n;(void 0===r.isDefaultTexture||!0===r.isDefaultTexture)&&(i.createTexture(e,t),r.isDefaultTexture=!1,r.generation=e.version),!0===e.source.dataReady&&i.updateTexture(e,t),t.needsMipmaps&&0===e.mipmaps.length&&i.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else i.createDefaultTexture(e),r.isDefaultTexture=!0,r.generation=e.version;if(!0!==r.initialized){r.initialized=!0,r.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&eD.getTransfer(e.colorSpace)!==et&&console.warn("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace.");let t=()=>{e.removeEventListener("dispose",t),this._destroyTexture(e)};e.addEventListener("dispose",t)}r.version=e.version}getSize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RV,r=e.images?e.images[0]:e.image;return r?(void 0!==r.image&&(r=r.image),"undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement?(t.width=r.videoWidth||1,t.height=r.videoHeight||1,t.depth=1):r instanceof VideoFrame?(t.width=r.displayWidth||1,t.height=r.displayHeight||1,t.depth=1):(t.width=r.width||1,t.height=r.height||1,t.depth=e.isCubeTexture?6:r.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,r){return e.mipmaps.length>0?e.mipmaps.length:!0===e.isCompressedTexture?1:Math.floor(Math.log2(Math.max(t,r)))+1}needsMipmaps(e){return!0===e.generateMipmaps||e.mipmaps.length>0}_destroyTexture(e){!0===this.has(e)&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}constructor(e,t,r){super(),this.renderer=e,this.backend=t,this.info=r}}class RG extends t6{set(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.a=n,super.set(e,t,r)}copy(e){return void 0!==e.a&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}constructor(e,t,r,n=1){super(e,t,r),this.a=n}}class RH extends vN{static get type(){return"ParameterNode"}getHash(){return this.uuid}generate(){return this.name}constructor(e,t=null){super(e,t),this.isParameterNode=!0}}let Rj=y8(class extends ym{static get type(){return"StackNode"}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput?this.outputNode.getMemberType(e,t):"void"}add(e){return!0!==e.isNode?console.error("THREE.TSL: Invalid node added to stack."):this.nodes.push(e),this}If(e,t){let r=new y3(t);return this._currentCond=_z(e,r),this.add(this._currentCond)}ElseIf(e,t){let r=_z(e,new y3(t));return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new y3(e),this}Switch(e){return this._expressionNode=y4(e),this}Case(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=[];if(t.length>=2)for(let e=0;e<t.length-1;e++)n.push(this._expressionNode.equal(y4(t[e])));else console.error("THREE.TSL: Invalid parameter length. Case() requires at least two parameters.");let i=new y3(t[t.length-1]),a=n[0];for(let e=1;e<n.length;e++)a=a.or(n[e]);let s=_z(a,i);return null===this._currentCond?(this._currentCond=s,this.add(this._currentCond)):(this._currentCond.elseNode=s,this._currentCond=s,this)}Default(e){return this.Else(e),this}setup(e){let t=e.getNodeProperties(this),r=0;for(let n of this.getChildren())n.isVarNode&&!0===n.intent&&!0!==e.getNodeProperties(n).assign||(t["node"+r++]=n);return t.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e){let t;for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];let a=e.currentStack,s=va();vi(this),e.currentStack=this;let o=e.buildStage;for(let t of this.nodes)if(!t.isVarNode||!0!==t.intent||!0===e.getNodeProperties(t).assign){if("setup"===o)t.build(e);else if("analyze"===o)t.build(e,this);else if("generate"===o){let r=e.getDataFromNode(t,"any").stages,n=r&&r[e.shaderStage];if(t.isVarNode&&n&&1===n.length&&n[0]&&n[0].isStackNode)continue;t.build(e,"void")}}return t=this.hasOutput?this.outputNode.build(e,...n):super.build(e,...n),vi(s),e.currentStack=a,t}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}}).setParameterLength(0,1);class RW extends ym{static get type(){return"StructTypeNode"}getLength(){let e=Float32Array.BYTES_PER_ELEMENT,t=0;for(let r of this.membersLayout){let n=r.type,i=(/float|int|uint/.test(n)?1:/vec2/.test(n)?2:/vec3/.test(n)?3:/vec4/.test(n)||/mat2/.test(n)?4:/mat3/.test(n)?12:/mat4/.test(n)?16:void console.error("THREE.TSL: Unsupported type:",n))*e,a=/float|int|uint/.test(n)?4:/vec2/.test(n)?8:/vec3/.test(n)||/vec4/.test(n)?16:/mat2/.test(n)?8:/mat3/.test(n)?48:/mat4/.test(n)?64:void console.error("THREE.TSL: Unsupported type:",n),s=t%8,o=s%a,l=s+o;t+=o,0!==l&&8-l<i&&(t+=8-l),t+=i}return 8*Math.ceil(t/8)/e}getMemberType(e,t){let r=this.membersLayout.find(e=>e.name===t);return r?r.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}constructor(e,t=null){super("struct"),this.membersLayout=Object.entries(e).map(e=>{let[t,r]=e;return"string"==typeof r?{name:t,type:r,atomic:!1}:{name:t,type:r.type,atomic:r.atomic||!1}}),this.name=t,this.isStructLayoutNode=!0}}class RX extends ym{static get type(){return"StructNode"}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,t){return this.structTypeNode.getMemberType(e,t)}generate(e){let t=e.getVarFromNode(this),r=t.type,n=e.getPropertyName(t);return e.addLineFlowCode("".concat(n," = ").concat(e.generateStruct(r,this.structTypeNode.membersLayout,this.values)),this),t.name}constructor(e,t){super("vec3"),this.structTypeNode=e,this.values=t,this.isStructNode=!0}}class RQ extends ym{static get type(){return"OutputStructNode"}getNodeType(e){let t=e.getNodeProperties(this);if(void 0===t.membersLayout){let r=this.members,n=[];for(let t=0;t<r.length;t++){let i="m"+t,a=r[t].getNodeType(e);n.push({name:i,type:a,index:t})}t.membersLayout=n,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){let t=e.getOutputStructName(),r=this.members,n=""!==t?t+".":"";for(let t=0;t<r.length;t++){let i=r[t].build(e);e.addLineFlowCode("".concat(n,"m").concat(t," = ").concat(i),this)}return t}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}}let RY=y8(RQ);function RK(e,t){for(let r=0;r<e.length;r++)if(e[r].name===t)return r;return -1}let RZ=y8(class extends RQ{static get type(){return"MRTNode"}has(e){return void 0!==this.outputNodes[e]}get(e){return this.outputNodes[e]}merge(e){return RZ({...this.outputNodes,...e.outputNodes})}setup(e){let t=this.outputNodes,r=e.renderer.getRenderTarget(),n=[],i=r.textures;for(let e in t)n[RK(i,e)]=v_(t[e]);return this.members=n,super.setup(e)}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}});class RJ extends yv{static get type(){return"BitcastNode"}getNodeType(e){if(null!==this.inputType){let t=this.valueNode.getNodeType(e),r=e.getTypeLength(t);return e.getTypeFromLength(r,this.conversionType)}return this.conversionType}generate(e){let t=this.getNodeType(e),r="";if(null!==this.inputType){let t=this.valueNode.getNodeType(e);r=1===e.getTypeLength(t)?this.inputType:e.changeComponentType(t,this.inputType)}else r=this.valueNode.getNodeType(e);return"".concat(e.getBitcastMethod(t,r),"( ").concat(this.valueNode.build(e,r)," )")}constructor(e,t,r=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=r,this.isBitcastNode=!0}}let R$=ve(RJ).setParameterLength(2),R0=vn(e=>{let[t]=e,r=t.toUint().mul(0x2c9277b5).add(0xac564b05),n=r.shiftRight(r.shiftRight(28).add(4)).bitXor(r).mul(0x108ef2d9);return n.shiftRight(22).bitXor(n).toFloat().mul(1/0x100000000)}),R1=(e,t)=>_b(xp(4,e.mul(xA(1,e))),t),R2=vn(e=>{let[t]=e;return t.fract().sub(.5).abs()}).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),R3=vn(e=>{let[t]=e;return vg(R2(t.z.add(R2(t.y.mul(1)))),R2(t.z.add(R2(t.x.mul(1)))),R2(t.y.add(R2(t.x.mul(1)))))}).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),R4=vn(e=>{let[t,r,n]=e,i=vg(t).toVar(),a=vu(1.4).toVar(),s=vu(0).toVar(),o=vg(i).toVar();return wv({start:vu(0),end:vu(3),type:"float",condition:"<="},()=>{let e=vg(R3(o.mul(2))).toVar();i.addAssign(e.add(n.mul(vu(.1).mul(r)))),o.mulAssign(1.8),a.mulAssign(1.5),i.mulAssign(1.2);let t=vu(R2(i.z.add(R2(i.x.add(R2(i.y)))))).toVar();s.addAssign(t.div(a)),o.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]}),R5=y8(class extends ym{static get type(){return"FunctionOverloadingNode"}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){let t=this.parametersNodes,r=this._candidateFnCall;if(null===r){let n=null,i=-1;for(let r of this.functionNodes){let a=r.shaderNode.layout;if(null===a)throw Error("FunctionOverloadingNode: FunctionNode must be a layout.");let s=a.inputs;if(t.length===s.length){let a=0;for(let r=0;r<t.length;r++){let n=t[r],i=s[r];n.getNodeType(e)===i.type?a++:a=0}a>i&&(n=r,i=a)}}this._candidateFnCall=r=n(...t)}return r}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}}),R6=e=>function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return R5(e,...r)},R7=xi(0).setGroup(xt).onRenderUpdate(e=>e.time),R8=xi(0).setGroup(xt).onRenderUpdate(e=>e.deltaTime),R9=xi(0,"uint").setGroup(xt).onRenderUpdate(e=>e.frameId),Ce=vn(e=>{let[t,r,n=vA(.5)]=e;return E8(t.sub(n),r).add(n)}),Ct=vn(e=>{let[t,r,n=vA(.5)]=e,i=t.sub(n),a=i.dot(i),s=a.mul(a).mul(r);return t.add(i.mul(s))}),Cr=vn(e=>{let t,{position:r=null,horizontal:n=!0,vertical:i=!1}=e;null!==r?((t=So.toVar())[3][0]=r.x,t[3][1]=r.y,t[3][2]=r.z):t=So;let a=b2.mul(t);return y1(n)&&(a[0][0]=So[0].length(),a[0][1]=0,a[0][2]=0),y1(i)&&(a[1][0]=0,a[1][1]=So[1].length(),a[1][2]=0),a[2][0]=0,a[2][1]=0,a[2][2]=1,b0.mul(a).mul(Sv)}),Cn=vn(e=>{let[t=null]=e,r=wq();return wq(wD(t)).sub(r).lessThan(0).select(bG,t)}),Ci=y8(class extends ym{static get type(){return"SpriteSheetUVNode"}setup(){let{frameNode:e,uvNode:t,countNode:r}=this,{width:n,height:i}=r,a=e.mod(n.mul(i)).floor(),s=a.mod(n),o=i.sub(a.add(1).div(n).ceil()),l=r.reciprocal(),u=vA(s,o);return t.add(u).mul(l)}constructor(e,t=bE(),r=vu(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=r}}).setParameterLength(3),Ca=vn(e=>{let[t,r=null,n=null,i=vu(1),a=Sv,s=SC]=e,o=s.abs().normalize();o=o.div(o.dot(vg(1)));let l=a.yz.mul(i),u=a.zx.mul(i),c=a.xy.mul(i),h=t.value,d=null!==r?r.value:h,A=null!==n?n.value:h,p=bL(h,l).mul(o.x);return xd(p,bL(d,u).mul(o.y),bL(A,c).mul(o.z))}),Cs=new nG,Co=new ex,Cl=new ex,Cu=new ex,Cc=new tp,Ch=new ex(0,0,-1),Cd=new eH,CA=new ex,Cp=new ex,Cf=new eH,Cm=new ey,Cg=new ej,Cy=bG.flipX();Cg.depthTexture=new iD(1,1);let Cv=!1;class Cx extends bP{static get type(){return"ReflectorNode"}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(null===this._depthNode){if(!0!==this._reflectorBaseNode.depth)throw Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=y4(new Cx({defaultTexture:Cg.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){let e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}constructor(e={}){super(e.defaultTexture||Cg.texture,Cy),this._reflectorBaseNode=e.reflector||new C_(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}}class C_ extends ym{static get type(){return"ReflectorBaseNode"}_updateResolution(e,t){let r=this.resolutionScale;t.getDrawingBufferSize(Cm),e.setSize(Math.round(Cm.width*r),Math.round(Cm.height*r))}setup(e){return this._updateResolution(Cg,e.renderer),super.setup(e)}dispose(){for(let e of(super.dispose(),this.renderTargets.values()))e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return void 0===t&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return void 0===t&&(t=new ej(0,0,{type:1016,samples:this.samples}),!0===this.generateMipmaps&&(t.texture.minFilter=1008,t.texture.generateMipmaps=!0),!0===this.depth&&(t.depthTexture=new iD),this.renderTargets.set(e,t)),t}updateBefore(e){if(!1===this.bounces&&Cv)return!1;Cv=!0;let{scene:t,camera:r,renderer:n,material:i}=e,{target:a}=this,s=this.getVirtualCamera(r),o=this.getRenderTarget(s);n.getDrawingBufferSize(Cm),this._updateResolution(o,n),Cl.setFromMatrixPosition(a.matrixWorld),Cu.setFromMatrixPosition(r.matrixWorld),Cc.extractRotation(a.matrixWorld),Co.set(0,0,1),Co.applyMatrix4(Cc),CA.subVectors(Cl,Cu);let l=CA.dot(Co)>0,u=!1;if(!0===l&&!1===this.forceUpdate){if(!1===this.hasOutput){Cv=!1;return}u=!0}CA.reflect(Co).negate(),CA.add(Cl),Cc.extractRotation(r.matrixWorld),Ch.set(0,0,-1),Ch.applyMatrix4(Cc),Ch.add(Cu),Cp.subVectors(Cl,Ch),Cp.reflect(Co).negate(),Cp.add(Cl),s.coordinateSystem=r.coordinateSystem,s.position.copy(CA),s.up.set(0,1,0),s.up.applyMatrix4(Cc),s.up.reflect(Co),s.lookAt(Cp),s.near=r.near,s.far=r.far,s.updateMatrixWorld(),s.projectionMatrix.copy(r.projectionMatrix),Cs.setFromNormalAndCoplanarPoint(Co,Cl),Cs.applyMatrix4(s.matrixWorldInverse),Cd.set(Cs.normal.x,Cs.normal.y,Cs.normal.z,Cs.constant);let c=s.projectionMatrix;Cf.x=(Math.sign(Cd.x)+c.elements[8])/c.elements[0],Cf.y=(Math.sign(Cd.y)+c.elements[9])/c.elements[5],Cf.z=-1,Cf.w=(1+c.elements[10])/c.elements[14],Cd.multiplyScalar(1/Cd.dot(Cf)),c.elements[2]=Cd.x,c.elements[6]=Cd.y,c.elements[10]=2001===n.coordinateSystem?Cd.z-0:Cd.z+1-0,c.elements[14]=Cd.w,this.textureNode.value=o.texture,!0===this.depth&&(this.textureNode.getDepthNode().value=o.depthTexture),i.visible=!1;let h=n.getRenderTarget(),d=n.getMRT(),A=n.autoClear;n.setMRT(null),n.setRenderTarget(o),n.autoClear=!0,u?(n.clear(),this.hasOutput=!1):(n.render(t,s),this.hasOutput=!0),n.setMRT(d),n.setRenderTarget(h),n.autoClear=A,i.visible=!0,Cv=!1,this.forceUpdate=!1}get resolution(){return eP('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){eP('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}constructor(e,t={}){super();let{target:r=new tV,resolutionScale:n=1,generateMipmaps:i=!1,bounces:a=!0,depth:s=!1,samples:o=0}=t;this.textureNode=e,this.target=r,this.resolutionScale=n,void 0!==t.resolution&&(eP('THREE.ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=t.resolution),this.generateMipmaps=i,this.bounces=a,this.depth=s,this.samples=o,this.updateBeforeType=a?yl.RENDER:yl.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}}let Cb=new sF(-1,1,1,-1,0,1),CS=new class extends rw{constructor(e=!1){super(),this.setAttribute("position",new rg([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new rg(!1===e?[0,-1,0,1,2,1]:[0,2,0,0,2,0],2))}};class CT extends rU{async renderAsync(e){return e.renderAsync(this,Cb)}render(e){e.render(this,Cb)}constructor(e=null){super(CS,e),this.camera=Cb,this.isQuadMesh=!0}}let Cw=new ey;class CM extends bP{static get type(){return"RTTNode"}get autoResize(){return null===this.width}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;let r=e*this.pixelRatio,n=t*this.pixelRatio;this.renderTarget.setSize(r,n),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore(e){let{renderer:t}=e;if(!1===this.textureNeedsUpdate&&!1===this.autoUpdate)return;if(this.textureNeedsUpdate=!1,!0===this.autoResize){let e=t.getPixelRatio(),r=t.getSize(Cw),n=r.width*e,i=r.height*e;(n!==this.renderTarget.width||i!==this.renderTarget.height)&&(this.renderTarget.setSize(n,i),this.textureNeedsUpdate=!0)}this._quadMesh.material.fragmentNode=this._rttNode;let r=t.getRenderTarget();t.setRenderTarget(this.renderTarget),this._quadMesh.render(t),t.setRenderTarget(r)}clone(){let e=new bP(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}constructor(e,t=null,r=null,n={type:1016}){let i=new ej(t,r,n);super(i.texture,bE()),this.isRTTNode=!0,this.node=e,this.width=t,this.height=r,this.pixelRatio=1,this.renderTarget=i,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new CT(new w3),this.updateBeforeType=yl.RENDER}}let CE=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return y4(new CM(y4(e),...r))},CR=vn((e,t)=>{let r,[n,i,a]=e;r=2001===t.renderer.coordinateSystem?v_(vg(n=vA(n.x,n.y.oneMinus()).mul(2).sub(1),i),1):v_(vg(n.x,n.y.oneMinus(),i).mul(2).sub(1),1);let s=v_(a.mul(r));return s.xyz.div(s.w)}),CC=vn(e=>{let[t,r]=e,n=r.mul(v_(t,1)),i=n.xy.div(n.w).mul(.5).add(.5).toVar();return vA(i.x,i.y.oneMinus())}),CN=vn(e=>{let[t,r,n]=e,i=bR(bD(r)),a=vp(t.mul(i)).toVar(),s=bD(r,a).toVar(),o=bD(r,a.sub(vp(2,0))).toVar(),l=bD(r,a.sub(vp(1,0))).toVar(),u=bD(r,a.add(vp(1,0))).toVar(),c=bD(r,a.add(vp(2,0))).toVar(),h=bD(r,a.add(vp(0,2))).toVar(),d=bD(r,a.add(vp(0,1))).toVar(),A=bD(r,a.sub(vp(0,1))).toVar(),p=bD(r,a.sub(vp(0,2))).toVar(),f=x9(xA(vu(2).mul(l).sub(o),s)).toVar(),m=x9(xA(vu(2).mul(u).sub(c),s)).toVar(),g=x9(xA(vu(2).mul(d).sub(h),s)).toVar(),y=x9(xA(vu(2).mul(A).sub(p),s)).toVar(),v=CR(t,s,n).toVar();return x1(__(f.lessThan(m).select(v.sub(CR(t.sub(vA(vu(1).div(i.x),0)),l,n)),v.negate().add(CR(t.add(vA(vu(1).div(i.x),0)),u,n))),g.lessThan(y).select(v.sub(CR(t.add(vA(0,vu(1).div(i.y))),d,n)),v.negate().add(CR(t.sub(vA(0,vu(1).div(i.y))),A,n)))))});class CP extends ym{static get type(){return"SampleNode"}setup(){return this.sample(bE())}sample(e){return this.callback(e)}constructor(e,t=null){super(),this.callback=e,this.uvNode=t,this.isSampleNode=!0}}class CI extends ym{static get type(){return"EventNode"}update(e){this.callback(e)}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===CI.OBJECT?this.updateType=yl.OBJECT:e===CI.MATERIAL&&(this.updateType=yl.RENDER)}}CI.OBJECT="object",CI.MATERIAL="material";let CL=(e,t)=>y4(new CI(e,t)).toStack();class CD extends nP{constructor(e,t,r=Float32Array){super(ArrayBuffer.isView(e)?e:new r(e*t),t),this.isStorageInstancedBufferAttribute=!0}}class CB extends rl{constructor(e,t,r=Float32Array){super(ArrayBuffer.isView(e)?e:new r(e*t),t),this.isStorageBufferAttribute=!0}}let CF=y9(class extends ym{static get type(){return"PointUVNode"}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}constructor(){super("vec2"),this.isPointUVNode=!0}}),CU=new tT,CO=new tp;class Ck extends ym{static get type(){return"SceneNode"}setup(e){let t,r=this.scope,n=null!==this.scene?this.scene:e.scene;return r===Ck.BACKGROUND_BLURRINESS?t=S1("backgroundBlurriness","float",n):r===Ck.BACKGROUND_INTENSITY?t=S1("backgroundIntensity","float",n):r===Ck.BACKGROUND_ROTATION?t=xi("mat4").setName("backgroundRotation").setGroup(xt).onRenderUpdate(()=>{let e=n.background;return null!==e&&e.isTexture&&300!==e.mapping?(CU.copy(n.backgroundRotation),CU.x*=-1,CU.y*=-1,CU.z*=-1,CO.makeRotationFromEuler(CU)):CO.identity(),CO}):console.error("THREE.SceneNode: Unknown scope:",r),t}constructor(e=Ck.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}}Ck.BACKGROUND_BLURRINESS="backgroundBlurriness",Ck.BACKGROUND_INTENSITY="backgroundIntensity",Ck.BACKGROUND_ROTATION="backgroundRotation";let Cz=y9(Ck,Ck.BACKGROUND_BLURRINESS),CV=y9(Ck,Ck.BACKGROUND_INTENSITY),Cq=y9(Ck,Ck.BACKGROUND_ROTATION),CG=y8(class extends bP{static get type(){return"StorageTextureNode"}getInputType(){return"storageTexture"}setup(e){super.setup(e);let t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}generate(e,t){return null!==this.storeNode?this.generateStore(e):super.generate(e,t)}toReadWrite(){return this.setAccess(yu.READ_WRITE)}toReadOnly(){return this.setAccess(yu.READ_ONLY)}toWriteOnly(){return this.setAccess(yu.WRITE_ONLY)}generateStore(e){let{uvNode:t,storeNode:r,depthNode:n}=e.getNodeProperties(this),i=super.generate(e,"property"),a=t.build(e,!0===this.value.is3DTexture?"uvec3":"uvec2"),s=r.build(e,"vec4"),o=n?n.build(e,"int"):null,l=e.generateTextureStore(e,i,a,o,s);e.addLineFlowCode(l,this)}clone(){let e=super.clone();return e.storeNode=this.storeNode,e}constructor(e,t,r=null){super(e,t),this.storeNode=r,this.isStorageTextureNode=!0,this.access=yu.WRITE_ONLY}}).setParameterLength(1,3),CH=vn(e=>{let{texture:t,uv:r}=e,n=vg().toVar();return vs(r.x.lessThan(1e-4),()=>{n.assign(vg(1,0,0))}).ElseIf(r.y.lessThan(1e-4),()=>{n.assign(vg(0,1,0))}).ElseIf(r.z.lessThan(1e-4),()=>{n.assign(vg(0,0,1))}).ElseIf(r.x.greaterThan(.9999),()=>{n.assign(vg(-1,0,0))}).ElseIf(r.y.greaterThan(.9999),()=>{n.assign(vg(0,-1,0))}).ElseIf(r.z.greaterThan(.9999),()=>{n.assign(vg(0,0,-1))}).Else(()=>{let e=t.sample(r.add(vg(-.01,0,0))).r.sub(t.sample(r.add(vg(.01,0,0))).r),i=t.sample(r.add(vg(0,-.01,0))).r.sub(t.sample(r.add(vg(0,.01,0))).r),a=t.sample(r.add(vg(0,0,-.01))).r.sub(t.sample(r.add(vg(0,0,.01))).r);n.assign(vg(e,i,a))}),n.normalize()}),Cj=y8(class extends bP{static get type(){return"Texture3DNode"}getInputType(){return"texture3D"}getDefaultUV(){return vg(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){let r=this.value;return e.isFlipY()&&(!0===r.isRenderTargetTexture||!0===r.isFramebufferTexture)&&(t=this.sampler?t.flipY():t.setY(vc(bR(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return CH({texture:this,uv:e})}constructor(e,t=null,r=null){super(e,t,r),this.isTexture3DNode=!0}}).setParameterLength(1,3);class CW extends S0{static get type(){return"UserDataNode"}updateReference(e){return this.reference=null!==this.userData?this.userData:e.object.userData,this.reference}constructor(e,t,r=null){super(e,t,r),this.userData=r}}let CX=new WeakMap;function CQ(e){let t=CX.get(e);return void 0===t&&(t={},CX.set(e,t)),t}function CY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=CQ(e),n=r[t];return void 0===n&&(r[t]=n=new tp,r[t].copy(e.matrixWorld)),n}let CK=y9(class extends yv{static get type(){return"VelocityNode"}setProjectionMatrix(e){this.projectionMatrix=e}update(e){let{frameId:t,camera:r,object:n}=e,i=CY(n);this.previousModelWorldMatrix.value.copy(i);let a=CQ(r);a.frameId!==t&&(a.frameId=t,void 0===a.previousProjectionMatrix?(a.previousProjectionMatrix=new tp,a.previousCameraViewMatrix=new tp,a.currentProjectionMatrix=new tp,a.currentCameraViewMatrix=new tp,a.previousProjectionMatrix.copy(this.projectionMatrix||r.projectionMatrix),a.previousCameraViewMatrix.copy(r.matrixWorldInverse)):(a.previousProjectionMatrix.copy(a.currentProjectionMatrix),a.previousCameraViewMatrix.copy(a.currentCameraViewMatrix)),a.currentProjectionMatrix.copy(this.projectionMatrix||r.projectionMatrix),a.currentCameraViewMatrix.copy(r.matrixWorldInverse),this.previousProjectionMatrix.value.copy(a.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(a.previousCameraViewMatrix))}updateAfter(e){let{object:t}=e;CY(t).copy(t.matrixWorld)}setup(){let e=null===this.projectionMatrix?b0:xi(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),r=e.mul(Sp).mul(Sv),n=this.previousProjectionMatrix.mul(t).mul(Sx);return xA(r.xy.div(r.w),n.xy.div(n.w))}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=yl.OBJECT,this.updateAfterType=yl.OBJECT,this.previousModelWorldMatrix=xi(new tp),this.previousProjectionMatrix=xi(new tp).setGroup(xt),this.previousCameraViewMatrix=xi(new tp)}}),CZ=vn(e=>{let[t]=e;return C1(t.rgb)}),CJ=vn(e=>{let[t,r=vu(1)]=e;return r.mix(C1(t.rgb),t.rgb)}),C$=vn(e=>{let[t,r=vu(1)]=e,n=xd(t.r,t.g,t.b).div(3),i=t.r.max(t.g.max(t.b)),a=i.sub(n).mul(r).mul(-3);return _C(t.rgb,i,a)}),C0=vn(e=>{let[t,r=vu(1)]=e,n=vg(.57735,.57735,.57735),i=r.cos();return vg(t.rgb.mul(i).add(n.cross(t.rgb).mul(r.sin()).add(n.mul(_x(n,t.rgb).mul(i.oneMinus())))))}),C1=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vg(eD.getLuminanceCoefficients(new ex));return _x(e,t)},C2=vn(e=>{let[t,r=vg(1),n=vg(0),i=vg(1),a=vu(1),s=vg(eD.getLuminanceCoefficients(new ex,$))]=e,o=t.rgb.dot(vg(s)),l=_f(t.rgb.mul(r).add(n),0).toVar(),u=l.pow(i).toVar();return vs(l.r.greaterThan(0),()=>{l.r.assign(u.r)}),vs(l.g.greaterThan(0),()=>{l.g.assign(u.g)}),vs(l.b.greaterThan(0),()=>{l.b.assign(u.b)}),l.assign(o.add(l.sub(o).mul(a))),v_(l.rgb,t.a)}),C3=y8(class extends yv{static get type(){return"PosterizeNode"}setup(){let{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}}).setParameterLength(2),C4=new ey;class C5 extends bP{static get type(){return"PassTextureNode"}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}}class C6 extends C5{static get type(){return"PassMultipleTextureNode"}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){let e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}constructor(e,t,r=!1){super(e,null),this.textureName=t,this.previousTexture=r}}class C7 extends yv{static get type(){return"PassNode"}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return void 0===t&&((t=this.renderTarget.texture.clone()).name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){let t=this._previousTextures[e];if(void 0!==t){let r=this._textures[e],n=this.renderTarget.textures.indexOf(r);this.renderTarget.textures[n]=t,this._textures[e]=t,this._previousTextures[e]=r,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"output",t=this._textureNodes[e];return void 0===t&&((t=y4(new C6(this,e))).updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"output",t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),(t=y4(new C6(this,e,!0))).updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"depth",t=this._viewZNodes[e];if(void 0===t){let r=this._cameraNear,n=this._cameraFar;this._viewZNodes[e]=t=wO(this.getTextureNode(e),r,n)}return t}getLinearDepthNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"depth",t=this._linearDepthNodes[e];if(void 0===t){let r=this._cameraNear,n=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=wF(i,r,n)}return t}async compileAsync(e){let t=e.getRenderTarget(),r=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(r)}setup(e){let{renderer:t}=e;return this.renderTarget.samples=void 0===this.options.samples?t.samples:this.options.samples,this.renderTarget.texture.type=t.getColorBufferType(),this.scope===C7.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){let t,r,{renderer:n}=e,{scene:i}=this,a=n.getOutputRenderTarget();a&&!0===a.isXRRenderTarget?(r=1,t=n.xr.getCamera(),n.xr.updateCamera(t),C4.set(a.width,a.height)):(t=this.camera,r=n.getPixelRatio(),n.getSize(C4)),this._pixelRatio=r,this.setSize(C4.width,C4.height);let s=n.getRenderTarget(),o=n.getMRT(),l=t.layers.mask;for(let e in this._cameraNear.value=t.near,this._cameraFar.value=t.far,null!==this._layers&&(t.layers.mask=this._layers.mask),this._previousTextures)this.toggleTexture(e);n.setRenderTarget(this.renderTarget),n.setMRT(this._mrt),n.render(i,t),n.setRenderTarget(s),n.setMRT(o),t.layers.mask=l}setSize(e,t){this._width=e,this._height=t;let r=this._width*this._pixelRatio*this._resolution,n=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(r,n),null!==this._scissor&&this.renderTarget.scissor.copy(this._scissor),null!==this._viewport&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,r,n){null===e?this._scissor=null:(null===this._scissor&&(this._scissor=new eH),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,r,n),this._scissor.multiplyScalar(this._pixelRatio*this._resolution).floor())}setViewport(e,t,r,n){null===e?this._viewport=null:(null===this._viewport&&(this._viewport=new eH),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,r,n),this._viewport.multiplyScalar(this._pixelRatio*this._resolution).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}constructor(e,t,r,n={}){super("vec4"),this.scope=e,this.scene=t,this.camera=r,this.options=n,this._pixelRatio=1,this._width=1,this._height=1;let i=new iD;i.isRenderTargetTexture=!0,i.name="depth";let a=new ej(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:1016,...n});a.texture.name="output",a.depthTexture=i,this.renderTarget=a,this._textures={output:a.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=xi(0),this._cameraFar=xi(0),this._mrt=null,this._layers=null,this._resolution=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=yl.FRAME,this.global=!0}}C7.COLOR="color",C7.DEPTH="depth";class C8 extends C7{static get type(){return"ToonOutlinePassNode"}updateBefore(e){let{renderer:t}=e,r=t.getRenderObjectFunction();t.setRenderObjectFunction((e,r,n,i,a,s,o,l)=>{if((a.isMeshToonMaterial||a.isMeshToonNodeMaterial)&&!1===a.wireframe){let u=this._getOutlineMaterial(a);t.renderObject(e,r,n,i,u,s,o,l)}t.renderObject(e,r,n,i,a,s,o,l)}),super.updateBefore(e),t.setRenderObjectFunction(r)}_createMaterial(){let e=new w3;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=1;let t=SC.negate(),r=b0.mul(Sp),n=vu(1),i=r.mul(v_(Sv,1)),a=r.mul(v_(Sv.add(t),1)),s=x1(i.sub(a));return e.vertexNode=i.add(s.mul(this.thicknessNode).mul(i.w).mul(n)),e.colorNode=v_(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return void 0===t&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}constructor(e,t,r,n,i){super(C7.COLOR,e,t),this.colorNode=r,this.thicknessNode=n,this.alphaNode=i,this._materialCache=new WeakMap}}let C9=vn(e=>{let[t,r]=e;return t.mul(r).clamp()}).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Ne=vn(e=>{let[t,r]=e;return(t=t.mul(r)).div(t.add(1)).clamp()}).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Nt=vn(e=>{let[t,r]=e,n=(t=(t=t.mul(r)).sub(.004).max(0)).mul(t.mul(6.2).add(.5)),i=t.mul(t.mul(6.2).add(1.7)).add(.06);return n.div(i).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Nr=vn(e=>{let[t]=e,r=t.mul(t.add(.0245786)).sub(90537e-9),n=t.mul(t.add(.432951).mul(.983729)).add(.238081);return r.div(n)}),Nn=vn(e=>{let[t,r]=e,n=vM(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),i=vM(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return t=t.mul(r).div(.6),t=Nr(t=n.mul(t)),(t=i.mul(t)).clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Ni=vM(vg(1.6605,-.1246,-.0182),vg(-.5876,1.1329,-.1006),vg(-.0728,-.0083,1.1187)),Na=vM(vg(.6274,.0691,.0164),vg(.3293,.9195,.088),vg(.0433,.0113,.8956)),Ns=vn(e=>{let[t]=e,r=vg(t).toVar(),n=vg(r.mul(r)).toVar(),i=vg(n.mul(n)).toVar();return vu(15.5).mul(i.mul(n)).sub(xp(40.14,i.mul(r))).add(xp(31.96,i).sub(xp(6.868,n.mul(r))).add(xp(.4298,n).add(xp(.1191,r).sub(.00232))))}),No=vn(e=>{let[t,r]=e,n=vg(t).toVar(),i=vM(vg(.856627153315983,.137318972929847,.11189821299995),vg(.0951212405381588,.761241990602591,.0767994186031903),vg(.0482516061458583,.101439036467562,.811302368396859)),a=vM(vg(1.1271005818144368,-.1413297634984383,-.14132976349843826),vg(-.11060664309660323,1.157823702216272,-.11060664309660294),vg(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=vu(-12.47393),o=vu(4.026069);return n.mulAssign(r),n.assign(Na.mul(n)),n.assign(i.mul(n)),n.assign(_f(n,1e-10)),n.assign(xK(n)),n.assign(n.sub(s).div(o.sub(s))),n.assign(_N(n,0,1)),n.assign(Ns(n)),n.assign(a.mul(n)),n.assign(_b(_f(vg(0),n),vg(2.2))),n.assign(Ni.mul(n)),n.assign(_N(n,0,1)),n}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Nl=vn(e=>{let[t,r]=e,n=vu(.76),i=vu(.15),a=_p((t=t.mul(r)).r,_p(t.g,t.b)),s=_z(a.lessThan(.08),a.sub(xp(6.25,a.mul(a))),.04);t.subAssign(s);let o=_f(t.r,_f(t.g,t.b));vs(o.lessThan(n),()=>t);let l=xA(1,n),u=xA(1,l.mul(l).div(o.add(l.sub(n))));t.mulAssign(u.div(o));let c=xA(1,xf(1,i.mul(o.sub(u)).add(1)));return _C(t,vg(u),c)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Nu extends ym{static get type(){return"CodeNode"}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){for(let t of this.getIncludes(e))t.build(e);let t=e.getCodeFromNode(this,this.getNodeType(e));return t.code=this.code,t.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}constructor(e="",t=[],r=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=r}}let Nc=y8(Nu).setParameterLength(1,3);class Nh extends Nu{static get type(){return"FunctionNode"}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){let r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){let t=e.getDataFromNode(this),r=t.nodeFunction;return void 0===r&&(t.nodeFunction=r=e.parser.parseFunction(this.code)),r}generate(e,t){super.generate(e);let r=this.getNodeFunction(e),n=r.name,i=r.type,a=e.getCodeFromNode(this,i);""!==n&&(a.name=n);let s=e.getPropertyName(a);return(a.code=this.getNodeFunction(e).getCode(s)+"\n","property"===t)?s:e.format("".concat(s,"()"),i,t)}constructor(e="",t=[],r=""){super(e,t,r)}}let Nd=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";for(let e=0;e<t.length;e++){let r=t[e];"function"==typeof r&&(t[e]=r.functionNode)}let n=y4(new Nh(e,t,r)),i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.call(...t)};return i.functionNode=n,i},NA=y8(class extends ym{static get type(){return"ScriptableValueNode"}get isScriptableOutputNode(){return null!==this.outputType}set value(e){this._value!==e&&(this._cache&&"URL"===this.inputType&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){let e=this.value;if(e&&null===this._cache&&"URL"===this.inputType&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&null!==e.value&&void 0!==e.value&&(("URL"===this.inputType||"String"===this.inputType)&&"string"==typeof e.value||"Number"===this.inputType&&"number"==typeof e.value||"Vector2"===this.inputType&&e.value.isVector2||"Vector3"===this.inputType&&e.value.isVector3||"Vector4"===this.inputType&&e.value.isVector4||"Color"===this.inputType&&e.value.isColor||"Matrix3"===this.inputType&&e.value.isMatrix3||"Matrix4"===this.inputType&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:vu()}serialize(e){super.serialize(e),null!==this.value?"ArrayBuffer"===this.inputType?e.value=ya(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;null!==e.value&&(t="ArrayBuffer"===e.inputType?ys(e.value):"Texture"===e.inputType?e.meta.textures[e.value]:e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new es,this.isScriptableValueNode=!0}}).setParameterLength(1);class Np extends Map{get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(this.has(e))return super.get(e);if(null!==t){let r=t(...n);return this.set(e,r),r}}}class Nf{get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){let t=this.parameters[e];return t?t.getValue():null}constructor(e){this.scriptableNode=e}}let Nm=new Np,Ng=y8(class extends ym{static get type(){return"ScriptableNode"}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(let t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(let t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){let r=this._outputs;return void 0===r[e]?r[e]=NA(t):r[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){let r=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),r[e]=t,r[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),r[e]=t,r[e].events.addEventListener("refresh",this.onRefresh)):void 0===r[e]?(r[e]=NA(t),r[e].events.addEventListener("refresh",this.onRefresh)):r[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(let e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let i=this.getObject()[e];if("function"==typeof i)return i(...r)}async callAsync(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let i=this.getObject()[e];if("function"==typeof i)return"AsyncFunction"===i.constructor.name?await i(...r):i(...r)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),null!==this._object)return this._object;let e=()=>this.refresh(),t=(e,t)=>this.setOutput(e,t),r=new Nf(this),n=Nm.get("THREE"),i=Nm.get("TSL"),a=this.getMethod(),s=[r,this._local,Nm,e,t,n,i];this._object=a(...s);let o=this._object.layout;if(o&&(!1===o.cache&&this._local.clear(),this._output.outputType=o.outputType||null,Array.isArray(o.elements)))for(let e of o.elements){let t=e.id||e.name;e.inputType&&(void 0===this.getParameter(t)&&this.setParameter(t,null),this.getParameter(t).inputType=e.inputType),e.outputType&&(void 0===this.getOutput(t)&&this.setOutput(t,null),this.getOutput(t).outputType=e.outputType)}return this._object}deserialize(e){for(let t in super.deserialize(e),this.parameters){let e=this.parameters[t];e.isScriptableNode&&(e=e.getDefaultOutput()),e.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){let e=this.getDefaultOutput().value;return e&&e.isNode?e:vu()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),null!==this._method)return this._method;let e="layout, init, main, dispose",t="var "+e+"; var output = {};\n"+this.codeNode.code+"\nreturn { ...output, "+e+" };";return this._method=Function("parameters","local","global","refresh","setOutput","THREE","TSL",t),this._method}dispose(){null!==this._method&&(this._object&&"function"==typeof this._object.dispose&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){let t=[g3(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(let r in this.parameters)t.push(this.parameters[r].getCacheKey(e));return g4(t)}set needsUpdate(e){!0===e&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return null===this.codeNode||(!0===this._needsOutputUpdate&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value),this}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new Np,this._output=NA(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}}).setParameterLength(1,2);function Ny(e){let t,r=e.context.getViewZ;return void 0!==r&&(t=r(this)),(t||SS.z).negate()}let Nv=vn((e,t)=>{let[r,n]=e;return _L(r,n,Ny(t))}),Nx=vn((e,t)=>{let[r]=e,n=Ny(t);return r.mul(r,n,n).negate().exp().oneMinus()}),N_=vn(e=>{let[t,r]=e;return v_(r.toFloat().mix(vZ.rgb,t.toVec3()),vZ.a)}),Nb=null,NS=null,NT=y8(class extends ym{static get type(){return"RangeNode"}getVectorLength(e){let t=e.getTypeLength(yr(this.minNode.value)),r=e.getTypeLength(yr(this.maxNode.value));return t>r?t:r}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){let t=e.object,r=null;if(t.count>1){let n=this.minNode.value,i=this.maxNode.value,a=e.getTypeLength(yr(n)),s=e.getTypeLength(yr(i));Nb=Nb||new eH,NS=NS||new eH,Nb.setScalar(0),NS.setScalar(0),1===a?Nb.setScalar(n):n.isColor?Nb.set(n.r,n.g,n.b,1):Nb.set(n.x,n.y,n.z||0,n.w||0),1===s?NS.setScalar(i):i.isColor?NS.set(i.r,i.g,i.b,1):NS.set(i.x,i.y,i.z||0,i.w||0);let o=4*t.count,l=new Float32Array(o);for(let e=0;e<o;e++){let t=e%4,r=Nb.getComponent(t),n=NS.getComponent(t);l[e]=eg.lerp(r,n,Math.random())}let u=this.getNodeType(e);if(t.count<=4096)r=bF(l,"vec4",t.count).element(wn).convert(u);else{let t=new nP(l,4);e.geometry.setAttribute("__range"+this.id,t),r=bo(t).convert(u)}}else r=vu(0);return r}constructor(e=vu(),t=vu()){super(),this.minNode=e,this.maxNode=t}}).setParameterLength(2);class Nw extends ym{static get type(){return"ComputeBuiltinNode"}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){let r=this.getBuiltinName(e),n=this.getNodeType(e);return"compute"===e.shaderStage?e.format(r,n,t):(console.warn("ComputeBuiltinNode: Compute built-in value ".concat(r," can not be accessed in the ").concat(e.shaderStage," stage")),e.generateConst(n))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}constructor(e,t){super(t),this._builtinName=e}}let NM=(e,t)=>y4(new Nw(e,t)),NE=NM("numWorkgroups","uvec3"),NR=NM("workgroupId","uvec3"),NC=NM("globalId","uvec3"),NN=NM("localId","uvec3"),NP=NM("subgroupSize","uint"),NI=y8(class extends ym{generate(e){let{scope:t}=this,{renderer:r}=e;!0===r.backend.isWebGLBackend?e.addFlowCode("	// ".concat(t,"Barrier \n")):e.addLineFlowCode("".concat(t,"Barrier()"),this)}constructor(e){super(),this.scope=e}});class NL extends yg{generate(e,t){let r,n=e.context.assign;if(r=super.generate(e),!0!==n){let n=this.getNodeType(e);r=e.format(r,n,t)}return r}constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}}class ND extends ym{setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return"".concat(this.scope,"Array")}element(e){return y4(new NL(this,e))}generate(e){let t=""!==this.name?this.name:"".concat(this.scope,"Array_").concat(this.id);return e.getScopedArray(t,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}constructor(e,t,r=0){super(t),this.bufferType=t,this.bufferCount=r,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e,this.name=""}}class NB extends ym{static get type(){return"AtomicFunctionNode"}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){let t=e.getNodeProperties(this),r=t.parents,n=this.method,i=this.getNodeType(e),a=this.getInputType(e),s=this.pointerNode,o=this.valueNode,l=[];l.push("&".concat(s.build(e,a))),null!==o&&l.push(o.build(e,a));let u="".concat(e.getMethod(n,i),"( ").concat(l.join(", ")," )");if(!(r&&1===r.length&&!0===r[0].isStackNode))return void 0===t.constNode&&(t.constNode=bv(u,i).toConst()),t.constNode.build(e);e.addLineFlowCode(u,this)}constructor(e,t,r){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=r,this.parents=!0}}NB.ATOMIC_LOAD="atomicLoad",NB.ATOMIC_STORE="atomicStore",NB.ATOMIC_ADD="atomicAdd",NB.ATOMIC_SUB="atomicSub",NB.ATOMIC_MAX="atomicMax",NB.ATOMIC_MIN="atomicMin",NB.ATOMIC_AND="atomicAnd",NB.ATOMIC_OR="atomicOr",NB.ATOMIC_XOR="atomicXor";let NF=y8(NB),NU=(e,t,r)=>NF(e,t,r).toStack();class NO extends yv{static get type(){return"SubgroupFunctionNode"}getInputType(e){let t=this.aNode?this.aNode.getNodeType(e):null,r=this.bNode?this.bNode.getNodeType(e):null;return(e.isMatrix(t)?0:e.getTypeLength(t))>(e.isMatrix(r)?0:e.getTypeLength(r))?t:r}getNodeType(e){let t=this.method;return t===NO.SUBGROUP_ELECT?"bool":t===NO.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){let r=this.method,n=this.getNodeType(e),i=this.getInputType(e),a=this.aNode,s=this.bNode,o=[];if(r===NO.SUBGROUP_BROADCAST||r===NO.SUBGROUP_SHUFFLE||r===NO.QUAD_BROADCAST){let t=s.getNodeType(e);o.push(a.build(e,n),s.build(e,"float"===t?"int":n))}else r===NO.SUBGROUP_SHUFFLE_XOR||r===NO.SUBGROUP_SHUFFLE_DOWN||r===NO.SUBGROUP_SHUFFLE_UP?o.push(a.build(e,n),s.build(e,"uint")):(null!==a&&o.push(a.build(e,i)),null!==s&&o.push(s.build(e,i)));let l=0===o.length?"()":"( ".concat(o.join(", ")," )");return e.format("".concat(e.getMethod(r,n)).concat(l),n,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}constructor(e,t=null,r=null){super(),this.method=e,this.aNode=t,this.bNode=r}}NO.SUBGROUP_ELECT="subgroupElect",NO.SUBGROUP_BALLOT="subgroupBallot",NO.SUBGROUP_ADD="subgroupAdd",NO.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd",NO.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd",NO.SUBGROUP_MUL="subgroupMul",NO.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul",NO.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul",NO.SUBGROUP_AND="subgroupAnd",NO.SUBGROUP_OR="subgroupOr",NO.SUBGROUP_XOR="subgroupXor",NO.SUBGROUP_MIN="subgroupMin",NO.SUBGROUP_MAX="subgroupMax",NO.SUBGROUP_ALL="subgroupAll",NO.SUBGROUP_ANY="subgroupAny",NO.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst",NO.QUAD_SWAP_X="quadSwapX",NO.QUAD_SWAP_Y="quadSwapY",NO.QUAD_SWAP_DIAGONAL="quadSwapDiagonal",NO.SUBGROUP_BROADCAST="subgroupBroadcast",NO.SUBGROUP_SHUFFLE="subgroupShuffle",NO.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor",NO.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp",NO.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown",NO.QUAD_BROADCAST="quadBroadcast";let Nk=ve(NO,NO.SUBGROUP_ELECT).setParameterLength(0),Nz=ve(NO,NO.SUBGROUP_BALLOT).setParameterLength(1),NV=ve(NO,NO.SUBGROUP_ADD).setParameterLength(1),Nq=ve(NO,NO.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),NG=ve(NO,NO.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),NH=ve(NO,NO.SUBGROUP_MUL).setParameterLength(1),Nj=ve(NO,NO.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),NW=ve(NO,NO.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),NX=ve(NO,NO.SUBGROUP_AND).setParameterLength(1),NQ=ve(NO,NO.SUBGROUP_OR).setParameterLength(1),NY=ve(NO,NO.SUBGROUP_XOR).setParameterLength(1),NK=ve(NO,NO.SUBGROUP_MIN).setParameterLength(1),NZ=ve(NO,NO.SUBGROUP_MAX).setParameterLength(1),NJ=ve(NO,NO.SUBGROUP_ALL).setParameterLength(0),N$=ve(NO,NO.SUBGROUP_ANY).setParameterLength(0),N0=ve(NO,NO.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),N1=ve(NO,NO.QUAD_SWAP_X).setParameterLength(1),N2=ve(NO,NO.QUAD_SWAP_Y).setParameterLength(1),N3=ve(NO,NO.QUAD_SWAP_DIAGONAL).setParameterLength(1),N4=ve(NO,NO.SUBGROUP_BROADCAST).setParameterLength(2),N5=ve(NO,NO.SUBGROUP_SHUFFLE).setParameterLength(2),N6=ve(NO,NO.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),N7=ve(NO,NO.SUBGROUP_SHUFFLE_UP).setParameterLength(2),N8=ve(NO,NO.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),N9=ve(NO,NO.QUAD_BROADCAST).setParameterLength(1);function Pe(e){let t=(l=l||new WeakMap).get(e);return void 0===t&&l.set(e,t={}),t}function Pt(e){let t=Pe(e);return t.shadowMatrix||(t.shadowMatrix=xi("mat4").setGroup(xt).onRenderUpdate(t=>((!0!==e.castShadow||!1===t.renderer.shadowMap.enabled)&&e.shadow.updateMatrices(e),e.shadow.matrix)))}function Pr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S_,r=Pt(e).mul(t);return r.xyz.div(r.w)}function Pn(e){let t=Pe(e);return t.position||(t.position=xi(new ex).setGroup(xt).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(e.matrixWorld)))}function Pi(e){let t=Pe(e);return t.targetPosition||(t.targetPosition=xi(new ex).setGroup(xt).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(e.target.matrixWorld)))}function Pa(e){let t=Pe(e);return t.viewPosition||(t.viewPosition=xi(new ex).setGroup(xt).onRenderUpdate((t,r)=>{let{camera:n}=t;r.value=r.value||new ex,r.value.setFromMatrixPosition(e.matrixWorld),r.value.applyMatrix4(n.matrixWorldInverse)}))}let Ps=e=>b2.transformDirection(Pn(e).sub(Pi(e))),Po=(e,t)=>{for(let r of t)if(r.isAnalyticLightNode&&r.light.id===e)return r;return null},Pl=new WeakMap,Pu=[];class Pc extends ym{static get type(){return"LightsNode"}customCacheKey(){let e=this._lights;for(let t=0;t<e.length;t++){let r=e[t];if(Pu.push(r.id),Pu.push(+!!r.castShadow),!0===r.isSpotLight){let e=null!==r.map?r.map.id:-1,t=r.colorNode?r.colorNode.getCacheKey():-1;Pu.push(e,t)}}let t=g4(Pu);return Pu.length=0,t}getHash(e){if(null===this._lightNodesHash){null===this._lightNodes&&this.setupLightsNode(e);let t=[];for(let e of this._lightNodes)t.push(e.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){let t=e.getNodeProperties(this);for(let r of t.nodes)r.build(e);t.outputNode.build(e)}setupLightsNode(e){let t=[],r=this._lightNodes,n=this._lights.sort((e,t)=>e.id-t.id),i=e.renderer.library;for(let e of n)if(e.isNode)t.push(y4(e));else{let n=null;if(null!==r&&(n=Po(e.id,r)),null===n){let r=i.getLightNodeClass(e.constructor);if(null===r){console.warn("LightsNode.setupNodeLights: Light node not found for ".concat(e.constructor.name));continue}let n=null;Pl.has(e)?n=Pl.get(e):(n=y4(new r(e)),Pl.set(e,n)),t.push(n)}}this._lightNodes=t}setupDirectLight(e,t,r){let{lightingModel:n,reflectedLight:i}=e.context;n.direct({...r,lightNode:t,reflectedLight:i},e)}setupDirectRectAreaLight(e,t,r){let{lightingModel:n,reflectedLight:i}=e.context;n.directRectArea({...r,lightNode:t,reflectedLight:i},e)}setupLights(e,t){for(let r of t)r.build(e)}getLightNodes(e){return null===this._lightNodes&&this.setupLightsNode(e),this._lightNodes}setup(e){let t=e.lightsNode;e.lightsNode=this;let r=this.outgoingLightNode,n=e.context,i=n.lightingModel,a=e.getNodeProperties(this);if(i){let{totalDiffuseNode:t,totalSpecularNode:s}=this;n.outgoingLight=r,a.nodes=e.addStack().nodes,i.start(e);let{backdrop:o,backdropAlpha:l}=n,{directDiffuse:u,directSpecular:c,indirectDiffuse:h,indirectSpecular:d}=n.reflectedLight,A=u.add(h);null!==o&&(A=null!==l?vg(l.mix(A,o)):vg(o),n.material.transparent=!0),t.assign(A),s.assign(c.add(d)),r.assign(t.add(s)),i.finish(e),r=r.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}constructor(){super("vec3"),this.totalDiffuseNode=vP("vec3","totalDiffuse"),this.totalSpecularNode=vP("vec3","totalSpecular"),this.outgoingLightNode=vP("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}}class Ph extends ym{static get type(){return"ShadowBaseNode"}setupShadowPosition(e){let{context:t,material:r}=e;Pd.assign(r.receivedShadowPositionNode||t.shadowPositionWorld||S_)}constructor(e){super(),this.light=e,this.updateBeforeType=yl.RENDER,this.isShadowBaseNode=!0}}let Pd=vP("vec3","shadowPositionWorld"),PA=new WeakMap,Pp=vn(e=>{let{depthTexture:t,shadowCoord:r,depthLayer:n}=e,i=bL(t,r.xy).setName("t_basic");return t.isArrayTexture&&(i=i.depth(n)),i.compare(r.z)}),Pf=vn(e=>{let{depthTexture:t,shadowCoord:r,shadow:n,depthLayer:i}=e,a=(e,r)=>{let n=bL(t,e);return t.isArrayTexture&&(n=n.depth(i)),n.compare(r)},s=S1("mapSize","vec2",n).setGroup(xt),o=S1("radius","float",n).setGroup(xt),l=vA(1).div(s),u=l.x.negate().mul(o),c=l.y.negate().mul(o),h=l.x.mul(o),d=l.y.mul(o),A=u.div(2),p=c.div(2),f=h.div(2),m=d.div(2);return xd(a(r.xy.add(vA(u,c)),r.z),a(r.xy.add(vA(0,c)),r.z),a(r.xy.add(vA(h,c)),r.z),a(r.xy.add(vA(A,p)),r.z),a(r.xy.add(vA(0,p)),r.z),a(r.xy.add(vA(f,p)),r.z),a(r.xy.add(vA(u,0)),r.z),a(r.xy.add(vA(A,0)),r.z),a(r.xy,r.z),a(r.xy.add(vA(f,0)),r.z),a(r.xy.add(vA(h,0)),r.z),a(r.xy.add(vA(A,m)),r.z),a(r.xy.add(vA(0,m)),r.z),a(r.xy.add(vA(f,m)),r.z),a(r.xy.add(vA(u,d)),r.z),a(r.xy.add(vA(0,d)),r.z),a(r.xy.add(vA(h,d)),r.z)).mul(1/17)}),Pm=vn(e=>{let{depthTexture:t,shadowCoord:r,shadow:n,depthLayer:i}=e,a=(e,r)=>{let n=bL(t,e);return t.isArrayTexture&&(n=n.depth(i)),n.compare(r)},s=S1("mapSize","vec2",n).setGroup(xt),o=vA(1).div(s),l=o.x,u=o.y,c=r.xy,h=x2(c.mul(s).add(.5));return c.subAssign(h.mul(o)),xd(a(c,r.z),a(c.add(vA(l,0)),r.z),a(c.add(vA(0,u)),r.z),a(c.add(o),r.z),_C(a(c.add(vA(l.negate(),0)),r.z),a(c.add(vA(l.mul(2),0)),r.z),h.x),_C(a(c.add(vA(l.negate(),u)),r.z),a(c.add(vA(l.mul(2),u)),r.z),h.x),_C(a(c.add(vA(0,u.negate())),r.z),a(c.add(vA(0,u.mul(2))),r.z),h.y),_C(a(c.add(vA(l,u.negate())),r.z),a(c.add(vA(l,u.mul(2))),r.z),h.y),_C(_C(a(c.add(vA(l.negate(),u.negate())),r.z),a(c.add(vA(l.mul(2),u.negate())),r.z),h.x),_C(a(c.add(vA(l.negate(),u.mul(2))),r.z),a(c.add(vA(l.mul(2),u.mul(2))),r.z),h.x),h.y)).mul(1/9)}),Pg=vn(e=>{let{depthTexture:t,shadowCoord:r,depthLayer:n}=e,i=vu(1).toVar(),a=bL(t).sample(r.xy);t.isArrayTexture&&(a=a.depth(n)),a=a.rg;let s=_m(r.z,a.x);return vs(s.notEqual(vu(1)),()=>{let e=r.z.sub(a.x),t=_f(0,a.y.mul(a.y)),n=t.div(t.add(e.mul(e)));n=_N(xA(n,.3).div(.95-.3)),i.assign(_N(_f(s,n)))}),i}),Py=vn(e=>{let[t,r,n]=e,i=S_.sub(t).length();return(i=i.sub(r).div(n.sub(r))).saturate()}),Pv=e=>{let t=PA.get(e);if(void 0===t){let r=e.isPointLight?(e=>{let t=e.shadow.camera,r=S1("near","float",t).setGroup(xt),n=S1("far","float",t).setGroup(xt);return Py(St(e),r,n)})(e):null;(t=new w3).colorNode=v_(0,0,0,1),t.depthNode=r,t.isShadowPassMaterial=!0,t.name="ShadowMaterial",t.fog=!1,PA.set(e,t)}return t},Px=new Ru,P_=[],Pb=(e,t,r,n)=>{P_[0]=e,P_[1]=t;let i=Px.get(P_);return(void 0===i||i.shadowType!==r||i.useVelocity!==n)&&((i=function(i,a,s,o,l,u){for(var c=arguments.length,h=Array(c>6?c-6:0),d=6;d<c;d++)h[d-6]=arguments[d];(!0===i.castShadow||i.receiveShadow&&3===r)&&(n&&(yi(i).useVelocity=!0),i.onBeforeShadow(e,i,s,t.camera,o,a.overrideMaterial,u),e.renderObject(i,a,s,o,l,u,...h),i.onAfterShadow(e,i,s,t.camera,o,a.overrideMaterial,u))}).shadowType=r,i.useVelocity=n,Px.set(P_,i)),P_[0]=null,P_[1]=null,i},PS=vn(e=>{let{samples:t,radius:r,size:n,shadowPass:i,depthLayer:a}=e,s=vu(0).toVar("meanVertical"),o=vu(0).toVar("squareMeanVertical"),l=t.lessThanEqual(vu(1)).select(vu(0),vu(2).div(t.sub(1))),u=t.lessThanEqual(vu(1)).select(vu(0),vu(-1));wv({start:vc(0),end:vc(t),type:"int",condition:"<"},e=>{let{i:t}=e,c=u.add(vu(t).mul(l)),h=i.sample(xd(bj.xy,vA(0,c).mul(r)).div(n));i.value.isArrayTexture&&(h=h.depth(a)),h=h.x,s.addAssign(h),o.addAssign(h.mul(h))}),s.divAssign(t),o.divAssign(t);let c=xZ(o.sub(s.mul(s)));return vA(s,c)}),PT=vn(e=>{let{samples:t,radius:r,size:n,shadowPass:i,depthLayer:a}=e,s=vu(0).toVar("meanHorizontal"),o=vu(0).toVar("squareMeanHorizontal"),l=t.lessThanEqual(vu(1)).select(vu(0),vu(2).div(t.sub(1))),u=t.lessThanEqual(vu(1)).select(vu(0),vu(-1));wv({start:vc(0),end:vc(t),type:"int",condition:"<"},e=>{let{i:t}=e,c=u.add(vu(t).mul(l)),h=i.sample(xd(bj.xy,vA(c,0).mul(r)).div(n));i.value.isArrayTexture&&(h=h.depth(a)),s.addAssign(h.x),o.addAssign(xd(h.y.mul(h.y),h.x.mul(h.x)))}),s.divAssign(t),o.divAssign(t);let c=xZ(o.sub(s.mul(s)));return vA(s,c)}),Pw=[Pp,Pf,Pm,Pg],PM=new CT;class PE extends Ph{static get type(){return"ShadowNode"}setupShadowFilter(e,t){let{filterFn:r,depthTexture:n,shadowCoord:i,shadow:a,depthLayer:s}=t,o=i.x.greaterThanEqual(0).and(i.x.lessThanEqual(1)).and(i.y.greaterThanEqual(0)).and(i.y.lessThanEqual(1)).and(i.z.lessThanEqual(1)),l=r({depthTexture:n,shadowCoord:i,shadow:a,depthLayer:s});return o.select(l,vu(1))}setupShadowCoord(e,t){let r,{shadow:n}=this,{renderer:i}=e,a=S1("bias","float",n).setGroup(xt),s=t;if(n.camera.isOrthographicCamera||!0!==i.logarithmicDepthBuffer)r=(s=s.xyz.div(s.w)).z,2001===i.coordinateSystem&&(r=r.mul(2).sub(1));else{let e=s.w;s=s.xy.div(e);let t=S1("near","float",n.camera).setGroup(xt),i=S1("far","float",n.camera).setGroup(xt);r=wk(e.negate(),t,i)}return vg(s.x,s.y.oneMinus(),r.add(a))}getShadowFilterFn(e){return Pw[e]}setupRenderTarget(e,t){let r=new iD(e.mapSize.width,e.mapSize.height);r.name="ShadowDepthTexture",r.compareFunction=513;let n=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return n.texture.name="ShadowMap",n.texture.type=e.mapType,n.depthTexture=r,{shadowMap:n,depthTexture:r}}setupShadow(e){let{renderer:t}=e,{light:r,shadow:n}=this,i=t.shadowMap.type,{depthTexture:a,shadowMap:s}=this.setupRenderTarget(n,e);if(n.camera.updateProjectionMatrix(),3===i&&!0!==n.isPointLightShadow){a.compareFunction=null,s.depth>1?(s._vsmShadowMapVertical||(s._vsmShadowMapVertical=e.createRenderTarget(n.mapSize.width,n.mapSize.height,{format:1030,type:1016,depth:s.depth,depthBuffer:!1}),s._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=s._vsmShadowMapVertical,s._vsmShadowMapHorizontal||(s._vsmShadowMapHorizontal=e.createRenderTarget(n.mapSize.width,n.mapSize.height,{format:1030,type:1016,depth:s.depth,depthBuffer:!1}),s._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=s._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(n.mapSize.width,n.mapSize.height,{format:1030,type:1016,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(n.mapSize.width,n.mapSize.height,{format:1030,type:1016,depthBuffer:!1}));let t=bL(a);a.isArrayTexture&&(t=t.depth(this.depthLayer));let r=bL(this.vsmShadowMapVertical.texture);a.isArrayTexture&&(r=r.depth(this.depthLayer));let i=S1("blurSamples","float",n).setGroup(xt),o=S1("radius","float",n).setGroup(xt),l=S1("mapSize","vec2",n).setGroup(xt),u=this.vsmMaterialVertical||(this.vsmMaterialVertical=new w3);u.fragmentNode=PS({samples:i,radius:o,size:l,shadowPass:t,depthLayer:this.depthLayer}).context(e.getSharedContext()),u.name="VSMVertical",(u=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new w3)).fragmentNode=PT({samples:i,radius:o,size:l,shadowPass:r,depthLayer:this.depthLayer}).context(e.getSharedContext()),u.name="VSMHorizontal"}let o=S1("intensity","float",n).setGroup(xt),l=S1("normalBias","float",n).setGroup(xt),u=Pt(r).mul(Pd.add(SD.mul(l))),c=this.setupShadowCoord(e,u),h=n.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(null===h)throw Error("THREE.WebGPURenderer: Shadow map type not supported yet.");let d=3===i&&!0!==n.isPointLightShadow?this.vsmShadowMapHorizontal.texture:a,A=this.setupShadowFilter(e,{filterFn:h,shadowTexture:s.texture,depthTexture:d,shadowCoord:c,shadow:n,depthLayer:this.depthLayer}),p=bL(s.texture,c);a.isArrayTexture&&(p=p.depth(this.depthLayer));let f=_C(1,A.rgb.mix(p,1),o.mul(p.a)).toVar();return this.shadowMap=s,this.shadow.map=s,f}setup(e){if(!1!==e.renderer.shadowMap.enabled)return vn(()=>{let t=this._node;return this.setupShadowPosition(e),null===t&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){let{shadow:t,shadowMap:r,light:n}=this,{renderer:i,scene:a}=e;t.updateMatrices(n),r.setSize(t.mapSize.width,t.mapSize.height,r.depth),i.render(a,t.camera)}updateShadow(e){var t,r,n;let{shadowMap:i,light:a,shadow:s}=this,{renderer:o,scene:l,camera:c}=e,h=o.shadowMap.type,d=i.depthTexture.version;this._depthVersionCached=d;let A=s.camera.layers.mask;(0xfffffffe&s.camera.layers.mask)==0&&(s.camera.layers.mask=c.layers.mask);let p=o.getRenderObjectFunction(),f=o.getMRT(),m=!!f&&f.has("velocity");t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.toneMapping=e.toneMapping,t.toneMappingExposure=e.toneMappingExposure,t.outputColorSpace=e.outputColorSpace,t.renderTarget=e.getRenderTarget(),t.activeCubeFace=e.getActiveCubeFace(),t.activeMipmapLevel=e.getActiveMipmapLevel(),t.renderObjectFunction=e.getRenderObjectFunction(),t.pixelRatio=e.getPixelRatio(),t.mrt=e.getMRT(),t.clearColor=e.getClearColor(t.clearColor||new t6),t.clearAlpha=e.getClearAlpha(),t.autoClear=e.autoClear,t.scissorTest=e.getScissorTest(),t}(o,t=u),o.setMRT(null),o.setRenderObjectFunction(null),o.setClearColor(0,1),o.autoClear=!0,r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.background=e.background,t.backgroundNode=e.backgroundNode,t.overrideMaterial=e.overrideMaterial,t}(l,r=t),l.background=null,l.backgroundNode=null,l.overrideMaterial=null,u=r,l.overrideMaterial=Pv(a),o.setRenderObjectFunction(Pb(o,s,h,m)),o.setClearColor(0,0),o.setRenderTarget(i),this.renderShadow(e),o.setRenderObjectFunction(p),3===h&&!0!==s.isPointLightShadow&&this.vsmPass(o),s.camera.layers.mask=A,o.toneMapping=(n=u).toneMapping,o.toneMappingExposure=n.toneMappingExposure,o.outputColorSpace=n.outputColorSpace,o.setRenderTarget(n.renderTarget,n.activeCubeFace,n.activeMipmapLevel),o.setRenderObjectFunction(n.renderObjectFunction),o.setPixelRatio(n.pixelRatio),o.setMRT(n.mrt),o.setClearColor(n.clearColor,n.clearAlpha),o.autoClear=n.autoClear,o.setScissorTest(n.scissorTest),l.background=n.background,l.backgroundNode=n.backgroundNode,l.overrideMaterial=n.overrideMaterial}vsmPass(e){let{shadow:t}=this,r=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,r),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,r),e.setRenderTarget(this.vsmShadowMapVertical),PM.material=this.vsmMaterialVertical,PM.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),PM.material=this.vsmMaterialHorizontal,PM.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,null!==this.vsmShadowMapVertical&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),null!==this.vsmShadowMapHorizontal&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){let{shadow:t}=this,r=t.needsUpdate||t.autoUpdate;r&&(this._cameraFrameId[e.camera]===e.frameId&&(r=!1),this._cameraFrameId[e.camera]=e.frameId),r&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}}let PR=(e,t)=>y4(new PE(e,t)),PC=new t6,PN=vn(e=>{let[t,r]=e,n=t.toVar(),i=x9(n),a=xf(1,_f(i.x,_f(i.y,i.z)));i.mulAssign(a),n.mulAssign(a.mul(r.mul(2).oneMinus()));let s=vA(n.xy).toVar(),o=r.mul(1.5).oneMinus();return vs(i.z.greaterThanEqual(o),()=>{vs(n.z.greaterThan(0),()=>{s.x.assign(xA(4,n.x))})}).ElseIf(i.x.greaterThanEqual(o),()=>{let e=_e(n.x);s.x.assign(n.z.mul(e).add(e.mul(2)))}).ElseIf(i.y.greaterThanEqual(o),()=>{let e=_e(n.y);s.x.assign(n.x.add(e.mul(2)).add(2)),s.y.assign(n.z.mul(e).sub(2))}),vA(.125,.25).mul(s).add(vA(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),PP=vn(e=>{let{depthTexture:t,bd3D:r,dp:n,texelSize:i}=e;return bL(t,PN(r,i.y)).compare(n)}),PI=vn(e=>{let{depthTexture:t,bd3D:r,dp:n,texelSize:i,shadow:a}=e,s=S1("radius","float",a).setGroup(xt),o=vA(-1,1).mul(s).mul(i.y);return bL(t,PN(r.add(o.xyy),i.y)).compare(n).add(bL(t,PN(r.add(o.yyy),i.y)).compare(n)).add(bL(t,PN(r.add(o.xyx),i.y)).compare(n)).add(bL(t,PN(r.add(o.yyx),i.y)).compare(n)).add(bL(t,PN(r,i.y)).compare(n)).add(bL(t,PN(r.add(o.xxy),i.y)).compare(n)).add(bL(t,PN(r.add(o.yxy),i.y)).compare(n)).add(bL(t,PN(r.add(o.xxx),i.y)).compare(n)).add(bL(t,PN(r.add(o.yxx),i.y)).compare(n)).mul(1/9)}),PL=vn(e=>{let{filterFn:t,depthTexture:r,shadowCoord:n,shadow:i}=e,a=n.xyz.toVar(),s=a.length(),o=xi("float").setGroup(xt).onRenderUpdate(()=>i.camera.near),l=xi("float").setGroup(xt).onRenderUpdate(()=>i.camera.far),u=S1("bias","float",i).setGroup(xt),c=xi(i.mapSize).setGroup(xt),h=vu(1).toVar();return vs(s.sub(l).lessThanEqual(0).and(s.sub(o).greaterThanEqual(0)),()=>{let e=s.sub(o).div(l.sub(o)).toVar();e.addAssign(u);let n=a.normalize(),d=vA(1).div(c.mul(vA(4,2)));h.assign(t({depthTexture:r,bd3D:n,dp:e,texelSize:d,shadow:i}))}),h}),PD=new eH,PB=new ey,PF=new ey;class PU extends PE{static get type(){return"PointShadowNode"}getShadowFilterFn(e){return 0===e?PP:PI}setupShadowCoord(e,t){return t}setupShadowFilter(e,t){let{filterFn:r,shadowTexture:n,depthTexture:i,shadowCoord:a,shadow:s}=t;return PL({filterFn:r,shadowTexture:n,depthTexture:i,shadowCoord:a,shadow:s})}renderShadow(e){let{shadow:t,shadowMap:r,light:n}=this,{renderer:i,scene:a}=e,s=t.getFrameExtents();PF.copy(t.mapSize),PF.multiply(s),r.setSize(PF.width,PF.height),PB.copy(t.mapSize);let o=i.autoClear,l=i.getClearColor(PC),u=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();let c=t.getViewportCount();for(let e=0;e<c;e++){let s=t.getViewport(e),o=PB.x*s.x,l=PF.y-PB.y-PB.y*s.y;PD.set(o,l,PB.x*s.z,PB.y*s.w),r.viewport.copy(PD),t.updateMatrices(n,e),i.render(a,t.camera)}i.autoClear=o,i.setClearColor(l,u)}constructor(e,t=null){super(e,t)}}let PO=(e,t)=>y4(new PU(e,t));class Pk extends ww{static get type(){return"AnalyticLightNode"}getHash(){return this.light.uuid}getLightVector(e){return Pa(this.light).sub(e.context.positionView||SS)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return PR(this.light)}setupShadow(e){let{renderer:t}=e;if(!1===t.shadowMap.enabled)return;let r=this.shadowColorNode;if(null===r){let e,t=this.light.shadow.shadowNode;e=void 0!==t?y4(t):this.setupShadowNode(),this.shadowNode=e,this.shadowColorNode=r=this.colorNode.mul(e),this.baseColorNode=this.colorNode}this.colorNode=r}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):null!==this.shadowNode&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);let t=this.setupDirect(e),r=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),r&&e.lightsNode.setupDirectRectAreaLight(e,this,r)}update(){let{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}constructor(e=null){super(),this.light=e,this.color=new t6,this.colorNode=e&&e.colorNode||xi(this.color).setGroup(xt),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=yl.FRAME}}let Pz=vn(e=>{let{lightDistance:t,cutoffDistance:r,decayExponent:n}=e,i=t.pow(n).max(.01).reciprocal();return r.greaterThan(0).select(i.mul(t.div(r).pow4().oneMinus().clamp().pow2()),i)}),PV=e=>{let{color:t,lightVector:r,cutoffDistance:n,decayExponent:i}=e,a=r.normalize(),s=Pz({lightDistance:r.length(),cutoffDistance:n,decayExponent:i});return{lightDirection:a,lightColor:t.mul(s)}};class Pq extends Pk{static get type(){return"PointLightNode"}update(e){let{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return PO(this.light)}setupDirect(e){return PV({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}constructor(e=null){super(e),this.cutoffDistanceNode=xi(0).setGroup(xt),this.decayExponentNode=xi(2).setGroup(xt)}}let PG=vn(e=>{let[t=bE()]=e,r=t.mul(2),n=r.x.floor(),i=r.y.floor();return n.add(i).mod(2).sign()}),PH=vn((e,t)=>{let r,[n=bE()]=e,{renderer:i,material:a}=t,s=_R(n.mul(2).sub(1));if(a.alphaToCoverage&&i.samples>1){let e=vu(s.fwidth()).toVar();r=_L(e.oneMinus(),e.add(1),s).oneMinus()}else r=_z(s.greaterThan(1),0,1);return r}),Pj=vn(e=>{let[t,r,n]=e,i=vu(n).toVar(),a=vu(r).toVar();return _z(vd(t).toVar(),a,i)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),PW=vn(e=>{let[t,r]=e,n=vd(r).toVar(),i=vu(t).toVar();return _z(n,i.negate(),i)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),PX=vn(e=>{let[t]=e;return vc(x$(vu(t).toVar()))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),PQ=vn(e=>{let[t,r]=e,n=vu(t).toVar();return r.assign(PX(n)),n.sub(vu(r))}),PY=R6([vn(e=>{let[t,r,n,i,a,s]=e,o=vu(s).toVar(),l=vu(a).toVar(),u=vu(i).toVar(),c=vu(n).toVar(),h=vu(r).toVar(),d=vu(t).toVar(),A=vu(xA(1,l)).toVar();return xA(1,o).mul(d.mul(A).add(h.mul(l))).add(o.mul(c.mul(A).add(u.mul(l))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),vn(e=>{let[t,r,n,i,a,s]=e,o=vu(s).toVar(),l=vu(a).toVar(),u=vg(i).toVar(),c=vg(n).toVar(),h=vg(r).toVar(),d=vg(t).toVar(),A=vu(xA(1,l)).toVar();return xA(1,o).mul(d.mul(A).add(h.mul(l))).add(o.mul(c.mul(A).add(u.mul(l))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]})]),PK=R6([vn(e=>{let[t,r,n,i,a,s,o,l,u,c,h]=e,d=vu(h).toVar(),A=vu(c).toVar(),p=vu(u).toVar(),f=vu(l).toVar(),m=vu(o).toVar(),g=vu(s).toVar(),y=vu(a).toVar(),v=vu(i).toVar(),x=vu(n).toVar(),_=vu(r).toVar(),b=vu(t).toVar(),S=vu(xA(1,p)).toVar(),T=vu(xA(1,A)).toVar();return vu(xA(1,d)).toVar().mul(T.mul(b.mul(S).add(_.mul(p))).add(A.mul(x.mul(S).add(v.mul(p))))).add(d.mul(T.mul(y.mul(S).add(g.mul(p))).add(A.mul(m.mul(S).add(f.mul(p))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),vn(e=>{let[t,r,n,i,a,s,o,l,u,c,h]=e,d=vu(h).toVar(),A=vu(c).toVar(),p=vu(u).toVar(),f=vg(l).toVar(),m=vg(o).toVar(),g=vg(s).toVar(),y=vg(a).toVar(),v=vg(i).toVar(),x=vg(n).toVar(),_=vg(r).toVar(),b=vg(t).toVar(),S=vu(xA(1,p)).toVar(),T=vu(xA(1,A)).toVar();return vu(xA(1,d)).toVar().mul(T.mul(b.mul(S).add(_.mul(p))).add(A.mul(x.mul(S).add(v.mul(p))))).add(d.mul(T.mul(y.mul(S).add(g.mul(p))).add(A.mul(m.mul(S).add(f.mul(p))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]})]),PZ=R6([vn(e=>{let[t,r,n]=e,i=vu(n).toVar(),a=vu(r).toVar(),s=vh(t).toVar(),o=vh(s.bitAnd(vh(7))).toVar(),l=vu(Pj(o.lessThan(vh(4)),a,i)).toVar(),u=vu(xp(2,Pj(o.lessThan(vh(4)),i,a))).toVar();return PW(l,vd(o.bitAnd(vh(1)))).add(PW(u,vd(o.bitAnd(vh(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),vn(e=>{let[t,r,n,i]=e,a=vu(i).toVar(),s=vu(n).toVar(),o=vu(r).toVar(),l=vh(t).toVar(),u=vh(l.bitAnd(vh(15))).toVar(),c=vu(Pj(u.lessThan(vh(8)),o,s)).toVar(),h=vu(Pj(u.lessThan(vh(4)),s,Pj(u.equal(vh(12)).or(u.equal(vh(14))),o,a))).toVar();return PW(c,vd(u.bitAnd(vh(1)))).add(PW(h,vd(u.bitAnd(vh(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]})]),PJ=R6([vn(e=>{let[t,r,n]=e,i=vu(n).toVar(),a=vu(r).toVar(),s=vv(t).toVar();return vg(PZ(s.x,a,i),PZ(s.y,a,i),PZ(s.z,a,i))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),vn(e=>{let[t,r,n,i]=e,a=vu(i).toVar(),s=vu(n).toVar(),o=vu(r).toVar(),l=vv(t).toVar();return vg(PZ(l.x,o,s,a),PZ(l.y,o,s,a),PZ(l.z,o,s,a))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]})]),P$=vn(e=>{let[t]=e;return xp(.6616,vu(t).toVar())}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),P0=vn(e=>{let[t]=e;return xp(.982,vu(t).toVar())}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),P1=R6([P$,vn(e=>{let[t]=e;return xp(.6616,vg(t).toVar())}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]})]),P2=R6([P0,vn(e=>{let[t]=e;return xp(.982,vg(t).toVar())}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]})]),P3=vn(e=>{let[t,r]=e,n=vc(r).toVar(),i=vh(t).toVar();return i.shiftLeft(n).bitOr(i.shiftRight(vc(32).sub(n)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),P4=vn(e=>{let[t,r,n]=e;t.subAssign(n),t.bitXorAssign(P3(n,vc(4))),n.addAssign(r),r.subAssign(t),r.bitXorAssign(P3(t,vc(6))),t.addAssign(n),n.subAssign(r),n.bitXorAssign(P3(r,vc(8))),r.addAssign(t),t.subAssign(n),t.bitXorAssign(P3(n,vc(16))),n.addAssign(r),r.subAssign(t),r.bitXorAssign(P3(t,vc(19))),t.addAssign(n),n.subAssign(r),n.bitXorAssign(P3(r,vc(4))),r.addAssign(t)}),P5=vn(e=>{let[t,r,n]=e,i=vh(n).toVar(),a=vh(r).toVar(),s=vh(t).toVar();return i.bitXorAssign(a),i.subAssign(P3(a,vc(14))),s.bitXorAssign(i),s.subAssign(P3(i,vc(11))),a.bitXorAssign(s),a.subAssign(P3(s,vc(25))),i.bitXorAssign(a),i.subAssign(P3(a,vc(16))),s.bitXorAssign(i),s.subAssign(P3(i,vc(4))),a.bitXorAssign(s),a.subAssign(P3(s,vc(14))),i.bitXorAssign(a),i.subAssign(P3(a,vc(24))),i}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),P6=vn(e=>{let[t]=e;return vu(vh(t).toVar()).div(vu(vh(vc(0xffffffff))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),P7=vn(e=>{let[t]=e,r=vu(t).toVar();return r.mul(r).mul(r).mul(r.mul(r.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),P8=vn(e=>{let[t]=e,r=vc(t).toVar(),n=vh(vh(1)).toVar(),i=vh(vh(vc(0xdeadbeef)).add(n.shiftLeft(vh(2))).add(vh(13))).toVar();return P5(i.add(vh(r)),i,i)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),P9=vn(e=>{let[t,r]=e,n=vc(r).toVar(),i=vc(t).toVar(),a=vh(vh(2)).toVar(),s=vh().toVar(),o=vh().toVar(),l=vh().toVar();return s.assign(o.assign(l.assign(vh(vc(0xdeadbeef)).add(a.shiftLeft(vh(2))).add(vh(13))))),s.addAssign(vh(i)),o.addAssign(vh(n)),P5(s,o,l)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Ie=vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vc(r).toVar(),s=vc(t).toVar(),o=vh(vh(3)).toVar(),l=vh().toVar(),u=vh().toVar(),c=vh().toVar();return l.assign(u.assign(c.assign(vh(vc(0xdeadbeef)).add(o.shiftLeft(vh(2))).add(vh(13))))),l.addAssign(vh(s)),u.addAssign(vh(a)),c.addAssign(vh(i)),P5(l,u,c)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),It=R6([P8,P9,Ie,vn(e=>{let[t,r,n,i]=e,a=vc(i).toVar(),s=vc(n).toVar(),o=vc(r).toVar(),l=vc(t).toVar(),u=vh(vh(4)).toVar(),c=vh().toVar(),h=vh().toVar(),d=vh().toVar();return c.assign(h.assign(d.assign(vh(vc(0xdeadbeef)).add(u.shiftLeft(vh(2))).add(vh(13))))),c.addAssign(vh(l)),h.addAssign(vh(o)),d.addAssign(vh(s)),P4(c,h,d),c.addAssign(vh(a)),P5(c,h,d)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),vn(e=>{let[t,r,n,i,a]=e,s=vc(a).toVar(),o=vc(i).toVar(),l=vc(n).toVar(),u=vc(r).toVar(),c=vc(t).toVar(),h=vh(vh(5)).toVar(),d=vh().toVar(),A=vh().toVar(),p=vh().toVar();return d.assign(A.assign(p.assign(vh(vc(0xdeadbeef)).add(h.shiftLeft(vh(2))).add(vh(13))))),d.addAssign(vh(c)),A.addAssign(vh(u)),p.addAssign(vh(l)),P4(d,A,p),d.addAssign(vh(o)),A.addAssign(vh(s)),P5(d,A,p)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]})]),Ir=R6([vn(e=>{let[t,r]=e,n=vc(r).toVar(),i=vh(It(vc(t).toVar(),n)).toVar(),a=vv().toVar();return a.x.assign(i.bitAnd(vc(255))),a.y.assign(i.shiftRight(vc(8)).bitAnd(vc(255))),a.z.assign(i.shiftRight(vc(16)).bitAnd(vc(255))),a}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vc(r).toVar(),s=vh(It(vc(t).toVar(),a,i)).toVar(),o=vv().toVar();return o.x.assign(s.bitAnd(vc(255))),o.y.assign(s.shiftRight(vc(8)).bitAnd(vc(255))),o.z.assign(s.shiftRight(vc(16)).bitAnd(vc(255))),o}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]})]),In=R6([vn(e=>{let[t]=e,r=vA(t).toVar(),n=vc().toVar(),i=vc().toVar(),a=vu(PQ(r.x,n)).toVar(),s=vu(PQ(r.y,i)).toVar(),o=vu(P7(a)).toVar(),l=vu(P7(s)).toVar();return P1(vu(PY(PZ(It(n,i),a,s),PZ(It(n.add(vc(1)),i),a.sub(1),s),PZ(It(n,i.add(vc(1))),a,s.sub(1)),PZ(It(n.add(vc(1)),i.add(vc(1))),a.sub(1),s.sub(1)),o,l)).toVar())}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),vn(e=>{let[t]=e,r=vg(t).toVar(),n=vc().toVar(),i=vc().toVar(),a=vc().toVar(),s=vu(PQ(r.x,n)).toVar(),o=vu(PQ(r.y,i)).toVar(),l=vu(PQ(r.z,a)).toVar(),u=vu(P7(s)).toVar(),c=vu(P7(o)).toVar(),h=vu(P7(l)).toVar();return P2(vu(PK(PZ(It(n,i,a),s,o,l),PZ(It(n.add(vc(1)),i,a),s.sub(1),o,l),PZ(It(n,i.add(vc(1)),a),s,o.sub(1),l),PZ(It(n.add(vc(1)),i.add(vc(1)),a),s.sub(1),o.sub(1),l),PZ(It(n,i,a.add(vc(1))),s,o,l.sub(1)),PZ(It(n.add(vc(1)),i,a.add(vc(1))),s.sub(1),o,l.sub(1)),PZ(It(n,i.add(vc(1)),a.add(vc(1))),s,o.sub(1),l.sub(1)),PZ(It(n.add(vc(1)),i.add(vc(1)),a.add(vc(1))),s.sub(1),o.sub(1),l.sub(1)),u,c,h)).toVar())}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]})]),Ii=R6([vn(e=>{let[t]=e,r=vA(t).toVar(),n=vc().toVar(),i=vc().toVar(),a=vu(PQ(r.x,n)).toVar(),s=vu(PQ(r.y,i)).toVar(),o=vu(P7(a)).toVar(),l=vu(P7(s)).toVar();return P1(vg(PY(PJ(Ir(n,i),a,s),PJ(Ir(n.add(vc(1)),i),a.sub(1),s),PJ(Ir(n,i.add(vc(1))),a,s.sub(1)),PJ(Ir(n.add(vc(1)),i.add(vc(1))),a.sub(1),s.sub(1)),o,l)).toVar())}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),vn(e=>{let[t]=e,r=vg(t).toVar(),n=vc().toVar(),i=vc().toVar(),a=vc().toVar(),s=vu(PQ(r.x,n)).toVar(),o=vu(PQ(r.y,i)).toVar(),l=vu(PQ(r.z,a)).toVar(),u=vu(P7(s)).toVar(),c=vu(P7(o)).toVar(),h=vu(P7(l)).toVar();return P2(vg(PK(PJ(Ir(n,i,a),s,o,l),PJ(Ir(n.add(vc(1)),i,a),s.sub(1),o,l),PJ(Ir(n,i.add(vc(1)),a),s,o.sub(1),l),PJ(Ir(n.add(vc(1)),i.add(vc(1)),a),s.sub(1),o.sub(1),l),PJ(Ir(n,i,a.add(vc(1))),s,o,l.sub(1)),PJ(Ir(n.add(vc(1)),i,a.add(vc(1))),s.sub(1),o,l.sub(1)),PJ(Ir(n,i.add(vc(1)),a.add(vc(1))),s,o.sub(1),l.sub(1)),PJ(Ir(n.add(vc(1)),i.add(vc(1)),a.add(vc(1))),s.sub(1),o.sub(1),l.sub(1)),u,c,h)).toVar())}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]})]),Ia=vn(e=>{let[t]=e;return P6(It(vc(PX(vu(t).toVar())).toVar()))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),Is=vn(e=>{let[t]=e,r=vA(t).toVar();return P6(It(vc(PX(r.x)).toVar(),vc(PX(r.y)).toVar()))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),Io=R6([Ia,Is,vn(e=>{let[t]=e,r=vg(t).toVar(),n=vc(PX(r.x)).toVar();return P6(It(n,vc(PX(r.y)).toVar(),vc(PX(r.z)).toVar()))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),vn(e=>{let[t]=e,r=v_(t).toVar(),n=vc(PX(r.x)).toVar(),i=vc(PX(r.y)).toVar();return P6(It(n,i,vc(PX(r.z)).toVar(),vc(PX(r.w)).toVar()))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]})]),Il=vn(e=>{let[t]=e,r=vc(PX(vu(t).toVar())).toVar();return vg(P6(It(r,vc(0))),P6(It(r,vc(1))),P6(It(r,vc(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),Iu=vn(e=>{let[t]=e,r=vA(t).toVar(),n=vc(PX(r.x)).toVar(),i=vc(PX(r.y)).toVar();return vg(P6(It(n,i,vc(0))),P6(It(n,i,vc(1))),P6(It(n,i,vc(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Ic=R6([Il,Iu,vn(e=>{let[t]=e,r=vg(t).toVar(),n=vc(PX(r.x)).toVar(),i=vc(PX(r.y)).toVar(),a=vc(PX(r.z)).toVar();return vg(P6(It(n,i,a,vc(0))),P6(It(n,i,a,vc(1))),P6(It(n,i,a,vc(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),vn(e=>{let[t]=e,r=v_(t).toVar(),n=vc(PX(r.x)).toVar(),i=vc(PX(r.y)).toVar(),a=vc(PX(r.z)).toVar(),s=vc(PX(r.w)).toVar();return vg(P6(It(n,i,a,s,vc(0))),P6(It(n,i,a,s,vc(1))),P6(It(n,i,a,s,vc(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]})]),Ih=vn(e=>{let[t,r,n,i]=e,a=vu(i).toVar(),s=vu(n).toVar(),o=vc(r).toVar(),l=vg(t).toVar(),u=vu(0).toVar(),c=vu(1).toVar();return wv(o,()=>{u.addAssign(c.mul(In(l))),c.mulAssign(a),l.mulAssign(s)}),u}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Id=vn(e=>{let[t,r,n,i]=e,a=vu(i).toVar(),s=vu(n).toVar(),o=vc(r).toVar(),l=vg(t).toVar(),u=vg(0).toVar(),c=vu(1).toVar();return wv(o,()=>{u.addAssign(c.mul(Ii(l))),c.mulAssign(a),l.mulAssign(s)}),u}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),IA=vn(e=>{let[t,r,n,i]=e,a=vu(i).toVar(),s=vu(n).toVar(),o=vc(r).toVar(),l=vg(t).toVar();return vA(Ih(l,o,s,a),Ih(l.add(vg(vc(19),vc(193),vc(17))),o,s,a))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Ip=vn(e=>{let[t,r,n,i]=e,a=vu(i).toVar(),s=vu(n).toVar(),o=vc(r).toVar(),l=vg(t).toVar();return v_(vg(Id(l,o,s,a)).toVar(),vu(Ih(l.add(vg(vc(19),vc(193),vc(17))),o,s,a)).toVar())}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),If=R6([vn(e=>{let[t,r,n,i,a,s,o]=e,l=vc(o).toVar(),u=vu(s).toVar(),c=vc(a).toVar(),h=vc(i).toVar(),d=vc(n).toVar(),A=vc(r).toVar(),p=vA(t).toVar(),f=vg(Ic(vA(A.add(h),d.add(c)))).toVar(),m=vA(f.x,f.y).toVar();m.subAssign(.5),m.mulAssign(u),m.addAssign(.5);let g=vA(vA(vu(A),vu(d)).add(m)).toVar(),y=vA(g.sub(p)).toVar();return vs(l.equal(vc(2)),()=>x9(y.x).add(x9(y.y))),vs(l.equal(vc(3)),()=>_f(x9(y.x),x9(y.y))),_x(y,y)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),vn(e=>{let[t,r,n,i,a,s,o,l,u]=e,c=vc(u).toVar(),h=vu(l).toVar(),d=vc(o).toVar(),A=vc(s).toVar(),p=vc(a).toVar(),f=vc(i).toVar(),m=vc(n).toVar(),g=vc(r).toVar(),y=vg(t).toVar(),v=vg(Ic(vg(g.add(p),m.add(A),f.add(d)))).toVar();v.subAssign(.5),v.mulAssign(h),v.addAssign(.5);let x=vg(vg(vu(g),vu(m),vu(f)).add(v)).toVar(),_=vg(x.sub(y)).toVar();return vs(c.equal(vc(2)),()=>x9(_.x).add(x9(_.y)).add(x9(_.z))),vs(c.equal(vc(3)),()=>_f(x9(_.x),x9(_.y),x9(_.z))),_x(_,_)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),Im=vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vu(r).toVar(),s=vA(t).toVar(),o=vc().toVar(),l=vc().toVar(),u=vA(PQ(s.x,o),PQ(s.y,l)).toVar(),c=vu(1e6).toVar();return wv({start:-1,end:vc(1),name:"x",condition:"<="},e=>{let{x:t}=e;wv({start:-1,end:vc(1),name:"y",condition:"<="},e=>{let{y:r}=e,n=vu(If(u,t,r,o,l,a,i)).toVar();c.assign(_p(c,n))})}),vs(i.equal(vc(0)),()=>{c.assign(xZ(c))}),c}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ig=vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vu(r).toVar(),s=vA(t).toVar(),o=vc().toVar(),l=vc().toVar(),u=vA(PQ(s.x,o),PQ(s.y,l)).toVar(),c=vA(1e6,1e6).toVar();return wv({start:-1,end:vc(1),name:"x",condition:"<="},e=>{let{x:t}=e;wv({start:-1,end:vc(1),name:"y",condition:"<="},e=>{let{y:r}=e,n=vu(If(u,t,r,o,l,a,i)).toVar();vs(n.lessThan(c.x),()=>{c.y.assign(c.x),c.x.assign(n)}).ElseIf(n.lessThan(c.y),()=>{c.y.assign(n)})})}),vs(i.equal(vc(0)),()=>{c.assign(xZ(c))}),c}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Iy=vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vu(r).toVar(),s=vA(t).toVar(),o=vc().toVar(),l=vc().toVar(),u=vA(PQ(s.x,o),PQ(s.y,l)).toVar(),c=vg(1e6,1e6,1e6).toVar();return wv({start:-1,end:vc(1),name:"x",condition:"<="},e=>{let{x:t}=e;wv({start:-1,end:vc(1),name:"y",condition:"<="},e=>{let{y:r}=e,n=vu(If(u,t,r,o,l,a,i)).toVar();vs(n.lessThan(c.x),()=>{c.z.assign(c.y),c.y.assign(c.x),c.x.assign(n)}).ElseIf(n.lessThan(c.y),()=>{c.z.assign(c.y),c.y.assign(n)}).ElseIf(n.lessThan(c.z),()=>{c.z.assign(n)})})}),vs(i.equal(vc(0)),()=>{c.assign(xZ(c))}),c}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Iv=R6([Im,vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vu(r).toVar(),s=vg(t).toVar(),o=vc().toVar(),l=vc().toVar(),u=vc().toVar(),c=vg(PQ(s.x,o),PQ(s.y,l),PQ(s.z,u)).toVar(),h=vu(1e6).toVar();return wv({start:-1,end:vc(1),name:"x",condition:"<="},e=>{let{x:t}=e;wv({start:-1,end:vc(1),name:"y",condition:"<="},e=>{let{y:r}=e;wv({start:-1,end:vc(1),name:"z",condition:"<="},e=>{let{z:n}=e,s=vu(If(c,t,r,n,o,l,u,a,i)).toVar();h.assign(_p(h,s))})})}),vs(i.equal(vc(0)),()=>{h.assign(xZ(h))}),h}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),Ix=R6([Ig,vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vu(r).toVar(),s=vg(t).toVar(),o=vc().toVar(),l=vc().toVar(),u=vc().toVar(),c=vg(PQ(s.x,o),PQ(s.y,l),PQ(s.z,u)).toVar(),h=vA(1e6,1e6).toVar();return wv({start:-1,end:vc(1),name:"x",condition:"<="},e=>{let{x:t}=e;wv({start:-1,end:vc(1),name:"y",condition:"<="},e=>{let{y:r}=e;wv({start:-1,end:vc(1),name:"z",condition:"<="},e=>{let{z:n}=e,s=vu(If(c,t,r,n,o,l,u,a,i)).toVar();vs(s.lessThan(h.x),()=>{h.y.assign(h.x),h.x.assign(s)}).ElseIf(s.lessThan(h.y),()=>{h.y.assign(s)})})})}),vs(i.equal(vc(0)),()=>{h.assign(xZ(h))}),h}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),I_=R6([Iy,vn(e=>{let[t,r,n]=e,i=vc(n).toVar(),a=vu(r).toVar(),s=vg(t).toVar(),o=vc().toVar(),l=vc().toVar(),u=vc().toVar(),c=vg(PQ(s.x,o),PQ(s.y,l),PQ(s.z,u)).toVar(),h=vg(1e6,1e6,1e6).toVar();return wv({start:-1,end:vc(1),name:"x",condition:"<="},e=>{let{x:t}=e;wv({start:-1,end:vc(1),name:"y",condition:"<="},e=>{let{y:r}=e;wv({start:-1,end:vc(1),name:"z",condition:"<="},e=>{let{z:n}=e,s=vu(If(c,t,r,n,o,l,u,a,i)).toVar();vs(s.lessThan(h.x),()=>{h.z.assign(h.y),h.y.assign(h.x),h.x.assign(s)}).ElseIf(s.lessThan(h.y),()=>{h.z.assign(h.y),h.y.assign(s)}).ElseIf(s.lessThan(h.z),()=>{h.z.assign(s)})})})}),vs(i.equal(vc(0)),()=>{h.assign(xZ(h))}),h}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),Ib=vn(e=>{let[t,r,n,i,a,s,o,l,u,c,h]=e,d=vc(t).toVar(),A=vA(r).toVar(),p=vA(n).toVar(),f=vA(i).toVar(),m=vu(a).toVar(),g=vu(s).toVar(),y=vu(o).toVar(),v=vd(l).toVar(),x=vc(u).toVar(),_=vu(c).toVar(),b=vu(h).toVar(),S=A.mul(p).add(f),T=vu(0).toVar();return vs(d.equal(vc(0)),()=>{T.assign(Ii(S))}),vs(d.equal(vc(1)),()=>{T.assign(Ic(S))}),vs(d.equal(vc(2)),()=>{T.assign(I_(S,m,vc(0)))}),vs(d.equal(vc(3)),()=>{T.assign(Id(vg(S,0),x,_,b))}),T.assign(T.mul(y.sub(g)).add(g)),vs(v,()=>{T.assign(_N(T,g,y))}),T}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),IS=vn(e=>{let[t,r,n,i,a,s,o,l,u,c,h]=e,d=vc(t).toVar(),A=vg(r).toVar(),p=vg(n).toVar(),f=vg(i).toVar(),m=vu(a).toVar(),g=vu(s).toVar(),y=vu(o).toVar(),v=vd(l).toVar(),x=vc(u).toVar(),_=vu(c).toVar(),b=vu(h).toVar(),S=A.mul(p).add(f),T=vu(0).toVar();return vs(d.equal(vc(0)),()=>{T.assign(Ii(S))}),vs(d.equal(vc(1)),()=>{T.assign(Ic(S))}),vs(d.equal(vc(2)),()=>{T.assign(I_(S,m,vc(0)))}),vs(d.equal(vc(3)),()=>{T.assign(Id(S,x,_,b))}),T.assign(T.mul(y.sub(g)).add(g)),vs(v,()=>{T.assign(_N(T,g,y))}),T}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),IT=vn(e=>{let[t]=e,r=t.y,n=t.z,i=vg().toVar();return vs(r.lessThan(1e-4),()=>{i.assign(vg(n,n,n))}).Else(()=>{let e=t.x,a=vc(_l(e=e.sub(x$(e)).mul(6).toVar())),s=e.sub(vu(a)),o=n.mul(r.oneMinus()),l=n.mul(r.mul(s).oneMinus()),u=n.mul(r.mul(s.oneMinus()).oneMinus());vs(a.equal(vc(0)),()=>{i.assign(vg(n,u,o))}).ElseIf(a.equal(vc(1)),()=>{i.assign(vg(l,n,o))}).ElseIf(a.equal(vc(2)),()=>{i.assign(vg(o,n,u))}).ElseIf(a.equal(vc(3)),()=>{i.assign(vg(o,l,n))}).ElseIf(a.equal(vc(4)),()=>{i.assign(vg(u,o,n))}).Else(()=>{i.assign(vg(n,o,l))})}),i}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),Iw=vn(e=>{let[t]=e,r=vg(t).toVar(),n=vu(r.x).toVar(),i=vu(r.y).toVar(),a=vu(r.z).toVar(),s=vu(_p(n,_p(i,a))).toVar(),o=vu(_f(n,_f(i,a))).toVar(),l=vu(o.sub(s)).toVar(),u=vu().toVar(),c=vu().toVar(),h=vu().toVar();return h.assign(o),vs(o.greaterThan(0),()=>{c.assign(l.div(o))}).Else(()=>{c.assign(0)}),vs(c.lessThanEqual(0),()=>{u.assign(0)}).Else(()=>{vs(n.greaterThanEqual(o),()=>{u.assign(i.sub(a).div(l))}).ElseIf(i.greaterThanEqual(o),()=>{u.assign(xd(2,a.sub(n).div(l)))}).Else(()=>{u.assign(xd(4,n.sub(i).div(l)))}),u.mulAssign(1/6),vs(u.lessThan(0),()=>{u.addAssign(1)})}),vg(u,c,h)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),IM=vn(e=>{let[t]=e,r=vg(t).toVar(),n=vx(xx(r,vg(.04045))).toVar();return _C(vg(r.div(12.92)).toVar(),vg(_b(_f(r.add(vg(.055)),vg(0)).div(1.055),vg(2.4))).toVar(),n)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),IE=(e,t)=>{e=vu(e);let r=vA((t=vu(t)).dFdx(),t.dFdy()).length().mul(.7071067811865476);return _L(e.sub(r),e.add(r),t)},IR=(e,t,r,n)=>_C(e,t,r[n].clamp()),IC=(e,t,r,n,i)=>_C(e,t,IE(r,n[i])),IN=vn(e=>{let[t,r,n]=e,i=x1(t).toVar(),a=xA(vu(.5).mul(r.sub(n)),S_).div(i).toVar(),s=xA(vu(-.5).mul(r.sub(n)),S_).div(i).toVar(),o=vg().toVar();o.x=i.x.greaterThan(vu(0)).select(a.x,s.x),o.y=i.y.greaterThan(vu(0)).select(a.y,s.y),o.z=i.z.greaterThan(vu(0)).select(a.z,s.z);let l=_p(o.x,o.y,o.z).toVar();return S_.add(i.mul(l)).toVar().sub(n)}),IP=vn(e=>{let[t,r]=e,n=t.x,i=t.y,a=t.z,s=r.element(0).mul(.886227);return(s=(s=(s=(s=(s=(s=(s=s.add(r.element(1).mul(1.023328).mul(i))).add(r.element(2).mul(1.023328).mul(a))).add(r.element(3).mul(1.023328).mul(n))).add(r.element(4).mul(.858086).mul(n).mul(i))).add(r.element(5).mul(.858086).mul(i).mul(a))).add(r.element(6).mul(a.mul(a).mul(.743125).sub(.247708)))).add(r.element(7).mul(.858086).mul(n).mul(a))).add(r.element(8).mul(.429043).mul(xp(n,n).sub(xp(i,i))))});var II=Object.freeze({__proto__:null,BRDF_GGX:MP,BRDF_Lambert:Mm,BasicPointShadowFilter:PP,BasicShadowFilter:Pp,Break:wx,Const:_Y,Continue:()=>bv("continue").toStack(),DFGApprox:MI,D_GGX:MR,Discard:bx,EPSILON:xk,F_Schlick:Mf,Fn:vn,INFINITY:xz,If:vs,Loop:wv,NodeAccess:yu,NodeShaderStage:yo,NodeType:{BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},NodeUpdateType:yl,OnMaterialUpdate:e=>CL(CI.MATERIAL,e),OnObjectUpdate:e=>CL(CI.OBJECT,e),PCFShadowFilter:Pf,PCFSoftShadowFilter:Pm,PI:xV,PI2:xq,PointShadowFilter:PI,Return:()=>bv("return").toStack(),Schlick_to_F0:MD,ScriptableNodeResources:Nm,ShaderNode:y3,Stack:vo,Switch:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return yC.Switch(...t)},TBNViewMatrix:Tg,VSMShadowFilter:Pg,V_GGX_SmithCorrelated:MM,Var:_Q,VarIntent:_K,abs:x9,acesFilmicToneMapping:Nn,acos:x7,add:xd,addMethodChaining:yP,addNodeElement:function(e){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",e)},agxToneMapping:No,all:xG,alphaT:vH,and:xS,anisotropy:vj,anisotropyB:vX,anisotropyT:vW,any:xH,append:e=>(console.warn("THREE.TSL: append() has been renamed to Stack()."),vo(e)),array:xs,arrayBuffer:e=>y4(new yE(e,"ArrayBuffer")),asin:x6,assign:xo,atan:x8,atan2:_k,atomicAdd:(e,t)=>NU(NB.ATOMIC_ADD,e,t),atomicAnd:(e,t)=>NU(NB.ATOMIC_AND,e,t),atomicFunc:NU,atomicLoad:e=>NU(NB.ATOMIC_LOAD,e,null),atomicMax:(e,t)=>NU(NB.ATOMIC_MAX,e,t),atomicMin:(e,t)=>NU(NB.ATOMIC_MIN,e,t),atomicOr:(e,t)=>NU(NB.ATOMIC_OR,e,t),atomicStore:(e,t)=>NU(NB.ATOMIC_STORE,e,t),atomicSub:(e,t)=>NU(NB.ATOMIC_SUB,e,t),atomicXor:(e,t)=>NU(NB.ATOMIC_XOR,e,t),attenuationColor:v5,attenuationDistance:v4,attribute:bM,attributeArray:function(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";return!0===n.isStruct?(t=n.layout.getLength(),r=ye("float")):(t=yt(n),r=ye(n)),wp(new CB(e,t,r),n,e)},backgroundBlurriness:Cz,backgroundIntensity:CV,backgroundRotation:Cq,batch:wh,bentNormalView:Tv,billboarding:Cr,bitAnd:xE,bitNot:xR,bitOr:xC,bitXor:xN,bitangentGeometry:TA,bitangentLocal:Tp,bitangentView:Tf,bitangentWorld:Tm,bitcast:R$,blendBurn:wK,blendColor:w0,blendDodge:wZ,blendOverlay:w$,blendScreen:wJ,blur:ES,bool:vd,buffer:bF,bufferAttribute:ba,builtin:bz,bumpMap:TS,burn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.'),wK(t)},bvec2:vm,bvec3:vx,bvec4:vT,bypass:bp,cache:bA,call:xu,cameraFar:b$,cameraIndex:bZ,cameraNear:bJ,cameraNormalMatrix:b4,cameraPosition:b5,cameraProjectionMatrix:b0,cameraProjectionMatrixInverse:b1,cameraViewMatrix:b2,cameraViewport:b6,cameraWorldMatrix:b3,cbrt:_E,cdl:C2,ceil:x0,checker:PG,cineonToneMapping:Nt,clamp:_N,clearcoat:vU,clearcoatNormalView:SB,clearcoatRoughness:vO,code:Nc,color:vl,colorSpaceToWorking:_6,colorToDirection:e=>y4(e).mul(2).sub(1),compute:bh,computeKernel:bc,computeSkinning:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new wm(e);return r.positionNode=wp(new nP(e.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(wn).toVar(),r.skinIndexNode=wp(new nP(new Uint32Array(e.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(wn).toVar(),r.skinWeightNode=wp(new nP(e.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(wn).toVar(),r.bindMatrixNode=xi(e.bindMatrix,"mat4"),r.bindMatrixInverseNode=xi(e.bindMatrixInverse,"mat4"),r.boneMatricesNode=bF(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length),r.toPositionNode=t,y4(r)},context:_q,convert:vC,convertColorSpace:(e,t,r)=>y4(new _4(y4(e),t,r)),convertToTexture:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.isSampleNode||e.isTextureNode?e:e.isPassNode?e.getTextureNode():CE(e,...r)},cos:x4,cross:__,cubeTexture:SJ,cubeTextureBase:SZ,cubeToUV:PN,dFdx:_i,dFdy:_a,dashSize:vJ,debug:bT,decrement:xF,decrementBefore:xD,defaultBuildStages:yh,defaultShaderStages:yc,defined:y1,degrees:xW,deltaTime:R8,densityFog:function(e,t){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),N_(e,Nx(t))},densityFogFactor:Nx,depth:wV,depthPass:(e,t,r)=>y4(new C7(C7.DEPTH,e,t,r)),determinant:_h,difference:_v,diffuseColor:vL,directPointLight:PV,directionToColor:Me,directionToFaceDirection:SE,dispersion:v6,distance:_y,div:xf,dodge:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.'),wZ(t)},dot:_x,drawIndex:wo,dynamicBufferAttribute:bs,element:vR,emissive:vD,equal:xg,equals:_A,equirectUV:Mn,exp:xX,exp2:xQ,expression:bv,faceDirection:SM,faceForward:_D,faceforward:_D,float:vu,floatBitsToInt:e=>new RJ(e,"int","float"),floatBitsToUint:e=>new RJ(e,"uint","float"),floor:x$,fog:N_,fract:x2,frameGroup:xe,frameId:R9,frontFacing:Sw,fwidth:_u,gain:(e,t)=>e.lessThan(.5)?R1(e.mul(2),t).div(2):xA(1,R1(xp(xA(1,e),2),t).div(2)),gapSize:v$,getConstNodeType:y2,getCurrentStack:va,getDirection:Ev,getDistanceAttenuation:Pz,getGeometryRoughness:MT,getNormalFromDepth:CN,getParallaxCorrectNormal:IN,getRoughness:Mw,getScreenPosition:CC,getShIrradianceAt:IP,getShadowMaterial:Pv,getShadowRenderObjectFunction:Pb,getTextureIndex:RK,getViewPosition:CR,globalId:NC,glsl:(e,t)=>Nc(e,t,"glsl"),glslFn:(e,t)=>Nd(e,t,"glsl"),grayscale:CZ,greaterThan:xx,greaterThanEqual:xb,hash:R0,highpModelNormalViewMatrix:Sg,highpModelViewMatrix:Sm,hue:C0,increment:xB,incrementBefore:xL,instance:wu,instanceIndex:wn,instancedArray:function(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";return!0===n.isStruct?(t=n.layout.getLength(),r=ye("float")):(t=yt(n),r=ye(n)),wp(new CD(e,t,r),n,e)},instancedBufferAttribute:bo,instancedDynamicBufferAttribute:bl,instancedMesh:wc,int:vc,intBitsToFloat:e=>new RJ(e,"float","int"),inverse:_d,inverseSqrt:xJ,inversesqrt:xJ,invocationLocalIndex:ws,invocationSubgroupIndex:wa,ior:v1,iridescence:vV,iridescenceIOR:vq,iridescenceThickness:vG,ivec2:vp,ivec3:vy,ivec4:vb,js:(e,t)=>Nc(e,t,"js"),label:_j,length:_t,lengthSq:_R,lessThan:xv,lessThanEqual:x_,lightPosition:Pn,lightProjectionUV:Pr,lightShadowMatrix:Pt,lightTargetDirection:Ps,lightTargetPosition:Pi,lightViewPosition:Pa,lightingContext:wE,lights:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return y4(new Pc).setLights(e)},linearDepth:wq,linearToneMapping:C9,localId:NN,log:xY,log2:xK,logarithmicDepthToViewZ:(e,t,r)=>{let n=e.mul(xY(r.div(t)));return vu(Math.E).pow(n).mul(t).negate()},luminance:C1,mat2:vw,mat3:vM,mat4:vE,matcapUV:E5,materialAO:T8,materialAlphaTest:TM,materialAnisotropy:Tj,materialAnisotropyVector:T9,materialAttenuationColor:T$,materialAttenuationDistance:TJ,materialClearcoat:Tk,materialClearcoatNormal:TV,materialClearcoatRoughness:Tz,materialColor:TE,materialDispersion:T6,materialEmissive:TC,materialEnvIntensity:SH,materialEnvRotation:Sj,materialIOR:TZ,materialIridescence:TW,materialIridescenceIOR:TX,materialIridescenceThickness:TQ,materialLightMap:T7,materialLineDashOffset:T4,materialLineDashSize:T1,materialLineGapSize:T2,materialLineScale:T0,materialLineWidth:T3,materialMetalness:TU,materialNormal:TO,materialOpacity:TN,materialPointSize:T5,materialReference:S4,materialReflectivity:TB,materialRefractionRatio:SG,materialRotation:Tq,materialRoughness:TF,materialSheen:TG,materialSheenRoughness:TH,materialShininess:TR,materialSpecular:TP,materialSpecularColor:TL,materialSpecularIntensity:TI,materialSpecularStrength:TD,materialThickness:TK,materialTransmission:TY,max:_f,maxMipLevel:bC,mediumpModelViewMatrix:Sf,metalness:vF,min:_p,mix:_C,mixElement:_F,mod:xm,modInt:xU,modelDirection:Ss,modelNormalMatrix:Sd,modelPosition:Sl,modelRadius:Sh,modelScale:Su,modelViewMatrix:Sp,modelViewPosition:Sc,modelViewProjection:we,modelWorldMatrix:So,modelWorldMatrixInverse:SA,morphReference:wT,mrt:RZ,mul:xp,mx_aastep:IE,mx_add:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(0);return xd(e,t)},mx_atan2:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vu(0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(1);return x8(e,t)},mx_cell_noise_float:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE();return Io(e.convert("vec2|vec3"))},mx_contrast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return vu(e).sub(r).mul(t).add(r)},mx_divide:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(1);return xf(e,t)},mx_fractal_noise_float:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return Ih(e,vc(t),r,n).mul(i)},mx_fractal_noise_vec2:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return IA(e,vc(t),r,n).mul(i)},mx_fractal_noise_vec3:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return Id(e,vc(t),r,n).mul(i)},mx_fractal_noise_vec4:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return Ip(e,vc(t),r,n).mul(i)},mx_frame:()=>R9,mx_heighttonormal:(e,t)=>TS(e=vg(e),t=vu(t)),mx_hsvtorgb:IT,mx_ifequal:(e,t,r,n)=>e.equal(t).mix(r,n),mx_ifgreater:(e,t,r,n)=>e.greaterThan(t).mix(r,n),mx_ifgreatereq:(e,t,r,n)=>e.greaterThanEqual(t).mix(r,n),mx_invert:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(1);return xA(t,e)},mx_modulo:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(1);return xm(e,t)},mx_multiply:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(1);return xp(e,t)},mx_noise_float:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return In(e.convert("vec2|vec3")).mul(t).add(r)},mx_noise_vec3:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ii(e.convert("vec2|vec3")).mul(t).add(r)},mx_noise_vec4:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return v_(Ii(e=e.convert("vec2|vec3")),In(e.add(vA(19,73)))).mul(t).add(r)},mx_place2d:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vA(.5,.5),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vA(1,1),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vu(0),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vA(0,0),a=e;if(t&&(a=a.sub(t)),r&&(a=a.mul(r)),n){let e=n.mul(Math.PI/180),t=e.cos(),r=e.sin();a=vA(a.x.mul(t).sub(a.y.mul(r)),a.x.mul(r).add(a.y.mul(t)))}return t&&(a=a.add(t)),i&&(a=a.add(i)),a},mx_power:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(1);return _b(e,t)},mx_ramp4:function(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:bE(),a=i.x.clamp(),s=i.y.clamp(),o=_C(e,t,a),l=_C(r,n,a);return _C(o,l,s)},mx_ramplr:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bE();return IR(e,t,r,"x")},mx_ramptb:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bE();return IR(e,t,r,"y")},mx_rgbtohsv:Iw,mx_rotate2d:(e,t)=>E8(e=vA(e),(t=vu(t)).mul(Math.PI/180)),mx_rotate3d:(e,t,r)=>{e=vg(e),t=vu(t),r=vg(r);let n=t.mul(Math.PI/180),i=r.normalize(),a=n.cos(),s=n.sin(),o=vu(1).sub(a);return e.mul(a).add(i.cross(e).mul(s)).add(i.mul(i.dot(e)).mul(o))},mx_safepower:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e=vu(e)).abs().pow(t).mul(e.sign())},mx_separate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof t){let r={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},n=t.replace(/^out/,"").toLowerCase();if(void 0!==r[n])return e.element(r[n])}if("number"==typeof t)return e.element(t);if("string"==typeof t&&1===t.length){let r={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(void 0!==r[t])return e.element(r[t])}return e},mx_splitlr:function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bE();return IC(e,t,r,n,"x")},mx_splittb:function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bE();return IC(e,t,r,n,"y")},mx_srgb_texture_to_lin_rec709:IM,mx_subtract:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vu(0);return xA(e,t)},mx_timer:()=>R7,mx_transform_uv:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bE();return r.mul(e).add(t)},mx_unifiednoise2d:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bE(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vA(1,1),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vA(0,0),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:2,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:.5;return Ib(e,t.convert("vec2|vec3"),r,n,i,a,s,o,l,u,c)},mx_unifiednoise3d:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bE(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vA(1,1),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vA(0,0),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:2,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:.5;return IS(e,t.convert("vec2|vec3"),r,n,i,a,s,o,l,u,c)},mx_worley_noise_float:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Iv(e.convert("vec2|vec3"),t,vc(1))},mx_worley_noise_vec2:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ix(e.convert("vec2|vec3"),t,vc(1))},mx_worley_noise_vec3:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return I_(e.convert("vec2|vec3"),t,vc(1))},negate:_r,neutralToneMapping:Nl,nodeArray:y7,nodeImmutable:y9,nodeObject:y4,nodeObjectIntent:y5,nodeObjects:y6,nodeProxy:y8,nodeProxyIntent:ve,normalFlat:SN,normalGeometry:SR,normalLocal:SC,normalMap:Tx,normalView:SL,normalViewGeometry:SP,normalWorld:SD,normalWorldGeometry:SI,normalize:x1,not:xw,notEqual:xy,numWorkgroups:NE,objectDirection:b9,objectGroup:xr,objectPosition:St,objectRadius:Si,objectScale:Sr,objectViewPosition:Sn,objectWorldMatrix:Se,oneMinus:_n,or:xT,orthographicDepthToViewZ:(e,t,r)=>t.sub(r).mul(e).sub(t),oscSawtooth:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R7;return e.fract()},oscSine:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R7;return e.add(.75).mul(2*Math.PI).sin().mul(.5).add(.5)},oscSquare:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R7;return e.fract().round()},oscTriangle:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R7;return e.add(.5).fract().mul(2).sub(1).abs()},output:vZ,outputStruct:RY,overlay:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),w$(t)},overloadingFn:R6,parabola:R1,parallaxDirection:Ty,parallaxUV:(e,t)=>e.sub(Ty.mul(t)),parameter:(e,t)=>y4(new RH(e,t)),pass:(e,t,r)=>y4(new C7(C7.COLOR,e,t,r)),passTexture:(e,t)=>y4(new C5(e,t)),pcurve:(e,t,r)=>_b(xf(_b(e,t),xd(_b(e,t),_b(xA(1,e),r))),1/t),perspectiveDepthToViewZ:wO,pmremTexture:EW,pointShadow:PO,pointUV:CF,pointWidth:v0,positionGeometry:Sy,positionLocal:Sv,positionPrevious:Sx,positionView:SS,positionViewDirection:ST,positionWorld:S_,positionWorldDirection:Sb,posterize:C3,pow:_b,pow2:_S,pow3:_T,pow4:_w,premultiplyAlpha:w1,property:vP,quadBroadcast:N9,quadSwapDiagonal:N3,quadSwapX:N1,quadSwapY:N2,radians:xj,rand:_B,range:NT,rangeFog:function(e,t,r){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),N_(e,Nv(t,r))},rangeFogFactor:Nv,reciprocal:_o,reference:S1,referenceBuffer:S2,reflect:_g,reflectVector:SQ,reflectView:SW,reflector:e=>y4(new Cx(e)),refract:_I,refractVector:SY,refractView:SX,reinhardToneMapping:Ne,remap:bm,remapClamp:bg,renderGroup:xt,renderOutput:bb,rendererReference:be,rotate:E8,rotateUV:Ce,roughness:vB,round:_s,rtt:CE,sRGBTransferEOTF:_1,sRGBTransferOETF:_2,sample:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return y4(new CP(e,y4(t)))},sampler:e=>(!0===e.isNode?e:bL(e)).convert("sampler"),samplerComparison:e=>(!0===e.isNode?e:bL(e)).convert("samplerComparison"),saturate:_P,saturation:CJ,screen:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.'),wJ(t)},screenCoordinate:bj,screenDPR:bq,screenSize:bH,screenUV:bG,scriptable:Ng,scriptableValue:NA,select:_z,setCurrentStack:vi,setName:_H,shaderStages:yd,shadow:PR,shadowPositionWorld:Pd,shapeCircle:PH,sharedUniformGroup:v9,sheen:vk,sheenRoughness:vz,shiftLeft:xP,shiftRight:xI,shininess:vK,sign:_e,sin:x3,sinc:(e,t)=>x3(xV.mul(t.mul(e).sub(1))).div(xV.mul(t.mul(e).sub(1))),skinning:wg,smoothstep:_L,smoothstepElement:_U,specularColor:vQ,specularF90:vY,spherizeUV:Ct,split:(e,t)=>y4(new yb(y4(e),t)),spritesheetUV:Ci,sqrt:xZ,stack:Rj,step:_m,stepElement:_O,storage:wp,storageBarrier:()=>NI("storage").toStack(),storageObject:(e,t,r)=>(console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),wp(e,t,r).setPBO(!0)),storageTexture:CG,string:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return y4(new yE(e,"string"))},struct:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new RW(e,t),n=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];let a=null;if(n.length>0)if(n[0].isNode){a={};let t=Object.keys(e);for(let e=0;e<n.length;e++)a[t[e]]=n[e]}else a=n[0];return y4(new RX(r,a))};return n.layout=r,n.isStruct=!0,n},sub:xA,subBuild:_J,subgroupAdd:NV,subgroupAll:NJ,subgroupAnd:NX,subgroupAny:N$,subgroupBallot:Nz,subgroupBroadcast:N4,subgroupBroadcastFirst:N0,subgroupElect:Nk,subgroupExclusiveAdd:NG,subgroupExclusiveMul:NW,subgroupInclusiveAdd:Nq,subgroupInclusiveMul:Nj,subgroupIndex:wi,subgroupMax:NZ,subgroupMin:NK,subgroupMul:NH,subgroupOr:NQ,subgroupShuffle:N5,subgroupShuffleDown:N8,subgroupShuffleUp:N7,subgroupShuffleXor:N6,subgroupSize:NP,subgroupXor:NY,tan:x5,tangentGeometry:Tl,tangentLocal:Tu,tangentView:Tc,tangentWorld:Th,texture:bL,texture3D:Cj,textureBarrier:()=>NI("texture").toStack(),textureBicubic:M$,textureBicubicLevel:MJ,textureCubeUV:Ex,textureLoad:bD,textureSize:bR,textureStore:(e,t,r)=>{let n=CG(e,t,r);return null!==r&&n.toStack(),n},thickness:v3,time:R7,toneMapping:br,toneMappingExposure:bn,toonOutlinePass:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t6(0,0,0),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.003,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return y4(new C8(e,t,y4(r),y4(n),y4(i)))},transformDirection:_M,transformNormal:SF,transformNormalToView:SU,transformedClearcoatNormalView:Sz,transformedNormalView:SO,transformedNormalWorld:Sk,transmission:v2,transpose:_c,triNoise3D:R4,triplanarTexture:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ca(...t)},triplanarTextures:Ca,trunc:_l,uint:vh,uintBitsToFloat:e=>new RJ(e,"float","uint"),uniform:xi,uniformArray:bk,uniformCubeTexture:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SK;return SZ(e)},uniformFlow:_G,uniformGroup:v8,uniformTexture:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bN;return bL(e)},unpremultiplyAlpha:w2,userData:(e,t,r)=>y4(new CW(e,t,r)),uv:bE,uvec2:vf,uvec3:vv,uvec4:vS,varying:_$,varyingProperty:vI,vec2:vA,vec3:vg,vec4:v_,vectorComponents:yA,velocity:CK,vertexColor:wY,vertexIndex:wr,vertexStage:_0,vibrance:C$,viewZToLogarithmicDepth:wk,viewZToOrthographicDepth:wF,viewZToPerspectiveDepth:wU,viewport:bW,viewportCoordinate:bQ,viewportDepthTexture:wD,viewportLinearDepth:wG,viewportMipTexture:wI,viewportResolution:bK,viewportSafeUV:Cn,viewportSharedTexture:w9,viewportSize:bX,viewportTexture:wP,viewportUV:bY,wgsl:(e,t)=>Nc(e,t,"wgsl"),wgslFn:(e,t)=>Nd(e,t,"wgsl"),workgroupArray:(e,t)=>y4(new ND("Workgroup",e,t)),workgroupBarrier:()=>NI("workgroup").toStack(),workgroupId:NR,workingToColorSpace:_5,xor:xM});let IL=new RG;class ID extends Rp{update(e,t,r){let n=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background,a=!1;if(null===i)n._clearColor.getRGB(IL),IL.a=n._clearColor.a;else if(!0===i.isColor)i.getRGB(IL),IL.a=1,a=!0;else if(!0===i.isNode){let r=this.get(e);IL.copy(n._clearColor);let a=r.backgroundMesh;if(void 0===a){let e=_q(v_(i).mul(CV),{getUV:()=>Cq.mul(SI),getTextureLevel:()=>Cz}),t=we;t=t.setZ(t.w);let n=new w3;n.name="Background.material",n.side=1,n.depthTest=!1,n.depthWrite=!1,n.allowOverride=!1,n.fog=!1,n.lights=!1,n.vertexNode=t,n.colorNode=e,r.backgroundMeshNode=e,r.backgroundMesh=a=new rU(new aD(1,32,32),n),a.frustumCulled=!1,a.name="Background.mesh",a.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},i.addEventListener("dispose",function e(){i.removeEventListener("dispose",e),a.material.dispose(),a.geometry.dispose()})}let s=i.getCacheKey();r.backgroundCacheKey!==s&&(r.backgroundMeshNode.node=v_(i).mul(CV),r.backgroundMeshNode.needsUpdate=!0,a.material.needsUpdate=!0,r.backgroundCacheKey=s),t.unshift(a,a.geometry,a.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);let s=n.xr.getEnvironmentBlendMode();if("additive"===s?IL.set(0,0,0,1):"alpha-blend"===s&&IL.set(0,0,0,0),!0===n.autoClear||!0===a){let e=r.clearColorValue;e.r=IL.r,e.g=IL.g,e.b=IL.b,e.a=IL.a,(!0===n.backend.isWebGLBackend||!0===n.alpha)&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),r.depthClearValue=n._clearDepth,r.stencilClearValue=n._clearStencil,r.clearColor=!0===n.autoClearColor,r.clearDepth=!0===n.autoClearDepth,r.clearStencil=!0===n.autoClearStencil}else r.clearColor=!1,r.clearDepth=!1,r.clearStencil=!1}constructor(e,t){super(),this.renderer=e,this.nodes=t}}let IB=0;class IF{constructor(e="",t=[],r=0,n=[]){this.name=e,this.bindings=t,this.index=r,this.bindingsReference=n,this.id=IB++}}class IU{createBindings(){let e=[];for(let t of this.bindings)if(!0!==t.bindings[0].groupNode.shared){let r=new IF(t.name,[],t.index,t.bindingsReference);for(let n of(e.push(r),t.bindings))r.bindings.push(n.clone())}else e.push(t);return e}constructor(e,t,r,n,i,a,s,o,l,u=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=r,this.transforms=u,this.nodeAttributes=n,this.bindings=i,this.updateNodes=a,this.updateBeforeNodes=s,this.updateAfterNodes=o,this.observer=l,this.usedTimes=0}}class IO{constructor(e,t,r=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=r}}class Ik{get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}constructor(e,t,r){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=r}}class Iz{constructor(e,t,r=!1,n=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=r,this.count=n}}class IV extends Iz{constructor(e,t,r=null,n=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=r,this.interpolationSampling=n}}class Iq{constructor(e,t,r=""){this.name=e,this.type=t,this.code=r,Object.defineProperty(this,"isNodeCode",{value:!0})}}let IG=0;class IH{getData(e){let t=this.nodesData.get(e);return void 0===t&&null!==this.parent&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}constructor(e=null){this.id=IG++,this.nodesData=new WeakMap,this.parent=e}}class Ij{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class IW{setValue(e){this.value=e}getValue(){return this.value}constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}}class IX extends IW{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class IQ extends IW{constructor(e,t=new ey){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class IY extends IW{constructor(e,t=new ex){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class IK extends IW{constructor(e,t=new eH){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class IZ extends IW{constructor(e,t=new t6){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class IJ extends IW{constructor(e,t=new oO){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class I$ extends IW{constructor(e,t=new eS){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class I0 extends IW{constructor(e,t=new tp){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class I1 extends IX{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I2 extends IQ{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I3 extends IY{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I4 extends IK{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I5 extends IZ{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I6 extends IJ{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I7 extends I${getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}class I8 extends I0{getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}constructor(e){super(e.name,e.value),this.nodeUniform=e}}let I9=new WeakMap,Le=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),Lt=e=>/e/g.test(e)?String(e).replace(/\+/g,""):(e=Number(e))+(e%1?"":".0");class Lr{getBindGroupsCache(){let e=I9.get(this.renderer);return void 0===e&&(e=new Ru,I9.set(this.renderer,e)),e}createRenderTarget(e,t,r){return new ej(e,t,r)}createCubeRenderTarget(e,t){return new Mi(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){let r,n=this.getBindGroupsCache(),i=[],a=!0;for(let e of t)i.push(e),a=a&&!0!==e.groupNode.shared;return a?void 0===(r=n.get(i))&&(r=new IF(e,i,this.bindingsIndexes[e].group,i),n.set(i,r)):r=new IF(e,i,this.bindingsIndexes[e].group,i),r}getBindGroupArray(e,t){let r=this.bindings[t],n=r[e];return void 0===n&&(void 0===this.bindingsIndexes[e]&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),r[e]=n=[]),n}getBindings(){let e=this.bindGroups;if(null===e){let t={},r=this.bindings;for(let e of yd)for(let n in r[e]){let i=r[e][n];(t[n]||(t[n]=[])).push(...i)}for(let r in e=[],t){let n=t[r],i=this._getBindGroup(r,n);e.push(i)}this.bindGroups=e}return e}sortBindingGroups(){let e=this.getBindings();e.sort((e,t)=>e.bindings[0].groupNode.order-t.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){let r=e[t];this.bindingsIndexes[r.name].group=t,r.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){!1===this.nodes.includes(e)&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){!1===this.sequentialNodes.includes(e)&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(let e of this.nodes)e.getUpdateType()!==yl.NONE&&this.updateNodes.push(e);for(let e of this.sequentialNodes){let t=e.getUpdateBeforeType(),r=e.getUpdateAfterType();t!==yl.NONE&&this.updateBeforeNodes.push(e),r!==yl.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return 1006===e.magFilter||1007===e.magFilter||1005===e.magFilter||1008===e.magFilter||1006===e.minFilter||1007===e.minFilter||1005===e.minFilter||1008===e.minFilter}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=this.getDataFromNode(e);return void 0===r.cache&&(r.cache=new IH(t?this.getCache():null)),r.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){let t=this.getDataFromNode(e);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.generateArrayDeclaration(e,t)+"( ";for(let i=0;i<t;i++){let a=r?r[i]:null;null!==a?n+=a.build(this,e):n+=this.generateConst(e),i<t-1&&(n+=", ")}return n+" )"}generateStruct(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=[];for(let e of t){let{name:t,type:i}=e;r&&r[t]&&r[t].isNode?n.push(r[t].build(this,i)):n.push(this.generateConst(i))}return e+"( "+n.join(", ")+" )"}generateConst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t&&("float"===e||"int"===e||"uint"===e?t=0:"bool"===e?t=!1:"color"===e?t=new t6:"vec2"===e?t=new ey:"vec3"===e?t=new ex:"vec4"===e&&(t=new eH)),"float"===e)return Lt(t);if("int"===e)return"".concat(Math.round(t));if("uint"===e)return t>=0?"".concat(Math.round(t),"u"):"0u";if("bool"===e)return t?"true":"false";if("color"===e)return"".concat(this.getType("vec3"),"( ").concat(Lt(t.r),", ").concat(Lt(t.g),", ").concat(Lt(t.b)," )");let r=this.getTypeLength(e),n=this.getComponentType(e),i=e=>this.generateConst(n,e);if(2===r)return"".concat(this.getType(e),"( ").concat(i(t.x),", ").concat(i(t.y)," )");if(3===r)return"".concat(this.getType(e),"( ").concat(i(t.x),", ").concat(i(t.y),", ").concat(i(t.z)," )");if(4===r&&"mat2"!==e)return"".concat(this.getType(e),"( ").concat(i(t.x),", ").concat(i(t.y),", ").concat(i(t.z),", ").concat(i(t.w)," )");if(r>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return"".concat(this.getType(e),"( ").concat(t.elements.map(i).join(", ")," )");if(r>4)return"".concat(this.getType(e),"()");throw Error("NodeBuilder: Type '".concat(e,"' not found in generate constant attempt."))}getType(e){return"color"===e?"vec3":e}hasGeometryAttribute(e){return this.geometry&&void 0!==this.geometry.getAttribute(e)}getAttribute(e,t){let r=this.attributes;for(let t of r)if(t.name===e)return t;let n=new IO(e,t);return this.registerDeclaration(n),r.push(n),n}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return"void"===e||"property"===e||"sampler"===e||"samplerComparison"===e||"texture"===e||"cubeTexture"===e||"storageTexture"===e||"depthTexture"===e||"texture3D"===e}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){let t=e.type;if(e.isDataTexture){if(1013===t)return"int";if(1014===t)return"uint"}return"float"}getElementType(e){return"mat2"===e?"vec2":"mat3"===e?"vec3":"mat4"===e?"vec4":this.getComponentType(e)}getComponentType(e){if("float"===(e=this.getVectorType(e))||"bool"===e||"int"===e||"uint"===e)return e;let t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return null===t?null:"b"===t[1]?"bool":"i"===t[1]?"int":"u"===t[1]?"uint":"float"}getVectorType(e){return"color"===e?"vec3":"texture"===e||"cubeTexture"===e||"storageTexture"===e||"texture3D"===e?"vec4":e}getTypeFromLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";if(1===e)return t;let r=g8.get(e),n="float"===t?"":t[0];return!0===/mat2/.test(t)&&(r=r.replace("vec","mat")),n+r}getTypeFromArray(e){return Le.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t,r=e;e.isInterleavedBufferAttribute&&(r=e.data);let n=r.array,i=e.itemSize,a=e.normalized;return e instanceof rm||!0===a||(t=this.getTypeFromArray(n)),this.getTypeFromLength(i,t)}getTypeLength(e){let t=this.getVectorType(e),r=/vec([2-4])/.exec(t);return null!==r?Number(r[1]):"float"===t||"bool"===t||"int"===t||"uint"===t?1:!0===/mat2/.test(e)?4:!0===/mat3/.test(e)?9:16*(!0===/mat4/.test(e))}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){let t=this.getComponentType(e);return"int"===t||"uint"===t?e:this.changeComponentType(e,"int")}addStack(){this.stack=Rj(this.stack);let e=va();return this.stacks.push(e),vi(this.stack),this.stack}removeStack(){let e=this.stack;return this.stack=e.parent,vi(this.stacks.pop()),e}getDataFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=(r=null===r?e.isGlobal(this)?this.globalCache:this.cache:r).getData(e);void 0===n&&(n={},r.setData(e,n)),void 0===n[t]&&(n[t]={});let i=n[t],a=n.any?n.any.subBuilds:null,s=this.getClosestSubBuild(a);return s&&(void 0===i.subBuildsCache&&(i.subBuildsCache={}),(i=i.subBuildsCache[s]||(i.subBuildsCache[s]={})).subBuilds=a),i}getNodeProperties(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",r=this.getDataFromNode(e,t);return r.properties||(r.properties={outputNode:null})}getBufferAttributeFromNode(e,t){let r=this.getDataFromNode(e),n=r.bufferAttribute;return void 0===n&&(n=new IO("nodeAttribute"+this.uniforms.index++,t,e),this.bufferAttributes.push(n),r.bufferAttribute=n),n}getStructTypeNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;return this.types[t][e]||null}getStructTypeFromNode(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage,i=this.getDataFromNode(e,n,this.globalCache),a=i.structType;if(void 0===a){let s=this.structs.index++;null===r&&(r="StructType"+s),a=new Ij(r,t),this.structs[n].push(a),this.types[n][r]=e,i.structType=a}return a}getOutputStructTypeFromNode(e,t){let r=this.getStructTypeFromNode(e,t,"OutputType","fragment");return r.output=!0,r}getUniformFromNode(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.getDataFromNode(e,r,this.globalCache),a=i.uniform;if(void 0===a){let s=this.uniforms.index++;a=new Ik(n||"nodeUniform"+s,t,e),this.uniforms[r].push(a),this.registerDeclaration(a),i.uniform=a}return a}getVarFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getNodeType(this),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.getDataFromNode(e,n),s=this.getSubBuildProperty("variable",a.subBuilds),o=a[s];if(void 0===o){let l=i?"_const":"_var",u=this.vars[n]||(this.vars[n]=[]),c=this.vars[l]||(this.vars[l]=0);null===t&&(t=(i?"nodeConst":"nodeVar")+c,this.vars[l]++),"variable"!==s&&(t=this.getSubBuildProperty(t,a.subBuilds)),o=new Iz(t,r,i,e.getArrayCount(this)),i||u.push(o),this.registerDeclaration(o),a[s]=o}return o}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode))&&(!e.cNode||this.isDeterministic(e.cNode));if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode));if(e.isArrayNode){if(null!==e.values){for(let t of e.values)if(!this.isDeterministic(t))return!1}return!0}return!!e.isConstNode||!1}getVaryingFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getNodeType(this),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=this.getDataFromNode(e,"any"),s=this.getSubBuildProperty("varying",a.subBuilds),o=a[s];if(void 0===o){let e=this.varyings,l=e.length;null===t&&(t="nodeVarying"+l),"varying"!==s&&(t=this.getSubBuildProperty(t,a.subBuilds)),o=new IV(t,r,n,i),e.push(o),this.registerDeclaration(o),a[s]=o}return o}registerDeclaration(e){let t=this.shaderStage,r=this.declarations[t]||(this.declarations[t]={}),n=this.getPropertyName(e),i=1,a=n;for(;void 0!==r[a];)a=n+"_"+i++;i>1&&(e.name=a,console.warn("THREE.TSL: Declaration name '".concat(n,"' of '").concat(e.type,"' already in use. Renamed to '").concat(a,"'."))),r[a]=e}getCodeFromNode(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,n=this.getDataFromNode(e),i=n.code;if(void 0===i){let e=this.codes[r]||(this.codes[r]=[]);i=new Iq("nodeCode"+e.length,t),e.push(i),n.code=i}return i}addFlowCodeHierarchy(e,t){let{flowCodes:r,flowCodeBlock:n}=this.getDataFromNode(e),i=!0,a=t;for(;a;){if(!0===n.get(a)){i=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(i)for(let e of r)this.addLineFlowCode(e)}addLineFlowCodeBlock(e,t,r){let n=this.getDataFromNode(e),i=n.flowCodes||(n.flowCodes=[]),a=n.flowCodeBlock||(n.flowCodeBlock=new WeakMap);i.push(t),a.set(r,!0)}addLineFlowCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return""===e||(null!==t&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e+=";\n"),this.flow.code+=e),this}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){let t=e.getNodeType(this),r=this.flowChildNode(e,t);return this.flowsData.set(e,r),r}addInclude(e){null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){let t=new Nh,r=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=r,t}flowShaderNode(e){let t=e.layout,r={[Symbol.iterator](){let e=0,t=Object.values(this);return{next:()=>({value:t[e],done:e++>=t.length})}}};for(let e of t.inputs)r[e.name]=new RH(e.type,e.name);e.layout=null;let n=e.call(r),i=this.flowStagesNode(n,t.type);return e.layout=t,i}flowBuildStage(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getBuildStage();this.setBuildStage(t);let i=e.build(this,r);return this.setBuildStage(n),i}flowStagesNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.flow,n=this.vars,i=this.declarations,a=this.cache,s=this.buildStage,o=this.stack,l={code:""};for(let r of(this.flow=l,this.vars={},this.declarations={},this.cache=new IH,this.stack=Rj(),yh))this.setBuildStage(r),l.result=e.build(this,t);return l.vars=this.getVars(this.shaderStage),this.flow=r,this.vars=n,this.declarations=i,this.cache=a,this.stack=o,this.setBuildStage(s),l}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.flow,n={code:""};return this.flow=n,n.result=e.build(this,t),this.flow=r,n}flowNodeFromShaderStage(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.tab,a=this.cache,s=this.shaderStage,o=this.context;this.setShaderStage(e);let l={...this.context};delete l.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=l;let u=null;if("generate"===this.buildStage){let i=this.flowChildNode(t,r);null!==n&&(i.code+="".concat(this.tab+n," = ").concat(i.result,";\n")),this.flowCode[e]=this.flowCode[e]+i.code,u=i}else u=t.build(this);return this.setShaderStage(s),this.cache=a,this.tab=i,this.context=o,u}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"".concat(null!==r?this.generateArrayDeclaration(e,r):this.getType(e)," ").concat(t)}getVars(e){let t="",r=this.vars[e];if(void 0!==r)for(let e of r)t+="".concat(this.getVar(e.type,e.name),"; ");return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){let t=this.codes[e],r="";if(void 0!==t)for(let e of t)r+=e.code+"\n";return r}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(!(t=e&&e.isNode?e.isShaderCallNodeInternal?e.shaderNode.subBuilds:e.isStackNode?[e.subBuild]:this.getDataFromNode(e,"any").subBuilds:e instanceof Set?[...e]:e))return null;let r=this.subBuildLayers;for(let e=t.length-1;e>=0;e--){let n=t[e];if(r.includes(n))return n}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(e=null!==r?this.getClosestSubBuild(r):this.subBuildFn)?t?e+"_"+t:e:t}build(){let{object:e,material:t,renderer:r}=this;if(null!==t){let e=r.library.fromMaterial(t);null===e&&(console.error('NodeMaterial: Material "'.concat(t.type,'" is not compatible.')),e=new w3),e.build(this)}else this.addFlow("compute",e);for(let e of yh)for(let t of(this.setBuildStage(e),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex),yd))for(let r of(this.setShaderStage(t),this.flowNodes[t]))"generate"===e?this.flowNode(r):r.build(this);return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if("float"===t||"int"===t||"uint"===t)return new I1(e);if("vec2"===t||"ivec2"===t||"uvec2"===t)return new I2(e);if("vec3"===t||"ivec3"===t||"uvec3"===t)return new I3(e);if("vec4"===t||"ivec4"===t||"uvec4"===t)return new I4(e);if("color"===t)return new I5(e);if("mat2"===t)return new I6(e);if("mat3"===t)return new I7(e);if("mat4"===t)return new I8(e);throw Error('Uniform "'.concat(t,'" not declared.'))}format(e,t,r){if(t=this.getVectorType(t),r=this.getVectorType(r),t===r||null===r||this.isReference(r))return e;let n=this.getTypeLength(t),i=this.getTypeLength(r);return 16===n&&9===i?"".concat(this.getType(r),"( ").concat(e,"[ 0 ].xyz, ").concat(e,"[ 1 ].xyz, ").concat(e,"[ 2 ].xyz )"):9===n&&4===i?"".concat(this.getType(r),"( ").concat(e,"[ 0 ].xy, ").concat(e,"[ 1 ].xy )"):n>4||i>4||0===i?e:n===i?"".concat(this.getType(r),"( ").concat(e," )"):n>i?(e="bool"===r?"all( ".concat(e," )"):"".concat(e,".").concat("xyz".slice(0,i)),this.format(e,this.getTypeFromLength(i,this.getComponentType(t)),r)):4===i&&n>1?"".concat(this.getType(r),"( ").concat(this.format(e,t,"vec3"),", 1.0 )"):2===n?"".concat(this.getType(r),"( ").concat(this.format(e,t,"vec2"),", 0.0 )"):(1===n&&i>1&&t!==this.getComponentType(r)&&(e="".concat(this.getType(this.getComponentType(r)),"( ").concat(e," )")),"".concat(this.getType(r),"( ").concat(e," )"))}getSignature(){return"// Three.js r".concat("180"," - Node System\n")}constructor(e,t,r){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=r,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=Rj(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new IH,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.currentStack=null,this.subBuildFn=null}}class Ln{_getMaps(e,t){let r=e.get(t);return void 0===r&&(r={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,r)),r}updateBeforeNode(e){let t=e.getUpdateBeforeType(),r=e.updateReference(this);if(t===yl.FRAME){let{frameMap:t}=this._getMaps(this.updateBeforeMap,r);t.get(r)!==this.frameId&&!1!==e.updateBefore(this)&&t.set(r,this.frameId)}else if(t===yl.RENDER){let{renderMap:t}=this._getMaps(this.updateBeforeMap,r);t.get(r)!==this.renderId&&!1!==e.updateBefore(this)&&t.set(r,this.renderId)}else t===yl.OBJECT&&e.updateBefore(this)}updateAfterNode(e){let t=e.getUpdateAfterType(),r=e.updateReference(this);if(t===yl.FRAME){let{frameMap:t}=this._getMaps(this.updateAfterMap,r);t.get(r)!==this.frameId&&!1!==e.updateAfter(this)&&t.set(r,this.frameId)}else if(t===yl.RENDER){let{renderMap:t}=this._getMaps(this.updateAfterMap,r);t.get(r)!==this.renderId&&!1!==e.updateAfter(this)&&t.set(r,this.renderId)}else t===yl.OBJECT&&e.updateAfter(this)}updateNode(e){let t=e.getUpdateType(),r=e.updateReference(this);if(t===yl.FRAME){let{frameMap:t}=this._getMaps(this.updateMap,r);t.get(r)!==this.frameId&&!1!==e.update(this)&&t.set(r,this.frameId)}else if(t===yl.RENDER){let{renderMap:t}=this._getMaps(this.updateMap,r);t.get(r)!==this.renderId&&!1!==e.update(this)&&t.set(r,this.renderId)}else t===yl.OBJECT&&e.update(this)}update(){this.frameId++,void 0===this.lastTime&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}}class Li{constructor(e,t,r=null,n="",i=!1){this.type=e,this.name=t,this.count=r,this.qualifier=n,this.isConst=i}}Li.isNodeFunctionInput=!0;class La extends Pk{static get type(){return"DirectionalLightNode"}setupDirect(){let e=this.colorNode;return{lightDirection:Ps(this.light),lightColor:e}}constructor(e=null){super(e)}}let Ls=new tp,Lo=new tp,Ll=null;class Lu extends Pk{static get type(){return"RectAreaLightNode"}update(e){super.update(e);let{light:t}=this,r=e.camera.matrixWorldInverse;Lo.identity(),Ls.copy(t.matrixWorld),Ls.premultiply(r),Lo.extractRotation(Ls),this.halfWidth.value.set(.5*t.width,0,0),this.halfHeight.value.set(0,.5*t.height,0),this.halfWidth.value.applyMatrix4(Lo),this.halfHeight.value.applyMatrix4(Lo)}setupDirectRectArea(e){let t,r;e.isAvailable("float32Filterable")?(t=bL(Ll.LTC_FLOAT_1),r=bL(Ll.LTC_FLOAT_2)):(t=bL(Ll.LTC_HALF_1),r=bL(Ll.LTC_HALF_2));let{colorNode:n,light:i}=this;return{lightColor:n,lightPosition:Pa(i),halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:r}}static setLTC(e){Ll=e}constructor(e=null){super(e),this.halfHeight=xi(new ex).setGroup(xt),this.halfWidth=xi(new ex).setGroup(xt),this.updateType=yl.RENDER}}class Lc extends Pk{static get type(){return"SpotLightNode"}update(e){super.update(e);let{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){let{coneCosNode:r,penumbraCosNode:n}=this;return _L(r,n,t)}getLightCoord(e){let t=e.getNodeProperties(this),r=t.projectionUV;return void 0===r&&(t.projectionUV=r=Pr(this.light,e.context.positionWorld)),r}setupDirect(e){let t,r,{colorNode:n,cutoffDistanceNode:i,decayExponentNode:a,light:s}=this,o=this.getLightVector(e),l=o.normalize(),u=l.dot(Ps(s)),c=this.getSpotAttenuation(e,u),h=Pz({lightDistance:o.length(),cutoffDistance:i,decayExponent:a}),d=n.mul(c).mul(h);return s.colorNode?(r=this.getLightCoord(e),t=s.colorNode(r)):s.map&&(r=this.getLightCoord(e),t=bL(s.map,r.xy).onRenderUpdate(()=>s.map)),t&&(d=r.mul(2).sub(1).abs().lessThan(1).all().select(d.mul(t),d)),{lightColor:d,lightDirection:l}}constructor(e=null){super(e),this.coneCosNode=xi(0).setGroup(xt),this.penumbraCosNode=xi(0).setGroup(xt),this.cutoffDistanceNode=xi(0).setGroup(xt),this.decayExponentNode=xi(0).setGroup(xt),this.colorNode=xi(this.color).setGroup(xt)}}class Lh extends Lc{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){let r=this.light.iesMap;return r&&!0===r.isTexture?bL(r,vA(t.acos().mul(1/Math.PI),0),0).r:super.getSpotAttenuation(t)}}let Ld=vn(e=>{let[t,r]=e,n=t.abs().sub(r);return _t(_f(n,0)).add(_p(_f(n.x,n.y),0))});class LA extends Lc{static get type(){return"ProjectorLightNode"}update(e){super.update(e);let t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),null===t.aspect){let e=1;null!==t.map&&(e=t.map.width/t.map.height),t.shadow.aspect=e}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){let t=vu(0),r=this.penumbraCosNode,n=Pt(this.light).mul(e.context.positionWorld||S_);return vs(n.w.greaterThan(0),()=>{let e=Ld(n.xyz.div(n.w).xy.sub(vA(.5)),vA(.5)),i=xf(-1,xA(1,x7(r)).sub(1));t.assign(_P(e.mul(-2).mul(i)))}),t}}class Lp extends Pk{static get type(){return"AmbientLightNode"}setup(e){let{context:t}=e;t.irradiance.addAssign(this.colorNode)}constructor(e=null){super(e)}}class Lf extends Pk{static get type(){return"HemisphereLightNode"}update(e){let{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){let{colorNode:t,groundColorNode:r,lightDirectionNode:n}=this,i=_C(r,t,SD.dot(n).mul(.5).add(.5));e.context.irradiance.addAssign(i)}constructor(e=null){super(e),this.lightPositionNode=Pn(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=xi(new t6).setGroup(xt)}}class Lm extends Pk{static get type(){return"LightProbeNode"}update(e){let{light:t}=this;super.update(e);for(let e=0;e<9;e++)this.lightProbe.array[e].copy(t.sh.coefficients[e]).multiplyScalar(t.intensity)}setup(e){let t=IP(SD,this.lightProbe);e.context.irradiance.addAssign(t)}constructor(e=null){super(e);let t=[];for(let e=0;e<9;e++)t.push(new ex);this.lightProbe=bk(t)}}class Lg{parseFunction(){console.warn("Abstract function.")}}class Ly{getCode(){console.warn("Abstract function.")}constructor(e,t,r="",n=""){this.type=e,this.inputs=t,this.name=r,this.precision=n}}Ly.isNodeFunction=!0;let Lv=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,Lx=/[a-z_0-9]+/ig,L_="#pragma main";class Lb extends Ly{getCode(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name,r=this.blockCode;if(""!==r){let{type:n,inputsCode:i,headerCode:a,precision:s}=this,o="".concat(n," ").concat(t," ( ").concat(i.trim()," )");""!==s&&(o="".concat(s," ").concat(o)),e=a+o+r}else e="";return e}constructor(e){let{type:t,inputs:r,name:n,precision:i,inputsCode:a,blockCode:s,headerCode:o}=(e=>{let t=(e=e.trim()).indexOf(L_),r=-1!==t?e.slice(t+L_.length):e,n=r.match(Lv);if(null!==n&&5===n.length){let i=n[4],a=[],s=null;for(;null!==(s=Lx.exec(i));)a.push(s);let o=[],l=0;for(;l<a.length;){let e="const"===a[l][0];!0===e&&l++;let t=a[l][0];"in"===t||"out"===t||"inout"===t?l++:t="";let r=a[l++][0],n=Number.parseInt(a[l][0]);!1===Number.isNaN(n)?l++:n=null;let i=a[l++][0];o.push(new Li(r,i,n,t,e))}let u=r.substring(n[0].length),c=void 0!==n[3]?n[3]:"",h=n[2];return{type:h,inputs:o,name:c,precision:void 0!==n[1]?n[1]:"",inputsCode:i,blockCode:u,headerCode:-1!==t?e.slice(0,t):""}}throw Error("FunctionNode: Function is not a GLSL code.")})(e);super(t,r,n,i),this.inputsCode=a,this.blockCode=s,this.headerCode=o}}class LS extends Lg{parseFunction(e){return new Lb(e)}}let LT=new WeakMap,Lw=[],LM=[];class LE extends Rp{updateGroup(e){let t=e.groupNode,r=t.name;if(r===xr.name)return!0;if(r===xt.name){let t=this.get(e),r=this.nodeFrame.renderId;return t.renderId!==r&&(t.renderId=r,!0)}if(r===xe.name){let t=this.get(e),r=this.nodeFrame.frameId;return t.frameId!==r&&(t.frameId=r,!0)}Lw[0]=t,Lw[1]=e;let n=this.groupsData.get(Lw);return void 0===n&&this.groupsData.set(Lw,n={}),Lw.length=0,n.version!==t.version&&(n.version=t.version,!0)}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){let t=this.get(e),r=t.nodeBuilderState;if(void 0===r){let{nodeBuilderCache:n}=this,i=this.getForRenderCacheKey(e);if(void 0===(r=n.get(i))){let t=this.backend.createNodeBuilder(e.object,this.renderer);t.scene=e.scene,t.material=e.material,t.camera=e.camera,t.context.material=e.material,t.lightsNode=e.lightsNode,t.environmentNode=this.getEnvironmentNode(e.scene),t.fogNode=this.getFogNode(e.scene),t.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&t.enableMultiview(),t.build(),r=this._createNodeBuilderState(t),n.set(i,r)}r.usedTimes++,t.nodeBuilderState=r}return r}delete(e){if(e.isRenderObject){let t=this.get(e).nodeBuilderState;t.usedTimes--,0===t.usedTimes&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){let t=this.get(e),r=t.nodeBuilderState;if(void 0===r){let n=this.backend.createNodeBuilder(e,this.renderer);n.build(),t.nodeBuilderState=r=this._createNodeBuilderState(n)}return r}_createNodeBuilderState(e){return new IU(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{let r=this.get(e);r.environmentNode&&(t=r.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{let r=this.get(e);r.backgroundNode&&(t=r.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){Lw[0]=e,Lw[1]=t;let r=this.renderer.info.calls,n=this.callHashCache.get(Lw)||{};if(n.callId!==r){let i=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&LM.push(t.getCacheKey(!0)),i&&LM.push(i.getCacheKey()),a&&LM.push(a.getCacheKey()),LM.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),LM.push(+!!this.renderer.shadowMap.enabled),n.callId=r,n.cacheKey=g4(LM),this.callHashCache.set(Lw,n),LM.length=0}return Lw.length=0,n.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){let t=this.get(e),r=e.background;if(r){let n=0===e.backgroundBlurriness&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&0===t.backgroundBlurriness;(t.background!==r||n)&&(t.backgroundNode=this.getCacheNode("background",r,()=>{if(!0===r.isCubeTexture||303===r.mapping||304===r.mapping||306===r.mapping)if(e.backgroundBlurriness>0||306===r.mapping)return EW(r);else return Ml(!0===r.isCubeTexture?SJ(r):bL(r));if(!0===r.isTexture)return bL(r,bG.flipY()).setUpdateMatrix(!0);!0!==r.isColor&&console.error("WebGPUNodes: Unsupported background configuration.",r)},n),t.background=r,t.backgroundBlurriness=e.backgroundBlurriness)}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap),a=i.get(t);return(void 0===a||n)&&(a=r(),i.set(t,a)),a}updateFog(e){let t=this.get(e),r=e.fog;r?t.fog!==r&&(t.fogNode=this.getCacheNode("fog",r,()=>{if(r.isFogExp2)return N_(S1("color","color",r).setGroup(xt),Nx(S1("density","float",r).setGroup(xt)));if(r.isFog){let e=S1("color","color",r).setGroup(xt);return N_(e,Nv(S1("near","float",r).setGroup(xt),S1("far","float",r).setGroup(xt)))}console.error("THREE.Renderer: Unsupported fog configuration.",r)}),t.fog=r):(delete t.fogNode,delete t.fog)}updateEnvironment(e){let t=this.get(e),r=e.environment;r?t.environment!==r&&(t.environmentNode=this.getCacheNode("environment",r,()=>!0===r.isCubeTexture?SJ(r):!0===r.isTexture?bL(r):void console.error("Nodes: Unsupported environment configuration.",r)),t.environment=r):t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderer,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=r,a.camera=n,a.material=i,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){let e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return LT.get(e)!==this.getOutputCacheKey()}getOutputNode(e){let t=this.renderer,r=this.getOutputCacheKey(),n=e.isArrayTexture?Cj(e,vg(bG,bz("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):bL(e,bG).renderOutput(t.toneMapping,t.currentColorSpace);return LT.set(e,r),n}updateBefore(e){for(let t of e.getNodeBuilderState().updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(t)}updateAfter(e){for(let t of e.getNodeBuilderState().updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(t)}updateForCompute(e){let t=this.getNodeFrame();for(let r of this.getForCompute(e).updateNodes)t.updateNode(r)}updateForRender(e){let t=this.getNodeFrameForRender(e);for(let r of e.getNodeBuilderState().updateNodes)t.updateNode(r)}needsRefresh(e){let t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new Ln,this.nodeBuilderCache=new Map,this.cacheLib={}}constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new Ln,this.nodeBuilderCache=new Map,this.callHashCache=new Ru,this.groupsData=new Ru,this.cacheLib={}}}let LR=new nG;class LC{projectPlanes(e,t,r){let n=e.length;for(let i=0;i<n;i++){LR.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);let n=t[r+i],a=LR.normal;n.x=-a.x,n.y=-a.y,n.z=-a.z,n.w=LR.constant}}updateGlobal(e,t){this.shadowPass=null!==e.overrideMaterial&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let r,n,i=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);let a=t.clippingPlanes,s=a.length;if(this.clipIntersection?(r=this.intersectionPlanes,n=e.intersectionPlanes.length):(r=this.unionPlanes,n=e.unionPlanes.length),r.length!==n+s){r.length=n+s;for(let e=0;e<s;e++)r[n+e]=new eH;i=!0}this.projectPlanes(a,r,n),i&&(this.version++,this.cacheKey="".concat(this.intersectionPlanes.length,":").concat(this.unionPlanes.length))}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return void 0===t&&(t=new LC(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new eS,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,null!==e&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}}class LN{constructor(e,t){this.bundleGroup=e,this.camera=t}}let LP=[];class LI{get(e,t){let r=this.bundles;LP[0]=e,LP[1]=t;let n=r.get(LP);return void 0===n&&(n=new LN(e,t),r.set(LP,n)),LP.length=0,n}dispose(){this.bundles=new Ru}constructor(){this.bundles=new Ru}}class LL{fromMaterial(e){if(e.isNodeMaterial)return e;let t=null,r=this.getMaterialNodeClass(e.type);if(null!==r)for(let n in t=new r,e)t[n]=e[n];return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,r){if(r.has(t))return void console.warn("Redefinition of node ".concat(t));if("function"!=typeof e)throw Error("Node class ".concat(e.name," is not a class."));if("function"==typeof t||"object"==typeof t)throw Error("Base class ".concat(t," is not a class."));r.set(t,e)}addClass(e,t,r){if(r.has(t))return void console.warn("Redefinition of node ".concat(t.name));if("function"!=typeof e)throw Error("Node class ".concat(e.name," is not a class."));if("function"!=typeof t)throw Error("Base class ".concat(t.name," is not a class."));r.set(t,e)}constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}}let LD=new Pc,LB=[];class LF extends Ru{createNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Pc().setLights(e)}getNode(e,t){if(e.isQuadMesh)return LD;LB[0]=e,LB[1]=t;let r=this.get(LB);return void 0===r&&(r=this.createNode(),this.set(LB,r)),LB.length=0,r}constructor(){super()}}class LU extends ej{copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}constructor(e=1,t=1,r={}){super(e,t,r),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}}let LO=new ex,Lk=new ex;class Lz extends es{getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(null!==this._glProjLayer||null!==this._glBaseLayer)return this._foveation}setFoveation(e){this._foveation=e,null!==this._glProjLayer&&(this._glProjLayer.fixedFoveation=e),null!==this._glBaseLayer&&void 0!==this._glBaseLayer.fixedFoveation&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(null!==this._session)return this._session.environmentBlendMode}getBinding(){return null===this._glBinding&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,r,n,i,a,s){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},l=new aP(e,t),u=new LU(i,a,{format:1023,type:1009,depthTexture:new iD(i,a,o.stencil?1020:1014,void 0,void 0,void 0,void 0,void 0,void 0,o.stencil?1027:1026),stencilBuffer:o.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});u._autoAllocateDepthBuffer=!0;let c=new re({color:0xffffff,side:0});c.map=u.texture,c.map.offset.y=1,c.map.repeat.y=-1;let h=new rU(l,c);h.position.copy(r),h.quaternion.copy(n);let d={type:"quad",width:e,height:t,translation:r,quaternion:n,pixelwidth:i,pixelheight:a,plane:h,material:c,rendercall:s,renderTarget:u};if(this._layers.push(d),null!==this._session){d.plane.material=new re({color:0xffffff,side:0}),d.plane.material.blending=5,d.plane.material.blendEquation=100,d.plane.material.blendSrc=200,d.plane.material.blendDst=200,d.xrlayer=this._createXRLayer(d);let e=this._session.renderState.layers;e.unshift(d.xrlayer),this._session.updateRenderState({layers:e})}else u.isXRRenderTarget=!1;return h}createCylinderLayer(e,t,r,n,i,a,s,o){let l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{},u=new iO(e,e,e*t/r,64,64,!0,Math.PI-t/2,t),c=new LU(a,s,{format:1023,type:1009,depthTexture:new iD(a,s,l.stencil?1020:1014,void 0,void 0,void 0,void 0,void 0,void 0,l.stencil?1027:1026),stencilBuffer:l.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});c._autoAllocateDepthBuffer=!0;let h=new re({color:0xffffff,side:1});h.map=c.texture,h.map.offset.y=1,h.map.repeat.y=-1;let d=new rU(u,h);d.position.copy(n),d.quaternion.copy(i);let A={type:"cylinder",radius:e,centralAngle:t,aspectratio:r,translation:n,quaternion:i,pixelwidth:a,pixelheight:s,plane:d,material:h,rendercall:o,renderTarget:c};if(this._layers.push(A),null!==this._session){A.plane.material=new re({color:0xffffff,side:1}),A.plane.material.blending=5,A.plane.material.blendEquation=100,A.plane.material.blendSrc=200,A.plane.material.blendDst=200,A.xrlayer=this._createXRLayer(A);let e=this._session.renderState.layers;e.unshift(A.xrlayer),this._session.updateRenderState({layers:e})}else c.isXRRenderTarget=!1;return d}renderLayers(){let e=new ex,t=new ev,r=this._renderer,n=this.isPresenting,i=r.getOutputRenderTarget(),a=r._frameBufferTarget;this.isPresenting=!1;let s=new ey;r.getSize(s);let o=r._quad;for(let n of this._layers)if(n.renderTarget.isXRRenderTarget=null!==this._session,n.renderTarget._hasExternalTextures=n.renderTarget.isXRRenderTarget,n.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){n.xrlayer.transform=new XRRigidTransform(n.plane.getWorldPosition(e),n.plane.getWorldQuaternion(t));let i=this._glBinding.getSubImage(n.xrlayer,this._xrFrame);r.backend.setXRRenderTargetTextures(n.renderTarget,i.colorTexture,void 0),r._setXRLayerSize(n.renderTarget.width,n.renderTarget.height),r.setOutputRenderTarget(n.renderTarget),r.setRenderTarget(null),r._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);let{frameBufferTarget:a,quad:s}=this._frameBufferTargets.get(n.renderTarget)||{frameBufferTarget:null,quad:null};a?(r._frameBufferTarget=a,r._quad=s):(r._quad=new CT(new w3),this._frameBufferTargets.set(n.renderTarget,{frameBufferTarget:r._getFrameBufferTarget(),quad:r._quad})),n.rendercall(),r._frameBufferTarget=null}else r.setRenderTarget(n.renderTarget),n.rendercall();r.setRenderTarget(null),r.setOutputRenderTarget(i),r._frameBufferTarget=a,r._setXRLayerSize(s.x,s.y),r._quad=o,this.isPresenting=n}getSession(){return this._session}async setSession(e){let t=this._renderer,r=t.backend;this._gl=t.getContext();let n=this._gl,i=n.getContextAttributes();if(this._session=e,null!==e){if(!0===r.isWebGPUBackend)throw Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await r.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),!0===this._supportsLayers){let r=null,a=null,s=null;t.depth&&(s=t.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,r=t.stencil?1027:1026,a=t.stencil?1020:1014);let o={colorFormat:n.RGBA8,depthFormat:s,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(o.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();let l=this._glBinding.createProjectionLayer(o),u=[l];this._glProjLayer=l,t.setPixelRatio(1),t._setXRLayerSize(l.textureWidth,l.textureHeight);let c=this._useMultiview?2:1,h=new iD(l.textureWidth,l.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,r,c);if(this._xrRenderTarget=new LU(l.textureWidth,l.textureHeight,{format:1023,type:1009,colorSpace:t.outputColorSpace,depthTexture:h,stencilBuffer:t.stencil,samples:4*!!i.antialias,resolveDepthBuffer:!1===l.ignoreDepthValues,resolveStencilBuffer:!1===l.ignoreDepthValues,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(let e of this._layers)e.plane.material=new re({color:0xffffff,side:+("cylinder"===e.type)}),e.plane.material.blending=5,e.plane.material.blendEquation=100,e.plane.material.blendSrc=200,e.plane.material.blendDst=200,e.xrlayer=this._createXRLayer(e),u.unshift(e.xrlayer);e.updateRenderState({layers:u})}else{let r=new XRWebGLLayer(e,n,{antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()});this._glBaseLayer=r,e.updateRenderState({baseLayer:r}),t.setPixelRatio(1),t._setXRLayerSize(r.framebufferWidth,r.framebufferHeight),this._xrRenderTarget=new LU(r.framebufferWidth,r.framebufferHeight,{format:1023,type:1009,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:!1===r.ignoreDepthValues,resolveStencilBuffer:!1===r.ignoreDepthValues}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){var t,r,n;let i=this._session;if(null===i)return;let a=e.near,s=e.far,o=this._cameraXR,l=this._cameraL,u=this._cameraR;o.near=u.near=l.near=a,o.far=u.far=l.far=s,o.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==o.near||this._currentDepthFar!==o.far)&&(i.updateRenderState({depthNear:o.near,depthFar:o.far}),this._currentDepthNear=o.near,this._currentDepthFar=o.far),o.layers.mask=6|e.layers.mask,l.layers.mask=3&o.layers.mask,u.layers.mask=5&o.layers.mask;let c=e.parent,h=o.cameras;LV(o,c);for(let e=0;e<h.length;e++)LV(h[e],c);2===h.length?function(e,t,r){LO.setFromMatrixPosition(t.matrixWorld),Lk.setFromMatrixPosition(r.matrixWorld);let n=LO.distanceTo(Lk),i=t.projectionMatrix.elements,a=r.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=n/(-c+h),A=-(d*c);if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(A),e.translateZ(d),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{let t=s+d,r=o+d;e.projectionMatrix.makePerspective(s*c-A,s*h+(n-A),l*o/r*t,u*o/r*t,t,r),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(o,l,u):o.projectionMatrix.copy(l.projectionMatrix),t=e,r=o,null===(n=c)?t.matrix.copy(r.matrixWorld):(t.matrix.copy(n.matrixWorld),t.matrix.invert(),t.matrix.multiply(r.matrixWorld)),t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(r.projectionMatrix),t.projectionMatrixInverse.copy(r.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*ec*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}_getController(e){let t=this._controllers[e];return void 0===t&&(t=new r1,this._controllers[e]=t),t}constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new rY,this._cameraL.viewport=new eH,this._cameraR=new rY,this._cameraR.viewport=new eH,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new s5,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding="undefined"!=typeof XRWebGLBinding,this._frameBufferTargets=null,this._createXRLayer=Lj.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new ey,this._onSessionEvent=Lq.bind(this),this._onSessionEnd=LG.bind(this),this._onInputSourcesChange=LH.bind(this),this._onAnimationFrame=LW.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}}function LV(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}function Lq(e){let t=this._controllerInputSources.indexOf(e.inputSource);if(-1===t)return;let r=this._controllers[t];if(void 0!==r){let t=this.getReferenceSpace();r.update(e.inputSource,e.frame,t),r.dispatchEvent({type:e.type,data:e.inputSource})}}function LG(){let e=this._session,t=this._renderer;e.removeEventListener("select",this._onSessionEvent),e.removeEventListener("selectstart",this._onSessionEvent),e.removeEventListener("selectend",this._onSessionEvent),e.removeEventListener("squeeze",this._onSessionEvent),e.removeEventListener("squeezestart",this._onSessionEvent),e.removeEventListener("squeezeend",this._onSessionEvent),e.removeEventListener("end",this._onSessionEnd),e.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let e=0;e<this._controllers.length;e++){let t=this._controllerInputSources[e];null!==t&&(this._controllerInputSources[e]=null,this._controllers[e].disconnect(t))}if(this._currentDepthNear=null,this._currentDepthFar=null,t._resetXRState(),this._session=null,this._xrRenderTarget=null,!0===this._sessionUsesLayers)for(let e of this._layers)e.renderTarget=new LU(e.pixelwidth,e.pixelheight,{format:1023,type:1009,depthTexture:new iD(e.pixelwidth,e.pixelheight,e.stencilBuffer?1020:1014,void 0,void 0,void 0,void 0,void 0,void 0,e.stencilBuffer?1027:1026),stencilBuffer:e.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),e.renderTarget.isXRRenderTarget=!1,e.plane.material=e.material,e.material.map=e.renderTarget.texture,e.material.map.offset.y=1,e.material.map.repeat.y=-1,delete e.xrlayer;this.isPresenting=!1,this._useMultiview=!1,t._animation.stop(),t._animation.setAnimationLoop(this._currentAnimationLoop),t._animation.setContext(this._currentAnimationContext),t._animation.start(),t.setPixelRatio(this._currentPixelRatio),t.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function LH(e){let t=this._controllers,r=this._controllerInputSources;for(let n=0;n<e.removed.length;n++){let i=e.removed[n],a=r.indexOf(i);a>=0&&(r[a]=null,t[a].disconnect(i))}for(let n=0;n<e.added.length;n++){let i=e.added[n],a=r.indexOf(i);if(-1===a){for(let e=0;e<t.length;e++)if(e>=r.length){r.push(i),a=e;break}else if(null===r[e]){r[e]=i,a=e;break}if(-1===a)break}let s=t[a];s&&s.connect(i)}}function Lj(e){return"quad"===e.type?this._glBinding.createQuadLayer({transform:new XRRigidTransform(e.translation,e.quaternion),width:e.width/2,height:e.height/2,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(e.translation,e.quaternion),radius:e.radius,centralAngle:e.centralAngle,aspectRatio:e.aspectRatio,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight,clearOnAccess:!1})}function LW(e,t){if(void 0===t)return;let r=this._cameraXR,n=this._renderer,i=n.backend,a=this._glBaseLayer,s=this.getReferenceSpace(),o=t.getViewerPose(s);if(this._xrFrame=t,null!==o){let e=o.views;null!==this._glBaseLayer&&i.setXRTarget(a.framebuffer);let t=!1;e.length!==r.cameras.length&&(r.cameras.length=0,t=!0);for(let n=0;n<e.length;n++){let s,o=e[n];if(!0===this._supportsLayers){let e=this._glBinding.getViewSubImage(this._glProjLayer,o);s=e.viewport,0===n&&i.setXRRenderTargetTextures(this._xrRenderTarget,e.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:e.depthStencilTexture)}else s=a.getViewport(o);let l=this._cameras[n];void 0===l&&((l=new rY).layers.enable(n),l.viewport=new eH,this._cameras[n]=l),l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.quaternion,l.scale),l.projectionMatrix.fromArray(o.projectionMatrix),l.projectionMatrixInverse.copy(l.projectionMatrix).invert(),l.viewport.set(s.x,s.y,s.width,s.height),0===n&&(r.matrix.copy(l.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),!0===t&&r.cameras.push(l)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let e=0;e<this._controllers.length;e++){let r=this._controllerInputSources[e],n=this._controllers[e];null!==r&&void 0!==n&&n.update(r,t,s)}this._currentAnimationLoop&&this._currentAnimationLoop(e,t),t.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:t}),this._xrFrame=null}let LX=new r4,LQ=new ey,LY=new eH,LK=new nX,LZ=new nK,LJ=new tp,L$=new eH;class L0{async init(){if(this._initialized)throw Error("Renderer: Backend has already been initialized.");return null!==this._initPromise||(this._initPromise=new Promise(async(e,t)=>{let r=this.backend;try{await r.init(this)}catch(e){if(null===this._getFallback)return void t(e);try{this.backend=r=this._getFallback(e),await r.init(this)}catch(e){t(e);return}}this._nodes=new LE(this,r),this._animation=new Rl(this._nodes,this.info),this._attributes=new Rm(r),this._background=new ID(this,this._nodes),this._geometries=new Rv(this._attributes,this.info),this._textures=new Rq(this,r,this.info),this._pipelines=new RM(r,this._nodes),this._bindings=new RE(r,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new RA(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new RL(this.lighting),this._bundles=new LI,this._renderContexts=new Rz,this._animation.start(),this._initialized=!0,e(this)})),this._initPromise}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!0===this._isDeviceLost)return;!1===this._initialized&&await this.init();let n=this._nodes.nodeFrame,i=n.renderId,a=this._currentRenderContext,s=this._currentRenderObjectFunction,o=this._compilationPromises,l=!0===e.isScene?e:LX;null===r&&(r=e);let u=this._renderTarget,c=this._renderContexts.get(r,t,u),h=this._activeMipmapLevel,d=[];this._currentRenderContext=c,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=d,n.renderId++,n.update(),c.depth=this.depth,c.stencil=this.stencil,c.clippingContext||(c.clippingContext=new LC),c.clippingContext.updateGlobal(l,t),l.onBeforeRender(this,e,t,u);let A=this._renderLists.get(e,t);if(A.begin(),this._projectObject(e,t,0,A,c.clippingContext),r!==e&&r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&A.pushLight(e)}),A.finish(),null!==u){this._textures.updateRenderTarget(u,h);let e=this._textures.get(u);c.textures=e.textures,c.depthTexture=e.depthTexture}else c.textures=null,c.depthTexture=null;this._background.update(l,A,c);let p=A.opaque,f=A.transparent,m=A.transparentDoublePass,g=A.lightsNode;!0===this.opaque&&p.length>0&&this._renderObjects(p,t,l,g),!0===this.transparent&&f.length>0&&this._renderTransparents(f,m,t,l,g),n.renderId=i,this._currentRenderContext=a,this._currentRenderObjectFunction=s,this._compilationPromises=o,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(d)}async renderAsync(e,t){!1===this._initialized&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){!0===e?(this.overrideNodes.modelViewMatrix=Sm,this.overrideNodes.modelNormalViewMatrix=Sg):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===Sm&&this.overrideNodes.modelNormalViewMatrix===Sg}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t="THREE.WebGPURenderer: ".concat(e.api," Device Lost:\n\nMessage: ").concat(e.message);e.reason&&(t+="\nReason: ".concat(e.reason)),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,r){let{bundleGroup:n,camera:i,renderList:a}=e,s=this._currentRenderContext,o=this._bundles.get(n,i),l=this.backend.get(o);void 0===l.renderContexts&&(l.renderContexts=new Set);let u=n.version!==l.version,c=!1===l.renderContexts.has(s)||u;if(l.renderContexts.add(s),c){this.backend.beginBundle(s),(void 0===l.renderObjects||u)&&(l.renderObjects=[]),this._currentRenderBundle=o;let{transparentDoublePass:e,transparent:c,opaque:h}=a;!0===this.opaque&&h.length>0&&this._renderObjects(h,i,t,r),!0===this.transparent&&c.length>0&&this._renderTransparents(c,e,i,t,r),this._currentRenderBundle=null,this.backend.finishBundle(s,o),l.version=n.version}else{let{renderObjects:e}=l;for(let t=0,r=e.length;t<r;t++){let r=e[t];this._nodes.needsRefresh(r)&&(this._nodes.updateBefore(r),this._nodes.updateForRender(r),this._bindings.updateForRender(r),this._nodes.updateAfter(r))}}this.backend.addBundle(s,o)}render(e,t){if(!1===this._initialized)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){let{currentToneMapping:e,currentColorSpace:t}=this,r=t!==eD.workingColorSpace;if(!1==(0!==e)&&!1===r)return null;let{width:n,height:i}=this.getDrawingBufferSize(LQ),{depth:a,stencil:s}=this,o=this._frameBufferTarget;null===o&&((o=new ej(n,i,{depthBuffer:a,stencilBuffer:s,type:this._colorBufferType,format:1023,colorSpace:eD.workingColorSpace,generateMipmaps:!1,minFilter:1006,magFilter:1006,samples:this.samples})).isPostProcessingRenderTarget=!0,this._frameBufferTarget=o);let l=this.getOutputRenderTarget();return o.depthBuffer=a,o.stencilBuffer=s,null!==l?o.setSize(l.width,l.height,l.depth):o.setSize(n,i,1),o.viewport.copy(this._viewport),o.scissor.copy(this._scissor),o.viewport.multiplyScalar(this._pixelRatio),o.scissor.multiplyScalar(this._pixelRatio),o.scissorTest=this._scissorTest,o.multiview=null!==l&&l.multiview,o.resolveDepthBuffer=null===l||l.resolveDepthBuffer,o._autoAllocateDepthBuffer=null!==l&&l._autoAllocateDepthBuffer,o}_renderScene(e,t){let r,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!0===this._isDeviceLost)return;let i=n?this._getFrameBufferTarget():null,a=this._nodes.nodeFrame,s=a.renderId,o=this._currentRenderContext,l=this._currentRenderObjectFunction,u=!0===e.isScene?e:LX,c=this._renderTarget||this._outputRenderTarget,h=this._activeCubeFace,d=this._activeMipmapLevel;null!==i?(r=i,this.setRenderTarget(r)):r=c;let A=this._renderContexts.get(e,t,r);this._currentRenderContext=A,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,a.renderId=this.info.calls;let p=this.coordinateSystem,f=this.xr;if(t.coordinateSystem!==p&&!1===f.isPresenting&&(t.coordinateSystem=p,t.updateProjectionMatrix(),t.isArrayCamera))for(let e of t.cameras)e.coordinateSystem=p,e.updateProjectionMatrix();!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===f.enabled&&!0===f.isPresenting&&(!0===f.cameraAutoUpdate&&f.updateCamera(t),t=f.getCamera());let m=this._viewport,g=this._scissor,y=this._pixelRatio;null!==r&&(m=r.viewport,g=r.scissor,y=1),this.getDrawingBufferSize(LQ),LY.set(0,0,LQ.width,LQ.height);let v=void 0===m.minDepth?0:m.minDepth,x=void 0===m.maxDepth?1:m.maxDepth;A.viewportValue.copy(m).multiplyScalar(y).floor(),A.viewportValue.width>>=d,A.viewportValue.height>>=d,A.viewportValue.minDepth=v,A.viewportValue.maxDepth=x,A.viewport=!1===A.viewportValue.equals(LY),A.scissorValue.copy(g).multiplyScalar(y).floor(),A.scissor=this._scissorTest&&!1===A.scissorValue.equals(LY),A.scissorValue.width>>=d,A.scissorValue.height>>=d,A.clippingContext||(A.clippingContext=new LC),A.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,r);let _=t.isArrayCamera?LZ:LK;t.isArrayCamera||(LJ.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),_.setFromProjectionMatrix(LJ,t.coordinateSystem,t.reversedDepth));let b=this._renderLists.get(e,t);if(b.begin(),this._projectObject(e,t,0,b,A.clippingContext),b.finish(),!0===this.sortObjects&&b.sort(this._opaqueSort,this._transparentSort),null!==r){this._textures.updateRenderTarget(r,d);let e=this._textures.get(r);A.textures=e.textures,A.depthTexture=e.depthTexture,A.width=e.width,A.height=e.height,A.renderTarget=r,A.depth=r.depthBuffer,A.stencil=r.stencilBuffer}else A.textures=null,A.depthTexture=null,A.width=LQ.width,A.height=LQ.height,A.depth=this.depth,A.stencil=this.stencil;A.width>>=d,A.height>>=d,A.activeCubeFace=h,A.activeMipmapLevel=d,A.occlusionQueryCount=b.occlusionQueryCount,A.scissorValue.max(L$.set(0,0,0,0)),A.scissorValue.x+A.scissorValue.width>A.width&&(A.scissorValue.width=Math.max(A.width-A.scissorValue.x,0)),A.scissorValue.y+A.scissorValue.height>A.height&&(A.scissorValue.height=Math.max(A.height-A.scissorValue.y,0)),this._background.update(u,b,A),A.camera=t,this.backend.beginRender(A);let{bundles:S,lightsNode:T,transparentDoublePass:w,transparent:M,opaque:E}=b;return S.length>0&&this._renderBundles(S,u,T),!0===this.opaque&&E.length>0&&this._renderObjects(E,t,u,T),!0===this.transparent&&M.length>0&&this._renderTransparents(M,w,t,u,T),this.backend.finishRender(A),a.renderId=s,this._currentRenderContext=o,this._currentRenderObjectFunction=l,null!==i&&(this.setRenderTarget(c,h,d),this._renderOutput(r)),u.onAfterRender(this,e,t,r),A}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){let t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);let r=this.autoClear,n=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=r,this.xr.enabled=n}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){!1===this._initialized&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,r){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=r,this.domElement.width=Math.floor(e*r),this.domElement.height=Math.floor(t*r),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),!0===r&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){let t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,r,n){let i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,r,n)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=this._viewport;e.isVector4?s.copy(e):s.set(e,t,r,n),s.minDepth=i,s.maxDepth=a}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){let t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!1===this._initialized)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,r);let n=this._renderTarget||this._getFrameBufferTarget(),i=null;if(null!==n){this._textures.updateRenderTarget(n);let e=this._textures.get(n);(i=this._renderContexts.getForClear(n)).textures=e.textures,i.depthTexture=e.depthTexture,i.width=e.width,i.height=e.height,i.renderTarget=n,i.depth=n.depthBuffer,i.stencil=n.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,r,i),null!==n&&null===this._renderTarget&&this._renderOutput(n)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===this._initialized&&await this.init(),this.clear(e,t,r)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:0}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:eD.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||null===this._renderTarget}dispose(){!0===this._initialized&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),null!==this._frameBufferTarget&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{null!==e&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=r}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!0===this._isDeviceLost)return;if(!1===this._initialized)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);let r=this._nodes.nodeFrame,n=r.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,r.renderId=this.info.calls;let i=this.backend,a=this._pipelines,s=this._bindings,o=this._nodes,l=Array.isArray(e)?e:[e];if(void 0===l[0]||!0!==l[0].isComputeNode)throw Error("THREE.Renderer: .compute() expects a ComputeNode.");for(let r of(i.beginCompute(e),l)){if(!1===a.has(r)){let e=()=>{r.removeEventListener("dispose",e),a.delete(r),s.delete(r),o.delete(r)};r.addEventListener("dispose",e);let t=r.onInitFunction;null!==t&&t.call(r,{renderer:this})}o.updateForCompute(r),s.updateForCompute(r);let n=s.getForCompute(r),l=a.getForCompute(r,n);i.compute(e,r,n,l,t)}i.finishCompute(e),r.renderId=n}async computeAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!1===this._initialized&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return!1===this._initialized&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"render";return!1===this._initialized&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return!1===this._initialized?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){!1===this._initialized&&await this.init(),this._textures.updateTexture(e)}initTexture(e){!1===this._initialized&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==r)if(r.isVector2)r=L$.set(r.x,r.y,e.image.width,e.image.height).floor();else{if(!r.isVector4)return void console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");r=L$.copy(r).floor()}else r=L$.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext;null!==n?t=n.renderTarget:null!==(t=this._renderTarget||this._getFrameBufferTarget())&&(this._textures.updateRenderTarget(t),n=this._textures.get(t)),this._textures.updateTexture(e,{renderTarget:t}),this.backend.copyFramebufferToTexture(e,n,r)}copyTextureToTexture(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,r,n,i,a)}async readRenderTargetPixelsAsync(e,t,r,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return this.backend.copyTextureToBuffer(e.textures[a],t,r,n,i,s)}_projectObject(e,t,r,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers)){if(e.isGroup)r=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)n.pushLight(e);else if(e.isSprite){let a=t.isArrayCamera?LZ:LK;if(!e.frustumCulled||a.intersectsSprite(e,t)){!0===this.sortObjects&&L$.setFromMatrixPosition(e.matrixWorld).applyMatrix4(LJ);let{geometry:t,material:a}=e;a.visible&&n.push(e,t,a,r,L$.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){let a=t.isArrayCamera?LZ:LK;if(!e.frustumCulled||a.intersectsObject(e,t)){let{geometry:t,material:a}=e;if(!0===this.sortObjects&&(null===t.boundingSphere&&t.computeBoundingSphere(),L$.copy(t.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(LJ)),Array.isArray(a)){let s=t.groups;for(let o=0,l=s.length;o<l;o++){let l=s[o],u=a[l.materialIndex];u&&u.visible&&n.push(e,t,u,r,L$.z,l,i)}}else a.visible&&n.push(e,t,a,r,L$.z,null,i)}}}if(!0===e.isBundleGroup&&void 0!==this.backend.beginBundle){let r=n;(n=this._renderLists.get(e,t)).begin(),r.pushBundle({bundleGroup:e,camera:t,renderList:n}),n.finish()}let a=e.children;for(let e=0,s=a.length;e<s;e++)this._projectObject(a[e],t,r,n,i)}_renderBundles(e,t,r){for(let n of e)this._renderBundle(n,t,r)}_renderTransparents(e,t,r,n,i){if(t.length>0){for(let{material:e}of t)e.side=1;for(let{material:e}of(this._renderObjects(t,r,n,i,"backSide"),t))e.side=0;for(let{material:a}of(this._renderObjects(e,r,n,i),t))a.side=2}else this._renderObjects(e,r,n,i)}_renderObjects(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;for(let a=0,s=e.length;a<s;a++){let{object:s,geometry:o,material:l,group:u,clippingContext:c}=e[a];this._currentRenderObjectFunction(s,r,t,o,l,u,n,c,i)}}renderObject(e,t,r,n,i,a,s){let o,l,u,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;if(e.onBeforeRender(this,t,r,n,i,a),!0===i.allowOverride&&null!==t.overrideMaterial){let e=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(o=e.positionNode,e.positionNode=i.positionNode),e.alphaTest=i.alphaTest,e.alphaMap=i.alphaMap,e.transparent=i.transparent||i.transmission>0,e.isShadowPassMaterial&&(e.side=null===i.shadowSide?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(u=e.depthNode,e.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(l=e.colorNode,e.colorNode=i.castShadowNode),i.castShadowPositionNode&&i.castShadowPositionNode.isNode&&(o=e.positionNode,e.positionNode=i.castShadowPositionNode)),i=e}!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,this._handleObjectFunction(e,i,t,r,s,a,c,"backSide"),i.side=0,this._handleObjectFunction(e,i,t,r,s,a,c,h),i.side=2):this._handleObjectFunction(e,i,t,r,s,a,c,h),void 0!==o&&(t.overrideMaterial.positionNode=o),void 0!==u&&(t.overrideMaterial.depthNode=u),void 0!==l&&(t.overrideMaterial.colorNode=l),e.onAfterRender(this,t,r,n,i,a)}_renderObjectDirect(e,t,r,n,i,a,s,o){let l=this._objects.get(e,t,r,n,i,this._currentRenderContext,s,o);l.drawRange=e.geometry.drawRange,l.group=a;let u=this._nodes.needsRefresh(l);u&&(this._nodes.updateBefore(l),this._geometries.updateForRender(l),this._nodes.updateForRender(l),this._bindings.updateForRender(l)),this._pipelines.updateForRender(l),null!==this._currentRenderBundle&&(this.backend.get(this._currentRenderBundle).renderObjects.push(l),l.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(l,this.info),u&&this._nodes.updateAfter(l)}_createObjectPipeline(e,t,r,n,i,a,s,o){let l=this._objects.get(e,t,r,n,i,this._currentRenderContext,s,o);l.drawRange=e.geometry.drawRange,l.group=a,this._nodes.updateBefore(l),this._geometries.updateForRender(l),this._nodes.updateForRender(l),this._bindings.updateForRender(l),this._pipelines.getForRender(l,this._compilationPromises),this._nodes.updateAfter(l)}get compile(){return this.compileAsync}constructor(e,t={}){this.isRenderer=!0;let{logarithmicDepthBuffer:r=!1,alpha:n=!0,depth:i=!0,stencil:a=!1,antialias:s=!1,samples:o=0,getFallback:l=null,colorBufferType:u=1016,multiview:c=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=o||!0===s?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=n,this.logarithmicDepthBuffer=r,this.outputColorSpace=J,this.toneMapping=0,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=i,this.stencil=a,this.info=new Rx,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new LL,this.lighting=new LF,this._getFallback=l,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new eH(0,0,this._width,this._height),this._scissor=new eH(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new CT(new w3),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;let h=+(!0!==this.alpha);this._clearColor=new RG(0,0,0,h),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=u,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:1},this.xr=new Lz(this,c),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(e,t,r)=>{await this.compileAsync(e,t);let n=this._renderLists.get(e,t),i=this._renderContexts.get(e,t,this._renderTarget),a=e.overrideMaterial||r.material,{fragmentShader:s,vertexShader:o}=this._objects.get(r,a,e,t,n.lightsNode,i,i.clippingContext).getNodeBuilderState();return{fragmentShader:s,vertexShader:o}}}}}class L1{setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}constructor(e=""){this.name=e,this.visibility=0}}class L2 extends L1{get byteLength(){var e;return(e=this._buffer.byteLength)+(16-e%16)%16}get buffer(){return this._buffer}update(){return!0}constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}}class L3 extends L2{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let L4=0;class L5 extends L3{get buffer(){return this.nodeUniform.value}constructor(e,t){super("UniformBuffer_"+L4++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}}class L6 extends L3{addUniform(e){return this.uniforms.push(e),this}removeUniform(e){let t=this.uniforms.indexOf(e);return -1!==t&&this.uniforms.splice(t,1),this}get values(){return null===this._values&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;return null===e&&(e=new Float32Array(new ArrayBuffer(this.byteLength)),this._buffer=e),e}get byteLength(){let e=this.bytesPerElement,t=0;for(let r=0,n=this.uniforms.length;r<n;r++){let n=this.uniforms[r],i=n.boundary,a=n.itemSize*e,s=t%16,o=s%i,l=s+o;t+=o,0!==l&&16-l<a&&(t+=16-l),n.offset=t/e,t+=a}return 16*Math.ceil(t/16)}update(){let e=!1;for(let t of this.uniforms)!0===this.updateByType(t)&&(e=!0);return e}updateByType(e){return e.isNumberUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1,r=this.values,n=e.getValue(),i=e.offset,a=e.getType();return r[i]!==n&&(this._getBufferForType(a)[i]=r[i]=n,t=!0),t}updateVector2(e){let t=!1,r=this.values,n=e.getValue(),i=e.offset,a=e.getType();if(r[i+0]!==n.x||r[i+1]!==n.y){let e=this._getBufferForType(a);e[i+0]=r[i+0]=n.x,e[i+1]=r[i+1]=n.y,t=!0}return t}updateVector3(e){let t=!1,r=this.values,n=e.getValue(),i=e.offset,a=e.getType();if(r[i+0]!==n.x||r[i+1]!==n.y||r[i+2]!==n.z){let e=this._getBufferForType(a);e[i+0]=r[i+0]=n.x,e[i+1]=r[i+1]=n.y,e[i+2]=r[i+2]=n.z,t=!0}return t}updateVector4(e){let t=!1,r=this.values,n=e.getValue(),i=e.offset,a=e.getType();if(r[i+0]!==n.x||r[i+1]!==n.y||r[i+2]!==n.z||r[i+4]!==n.w){let e=this._getBufferForType(a);e[i+0]=r[i+0]=n.x,e[i+1]=r[i+1]=n.y,e[i+2]=r[i+2]=n.z,e[i+3]=r[i+3]=n.w,t=!0}return t}updateColor(e){let t=!1,r=this.values,n=e.getValue(),i=e.offset;if(r[i+0]!==n.r||r[i+1]!==n.g||r[i+2]!==n.b){let e=this.buffer;e[i+0]=r[i+0]=n.r,e[i+1]=r[i+1]=n.g,e[i+2]=r[i+2]=n.b,t=!0}return t}updateMatrix3(e){let t=!1,r=this.values,n=e.getValue().elements,i=e.offset;if(r[i+0]!==n[0]||r[i+1]!==n[1]||r[i+2]!==n[2]||r[i+4]!==n[3]||r[i+5]!==n[4]||r[i+6]!==n[5]||r[i+8]!==n[6]||r[i+9]!==n[7]||r[i+10]!==n[8]){let e=this.buffer;e[i+0]=r[i+0]=n[0],e[i+1]=r[i+1]=n[1],e[i+2]=r[i+2]=n[2],e[i+4]=r[i+4]=n[3],e[i+5]=r[i+5]=n[4],e[i+6]=r[i+6]=n[5],e[i+8]=r[i+8]=n[6],e[i+9]=r[i+9]=n[7],e[i+10]=r[i+10]=n[8],t=!0}return t}updateMatrix4(e){let t=!1,r=this.values,n=e.getValue().elements,i=e.offset;return!1===function(e,t,r){for(let n=0,i=t.length;n<i;n++)if(e[r+n]!==t[n])return!1;return!0}(r,n,i)&&(this.buffer.set(n,i),function(e,t,r){for(let n=0,i=t.length;n<i;n++)e[r+n]=t[n]}(r,n,i),t=!0),t}_getBufferForType(e){return"int"===e||"ivec2"===e||"ivec3"===e||"ivec4"===e?new Int32Array(this.buffer.buffer):"uint"===e||"uvec2"===e||"uvec3"===e||"uvec4"===e?new Uint32Array(this.buffer.buffer):this.buffer}constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}}let L7=0;class L8 extends L6{constructor(e,t){super(e),this.id=L7++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class L9 extends L1{set texture(e){if(this._texture===e)return;let t=()=>{this._texture=null,this.generation=null,this.version=0};this._texture&&this._texture.removeEventListener("dispose",t),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",t)}get texture(){return this._texture}update(){let{texture:e,version:t}=this;return t!==e.version&&(this.version=e.version,!0)}clone(){let e=super.clone();return e._texture=null,e.texture=this.texture,e}constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.generation=null,this.isSampler=!0}}let De=0;class Dt extends L9{constructor(e,t){super(e,t),this.id=De++,this.store=!1,this.isSampledTexture=!0}}class Dr extends Dt{update(){let{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}constructor(e,t,r,n=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r,this.access=n}}class Dn extends Dr{constructor(e,t,r,n=null){super(e,t,r,n),this.isSampledCubeTexture=!0}}class Di extends Dr{constructor(e,t,r,n=null){super(e,t,r,n),this.isSampledTexture3D=!0}}let Da={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint"},Ds={low:"lowp",medium:"mediump",high:"highp"},Do={swizzleAssign:!0,storageBuffer:!1},Dl={perspective:"smooth",linear:"noperspective"},Du={centroid:"centroid"},Dc="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\nprecision lowp sampler2DArrayShadow;\nprecision lowp samplerCubeShadow;\n";class Dh extends Lr{needsToWorkingColorSpace(e){return!0===e.isVideoTexture&&""!==e.colorSpace}getMethod(e){return Da[e]||e}getBitcastMethod(e,t){return Da["bitcast_".concat(t,"_").concat(e)]}getTernary(e,t,r){return"".concat(e," ? ").concat(t," : ").concat(r)}getOutputStructName(){return""}buildFunctionCode(e){let t=e.layout,r=this.flowShaderNode(e),n=[];for(let e of t.inputs)n.push(this.getType(e.type)+" "+e.name);return"".concat(this.getType(t.type)," ").concat(t.name,"( ").concat(n.join(", ")," ) {\n\n	").concat(r.vars,"\n\n").concat(r.code,"\n	return ").concat(r.result,";\n\n}")}setupPBO(e){let t=e.value;if(void 0===t.pbo){let e=t.array,r=t.count*t.itemSize,{itemSize:n}=t,i=t.array.constructor.name.toLowerCase().includes("int"),a=i?1029:1028;2===n?a=i?1031:1030:3===n?a=i?1032:1022:4===n&&(a=i?1033:1023);let s=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/n)))),o=Math.ceil(r/n/s);s*o*n<r&&o++;let l=s*o*n,u=new e.constructor(l);u.set(e,0),t.array=u;let c=new nE(t.array,s,o,a,{Float32Array:1015,Uint8Array:1009,Uint16Array:1012,Uint32Array:1014,Int8Array:1010,Int16Array:1011,Int32Array:1013,Uint8ClampedArray:1009}[t.array.constructor.name]||1015);c.needsUpdate=!0,c.isPBOTexture=!0;let h=new bP(c,null,null);h.setPrecision("high"),t.pboNode=h,t.pbo=h.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;return e.isNodeUniform&&!0!==e.node.isTextureNode&&!0!==e.node.isBufferNode?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){let{node:t,indexNode:r}=e,n=t.value;this.renderer.backend.has(n)&&(this.renderer.backend.get(n).pbo=n.pbo);let i=this.getUniformFromNode(n.pboNode,"texture",this.shaderStage,this.context.nodeName),a=this.getPropertyName(i);this.increaseUsage(r);let s=r.build(this,"uint"),o=this.getDataFromNode(e),l=o.propertyName;if(void 0===l){let r=this.getVarFromNode(e);l=this.getPropertyName(r);let i=this.getDataFromNode(t),u=i.propertySizeName;void 0===u&&(u=l+"Size",this.getVarFromNode(t,u,"uint"),this.addLineFlowCode("".concat(u," = uint( textureSize( ").concat(a,", 0 ).x )"),e),i.propertySizeName=u);let{itemSize:c}=n,h="."+yA.join("").slice(0,c),d="ivec2(".concat(s," % ").concat(u,", ").concat(s," / ").concat(u,")"),A=this.generateTextureLoad(null,a,d,null,null,"0"),p="vec4";1014===n.pbo.type?p="uvec4":1013===n.pbo.type&&(p="ivec4"),this.addLineFlowCode("".concat(l," = ").concat(p,"(").concat(A,")").concat(h),e),o.propertyName=l}return l}generateTextureLoad(e,t,r,n,i){let a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"0";return a=n?i?"texelFetchOffset( ".concat(t,", ivec3( ").concat(r,", ").concat(n," ), ").concat(s,", ").concat(i," )"):"texelFetch( ".concat(t,", ivec3( ").concat(r,", ").concat(n," ), ").concat(s," )"):i?"texelFetchOffset( ".concat(t,", ").concat(r,", ").concat(s,", ").concat(i," )"):"texelFetch( ".concat(t,", ").concat(r,", ").concat(s," )"),null!==e&&e.isDepthTexture&&(a+=".x"),a}generateTexture(e,t,r,n,i){return(n&&(r="vec3( ".concat(r,", ").concat(n," )")),e.isDepthTexture)?i?"textureOffset( ".concat(t,", ").concat(r,", ").concat(i," ).x"):"texture( ".concat(t,", ").concat(r," ).x"):i?"textureOffset( ".concat(t,", ").concat(r,", ").concat(i," )"):"texture( ".concat(t,", ").concat(r," )")}generateTextureLevel(e,t,r,n,i){return i?"textureLodOffset( ".concat(t,", ").concat(r,", ").concat(n,", ").concat(i," )"):"textureLod( ".concat(t,", ").concat(r,", ").concat(n," )")}generateTextureBias(e,t,r,n,i){return i?"textureOffset( ".concat(t,", ").concat(r,", ").concat(i,", ").concat(n," )"):"texture( ".concat(t,", ").concat(r,", ").concat(n," )")}generateTextureGrad(e,t,r,n,i){return i?"textureGradOffset( ".concat(t,", ").concat(r,", ").concat(n[0],", ").concat(n[1],", ").concat(i," )"):"textureGrad( ".concat(t,", ").concat(r,", ").concat(n[0],", ").concat(n[1]," )")}generateTextureCompare(e,t,r,n,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.shaderStage;if("fragment"===s)return i?a?"textureOffset( ".concat(t,", vec4( ").concat(r,", ").concat(i,", ").concat(n," ), ").concat(a," )"):"texture( ".concat(t,", vec4( ").concat(r,", ").concat(i,", ").concat(n," ) )"):a?"textureOffset( ".concat(t,", vec3( ").concat(r,", ").concat(n," ), ").concat(a," )"):"texture( ".concat(t,", vec3( ").concat(r,", ").concat(n," ) )");console.error("WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ".concat(s," shader."))}getVars(e){let t=[],r=this.vars[e];if(void 0!==r)for(let e of r)t.push("".concat(this.getVar(e.type,e.name,e.count),";"));return t.join("\n	")}getUniforms(e){let t=this.uniforms[e],r=[],n={};for(let i of t){let t=null,a=!1;if("texture"===i.type||"texture3D"===i.type){let e=i.node.value,r="";(!0===e.isDataTexture||!0===e.isData3DTexture)&&(1014===e.type?r="u":1013===e.type&&(r="i")),t="texture3D"===i.type&&!1===e.isArrayTexture?"".concat(r,"sampler3D ").concat(i.name,";"):e.compareFunction?!0===e.isArrayTexture?"sampler2DArrayShadow ".concat(i.name,";"):"sampler2DShadow ".concat(i.name,";"):!0===e.isArrayTexture||!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?"".concat(r,"sampler2DArray ").concat(i.name,";"):"".concat(r,"sampler2D ").concat(i.name,";")}else if("cubeTexture"===i.type)t="samplerCube ".concat(i.name,";");else if("buffer"===i.type){let e=i.node,r=this.getType(e.bufferType),n=e.bufferCount,a=n>0?n:"";t="".concat(e.name," {\n	").concat(r," ").concat(i.name,"[").concat(a,"];\n};\n")}else{let r=this.getVectorType(i.type);t="".concat(r," ").concat(this.getPropertyName(i,e),";"),a=!0}let s=i.node.precision;if(null!==s&&(t=Ds[s]+" "+t),a){t="	"+t;let e=i.groupNode.name;(n[e]||(n[e]=[])).push(t)}else t="uniform "+t,r.push(t)}let i="";for(let t in n){let r=n[t];i+=this._getGLSLUniformStruct(e+"_"+t,r.join("\n"))+"\n"}return i+r.join("\n")}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&1013!==e.gpuType){let r=e;e.isInterleavedBufferAttribute&&(r=e.data);let n=r.array;!1==(n instanceof Uint32Array||n instanceof Int32Array)&&(t=t.slice(1))}return t}getAttributes(e){let t="";if("vertex"===e||"compute"===e){let e=this.getAttributesArray(),r=0;for(let n of e)t+="layout( location = ".concat(r++," ) in ").concat(n.type," ").concat(n.name,";\n")}return t}getStructMembers(e){let t=[];for(let r of e.members)t.push("	".concat(r.type," ").concat(r.name,";"));return t.join("\n")}getStructs(e){let t=[],r=this.structs[e],n=[];for(let e of r)if(e.output)for(let t of e.members)n.push("layout( location = ".concat(t.index," ) out ").concat(t.type," ").concat(t.name,";"));else{let r="struct "+e.name+" {\n";r+=this.getStructMembers(e),r+="\n};\n",t.push(r)}return 0===n.length&&n.push("layout( location = 0 ) out vec4 fragColor;"),"\n"+n.join("\n")+"\n\n"+t.join("\n")}getVaryings(e){let t="",r=this.varyings;if("vertex"===e||"compute"===e)for(let n of r){"compute"===e&&(n.needsInterpolation=!0);let r=this.getType(n.type);if(n.needsInterpolation)if(n.interpolationType){let e=Dl[n.interpolationType]||n.interpolationType,i=Du[n.interpolationSampling]||"";t+="".concat(e," ").concat(i," out ").concat(r," ").concat(n.name,";\n")}else{let e=r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":"";t+="".concat(e,"out ").concat(r," ").concat(n.name,";\n")}else t+="".concat(r," ").concat(n.name,";\n")}else if("fragment"===e){for(let e of r)if(e.needsInterpolation){let r=this.getType(e.type);if(e.interpolationType){let n=Dl[e.interpolationType]||e.interpolationType,i=Du[e.interpolationSampling]||"";t+="".concat(n," ").concat(i," in ").concat(r," ").concat(e.name,";\n")}else{let n=r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":"";t+="".concat(n,"in ").concat(r," ").concat(e.name,";\n")}}}for(let r of this.builtins[e])t+="".concat(r,";\n");return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){let e=this.object.workgroupSize.reduce((e,t)=>e*t,1);return"uint( gl_InstanceID ) % ".concat(e,"u")}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,n=this.extensions[r]||(this.extensions[r]=new Map);!1===n.has(e)&&n.set(e,{name:e,behavior:t})}getExtensions(e){let t=[];if("vertex"===e){let t=this.renderer.backend.extensions;this.object.isBatchedMesh&&t.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}let r=this.extensions[e];if(void 0!==r)for(let{name:e,behavior:n}of r.values())t.push("#extension ".concat(e," : ").concat(n));return t.join("\n")}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=Do[e];if(void 0===t){let r;switch(t=!1,e){case"float32Filterable":r="OES_texture_float_linear";break;case"clipDistance":r="WEBGL_clip_cull_distance"}if(void 0!==r){let e=this.renderer.backend.extensions;e.has(r)&&(e.get(r),t=!0)}Do[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push("out float gl_ClipDistance[ ".concat(e," ]"))}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){let e=this.transforms,t="";for(let r=0;r<e.length;r++){let n=e[r],i=this.getPropertyName(n.attributeNode);i&&(t+="".concat(n.varyingName," = ").concat(i,";\n	"))}return t}_getGLSLUniformStruct(e,t){return"\nlayout( std140 ) uniform ".concat(e," {\n").concat(t,"\n};")}_getGLSLVertexCode(e){return"#version 300 es\n\n".concat(this.getSignature(),"\n\n// extensions\n").concat(e.extensions,"\n\n// precision\n").concat(Dc,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\n\n// attributes\n").concat(e.attributes,"\n\n// codes\n").concat(e.codes,"\n\nvoid main() {\n\n	// vars\n	").concat(e.vars,"\n\n	// transforms\n	").concat(e.transforms,"\n\n	// flow\n	").concat(e.flow,"\n\n	gl_PointSize = 1.0;\n\n}\n")}_getGLSLFragmentCode(e){return"#version 300 es\n\n".concat(this.getSignature(),"\n\n// extensions\n").concat(e.extensions,"\n\n// precision\n").concat(Dc,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\n\n// codes\n").concat(e.codes,"\n\n// structs\n").concat(e.structs,"\n\nvoid main() {\n\n	// vars\n	").concat(e.vars,"\n\n	// flow\n	").concat(e.flow,"\n\n}\n")}buildCode(){let e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};for(let t in this.sortBindingGroups(),e){let r="// code\n\n";r+=this.flowCode[t];let n=this.flowNodes[t],i=n[n.length-1];for(let e of n){let n=this.getFlowData(e),a=e.name;a&&(r.length>0&&(r+="\n"),r+="	// flow -> ".concat(a,"\n	")),r+="".concat(n.code,"\n	"),e===i&&"compute"!==t&&(r+="// result\n	","vertex"===t?(r+="gl_Position = ",r+="".concat(n.result,";")):"fragment"!==t||e.outputNode.isOutputStructNode||(r+="fragColor = ",r+="".concat(n.result,";")))}let a=e[t];a.extensions=this.getExtensions(t),a.uniforms=this.getUniforms(t),a.attributes=this.getAttributes(t),a.varyings=this.getVaryings(t),a.vars=this.getVars(t),a.structs=this.getStructs(t),a.codes=this.getCodes(t),a.transforms=this.getTransforms(t),a.flow=r}null!==this.material?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=super.getUniformFromNode(e,t,r,n),a=this.getDataFromNode(e,r,this.globalCache),s=a.uniformGPU;if(void 0===s){let n=e.groupNode,o=n.name,l=this.getBindGroupArray(o,r);if("texture"===t)s=new Dr(i.name,i.node,n),l.push(s);else if("cubeTexture"===t)s=new Dn(i.name,i.node,n),l.push(s);else if("texture3D"===t)s=new Di(i.name,i.node,n),l.push(s);else if("buffer"===t){e.name="NodeBuffer_".concat(e.id),i.name="buffer".concat(e.id);let t=new L5(e,n);t.name=e.name,l.push(t),s=t}else{let e=this.uniformGroups[r]||(this.uniformGroups[r]={}),a=e[o];void 0===a&&(a=new L8(r+"_"+o,n),e[o]=a,l.push(a)),s=this.getNodeUniform(i,t),a.addUniform(s)}a.uniformGPU=s}return i}constructor(e,t){super(e,t,new LS),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}}let Dd=null,DA=null;class Dp{async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}getTimestampUID(e){let t=this.get(e),r=!0===e.isComputeNode?"c":"r";return r+(":"+t.frameCalls+":"+e.id)}isOccluded(){}async resolveTimestampsAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"render";if(!this.trackTimestamp)return void eP("WebGPURenderer: Timestamp tracking is disabled.");let t=this.timestampQueryPool[e];if(!t)return void eP("WebGPURenderer: No timestamp query pool for type '".concat(e,"' found."));let r=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=r,r}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return Dd=Dd||new ey,this.renderer.getDrawingBufferSize(Dd)}setScissorTest(){}getClearColor(){let e=this.renderer;return DA=DA||new RG,e.getClearColor(DA),DA.getRGB(DA),DA}getDomElement(){let e=this.domElement;return null===e&&("setAttribute"in(e=void 0!==this.parameters.canvas?this.parameters.canvas:eC())&&e.setAttribute("data-engine","three.js r".concat("180"," webgpu")),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=!0===e.trackTimestamp}}let Df=0;class Dm{get id(){return"".concat(this.baseId,"|").concat(this.activeBufferIndex)}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[1^this.activeBufferIndex]}switchBuffers(){this.activeBufferIndex^=1}constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}}class Dg{createAttribute(e,t){let r,n=this.backend,{gl:i}=n,a=e.array,s=e.usage||i.STATIC_DRAW,o=e.isInterleavedBufferAttribute?e.data:e,l=n.get(o),u=l.bufferGPU;if(void 0===u&&(l.bufferGPU=u=this._createBuffer(i,t,a,s),l.bufferType=t,l.version=o.version),a instanceof Float32Array)r=i.FLOAT;else if("undefined"!=typeof Float16Array&&a instanceof Float16Array)r=i.HALF_FLOAT;else if(a instanceof Uint16Array)r=e.isFloat16BufferAttribute?i.HALF_FLOAT:i.UNSIGNED_SHORT;else if(a instanceof Int16Array)r=i.SHORT;else if(a instanceof Uint32Array)r=i.UNSIGNED_INT;else if(a instanceof Int32Array)r=i.INT;else if(a instanceof Int8Array)r=i.BYTE;else if(a instanceof Uint8Array)r=i.UNSIGNED_BYTE;else if(a instanceof Uint8ClampedArray)r=i.UNSIGNED_BYTE;else throw Error("THREE.WebGLBackend: Unsupported buffer data format: "+a);let c={bufferGPU:u,bufferType:t,type:r,byteLength:a.byteLength,bytesPerElement:a.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:r===i.INT||r===i.UNSIGNED_INT||1013===e.gpuType,id:Df++};(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(c=new Dm(c,this._createBuffer(i,t,a,s))),n.set(e,c)}updateAttribute(e){let t=this.backend,{gl:r}=t,n=e.array,i=e.isInterleavedBufferAttribute?e.data:e,a=t.get(i),s=a.bufferType,o=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(r.bindBuffer(s,a.bufferGPU),0===o.length)r.bufferSubData(s,0,n);else{for(let e=0,t=o.length;e<t;e++){let t=o[e];r.bufferSubData(s,t.start*n.BYTES_PER_ELEMENT,n,t.start,t.count)}i.clearUpdateRanges()}r.bindBuffer(s,null),a.version=i.version}destroyAttribute(e){let t=this.backend,{gl:r}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);let n=t.get(e);r.deleteBuffer(n.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){let t=this.backend,{gl:r}=t,n=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(n),a=e.array,s=a.byteLength;r.bindBuffer(r.COPY_READ_BUFFER,i);let o=r.createBuffer();r.bindBuffer(r.COPY_WRITE_BUFFER,o),r.bufferData(r.COPY_WRITE_BUFFER,s,r.STREAM_READ),r.copyBufferSubData(r.COPY_READ_BUFFER,r.COPY_WRITE_BUFFER,0,0,s),await t.utils._clientWaitAsync();let l=new e.array.constructor(a.length);return r.bindBuffer(r.COPY_WRITE_BUFFER,o),r.getBufferSubData(r.COPY_WRITE_BUFFER,0,l),r.deleteBuffer(o),r.bindBuffer(r.COPY_READ_BUFFER,null),r.bindBuffer(r.COPY_WRITE_BUFFER,null),l.buffer}_createBuffer(e,t,r,n){let i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,r,n),e.bindBuffer(t,null),i}constructor(e){this.backend=e}}class Dy{_init(){let e=this.gl;c={100:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT},h={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,204:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,205:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA};let t=e.getParameter(e.SCISSOR_BOX),r=e.getParameter(e.VIEWPORT);this.currentScissor=new eH().fromArray(t),this.currentViewport=new eH().fromArray(r),this._tempVec4=new eH}enable(e){let{enabled:t}=this;!0!==t[e]&&(this.gl.enable(e),t[e]=!0)}disable(e){let{enabled:t}=this;!1!==t[e]&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){let{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){let{gl:t}=this;0!==e?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){let{currentLineWidth:t,gl:r}=this;e!==t&&(r.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,r,n,i,a,s,o){let{gl:l}=this;if(0===e){!0===this.currentBlendingEnabled&&(this.disable(l.BLEND),this.currentBlendingEnabled=!1);return}if(!1===this.currentBlendingEnabled&&(this.enable(l.BLEND),this.currentBlendingEnabled=!0),5!==e){if(e!==this.currentBlending||o!==this.currentPremultipledAlpha){if((100!==this.currentBlendEquation||100!==this.currentBlendEquationAlpha)&&(l.blendEquation(l.FUNC_ADD),this.currentBlendEquation=100,this.currentBlendEquationAlpha=100),o)switch(e){case 1:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.ONE,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFuncSeparate(l.DST_COLOR,l.ONE_MINUS_SRC_ALPHA,l.ZERO,l.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE,l.ONE,l.ONE);break;case 3:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=o}return}i=i||t,a=a||r,s=s||n,(t!==this.currentBlendEquation||i!==this.currentBlendEquationAlpha)&&(l.blendEquationSeparate(c[t],c[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),(r!==this.currentBlendSrc||n!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||s!==this.currentBlendDstAlpha)&&(l.blendFuncSeparate(h[r],h[n],h[a],h[s]),this.currentBlendSrc=r,this.currentBlendDst=n,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=s),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){let{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){let{gl:t}=this;switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}this.currentDepthFunc=e}}scissor(e,t,r,n){let i=this._tempVec4.set(e,t,r,n);if(!1===this.currentScissor.equals(i)){let{gl:e}=this;e.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i)}}viewport(e,t,r,n){let i=this._tempVec4.set(e,t,r,n);if(!1===this.currentViewport.equals(i)){let{gl:e}=this;e.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i)}}setScissorTest(e){let t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){let{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,r){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==r)&&(this.gl.stencilFunc(e,t,r),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=r)}setStencilOp(e,t,r){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==r)&&(this.gl.stencilOp(e,t,r),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=r)}setMaterial(e,t,r){let{gl:n}=this;2===e.side?this.disable(n.CULL_FACE):this.enable(n.CULL_FACE);let i=1===e.side;t&&(i=!i),this.setFlipSided(i),1===e.blending&&!1===e.transparent?this.setBlending(0):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);let a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage&&this.backend.renderer.samples>1?this.enable(n.SAMPLE_ALPHA_TO_COVERAGE):this.disable(n.SAMPLE_ALPHA_TO_COVERAGE),r>0&&this.currentClippingPlanes!==r)for(let e=0;e<8;e++)e<r?this.enable(12288+e):this.disable(12288+e)}setPolygonOffset(e,t,r){let{gl:n}=this;e?(this.enable(n.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==r)&&(n.polygonOffset(t,r),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=r)):this.disable(n.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e&&(this.gl.useProgram(e),this.currentProgram=e,!0)}setVertexState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.gl;return(this.currentVAO!==e||this.currentIndex!==t)&&(r.bindVertexArray(e),null!==t&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0)}resetVertexState(){let e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){let{gl:r,currentBoundFramebuffers:n}=this;return n[e]!==t&&(r.bindFramebuffer(e,t),n[e]=t,e===r.DRAW_FRAMEBUFFER&&(n[r.FRAMEBUFFER]=t),e===r.FRAMEBUFFER&&(n[r.DRAW_FRAMEBUFFER]=t),!0)}drawBuffers(e,t){let{gl:r}=this,n=[],i=!1;if(null!==e.textures){void 0===(n=this.currentDrawbuffers.get(t))&&(n=[],this.currentDrawbuffers.set(t,n));let a=e.textures;if(n.length!==a.length||n[0]!==r.COLOR_ATTACHMENT0){for(let e=0,t=a.length;e<t;e++)n[e]=r.COLOR_ATTACHMENT0+e;n.length=a.length,i=!0}}else n[0]!==r.BACK&&(n[0]=r.BACK,i=!0);i&&r.drawBuffers(n)}activeTexture(e){let{gl:t,currentTextureSlot:r,maxTextures:n}=this;void 0===e&&(e=t.TEXTURE0+n-1),r!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,r){let{gl:n,currentTextureSlot:i,currentBoundTextures:a,maxTextures:s}=this;void 0===r&&(r=null===i?n.TEXTURE0+s-1:i);let o=a[r];void 0===o&&(o={type:void 0,texture:void 0},a[r]=o),(o.type!==e||o.texture!==t)&&(i!==r&&(n.activeTexture(r),this.currentTextureSlot=r),n.bindTexture(e,t),o.type=e,o.texture=t)}bindBufferBase(e,t,r){let{gl:n}=this,i="".concat(e,"-").concat(t);return this.currentBoundBufferBases[i]!==r&&(n.bindBufferBase(e,t,r),this.currentBoundBufferBases[i]=r,!0)}unbindTexture(){let{gl:e,currentTextureSlot:t,currentBoundTextures:r}=this,n=r[t];void 0!==n&&void 0!==n.type&&(e.bindTexture(n.type,null),n.type=void 0,n.texture=void 0)}constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}}class Dv{convert(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",{gl:n,extensions:i}=this,a=eD.getTransfer(r);if(1009===e)return n.UNSIGNED_BYTE;if(1017===e)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return n.UNSIGNED_SHORT_5_5_5_1;if(35902===e)return n.UNSIGNED_INT_5_9_9_9_REV;if(35899===e)return n.UNSIGNED_INT_10F_11F_11F_REV;if(1010===e)return n.BYTE;if(1011===e)return n.SHORT;if(1012===e)return n.UNSIGNED_SHORT;if(1013===e)return n.INT;if(1014===e)return n.UNSIGNED_INT;if(1015===e)return n.FLOAT;if(1016===e)return n.HALF_FLOAT;if(1021===e)return n.ALPHA;if(1022===e)return n.RGB;if(1023===e)return n.RGBA;if(1026===e)return n.DEPTH_COMPONENT;if(1027===e)return n.DEPTH_STENCIL;if(1028===e)return n.RED;if(1029===e)return n.RED_INTEGER;if(1030===e)return n.RG;if(1031===e)return n.RG_INTEGER;if(1033===e)return n.RGBA_INTEGER;if(33776===e||33777===e||33778===e||33779===e)if(a===et){if(null===(t=i.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(33776===e)return t.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===e)return t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===e)return t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===e)return t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(t=i.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===e)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(null===(t=i.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===e)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e||37492===e||37496===e){if(null===(t=i.get("WEBGL_compressed_texture_etc")))return null;if(36196===e||37492===e)return a===et?t.COMPRESSED_SRGB8_ETC2:t.COMPRESSED_RGB8_ETC2;if(37496===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:t.COMPRESSED_RGBA8_ETC2_EAC}if(37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e){if(null===(t=i.get("WEBGL_compressed_texture_astc")))return null;if(37808===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:t.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:t.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:t.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:t.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:t.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:t.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:t.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:t.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:t.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:t.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:t.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:t.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:t.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===e)return a===et?t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:t.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===e){if(null===(t=i.get("EXT_texture_compression_bptc")))return null;if(36492===e)return a===et?t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:t.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===e||36284===e||36285===e||36286===e){if(null===(t=i.get("EXT_texture_compression_rgtc")))return null;if(36283===e)return t.COMPRESSED_RED_RGTC1_EXT;if(36284===e)return t.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===e)return t.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===e)return t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return 1020===e?n.UNSIGNED_INT_24_8:void 0!==n[e]?n[e]:null}_clientWaitAsync(){let{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((r,n)=>{!function i(){let a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(t),n();return}if(a===e.TIMEOUT_EXPIRED)return void requestAnimationFrame(i);e.deleteSync(t),r()}()})}constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}}let Dx=!1,D_,Db,DS;class DT{_init(){let e=this.gl;D_={1e3:e.REPEAT,1001:e.CLAMP_TO_EDGE,1002:e.MIRRORED_REPEAT},Db={1003:e.NEAREST,1004:e.NEAREST_MIPMAP_NEAREST,1005:e.NEAREST_MIPMAP_LINEAR,1006:e.LINEAR,1007:e.LINEAR_MIPMAP_NEAREST,1008:e.LINEAR_MIPMAP_LINEAR},DS={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL}}getGLTextureType(e){let{gl:t}=this;return!0===e.isCubeTexture?t.TEXTURE_CUBE_MAP:!0===e.isArrayTexture||!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:!0===e.isData3DTexture?t.TEXTURE_3D:t.TEXTURE_2D}getInternalFormat(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],{gl:a,extensions:s}=this;if(null!==e){if(void 0!==a[e])return a[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let o=t;if(t===a.RED&&(r===a.FLOAT&&(o=a.R32F),r===a.HALF_FLOAT&&(o=a.R16F),r===a.UNSIGNED_BYTE&&(o=a.R8),r===a.UNSIGNED_SHORT&&(o=a.R16),r===a.UNSIGNED_INT&&(o=a.R32UI),r===a.BYTE&&(o=a.R8I),r===a.SHORT&&(o=a.R16I),r===a.INT&&(o=a.R32I)),t===a.RED_INTEGER&&(r===a.UNSIGNED_BYTE&&(o=a.R8UI),r===a.UNSIGNED_SHORT&&(o=a.R16UI),r===a.UNSIGNED_INT&&(o=a.R32UI),r===a.BYTE&&(o=a.R8I),r===a.SHORT&&(o=a.R16I),r===a.INT&&(o=a.R32I)),t===a.RG&&(r===a.FLOAT&&(o=a.RG32F),r===a.HALF_FLOAT&&(o=a.RG16F),r===a.UNSIGNED_BYTE&&(o=a.RG8),r===a.UNSIGNED_SHORT&&(o=a.RG16),r===a.UNSIGNED_INT&&(o=a.RG32UI),r===a.BYTE&&(o=a.RG8I),r===a.SHORT&&(o=a.RG16I),r===a.INT&&(o=a.RG32I)),t===a.RG_INTEGER&&(r===a.UNSIGNED_BYTE&&(o=a.RG8UI),r===a.UNSIGNED_SHORT&&(o=a.RG16UI),r===a.UNSIGNED_INT&&(o=a.RG32UI),r===a.BYTE&&(o=a.RG8I),r===a.SHORT&&(o=a.RG16I),r===a.INT&&(o=a.RG32I)),t===a.RGB){let e=i?ee:eD.getTransfer(n);r===a.FLOAT&&(o=a.RGB32F),r===a.HALF_FLOAT&&(o=a.RGB16F),r===a.UNSIGNED_BYTE&&(o=a.RGB8),r===a.UNSIGNED_SHORT&&(o=a.RGB16),r===a.UNSIGNED_INT&&(o=a.RGB32UI),r===a.BYTE&&(o=a.RGB8I),r===a.SHORT&&(o=a.RGB16I),r===a.INT&&(o=a.RGB32I),r===a.UNSIGNED_BYTE&&(o=e===et?a.SRGB8:a.RGB8),r===a.UNSIGNED_SHORT_5_6_5&&(o=a.RGB565),r===a.UNSIGNED_SHORT_5_5_5_1&&(o=a.RGB5_A1),r===a.UNSIGNED_SHORT_4_4_4_4&&(o=a.RGB4),r===a.UNSIGNED_INT_5_9_9_9_REV&&(o=a.RGB9_E5),r===a.UNSIGNED_INT_10F_11F_11F_REV&&(o=a.R11F_G11F_B10F)}if(t===a.RGB_INTEGER&&(r===a.UNSIGNED_BYTE&&(o=a.RGB8UI),r===a.UNSIGNED_SHORT&&(o=a.RGB16UI),r===a.UNSIGNED_INT&&(o=a.RGB32UI),r===a.BYTE&&(o=a.RGB8I),r===a.SHORT&&(o=a.RGB16I),r===a.INT&&(o=a.RGB32I)),t===a.RGBA){let e=i?ee:eD.getTransfer(n);r===a.FLOAT&&(o=a.RGBA32F),r===a.HALF_FLOAT&&(o=a.RGBA16F),r===a.UNSIGNED_BYTE&&(o=a.RGBA8),r===a.UNSIGNED_SHORT&&(o=a.RGBA16),r===a.UNSIGNED_INT&&(o=a.RGBA32UI),r===a.BYTE&&(o=a.RGBA8I),r===a.SHORT&&(o=a.RGBA16I),r===a.INT&&(o=a.RGBA32I),r===a.UNSIGNED_BYTE&&(o=e===et?a.SRGB8_ALPHA8:a.RGBA8),r===a.UNSIGNED_SHORT_4_4_4_4&&(o=a.RGBA4),r===a.UNSIGNED_SHORT_5_5_5_1&&(o=a.RGB5_A1)}return t===a.RGBA_INTEGER&&(r===a.UNSIGNED_BYTE&&(o=a.RGBA8UI),r===a.UNSIGNED_SHORT&&(o=a.RGBA16UI),r===a.UNSIGNED_INT&&(o=a.RGBA32UI),r===a.BYTE&&(o=a.RGBA8I),r===a.SHORT&&(o=a.RGBA16I),r===a.INT&&(o=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(r===a.UNSIGNED_SHORT&&(o=a.DEPTH_COMPONENT16),r===a.UNSIGNED_INT&&(o=a.DEPTH_COMPONENT24),r===a.FLOAT&&(o=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&r===a.UNSIGNED_INT_24_8&&(o=a.DEPTH24_STENCIL8),(o===a.R16F||o===a.R32F||o===a.RG16F||o===a.RG32F||o===a.RGBA16F||o===a.RGBA32F)&&s.get("EXT_color_buffer_float"),o}setTextureParameters(e,t){let{gl:r,extensions:n,backend:i}=this,a=eD.getPrimaries(eD.workingColorSpace),s=""===t.colorSpace?null:eD.getPrimaries(t.colorSpace),o=""===t.colorSpace||a===s?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,t.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,o),r.texParameteri(e,r.TEXTURE_WRAP_S,D_[t.wrapS]),r.texParameteri(e,r.TEXTURE_WRAP_T,D_[t.wrapT]),e!==r.TEXTURE_3D&&e!==r.TEXTURE_2D_ARRAY||t.isArrayTexture||r.texParameteri(e,r.TEXTURE_WRAP_R,D_[t.wrapR]),r.texParameteri(e,r.TEXTURE_MAG_FILTER,Db[t.magFilter]);let l=void 0!==t.mipmaps&&t.mipmaps.length>0,u=1006===t.minFilter&&l?1008:t.minFilter;if(r.texParameteri(e,r.TEXTURE_MIN_FILTER,Db[u]),t.compareFunction&&(r.texParameteri(e,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(e,r.TEXTURE_COMPARE_FUNC,DS[t.compareFunction])),!0===n.has("EXT_texture_filter_anisotropic")){if(1003===t.magFilter||1005!==t.minFilter&&1008!==t.minFilter||1015===t.type&&!1===n.has("OES_texture_float_linear"))return;if(t.anisotropy>1){let a=n.get("EXT_texture_filter_anisotropic");r.texParameterf(e,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){let{gl:t,backend:r,defaultTextures:n}=this,i=this.getGLTextureType(e),a=n[i];void 0===a&&(a=t.createTexture(),r.state.bindTexture(i,a),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),n[i]=a),r.set(e,{textureGPU:a,glTextureType:i,isDefault:!0})}createTexture(e,t){let{gl:r,backend:n}=this,{levels:i,width:a,height:s,depth:o}=t,l=n.utils.convert(e.format,e.colorSpace),u=n.utils.convert(e.type),c=this.getInternalFormat(e.internalFormat,l,u,e.colorSpace,e.isVideoTexture),h=r.createTexture(),d=this.getGLTextureType(e);n.state.bindTexture(d,h),this.setTextureParameters(d,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?r.texStorage3D(r.TEXTURE_2D_ARRAY,i,c,a,s,o):e.isData3DTexture?r.texStorage3D(r.TEXTURE_3D,i,c,a,s,o):e.isVideoTexture||r.texStorage2D(d,i,c,a,s),n.set(e,{textureGPU:h,glTextureType:d,glFormat:l,glType:u,glInternalFormat:c})}copyBufferToTexture(e,t){let{gl:r,backend:n}=this,{textureGPU:i,glTextureType:a,glFormat:s,glType:o}=n.get(t),{width:l,height:u}=t.source.data;r.bindBuffer(r.PIXEL_UNPACK_BUFFER,e),n.state.bindTexture(a,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texSubImage2D(a,0,0,0,l,u,s,o,0),r.bindBuffer(r.PIXEL_UNPACK_BUFFER,null),n.state.unbindTexture()}updateTexture(e,t){let{gl:r}=this,{width:n,height:i}=t,{textureGPU:a,glTextureType:s,glFormat:o,glType:l,glInternalFormat:u}=this.backend.get(e);if(!e.isRenderTargetTexture&&void 0!==a)if(this.backend.state.bindTexture(s,a),this.setTextureParameters(s,e),e.isCompressedTexture){let n=e.mipmaps,i=t.image;for(let t=0;t<n.length;t++){let a=n[t];e.isCompressedArrayTexture?e.format!==r.RGBA?null!==o?r.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,t,0,0,0,a.width,a.height,i.depth,o,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texSubImage3D(r.TEXTURE_2D_ARRAY,t,0,0,0,a.width,a.height,i.depth,o,l,a.data):null!==o?r.compressedTexSubImage2D(r.TEXTURE_2D,t,0,0,a.width,a.height,o,a.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){let a=t.images,s=e.mipmaps;for(let e=0;e<6;e++){let t=Dw(a[e]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,n,i,o,l,t);for(let t=0;t<s.length;t++){let n=Dw(s[t].images[e]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,t+1,0,0,n.width,n.height,o,l,n)}}}else if(e.isDataArrayTexture||e.isArrayTexture){let n=t.image;if(e.layerUpdates.size>0){let t=lf(n.width,n.height,e.format,e.type);for(let i of e.layerUpdates){let e=n.data.subarray(i*t/n.data.BYTES_PER_ELEMENT,(i+1)*t/n.data.BYTES_PER_ELEMENT);r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,i,n.width,n.height,1,o,l,e)}e.clearLayerUpdates()}else r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,n.width,n.height,n.depth,o,l,n.data)}else if(e.isData3DTexture){let e=t.image;r.texSubImage3D(r.TEXTURE_3D,0,0,0,0,e.width,e.height,e.depth,o,l,e.data)}else if(e.isVideoTexture)e.update(),r.texImage2D(s,0,u,o,l,t.image);else{let a=e.mipmaps;if(a.length>0)for(let e=0,t=a.length;e<t;e++){let t=a[e],n=Dw(t);r.texSubImage2D(s,e,0,0,t.width,t.height,o,l,n)}else{let e=Dw(t.image);r.texSubImage2D(s,0,0,0,n,i,o,l,e)}}}generateMipmaps(e){let{gl:t,backend:r}=this,{textureGPU:n,glTextureType:i}=r.get(e);r.state.bindTexture(i,n),t.generateMipmap(i)}deallocateRenderBuffers(e){let{gl:t,backend:r}=this;if(e){let n=r.get(e);if(n.renderBufferStorageSetup=void 0,n.framebuffers){for(let e in n.framebuffers)t.deleteFramebuffer(n.framebuffers[e]);delete n.framebuffers}if(n.depthRenderbuffer&&(t.deleteRenderbuffer(n.depthRenderbuffer),delete n.depthRenderbuffer),n.stencilRenderbuffer&&(t.deleteRenderbuffer(n.stencilRenderbuffer),delete n.stencilRenderbuffer),n.msaaFrameBuffer&&(t.deleteFramebuffer(n.msaaFrameBuffer),delete n.msaaFrameBuffer),n.msaaRenderbuffers){for(let e=0;e<n.msaaRenderbuffers.length;e++)t.deleteRenderbuffer(n.msaaRenderbuffers[e]);delete n.msaaRenderbuffers}}}destroyTexture(e){let{gl:t,backend:r}=this,{textureGPU:n,renderTarget:i}=r.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(n),r.delete(e)}copyTextureToTexture(e,t){let r,n,i,a,s,o,l,u,c,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,{gl:f,backend:m}=this,{state:g}=this.backend,{textureGPU:y,glTextureType:v,glType:x,glFormat:_}=m.get(t);g.bindTexture(v,y);let b=e.isCompressedTexture?e.mipmaps[p]:e.image;if(null!==h)r=h.max.x-h.min.x,n=h.max.y-h.min.y,i=h.isBox3?h.max.z-h.min.z:1,a=h.min.x,s=h.min.y,o=h.isBox3?h.min.z:0;else{let t=Math.pow(2,-A);r=Math.floor(b.width*t),n=Math.floor(b.height*t),i=e.isDataArrayTexture||e.isArrayTexture?b.depth:e.isData3DTexture?Math.floor(b.depth*t):1,a=0,s=0,o=0}null!==d?(l=d.x,u=d.y,c=d.z):(l=0,u=0,c=0),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,t.flipY),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),f.pixelStorei(f.UNPACK_ALIGNMENT,t.unpackAlignment);let S=f.getParameter(f.UNPACK_ROW_LENGTH),T=f.getParameter(f.UNPACK_IMAGE_HEIGHT),w=f.getParameter(f.UNPACK_SKIP_PIXELS),M=f.getParameter(f.UNPACK_SKIP_ROWS),E=f.getParameter(f.UNPACK_SKIP_IMAGES);f.pixelStorei(f.UNPACK_ROW_LENGTH,b.width),f.pixelStorei(f.UNPACK_IMAGE_HEIGHT,b.height),f.pixelStorei(f.UNPACK_SKIP_PIXELS,a),f.pixelStorei(f.UNPACK_SKIP_ROWS,s),f.pixelStorei(f.UNPACK_SKIP_IMAGES,o);let R=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){let i=m.get(e),o=m.get(t),c=m.get(i.renderTarget),h=m.get(o.renderTarget),d=c.framebuffers[i.cacheKey],A=h.framebuffers[o.cacheKey];g.bindFramebuffer(f.READ_FRAMEBUFFER,d),g.bindFramebuffer(f.DRAW_FRAMEBUFFER,A);let p=f.COLOR_BUFFER_BIT;e.isDepthTexture&&(p=f.DEPTH_BUFFER_BIT),f.blitFramebuffer(a,s,r,n,l,u,r,n,p,f.NEAREST),g.bindFramebuffer(f.READ_FRAMEBUFFER,null),g.bindFramebuffer(f.DRAW_FRAMEBUFFER,null)}else R?e.isDataTexture||e.isData3DTexture?f.texSubImage3D(v,p,l,u,c,r,n,i,_,x,b.data):t.isCompressedArrayTexture?f.compressedTexSubImage3D(v,p,l,u,c,r,n,i,_,b.data):f.texSubImage3D(v,p,l,u,c,r,n,i,_,x,b):e.isDataTexture?f.texSubImage2D(v,p,l,u,r,n,_,x,b.data):e.isCompressedTexture?f.compressedTexSubImage2D(v,p,l,u,b.width,b.height,_,b.data):f.texSubImage2D(v,p,l,u,r,n,_,x,b);f.pixelStorei(f.UNPACK_ROW_LENGTH,S),f.pixelStorei(f.UNPACK_IMAGE_HEIGHT,T),f.pixelStorei(f.UNPACK_SKIP_PIXELS,w),f.pixelStorei(f.UNPACK_SKIP_ROWS,M),f.pixelStorei(f.UNPACK_SKIP_IMAGES,E),0===p&&t.generateMipmaps&&f.generateMipmap(v),g.unbindTexture()}copyFramebufferToTexture(e,t,r){let{gl:n}=this,{state:i}=this.backend,{textureGPU:a}=this.backend.get(e),{x:s,y:o,z:l,w:u}=r,c=!0===e.isDepthTexture||t.renderTarget&&t.renderTarget.samples>0,h=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(c){let r,c,d=0!==s||0!==o;if(!0===e.isDepthTexture?(r=n.DEPTH_BUFFER_BIT,c=n.DEPTH_ATTACHMENT,t.stencil&&(r|=n.STENCIL_BUFFER_BIT)):(r=n.COLOR_BUFFER_BIT,c=n.COLOR_ATTACHMENT0),d){let e=this.backend.get(t.renderTarget),c=e.framebuffers[t.getCacheKey()],d=e.msaaFrameBuffer;i.bindFramebuffer(n.DRAW_FRAMEBUFFER,c),i.bindFramebuffer(n.READ_FRAMEBUFFER,d);let A=h-o-u;n.blitFramebuffer(s,A,s+l,A+u,s,A,s+l,A+u,r,n.NEAREST),i.bindFramebuffer(n.READ_FRAMEBUFFER,c),i.bindTexture(n.TEXTURE_2D,a),n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,s,A,l,u),i.unbindTexture()}else{let e=n.createFramebuffer();i.bindFramebuffer(n.DRAW_FRAMEBUFFER,e),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,c,n.TEXTURE_2D,a,0),n.blitFramebuffer(0,0,l,u,0,0,l,u,r,n.NEAREST),n.deleteFramebuffer(e)}}else i.bindTexture(n.TEXTURE_2D,a),n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,s,h-u-o,l,u),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{gl:i}=this,a=t.renderTarget,{depthTexture:s,depthBuffer:o,stencilBuffer:l,width:u,height:c}=a;if(i.bindRenderbuffer(i.RENDERBUFFER,e),o&&!l){let t=i.DEPTH_COMPONENT24;!0===n?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(i.RENDERBUFFER,a.samples,t,u,c):r>0?(s&&s.isDepthTexture&&s.type===i.FLOAT&&(t=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,r,t,u,c)):i.renderbufferStorage(i.RENDERBUFFER,t,u,c),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else o&&l&&(r>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,r,i.DEPTH24_STENCIL8,u,c):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,u,c),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e));i.bindRenderbuffer(i.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,r,n,i,a){let{backend:s,gl:o}=this,{textureGPU:l,glFormat:u,glType:c}=this.backend.get(e),h=o.createFramebuffer();o.bindFramebuffer(o.READ_FRAMEBUFFER,h);let d=e.isCubeTexture?o.TEXTURE_CUBE_MAP_POSITIVE_X+a:o.TEXTURE_2D;o.framebufferTexture2D(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,d,l,0);let A=this._getTypedArrayType(c),p=n*i*this._getBytesPerTexel(c,u),f=o.createBuffer();o.bindBuffer(o.PIXEL_PACK_BUFFER,f),o.bufferData(o.PIXEL_PACK_BUFFER,p,o.STREAM_READ),o.readPixels(t,r,n,i,u,c,0),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),await s.utils._clientWaitAsync();let m=new A(p/A.BYTES_PER_ELEMENT);return o.bindBuffer(o.PIXEL_PACK_BUFFER,f),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,m),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),o.deleteFramebuffer(h),m}_getTypedArrayType(e){let{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw Error("Unsupported WebGL type: ".concat(e))}_getBytesPerTexel(e,t){let{gl:r}=this,n=0;return(e===r.UNSIGNED_BYTE&&(n=1),(e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5||e===r.UNSIGNED_SHORT||e===r.HALF_FLOAT)&&(n=2),(e===r.UNSIGNED_INT||e===r.FLOAT)&&(n=4),t===r.RGBA)?4*n:t===r.RGB?3*n:t===r.ALPHA?n:void 0}constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},!1===Dx&&(this._init(),Dx=!0)}}function Dw(e){return e.isDataTexture?e.image.data:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?e:e.data}class DM{get(e){let t=this.extensions[e];return void 0===t&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}}class DE{getMaxAnisotropy(){if(null!==this.maxAnisotropy)return this.maxAnisotropy;let e=this.backend.gl,t=this.backend.extensions;if(!0===t.has("EXT_texture_filter_anisotropic")){let r=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}constructor(e){this.backend=e,this.maxAnisotropy=null}}let DR={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class DC{render(e,t){let{gl:r,mode:n,object:i,type:a,info:s,index:o}=this;0!==o?r.drawElements(n,t,a,e):r.drawArrays(n,e,t),s.update(i,t,1)}renderInstances(e,t,r){let{gl:n,mode:i,type:a,index:s,object:o,info:l}=this;0!==r&&(0!==s?n.drawElementsInstanced(i,t,a,e,r):n.drawArraysInstanced(i,e,t,r),l.update(o,t,r))}renderMultiDraw(e,t,r){let{extensions:n,mode:i,object:a,info:s}=this;if(0===r)return;let o=n.get("WEBGL_multi_draw");if(null===o)for(let n=0;n<r;n++)this.render(e[n],t[n]);else{0!==this.index?o.multiDrawElementsWEBGL(i,t,0,this.type,e,0,r):o.multiDrawArraysWEBGL(i,e,0,t,0,r);let n=0;for(let e=0;e<r;e++)n+=t[e];s.update(a,n,1)}}renderMultiDrawInstances(e,t,r,n){let{extensions:i,mode:a,object:s,info:o}=this;if(0===r)return;let l=i.get("WEBGL_multi_draw");if(null===l)for(let i=0;i<r;i++)this.renderInstances(e[i],t[i],n[i]);else{0!==this.index?l.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,n,0,r):l.multiDrawArraysInstancedWEBGL(a,e,0,t,0,n,0,r);let i=0;for(let e=0;e<r;e++)i+=t[e]*n[e];o.update(s,i,1)}}constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}}class DN{allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}}class DP extends DN{allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return eP("WebGPUTimestampQueryPool [".concat(this.type,"]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.").concat(this.type.toUpperCase()," ).")),null;let t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;let t=this.queryOffsets.get(e);if(null==t||null!==this.activeQuery)return;let r=this.queries[t];if(r)try{"inactive"===this.queryStates.get(t)&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,r),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(e){console.error("Error in beginQuery:",e),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;let t=this.queryOffsets.get(e);if(null!=t&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(e){console.error("Error in endQuery:",e),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{let e=[];for(let[t,r]of this.queryStates)if("ended"===r){let r=this.queries[t];e.push(this.resolveQuery(r))}if(0===e.length)return this.lastValue;let t=(await Promise.all(e)).reduce((e,t)=>e+t,0);return this.lastValue=t,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,t}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{let r;if(this.isDisposed)return void t(this.lastValue);let n=!1,i=e=>{n||(n=!0,r&&(clearTimeout(r),r=null),t(e))},a=()=>{if(this.isDisposed)return void i(this.lastValue);try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT))return void i(this.lastValue);if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){r=setTimeout(a,1);return}let n=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(n)/1e6)}catch(e){console.error("Error checking query:",e),t(this.lastValue)}};a()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,this.trackTimestamp)){for(let e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}constructor(e,t,r=2048){if(super(r),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let t=0;t<this.maxQueries;t++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}}class DI extends Dp{init(e){super.init(e);let t=this.parameters,r={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},n=void 0!==t.context?t.context:e.domElement.getContext("webgl2",r);function i(t){t.preventDefault();let r={api:"WebGL",message:t.statusMessage||"Unknown reason",reason:null,originalEvent:t};e.onDeviceLost(r)}this._onContextLost=i,e.domElement.addEventListener("webglcontextlost",i,!1),this.gl=n,this.extensions=new DM(this),this.capabilities=new DE(this),this.attributeUtils=new Dg(this),this.textureUtils=new DT(this),this.bufferRenderer=new DC(this),this.state=new Dy(this),this.utils=new Dv(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return 2e3}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){!0!==this.gl.getContextAttributes().xrCompatible&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:n.RGBA8}),null!==r){let t=e.stencilBuffer?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:r,glInternalFormat:t}),!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!0===e._autoAllocateDepthBuffer&&!1===e.multiview&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new DP(this.gl,e,2048));let r=this.timestampQueryPool[e];null!==r.allocateQueriesForContext(t)&&r.beginQuery(t)}prepareTimestampBuffer(e,t){this.disjoint&&this.trackTimestamp&&this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){let{state:t}=this,r=this.get(e);if(r.frameCalls=this.renderer.info.render.frameCalls,e.viewport)this.updateViewport(e);else{let{width:e,height:r}=this.getDrawingBufferSize();t.viewport(0,0,e,r)}if(e.scissor){let{x:r,y:n,width:i,height:a}=e.scissorValue;t.scissor(r,e.height-a-n,i,a)}this.initTimestampQuery(en.RENDER,this.getTimestampUID(e)),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);let n=e.occlusionQueryCount;n>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=Array(n),r.occlusionQueryObjects=Array(n),r.occlusionQueryIndex=0)}finishRender(e){let{gl:t,state:r}=this,n=this.get(e),i=n.previousContext;r.resetVertexState();let a=e.occlusionQueryCount;a>0&&(a>n.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));let s=e.textures;if(null!==s)for(let e=0;e<s.length;e++){let t=s[e];t.generateMipmaps&&this.generateMipmaps(t)}if(this._currentContext=i,this._resolveRenderTarget(e),null!==i)if(this._setFramebuffer(i),i.viewport)this.updateViewport(i);else{let{width:e,height:t}=this.getDrawingBufferSize();r.viewport(0,0,e,t)}this.prepareTimestampBuffer(en.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){let t=this.get(e),{currentOcclusionQueries:r,currentOcclusionQueryObjects:n}=t;if(r&&n){let e=new WeakSet,{gl:i}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;let a=()=>{let s=0;for(let t=0;t<r.length;t++){let a=r[t];null!==a&&i.getQueryParameter(a,i.QUERY_RESULT_AVAILABLE)&&(0===i.getQueryParameter(a,i.QUERY_RESULT)&&e.add(n[t]),r[t]=null,i.deleteQuery(a),s++)}s<r.length?requestAnimationFrame(a):t.occluded=e};a()}}isOccluded(e,t){let r=this.get(e);return r.occluded&&r.occluded.has(t)}updateViewport(e){let{state:t}=this,{x:r,y:n,width:i,height:a}=e.viewportValue;t.viewport(r,e.height-a-n,i,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){let e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4],a=!(arguments.length>5)||void 0===arguments[5]||arguments[5],{gl:s,renderer:o}=this;null===n&&(n={textures:null,clearColorValue:this.getClearColor()});let l=0;if(e&&(l|=s.COLOR_BUFFER_BIT),t&&(l|=s.DEPTH_BUFFER_BIT),r&&(l|=s.STENCIL_BUFFER_BIT),0!==l){let u;u=n.clearColorValue?n.clearColorValue:this.getClearColor();let c=o.getClearDepth(),h=o.getClearStencil();if(t&&this.state.setDepthMask(!0),null===n.textures)s.clearColor(u.r,u.g,u.b,u.a),s.clear(l);else{if(i&&this._setFramebuffer(n),e)for(let e=0;e<n.textures.length;e++)0===e?s.clearBufferfv(s.COLOR,e,[u.r,u.g,u.b,u.a]):s.clearBufferfv(s.COLOR,e,[0,0,0,1]);t&&r?s.clearBufferfi(s.DEPTH_STENCIL,0,c,h):t?s.clearBufferfv(s.DEPTH,0,[c]):r&&s.clearBufferiv(s.STENCIL,0,[h]),i&&a&&this._resolveRenderTarget(n)}}}beginCompute(e){let{state:t,gl:r}=this;this.get(e).frameCalls=this.renderer.info.compute.frameCalls,t.bindFramebuffer(r.FRAMEBUFFER,null),this.initTimestampQuery(en.COMPUTE,this.getTimestampUID(e))}compute(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,{state:a,gl:s}=this;!1===this.discard&&(s.enable(s.RASTERIZER_DISCARD),this.discard=!0);let{programGPU:o,transformBuffers:l,attributes:u}=this.get(n),c=this._getVaoKey(u),h=this.vaoCache[c];void 0===h?this.vaoCache[c]=this._createVao(u):a.setVertexState(h),a.useProgram(o),this._bindUniforms(r);let d=this._getTransformFeedback(l);s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,d),s.beginTransformFeedback(s.POINTS),Array.isArray(i=null!==i?i:t.count)&&(eP("WebGLBackend.compute(): The count parameter must be a single number, not an array."),i=i[0]),u[0].isStorageInstancedBufferAttribute?s.drawArraysInstanced(s.POINTS,0,1,i):s.drawArrays(s.POINTS,0,i),s.endTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null);for(let e=0;e<l.length;e++){let t=l[e];t.pbo&&this.has(t.pbo)&&this.textureUtils.copyBufferToTexture(t.transformBuffer,t.pbo),t.switchBuffers()}}finishCompute(e){let t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(en.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){let{object:t,pipeline:r,material:n,context:i,hardwareClippingPlanes:a}=e,{programGPU:s}=this.get(r),{gl:o,state:l}=this,u=this.get(i),c=e.getDrawParameters();if(null===c)return;this._bindUniforms(e.getBindings());let h=t.isMesh&&0>t.matrixWorld.determinant();l.setMaterial(n,h,a),l.useProgram(s);let d=e.getAttributes(),A=this.get(d),p=A.vaoGPU;if(void 0===p){let e=this._getVaoKey(d);void 0===(p=this.vaoCache[e])&&(p=this._createVao(d),this.vaoCache[e]=p,A.vaoGPU=p)}let f=e.getIndex(),m=null!==f?this.get(f).bufferGPU:null;l.setVertexState(p,m);let g=u.lastOcclusionObject;if(g!==t&&void 0!==g){if(null!==g&&!0===g.occlusionTest&&(o.endQuery(o.ANY_SAMPLES_PASSED),u.occlusionQueryIndex++),!0===t.occlusionTest){let e=o.createQuery();o.beginQuery(o.ANY_SAMPLES_PASSED,e),u.occlusionQueries[u.occlusionQueryIndex]=e,u.occlusionQueryObjects[u.occlusionQueryIndex]=t}u.lastOcclusionObject=t}let y=this.bufferRenderer;t.isPoints?y.mode=o.POINTS:t.isLineSegments?y.mode=o.LINES:t.isLine?y.mode=o.LINE_STRIP:t.isLineLoop?y.mode=o.LINE_LOOP:!0===n.wireframe?(l.setLineWidth(n.wireframeLinewidth*this.renderer.getPixelRatio()),y.mode=o.LINES):y.mode=o.TRIANGLES;let{vertexCount:v,instanceCount:x}=c,{firstVertex:_}=c;if(y.object=t,null!==f){_*=f.array.BYTES_PER_ELEMENT;let e=this.get(f);y.index=f.count,y.type=e.type}else y.index=0;let b=()=>{t.isBatchedMesh?null!==t._multiDrawInstances?(eP("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),y.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?y.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):eP("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):x>1?y.renderInstances(_,v,x):y.render(_,v)};if(!0===e.camera.isArrayCamera&&e.camera.cameras.length>0&&!1===e.camera.isMultiViewCamera){let r=this.get(e.camera),n=e.camera.cameras,i=e.getBindingGroup("cameraIndex").bindings[0];if(void 0===r.indexesGPU||r.indexesGPU.length!==n.length){let e=new Uint32Array([0,0,0,0]),t=[];for(let r=0,i=n.length;r<i;r++){let n=o.createBuffer();e[0]=r,o.bindBuffer(o.UNIFORM_BUFFER,n),o.bufferData(o.UNIFORM_BUFFER,e,o.STATIC_DRAW),t.push(n)}r.indexesGPU=t}let a=this.get(i),s=this.renderer.getPixelRatio(),u=this._currentContext.renderTarget,c=this._isRenderCameraDepthArray(this._currentContext),h=this._currentContext.activeCubeFace;if(c){let e=this.get(u.depthTexture);if(e.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){e.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;let{stencilBuffer:t}=u;for(let e=0,r=n.length;e<r;e++)this.renderer._activeCubeFace=e,this._currentContext.activeCubeFace=e,this._setFramebuffer(this._currentContext),this.clear(!1,!0,t,this._currentContext,!1,!1);this.renderer._activeCubeFace=h,this._currentContext.activeCubeFace=h}}for(let i=0,u=n.length;i<u;i++){let u=n[i];if(t.layers.test(u.layers)){c&&(this.renderer._activeCubeFace=i,this._currentContext.activeCubeFace=i,this._setFramebuffer(this._currentContext));let t=u.viewport;if(void 0!==t){let r=t.x*s,n=t.y*s,i=t.width*s,a=t.height*s;l.viewport(Math.floor(r),Math.floor(e.context.height-a-n),Math.floor(i),Math.floor(a))}l.bindBufferBase(o.UNIFORM_BUFFER,a.index,r.indexesGPU[i]),b()}this._currentContext.activeCubeFace=h,this.renderer._activeCubeFace=h}}else b()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,n,i,a){return this.textureUtils.copyTextureToBuffer(e,t,r,n,i,a)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new Dh(e,t)}createProgram(e){let t=this.gl,{stage:r,code:n}=e,i="fragment"===r?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,n),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){let r=this.gl,n=e.pipeline,{fragmentProgram:i,vertexProgram:a}=n,s=r.createProgram(),o=this.get(i).shaderGPU,l=this.get(a).shaderGPU;if(r.attachShader(s,o),r.attachShader(s,l),r.linkProgram(s),this.set(n,{programGPU:s,fragmentShader:o,vertexShader:l}),null!==t&&this.parallel){let i=new Promise(t=>{let i=this.parallel,a=()=>{r.getProgramParameter(s,i.COMPLETION_STATUS_KHR)?(this._completeCompile(e,n),t()):requestAnimationFrame(a)};a()});t.push(i);return}this._completeCompile(e,n)}_handleSource(e,t){let r=e.split("\n"),n=[],i=Math.max(t-6,0),a=Math.min(t+6,r.length);for(let e=i;e<a;e++){let i=e+1;n.push("".concat(i===t?">":" "," ").concat(i,": ").concat(r[e]))}return n.join("\n")}_getShaderErrors(e,t,r){let n=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(n&&""===i)return"";let a=/ERROR: 0:(\d+)/.exec(i);if(!a)return i;{let n=parseInt(a[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+this._handleSource(e.getShaderSource(t),n)}}_logProgramError(e,t,r){if(this.renderer.debug.checkShaderErrors){let n=this.gl,i=(n.getProgramInfoLog(e)||"").trim();if(!1===n.getProgramParameter(e,n.LINK_STATUS))if("function"==typeof this.renderer.debug.onShaderError)this.renderer.debug.onShaderError(n,e,r,t);else{let a=this._getShaderErrors(n,r,"vertex"),s=this._getShaderErrors(n,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(e,n.VALIDATE_STATUS)+"\n\nProgram Info Log: "+i+"\n"+a+"\n"+s)}else""!==i&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){let{state:r,gl:n}=this,{programGPU:i,fragmentShader:a,vertexShader:s}=this.get(t);!1===n.getProgramParameter(i,n.LINK_STATUS)&&this._logProgramError(i,a,s),r.useProgram(i);let o=e.getBindings();this._setupBindings(o,i),this.set(t,{programGPU:i})}createComputePipeline(e,t){let{state:r,gl:n}=this,i={stage:"fragment",code:"#version 300 es\nprecision highp float;\nvoid main() {}"};this.createProgram(i);let{computeProgram:a}=e,s=n.createProgram(),o=this.get(i).shaderGPU,l=this.get(a).shaderGPU,u=a.transforms,c=[],h=[];for(let e=0;e<u.length;e++){let t=u[e];c.push(t.varyingName),h.push(t.attributeNode)}n.attachShader(s,o),n.attachShader(s,l),n.transformFeedbackVaryings(s,c,n.SEPARATE_ATTRIBS),n.linkProgram(s),!1===n.getProgramParameter(s,n.LINK_STATUS)&&this._logProgramError(s,o,l),r.useProgram(s),this._setupBindings(t,s);let d=a.attributes,A=[],p=[];for(let e=0;e<d.length;e++){let t=d[e].node.attribute;A.push(t),this.has(t)||this.attributeUtils.createAttribute(t,n.ARRAY_BUFFER)}for(let e=0;e<h.length;e++){let t=h[e].attribute;this.has(t)||this.attributeUtils.createAttribute(t,n.ARRAY_BUFFER);let r=this.get(t);p.push(r)}this.set(e,{programGPU:s,transformBuffers:p,attributes:A})}createBindings(e,t){if(!1===this._knownBindings.has(t)){this._knownBindings.add(t);let e=0,r=0;for(let n of t)for(let t of(this.set(n,{textures:r,uniformBuffers:e}),n.bindings))t.isUniformBuffer&&e++,t.isSampledTexture&&r++}this.updateBindings(e,t)}updateBindings(e){let{gl:t}=this,r=this.get(e),n=r.uniformBuffers,i=r.textures;for(let r of e.bindings){let e=this.get(r);if(r.isUniformsGroup||r.isUniformBuffer){let i=r.buffer,{bufferGPU:a}=this.get(i);void 0===a?(a=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,a),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW),this.set(i,{bufferGPU:a})):(t.bindBuffer(t.UNIFORM_BUFFER,a),t.bufferSubData(t.UNIFORM_BUFFER,0,i)),e.index=n++,e.bufferGPU=a,this.set(r,e)}else if(r.isSampledTexture){let{textureGPU:t,glTextureType:n}=this.get(r.texture);e.index=i++,e.textureGPU=t,e.glTextureType=n,this.set(r,e)}}}updateBinding(e){let t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){let r=this.get(e).bufferGPU,n=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,n,t.DYNAMIC_DRAW)}}createIndexAttribute(e){let t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;let t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;let t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){let t=Object.keys(DR).filter(t=>DR[t]===e),r=this.extensions;for(let e=0;e<t.length;e++)if(r.has(t[e]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.textureUtils.copyTextureToTexture(e,t,r,n,i,a)}copyFramebufferToTexture(e,t,r){this.textureUtils.copyFramebufferToTexture(e,t,r)}_setFramebuffer(e){let{gl:t,state:r}=this,n=null;if(null!==e.textures){let i,a=e.renderTarget,s=this.get(a),{samples:o,depthBuffer:l,stencilBuffer:u}=a,c=!0===a.isWebGLCubeRenderTarget,h=!0===a.isRenderTarget3D,d=a.depth>1,A=!0===a.isXRRenderTarget,p=!0===A&&!0===a._hasExternalTextures,f=s.msaaFrameBuffer,m=s.depthRenderbuffer,g=this.extensions.get("WEBGL_multisampled_render_to_texture"),y=this.extensions.get("OVR_multiview2"),v=this._useMultisampledExtension(a),x=RF(e);if(c?(s.cubeFramebuffers||(s.cubeFramebuffers={}),i=s.cubeFramebuffers[x]):A&&!1===p?i=this._xrFramebuffer:(s.framebuffers||(s.framebuffers={}),i=s.framebuffers[x]),void 0===i){i=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,i);let n=e.textures,l=[];if(c){s.cubeFramebuffers[x]=i;let{textureGPU:e}=this.get(n[0]),r=this.renderer._activeCubeFace,a=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+r,e,a)}else{s.framebuffers[x]=i;for(let r=0;r<n.length;r++){let i=n[r],s=this.get(i);s.renderTarget=e.renderTarget,s.cacheKey=x;let l=t.COLOR_ATTACHMENT0+r;if(a.multiview)y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,l,s.textureGPU,0,o,0,2);else if(h||d){let e=this.renderer._activeCubeFace,r=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,l,s.textureGPU,r,e)}else if(v)g.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,l,t.TEXTURE_2D,s.textureGPU,0,o);else{let e=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,l,t.TEXTURE_2D,s.textureGPU,e)}}}let A=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===a._autoAllocateDepthBuffer){let r=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(r,e,0,v),s.xrDepthRenderbuffer=r,l.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,A,t.RENDERBUFFER,r)}else if(null!==e.depthTexture){l.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);let r=this.get(e.depthTexture);if(r.renderTarget=e.renderTarget,r.cacheKey=x,a.multiview)y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,A,r.textureGPU,0,o,0,2);else if(p&&v)g.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,A,t.TEXTURE_2D,r.textureGPU,0,o);else if(e.depthTexture.isArrayTexture){let e=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,A,r.textureGPU,0,e)}else t.framebufferTexture2D(t.FRAMEBUFFER,A,t.TEXTURE_2D,r.textureGPU,0)}s.depthInvalidationArray=l}else{if(this._isRenderCameraDepthArray(e)){r.bindFramebuffer(t.FRAMEBUFFER,i);let n=this.renderer._activeCubeFace,a=this.get(e.depthTexture),s=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,s,a.textureGPU,0,n)}if((A||v||a.multiview)&&!0!==a._isOpaqueFramebuffer){r.bindFramebuffer(t.FRAMEBUFFER,i);let n=this.get(e.textures[0]);a.multiview?y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,n.textureGPU,0,o,0,2):v?g.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.textureGPU,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.textureGPU,0);let l=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===a._autoAllocateDepthBuffer){let e=s.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,l,t.RENDERBUFFER,e)}else{let r=this.get(e.depthTexture);a.multiview?y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,l,r.textureGPU,0,o,0,2):v?g.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,l,t.TEXTURE_2D,r.textureGPU,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,l,t.TEXTURE_2D,r.textureGPU,0)}}}if(o>0&&!1===v&&!a.multiview){if(void 0===f){let n=[];f=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,f);let i=[],a=e.textures;for(let r=0;r<a.length;r++){i[r]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,i[r]),n.push(t.COLOR_ATTACHMENT0+r);let a=e.textures[r],s=this.get(a);t.renderbufferStorageMultisample(t.RENDERBUFFER,o,s.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+r,t.RENDERBUFFER,i[r])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),s.msaaFrameBuffer=f,s.msaaRenderbuffers=i,l&&void 0===m){m=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(m,e,o),s.depthRenderbuffer=m;let r=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;n.push(r)}s.invalidationArray=n}n=s.msaaFrameBuffer}else n=i;r.drawBuffers(e,i)}r.bindFramebuffer(t.FRAMEBUFFER,n)}_getVaoKey(e){let t="";for(let r=0;r<e.length;r++)t+=":"+this.get(e[r]).id;return t}_createVao(e){let{gl:t}=this,r=t.createVertexArray();t.bindVertexArray(r);for(let r=0;r<e.length;r++){let n,i,a=e[r],s=this.get(a);t.bindBuffer(t.ARRAY_BUFFER,s.bufferGPU),t.enableVertexAttribArray(r),!0===a.isInterleavedBufferAttribute?(n=a.data.stride*s.bytesPerElement,i=a.offset*s.bytesPerElement):(n=0,i=0),s.isInteger?t.vertexAttribIPointer(r,a.itemSize,s.type,n,i):t.vertexAttribPointer(r,a.itemSize,s.type,a.normalized,n,i),a.isInstancedBufferAttribute&&!a.isInterleavedBufferAttribute?t.vertexAttribDivisor(r,a.meshPerAttribute):a.isInterleavedBufferAttribute&&a.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(r,a.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),r}_getTransformFeedback(e){let t="";for(let r=0;r<e.length;r++)t+=":"+e[r].id;let r=this.transformFeedbackCache[t];if(void 0!==r)return r;let{gl:n}=this;r=n.createTransformFeedback(),n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,r);for(let t=0;t<e.length;t++){let r=e[t];n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,t,r.transformBuffer)}return n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=r,r}_setupBindings(e,t){let r=this.gl;for(let n of e)for(let e of n.bindings){let n=this.get(e).index;if(e.isUniformsGroup||e.isUniformBuffer){let i=r.getUniformBlockIndex(t,e.name);r.uniformBlockBinding(t,i,n)}else if(e.isSampledTexture){let i=r.getUniformLocation(t,e.name);r.uniform1i(i,n)}}}_bindUniforms(e){let{gl:t,state:r}=this;for(let n of e)for(let e of n.bindings){let n=this.get(e),i=n.index;e.isUniformsGroup||e.isUniformBuffer?r.bindBufferBase(t.UNIFORM_BUFFER,i,n.bufferGPU):e.isSampledTexture&&r.bindTexture(n.glTextureType,n.textureGPU,t.TEXTURE0+i)}}_resolveRenderTarget(e){let{gl:t,state:r}=this,n=e.renderTarget;if(null!==e.textures&&n){let i=this.get(n);if(n.samples>0&&!1===this._useMultisampledExtension(n)){let a=i.framebuffers[e.getCacheKey()],s=t.COLOR_BUFFER_BIT;n.resolveDepthBuffer&&(n.depthBuffer&&(s|=t.DEPTH_BUFFER_BIT),n.stencilBuffer&&n.resolveStencilBuffer&&(s|=t.STENCIL_BUFFER_BIT));let o=i.msaaFrameBuffer,l=i.msaaRenderbuffers,u=e.textures,c=u.length>1;if(r.bindFramebuffer(t.READ_FRAMEBUFFER,o),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),c)for(let e=0;e<u.length;e++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);for(let r=0;r<u.length;r++){if(c){let{textureGPU:e}=this.get(u[r]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,l[r]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}if(e.scissor){let{x:r,y:n,width:i,height:a}=e.scissorValue,o=e.height-a-n;t.blitFramebuffer(r,o,r+i,o+a,r,o,r+i,o+a,s,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,s,t.NEAREST)}if(c)for(let e=0;e<u.length;e++){let{textureGPU:r}=this.get(u[e]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,l[e]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,r,0)}!0===this._supportsInvalidateFramebuffer&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,i.invalidationArray)}else if(!1===n.resolveDepthBuffer&&i.framebuffers){let n=i.framebuffers[e.getCacheKey()];r.bindFramebuffer(t.DRAW_FRAMEBUFFER,n),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,i.depthInvalidationArray)}}}_useMultisampledExtension(e){return!0===e.multiview||e.samples>0&&!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!1!==e._autoAllocateDepthBuffer}dispose(){let e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}}let DL={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},DD={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},DB={Store:"store"},DF={Load:"load",Clear:"clear"},DU={CCW:"ccw",CW:"cw"},DO={None:"none",Back:"back"},Dk={Uint16:"uint16",Uint32:"uint32"},Dz={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rg11b10ufloat",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-unorm-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},DV={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},Dq={Linear:"linear",Nearest:"nearest"},DG={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},DH={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},Dj={None:0,All:15},DW={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},DX={Storage:"storage",ReadOnlyStorage:"read-only-storage"},DQ={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},DY={NonFiltering:"non-filtering",Comparison:"comparison"},DK={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},DZ={TwoD:"2d",ThreeD:"3d"},DJ={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},D$={All:"all"},D0={Vertex:"vertex",Instance:"instance"},D1={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"};class D2 extends L9{update(){this.texture=this.textureNode.value}constructor(e,t,r){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r}}class D3 extends L2{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let D4=0;class D5 extends D3{get buffer(){return this.nodeUniform.value}constructor(e,t){super("StorageBuffer_"+D4++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:yu.READ_WRITE,this.groupNode=t}}class D6 extends Rp{getTransferPipeline(e){let t=this.transferPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:"mipmap-".concat(e),vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:DL.TriangleStrip,stripIndexFormat:Dk.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:"flipY-".concat(e),vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:DL.TriangleStrip,stripIndexFormat:Dk.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.format,{width:i,height:a}=t.size,s=this.getTransferPipeline(n),o=this.getFlipYPipeline(n),l=this.device.createTexture({size:{width:i,height:a,depthOrArrayLayers:1},format:n,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),u=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:DJ.TwoD,baseArrayLayer:r}),c=l.createView({baseMipLevel:0,mipLevelCount:1,dimension:DJ.TwoD,baseArrayLayer:0}),h=this.device.createCommandEncoder({}),d=(e,t,r)=>{let n=e.getBindGroupLayout(0),i=this.device.createBindGroup({layout:n,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:t}]}),a=h.beginRenderPass({colorAttachments:[{view:r,loadOp:DF.Clear,storeOp:DB.Store,clearValue:[0,0,0,0]}]});a.setPipeline(e),a.setBindGroup(0,i),a.draw(4,1,0,0),a.end()};d(s,u,c),d(o,c,u),this.device.queue.submit([h.finish()]),l.destroy()}generateMipmaps(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.get(e);void 0===n.useCount&&(n.useCount=0,n.layers=[]);let i=n.layers[r]||this._mipmapCreateBundles(e,t,r),a=this.device.createCommandEncoder({});this._mipmapRunBundles(a,i),this.device.queue.submit([a.finish()]),0!==n.useCount&&(n.layers[r]=i),n.useCount++}_mipmapCreateBundles(e,t,r){let n=this.getTransferPipeline(t.format),i=n.getBindGroupLayout(0),a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:DJ.TwoD,baseArrayLayer:r}),s=[];for(let o=1;o<t.mipLevelCount;o++){let l=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),u=e.createView({baseMipLevel:o,mipLevelCount:1,dimension:DJ.TwoD,baseArrayLayer:r}),c={colorAttachments:[{view:u,loadOp:DF.Clear,storeOp:DB.Store,clearValue:[0,0,0,0]}]},h=this.device.createRenderBundleEncoder({colorFormats:[t.format]});h.setPipeline(n),h.setBindGroup(0,l),h.draw(4,1,0,0),s.push({renderBundles:[h.finish()],passDescriptor:c}),a=u}return s}_mipmapRunBundles(e,t){let r=t.length;for(let n=0;n<r;n++){let r=t[n],i=e.beginRenderPass(r.passDescriptor);i.executeBundles(r.renderBundles),i.end()}}constructor(e){super(),this.device=e,this.mipmapSampler=e.createSampler({minFilter:Dq.Linear}),this.flipYSampler=e.createSampler({minFilter:Dq.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:"\nstruct VarysStruct {\n	@builtin( position ) Position: vec4<f32>,\n	@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n	var Varys : VarysStruct;\n\n	var pos = array< vec2<f32>, 4 >(\n		vec2<f32>( -1.0,  1.0 ),\n		vec2<f32>(  1.0,  1.0 ),\n		vec2<f32>( -1.0, -1.0 ),\n		vec2<f32>(  1.0, -1.0 )\n	);\n\n	var tex = array< vec2<f32>, 4 >(\n		vec2<f32>( 0.0, 0.0 ),\n		vec2<f32>( 1.0, 0.0 ),\n		vec2<f32>( 0.0, 1.0 ),\n		vec2<f32>( 1.0, 1.0 )\n	);\n\n	Varys.vTex = tex[ vertexIndex ];\n	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n	return Varys;\n\n}\n"}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n	return textureSample( img, imgSampler, vTex );\n\n}\n"}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n"})}}let D7={512:"never",513:"less",514:"equal",515:"less-equal",516:"greater",518:"greater-equal",519:"always",517:"not-equal"},D8=[0,1,3,2,4,5];class D9{createSampler(e){let t=this.backend,r=t.device,n=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===Dq.Linear&&i.minFilter===Dq.Linear&&i.mipmapFilter===Dq.Linear&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&null!==e.compareFunction&&(i.compare=D7[e.compareFunction]),n.sampler=r.createSampler(i)}createDefaultTexture(e){let t,r=Be(e);t=e.isCubeTexture?this._getDefaultCubeTextureGPU(r):this._getDefaultTextureGPU(r),this.backend.get(e).texture=t}createTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.backend,n=r.get(e);if(n.initialized)throw Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture){n.texture=e.sourceTexture,n.initialized=!0;return}void 0===t.needsMipmaps&&(t.needsMipmaps=!1),void 0===t.levels&&(t.levels=1),void 0===t.depth&&(t.depth=1);let{width:i,height:a,depth:s,levels:o}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());let l=this._getDimension(e),u=e.internalFormat||t.format||Be(e,r.device);n.format=u;let{samples:c,primarySamples:h,isMSAA:d}=r.utils.getTextureSampleData(e),A=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;!0===e.isStorageTexture&&(A|=GPUTextureUsage.STORAGE_BINDING),!0!==e.isCompressedTexture&&!0!==e.isCompressedArrayTexture&&u!==Dz.RGB9E5UFloat&&(A|=GPUTextureUsage.RENDER_ATTACHMENT);let p={label:e.name,size:{width:i,height:a,depthOrArrayLayers:s},mipLevelCount:o,sampleCount:h,dimension:l,format:u,usage:A};if(void 0===u){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}if(e.isCubeTexture&&(p.textureBindingViewDimension=DJ.Cube),n.texture=r.device.createTexture(p),d){let e=Object.assign({},p);e.label=e.label+"-msaa",e.sampleCount=c,e.mipLevelCount=1,n.msaaTexture=r.device.createTexture(e)}n.initialized=!0,n.textureDescriptorGPU=p}destroyTexture(e){let t=this.backend,r=t.get(e);void 0!==r.texture&&r.texture.destroy(),void 0!==r.msaaTexture&&r.msaaTexture.destroy(),t.delete(e)}destroySampler(e){let t=this.backend.get(e);delete t.sampler}generateMipmaps(e){let t=this.backend.get(e);if(e.isCubeTexture)for(let e=0;e<6;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e);else{let r=e.image.depth||1;for(let e=0;e<r;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();let e=this.backend,{width:t,height:r}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(){let e,t,r=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.backend,{width:a,height:s}=i.getDrawingBufferSize(),o=this.depthTexture,l=i.get(o).texture;if(n?(e=1027,t=1020):r&&(e=1026,t=1014),void 0!==l){if(o.image.width===a&&o.image.height===s&&o.format===e&&o.type===t)return l;this.destroyTexture(o)}return o.name="depthBuffer",o.format=e,o.type=t,o.image.width=a,o.image.height=s,this.createTexture(o,{width:a,height:s}),i.get(o).texture}updateTexture(e,t){let r=this.backend.get(e),n=e.mipmaps,{textureDescriptorGPU:i}=r;if(!e.isRenderTargetTexture&&void 0!==i){if(e.isDataTexture)if(n.length>0)for(let t=0,a=n.length;t<a;t++){let a=n[t];this._copyBufferToTexture(a,r.texture,i,0,e.flipY,0,t)}else this._copyBufferToTexture(t.image,r.texture,i,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let n=0;n<t.image.depth;n++)this._copyBufferToTexture(t.image,r.texture,i,n,e.flipY,n);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,r.texture,i);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,r.texture,i);else if(n.length>0)for(let t=0,a=n.length;t<a;t++){let a=n[t];this._copyImageToTexture(a,r.texture,i,0,e.flipY,e.premultiplyAlpha,t)}else this._copyImageToTexture(t.image,r.texture,i,0,e.flipY,e.premultiplyAlpha);r.version=e.version}}async copyTextureToBuffer(e,t,r,n,i,a){let s=this.backend.device,o=this.backend.get(e),l=o.texture,u=o.textureDescriptorGPU.format,c=this._getBytesPerTexel(u),h=n*c;h=256*Math.ceil(h/256);let d=s.createBuffer({size:(i-1)*h+n*c,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),A=s.createCommandEncoder();A.copyTextureToBuffer({texture:l,origin:{x:t,y:r,z:a}},{buffer:d,bytesPerRow:h},{width:n,height:i});let p=this._getTypedArrayType(u);return s.queue.submit([A.finish()]),await d.mapAsync(GPUMapMode.READ),new p(d.getMappedRange())}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){let r=new eG;r.minFilter=1003,r.magFilter=1003,this.createTexture(r,{width:1,height:1,format:e}),this.defaultTexture[e]=t=r}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){let r=new rZ;r.minFilter=1003,r.magFilter=1003,this.createTexture(r,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=r}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,r){let n=e.images,i=e.mipmaps;for(let a=0;a<6;a++){let s=n[a],o=!0===e.flipY?D8[a]:a;s.isDataTexture?this._copyBufferToTexture(s.image,t,r,o,e.flipY):this._copyImageToTexture(s,t,r,o,e.flipY,e.premultiplyAlpha);for(let n=0;n<i.length;n++){let s=i[n].images[a];s.isDataTexture?this._copyBufferToTexture(s.image,t,r,o,e.flipY,0,n+1):this._copyImageToTexture(s,t,r,o,e.flipY,e.premultiplyAlpha,n+1)}}}_copyImageToTexture(e,t,r,n,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=this.backend.device,l=s>0?e.width:r.size.width,u=s>0?e.height:r.size.height;o.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:s,origin:{x:0,y:0,z:n},premultipliedAlpha:a},{width:l,height:u,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return null===e&&(this._passUtils=e=new D6(this.backend.device)),e}_generateMipmaps(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._getPassUtils().generateMipmaps(e,t,r)}_flipY(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._getPassUtils().flipY(e,t,r)}_copyBufferToTexture(e,t,r,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=this.backend.device,l=e.data,u=this._getBytesPerTexel(r.format),c=e.width*u;o.queue.writeTexture({texture:t,mipLevel:s,origin:{x:0,y:0,z:n}},l,{offset:e.width*e.height*u*a,bytesPerRow:c},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===i&&this._flipY(t,r,n)}_copyCompressedBufferToTexture(e,t,r){let n=this.backend.device,i=this._getBlockData(r.format),a=r.size.depthOrArrayLayers>1;for(let s=0;s<e.length;s++){let o=e[s],l=o.width,u=o.height,c=a?r.size.depthOrArrayLayers:1,h=Math.ceil(l/i.width)*i.byteLength,d=h*Math.ceil(u/i.height);for(let e=0;e<c;e++)n.queue.writeTexture({texture:t,mipLevel:s,origin:{x:0,y:0,z:e}},o.data,{offset:e*d,bytesPerRow:h,rowsPerImage:Math.ceil(u/i.height)},{width:Math.ceil(l/i.width)*i.width,height:Math.ceil(u/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){return e===Dz.BC1RGBAUnorm||e===Dz.BC1RGBAUnormSRGB?{byteLength:8,width:4,height:4}:e===Dz.BC2RGBAUnorm||e===Dz.BC2RGBAUnormSRGB||e===Dz.BC3RGBAUnorm||e===Dz.BC3RGBAUnormSRGB?{byteLength:16,width:4,height:4}:e===Dz.BC4RUnorm||e===Dz.BC4RSnorm?{byteLength:8,width:4,height:4}:e===Dz.BC5RGUnorm||e===Dz.BC5RGSnorm||e===Dz.BC6HRGBUFloat||e===Dz.BC6HRGBFloat||e===Dz.BC7RGBAUnorm||e===Dz.BC7RGBAUnormSRGB?{byteLength:16,width:4,height:4}:e===Dz.ETC2RGB8Unorm||e===Dz.ETC2RGB8UnormSRGB||e===Dz.ETC2RGB8A1Unorm||e===Dz.ETC2RGB8A1UnormSRGB?{byteLength:8,width:4,height:4}:e===Dz.ETC2RGBA8Unorm||e===Dz.ETC2RGBA8UnormSRGB?{byteLength:16,width:4,height:4}:e===Dz.EACR11Unorm||e===Dz.EACR11Snorm?{byteLength:8,width:4,height:4}:e===Dz.EACRG11Unorm||e===Dz.EACRG11Snorm||e===Dz.ASTC4x4Unorm||e===Dz.ASTC4x4UnormSRGB?{byteLength:16,width:4,height:4}:e===Dz.ASTC5x4Unorm||e===Dz.ASTC5x4UnormSRGB?{byteLength:16,width:5,height:4}:e===Dz.ASTC5x5Unorm||e===Dz.ASTC5x5UnormSRGB?{byteLength:16,width:5,height:5}:e===Dz.ASTC6x5Unorm||e===Dz.ASTC6x5UnormSRGB?{byteLength:16,width:6,height:5}:e===Dz.ASTC6x6Unorm||e===Dz.ASTC6x6UnormSRGB?{byteLength:16,width:6,height:6}:e===Dz.ASTC8x5Unorm||e===Dz.ASTC8x5UnormSRGB?{byteLength:16,width:8,height:5}:e===Dz.ASTC8x6Unorm||e===Dz.ASTC8x6UnormSRGB?{byteLength:16,width:8,height:6}:e===Dz.ASTC8x8Unorm||e===Dz.ASTC8x8UnormSRGB?{byteLength:16,width:8,height:8}:e===Dz.ASTC10x5Unorm||e===Dz.ASTC10x5UnormSRGB?{byteLength:16,width:10,height:5}:e===Dz.ASTC10x6Unorm||e===Dz.ASTC10x6UnormSRGB?{byteLength:16,width:10,height:6}:e===Dz.ASTC10x8Unorm||e===Dz.ASTC10x8UnormSRGB?{byteLength:16,width:10,height:8}:e===Dz.ASTC10x10Unorm||e===Dz.ASTC10x10UnormSRGB?{byteLength:16,width:10,height:10}:e===Dz.ASTC12x10Unorm||e===Dz.ASTC12x10UnormSRGB?{byteLength:16,width:12,height:10}:e===Dz.ASTC12x12Unorm||e===Dz.ASTC12x12UnormSRGB?{byteLength:16,width:12,height:12}:void 0}_convertAddressMode(e){let t=DV.ClampToEdge;return 1e3===e?t=DV.Repeat:1002===e&&(t=DV.MirrorRepeat),t}_convertFilterMode(e){let t=Dq.Linear;return(1003===e||1004===e||1005===e)&&(t=Dq.Nearest),t}_getBytesPerTexel(e){return e===Dz.R8Unorm||e===Dz.R8Snorm||e===Dz.R8Uint||e===Dz.R8Sint?1:e===Dz.R16Uint||e===Dz.R16Sint||e===Dz.R16Float||e===Dz.RG8Unorm||e===Dz.RG8Snorm||e===Dz.RG8Uint||e===Dz.RG8Sint?2:e===Dz.R32Uint||e===Dz.R32Sint||e===Dz.R32Float||e===Dz.RG16Uint||e===Dz.RG16Sint||e===Dz.RG16Float||e===Dz.RGBA8Unorm||e===Dz.RGBA8UnormSRGB||e===Dz.RGBA8Snorm||e===Dz.RGBA8Uint||e===Dz.RGBA8Sint||e===Dz.BGRA8Unorm||e===Dz.BGRA8UnormSRGB||e===Dz.RGB9E5UFloat||e===Dz.RGB10A2Unorm||e===Dz.RG11B10UFloat||e===Dz.Depth32Float||e===Dz.Depth24Plus||e===Dz.Depth24PlusStencil8||e===Dz.Depth32FloatStencil8?4:e===Dz.RG32Uint||e===Dz.RG32Sint||e===Dz.RG32Float||e===Dz.RGBA16Uint||e===Dz.RGBA16Sint||e===Dz.RGBA16Float?8:e===Dz.RGBA32Uint||e===Dz.RGBA32Sint||e===Dz.RGBA32Float?16:void 0}_getTypedArrayType(e){return e===Dz.R8Uint?Uint8Array:e===Dz.R8Sint?Int8Array:e===Dz.R8Unorm?Uint8Array:e===Dz.R8Snorm?Int8Array:e===Dz.RG8Uint?Uint8Array:e===Dz.RG8Sint?Int8Array:e===Dz.RG8Unorm?Uint8Array:e===Dz.RG8Snorm?Int8Array:e===Dz.RGBA8Uint?Uint8Array:e===Dz.RGBA8Sint?Int8Array:e===Dz.RGBA8Unorm||e===Dz.RGBA8UnormSRGB?Uint8Array:e===Dz.RGBA8Snorm?Int8Array:e===Dz.R16Uint?Uint16Array:e===Dz.R16Sint?Int16Array:e===Dz.RG16Uint?Uint16Array:e===Dz.RG16Sint?Int16Array:e===Dz.RGBA16Uint?Uint16Array:e===Dz.RGBA16Sint?Int16Array:e===Dz.R16Float||e===Dz.RG16Float||e===Dz.RGBA16Float?Uint16Array:e===Dz.R32Uint?Uint32Array:e===Dz.R32Sint?Int32Array:e===Dz.R32Float?Float32Array:e===Dz.RG32Uint?Uint32Array:e===Dz.RG32Sint?Int32Array:e===Dz.RG32Float?Float32Array:e===Dz.RGBA32Uint?Uint32Array:e===Dz.RGBA32Sint?Int32Array:e===Dz.RGBA32Float?Float32Array:e===Dz.BGRA8Unorm||e===Dz.BGRA8UnormSRGB?Uint8Array:e===Dz.RGB10A2Unorm||e===Dz.RGB9E5UFloat||e===Dz.RG11B10UFloat?Uint32Array:e===Dz.Depth32Float?Float32Array:e===Dz.Depth24Plus||e===Dz.Depth24PlusStencil8?Uint32Array:e===Dz.Depth32FloatStencil8?Float32Array:void 0}_getDimension(e){return e.is3DTexture||e.isData3DTexture?DZ.ThreeD:DZ.TwoD}constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new iD,this.depthTexture.name="depthBuffer"}}function Be(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.format,i=e.type,a=e.colorSpace,s=eD.getTransfer(a);if(!0===e.isCompressedTexture||!0===e.isCompressedArrayTexture)switch(n){case 33776:case 33777:t=s===et?Dz.BC1RGBAUnormSRGB:Dz.BC1RGBAUnorm;break;case 33778:t=s===et?Dz.BC2RGBAUnormSRGB:Dz.BC2RGBAUnorm;break;case 33779:t=s===et?Dz.BC3RGBAUnormSRGB:Dz.BC3RGBAUnorm;break;case 36283:t=Dz.BC4RUnorm;break;case 36284:t=Dz.BC4RSnorm;break;case 36285:t=Dz.BC5RGUnorm;break;case 36286:t=Dz.BC5RGSnorm;break;case 36492:t=s===et?Dz.BC7RGBAUnormSRGB:Dz.BC7RGBAUnorm;break;case 37492:case 36196:t=s===et?Dz.ETC2RGB8UnormSRGB:Dz.ETC2RGB8Unorm;break;case 37496:t=s===et?Dz.ETC2RGBA8UnormSRGB:Dz.ETC2RGBA8Unorm;break;case 37808:t=s===et?Dz.ASTC4x4UnormSRGB:Dz.ASTC4x4Unorm;break;case 37809:t=s===et?Dz.ASTC5x4UnormSRGB:Dz.ASTC5x4Unorm;break;case 37810:t=s===et?Dz.ASTC5x5UnormSRGB:Dz.ASTC5x5Unorm;break;case 37811:t=s===et?Dz.ASTC6x5UnormSRGB:Dz.ASTC6x5Unorm;break;case 37812:t=s===et?Dz.ASTC6x6UnormSRGB:Dz.ASTC6x6Unorm;break;case 37813:t=s===et?Dz.ASTC8x5UnormSRGB:Dz.ASTC8x5Unorm;break;case 37814:t=s===et?Dz.ASTC8x6UnormSRGB:Dz.ASTC8x6Unorm;break;case 37815:t=s===et?Dz.ASTC8x8UnormSRGB:Dz.ASTC8x8Unorm;break;case 37816:t=s===et?Dz.ASTC10x5UnormSRGB:Dz.ASTC10x5Unorm;break;case 37817:t=s===et?Dz.ASTC10x6UnormSRGB:Dz.ASTC10x6Unorm;break;case 37818:t=s===et?Dz.ASTC10x8UnormSRGB:Dz.ASTC10x8Unorm;break;case 37819:t=s===et?Dz.ASTC10x10UnormSRGB:Dz.ASTC10x10Unorm;break;case 37820:t=s===et?Dz.ASTC12x10UnormSRGB:Dz.ASTC12x10Unorm;break;case 37821:t=s===et?Dz.ASTC12x12UnormSRGB:Dz.ASTC12x12Unorm;break;case 1023:t=s===et?Dz.RGBA8UnormSRGB:Dz.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}else switch(n){case 1023:switch(i){case 1010:t=Dz.RGBA8Snorm;break;case 1011:t=Dz.RGBA16Sint;break;case 1012:t=Dz.RGBA16Uint;break;case 1014:t=Dz.RGBA32Uint;break;case 1013:t=Dz.RGBA32Sint;break;case 1009:t=s===et?Dz.RGBA8UnormSRGB:Dz.RGBA8Unorm;break;case 1016:t=Dz.RGBA16Float;break;case 1015:t=Dz.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case 1022:switch(i){case 35902:t=Dz.RGB9E5UFloat;break;case 35899:t=Dz.RG11B10UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i)}break;case 1028:switch(i){case 1010:t=Dz.R8Snorm;break;case 1011:t=Dz.R16Sint;break;case 1012:t=Dz.R16Uint;break;case 1014:t=Dz.R32Uint;break;case 1013:t=Dz.R32Sint;break;case 1009:t=Dz.R8Unorm;break;case 1016:t=Dz.R16Float;break;case 1015:t=Dz.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case 1030:switch(i){case 1010:t=Dz.RG8Snorm;break;case 1011:t=Dz.RG16Sint;break;case 1012:t=Dz.RG16Uint;break;case 1014:t=Dz.RG32Uint;break;case 1013:t=Dz.RG32Sint;break;case 1009:t=Dz.RG8Unorm;break;case 1016:t=Dz.RG16Float;break;case 1015:t=Dz.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case 1026:switch(i){case 1012:t=Dz.Depth16Unorm;break;case 1014:t=Dz.Depth24Plus;break;case 1015:t=Dz.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case 1027:switch(i){case 1020:t=Dz.Depth24PlusStencil8;break;case 1015:r&&!1===r.features.has(D1.Depth32FloatStencil8)&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),t=Dz.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case 1029:switch(i){case 1013:t=Dz.R32Sint;break;case 1014:t=Dz.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case 1031:switch(i){case 1013:t=Dz.RG32Sint;break;case 1014:t=Dz.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case 1033:switch(i){case 1013:t=Dz.RGBA32Sint;break;case 1014:t=Dz.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}return t}let Bt=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,Br=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,Bn={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"};class Bi extends Ly{getCode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name,t="void"!==this.outputType?"-> "+this.outputType:"";return"fn ".concat(e," ( ").concat(this.inputsCode.trim()," ) ").concat(t)+this.blockCode}constructor(e){let{type:t,inputs:r,name:n,inputsCode:i,blockCode:a,outputType:s}=(e=>{let t=(e=e.trim()).match(Bt);if(null!==t&&4===t.length){let r=t[2],n=[],i=null;for(;null!==(i=Br.exec(r));)n.push({name:i[1],type:i[2]});let a=[];for(let e=0;e<n.length;e++){let{name:t,type:r}=n[e],i=r;i.startsWith("ptr")?i="pointer":(i.startsWith("texture")&&(i=r.split("<")[0]),i=Bn[i]),a.push(new Li(i,t))}let s=e.substring(t[0].length),o=t[3]||"void",l=void 0!==t[1]?t[1]:"";return{type:Bn[o]||o,inputs:a,name:l,inputsCode:r,blockCode:s,outputType:o}}throw Error("FunctionNode: Function is not a WGSL code.")})(e);super(t,r,n),this.inputsCode=i,this.blockCode=a,this.outputType=s}}class Ba extends Lg{parseFunction(e){return new Bi(e)}}let Bs="undefined"!=typeof self?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Bo={[yu.READ_ONLY]:"read",[yu.WRITE_ONLY]:"write",[yu.READ_WRITE]:"read_write"},Bl={1e3:"repeat",1001:"clamp",1002:"mirror"},Bu={vertex:Bs?Bs.VERTEX:1,fragment:Bs?Bs.FRAGMENT:2,compute:Bs?Bs.COMPUTE:4},Bc={instance:!0,swizzleAssign:!1,storageBuffer:!0},Bh={"^^":"tsl_xor"},Bd={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},BA={},Bp={tsl_xor:new Nu("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Nu("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Nu("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Nu("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Nu("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Nu("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Nu("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Nu("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Nu("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new Nu("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new Nu("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new Nu("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new Nu("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {\n\n	let res = vec2f( iRes );\n\n	let uvScaled = coord * res;\n	let uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n	// https://www.shadertoy.com/view/WtyXRy\n\n	let uv = uvWrapping - 0.5;\n	let iuv = floor( uv );\n	let f = fract( uv );\n\n	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n")},Bf={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"},Bm="";!0!==("undefined"!=typeof navigator&&/Firefox|Deno/g.test(navigator.userAgent))&&(Bm+="diagnostic( off, derivative_uniformity );\n");class Bg extends Lr{_generateTextureSample(e,t,r,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;return"fragment"!==a?this.generateTextureSampleLevel(e,t,r,"0",n):n?i?"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n,", ").concat(i," )"):"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n," )"):i?"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(i," )"):"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(r," )")}generateTextureSampleLevel(e,t,r,n,i,a){return!1===this.isUnfilterable(e)?a?"textureSampleLevel( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n,", ").concat(a," )"):"textureSampleLevel( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n," )"):this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,a,n):this.generateTextureLod(e,t,r,i,a,n)}generateWrapFunction(e){let t="tsl_coord_".concat(Bl[e.wrapS],"S_").concat(Bl[e.wrapT],"_").concat(e.isData3DTexture?"3d":"2d","T"),r=BA[t];if(void 0===r){let n=[],i=e.isData3DTexture?"vec3f":"vec2f",a="fn ".concat(t,"( coord : ").concat(i," ) -> ").concat(i," {\n\n	return ").concat(i,"(\n"),s=(e,t)=>{1e3===e?(n.push(Bp.repeatWrapping_float),a+="		tsl_repeatWrapping_float( coord.".concat(t," )")):1001===e?(n.push(Bp.clampWrapping_float),a+="		tsl_clampWrapping_float( coord.".concat(t," )")):1002===e?(n.push(Bp.mirrorWrapping_float),a+="		tsl_mirrorWrapping_float( coord.".concat(t," )")):(a+="		coord.".concat(t),console.warn('WebGPURenderer: Unsupported texture wrap type "'.concat(e,'" for vertex shader.')))};s(e.wrapS,"x"),a+=",\n",s(e.wrapT,"y"),e.isData3DTexture&&(a+=",\n",s(e.wrapR,"z")),a+="\n	);\n\n}\n",BA[t]=r=new Nu(a,n)}return r.build(this),t}generateArrayDeclaration(e,t){return"array< ".concat(this.getType(e),", ").concat(t," >")}generateTextureDimension(e,t,r){let n=this.getDataFromNode(e,this.shaderStage,this.globalCache);void 0===n.dimensionsSnippet&&(n.dimensionsSnippet={});let i=n.dimensionsSnippet[r];if(void 0===n.dimensionsSnippet[r]){let a,s,{primarySamples:o}=this.renderer.backend.utils.getTextureSampleData(e);s=e.isData3DTexture?"vec3<u32>":"vec2<u32>",a=o>1||e.isStorageTexture?t:"".concat(t).concat(r?", u32( ".concat(r," )"):""),i=new _W(new by("textureDimensions( ".concat(a," )"),s)),n.dimensionsSnippet[r]=i,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(n.arrayLayerCount=new _W(new by("textureNumLayers(".concat(t,")"),"u32"))),e.isTextureCube&&(n.cubeFaceCount=new _W(new by("6u","u32")))}return i.build(this)}generateFilteredTexture(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0u";this._include("biquadraticTexture");let a=this.generateWrapFunction(e),s=this.generateTextureDimension(e,t,i);return n&&(r="".concat(r," + vec2<f32>(").concat(n,") / ").concat(s)),"tsl_biquadraticTexture( ".concat(t,", ").concat(a,"( ").concat(r," ), ").concat(s,", u32( ").concat(i," ) )")}generateTextureLod(e,t,r,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"0u",s=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,a),l=e.isData3DTexture?"vec3":"vec2";i&&(r="".concat(r," + ").concat(l,"<f32>(").concat(i,") / ").concat(l,"<f32>( ").concat(o," )"));let u="".concat(l,"<u32>( ").concat(s,"( ").concat(r," ) * ").concat(l,"<f32>( ").concat(o," ) )");return this.generateTextureLoad(e,t,u,n,null,a)}generateTextureLoad(e,t,r,n,i){let a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"0u";return i&&(r="".concat(r," + ").concat(i)),n?a="textureLoad( ".concat(t,", ").concat(r,", ").concat(n,", u32( ").concat(s," ) )"):(a="textureLoad( ".concat(t,", ").concat(r,", u32( ").concat(s," ) )"),this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,t,r,n,i){return n?"textureStore( ".concat(t,", ").concat(r,", ").concat(n,", ").concat(i," )"):"textureStore( ".concat(t,", ").concat(r,", ").concat(i," )")}isSampleCompare(e){return!0===e.isDepthTexture&&null!==e.compareFunction}isUnfilterable(e){return"float"!==this.getComponentTypeFromTexture(e)||!this.isAvailable("float32Filterable")&&!0===e.isDataTexture&&1015===e.type||!1===this.isSampleCompare(e)&&1003===e.minFilter&&1003===e.magFilter||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,r,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;return this.isUnfilterable(e)?this.generateTextureLod(e,t,r,n,i,"0",a):this._generateTextureSample(e,t,r,n,i,a)}generateTextureGrad(e,t,r,n,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.shaderStage;if("fragment"===s)return a?"textureSampleGrad( ".concat(t,", ").concat(t,"_sampler, ").concat(r,",  ").concat(n[0],", ").concat(n[1],", ").concat(a," )"):"textureSampleGrad( ".concat(t,", ").concat(t,"_sampler, ").concat(r,",  ").concat(n[0],", ").concat(n[1]," )");console.error("WebGPURenderer: THREE.TextureNode.gradient() does not support ".concat(s," shader."))}generateTextureCompare(e,t,r,n,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.shaderStage;if("fragment"===s)return!0===e.isDepthTexture&&!0===e.isArrayTexture?a?"textureSampleCompare( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(i,", ").concat(n,", ").concat(a," )"):"textureSampleCompare( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(i,", ").concat(n," )"):a?"textureSampleCompare( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n,", ").concat(a," )"):"textureSampleCompare( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n," )");console.error("WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ".concat(s," shader."))}generateTextureLevel(e,t,r,n,i,a){return!1===this.isUnfilterable(e)?a?"textureSampleLevel( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n,", ").concat(a," )"):"textureSampleLevel( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n," )"):this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,a,n):this.generateTextureLod(e,t,r,i,a,n)}generateTextureBias(e,t,r,n,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.shaderStage;if("fragment"===s)return a?"textureSampleBias( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n,", ").concat(a," )"):"textureSampleBias( ".concat(t,", ").concat(t,"_sampler, ").concat(r,", ").concat(n," )");console.error("WebGPURenderer: THREE.TextureNode.biasNode does not support ".concat(s," shader."))}getPropertyName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;if(!0===e.isNodeVarying&&!0===e.needsInterpolation){if("vertex"===t)return"varyings.".concat(e.name)}else if(!0===e.isNodeUniform){let t=e.name,r=e.type;return"texture"===r||"cubeTexture"===r||"storageTexture"===r||"texture3D"===r?t:"buffer"!==r&&"storageBuffer"!==r&&"indirectStorageBuffer"!==r?e.groupNode.name+"."+t:this.isCustomStruct(e)?t:t+".value"}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){let t=Bh[e];return void 0!==t?(this._include(t),t):null}getNodeAccess(e,t){return"compute"!==t?!0===e.isAtomic?(console.warn("WebGPURenderer: Atomic operations are only supported in compute shaders."),yu.READ_WRITE):yu.READ_ONLY:e.access}getStorageAccess(e,t){return Bo[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=super.getUniformFromNode(e,t,r,n),a=this.getDataFromNode(e,r,this.globalCache);if(void 0===a.uniformGPU){let s,o=e.groupNode,l=o.name,u=this.getBindGroupArray(l,r);if("texture"===t||"cubeTexture"===t||"storageTexture"===t||"texture3D"===t){let n=null,a=this.getNodeAccess(e,r);if("texture"===t||"storageTexture"===t?n=!0===e.value.is3DTexture?new Di(i.name,i.node,o,a):new Dr(i.name,i.node,o,a):"cubeTexture"===t?n=new Dn(i.name,i.node,o,a):"texture3D"===t&&(n=new Di(i.name,i.node,o,a)),n.store=!0===e.isStorageTextureNode,n.setVisibility(Bu[r]),!1===this.isUnfilterable(e.value)&&!1===n.store){let e=new D2("".concat(i.name,"_sampler"),i.node,o);e.setVisibility(Bu[r]),u.push(e,n),s=[e,n]}else u.push(n),s=[n]}else if("buffer"===t||"storageBuffer"===t||"indirectStorageBuffer"===t){let a=new("buffer"===t?L5:D5)(e,o);a.setVisibility(Bu[r]),u.push(a),s=a,i.name=n||"NodeBuffer_"+i.id}else{let e=this.uniformGroups[r]||(this.uniformGroups[r]={}),n=e[l];void 0===n&&((n=new L8(l,o)).setVisibility(Bu[r]),e[l]=n,u.push(n)),s=this.getNodeUniform(i,t),n.addUniform(s)}a.uniformGPU=s}return i}getBuiltin(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage,i=this.builtins[n]||(this.builtins[n]=new Map);return!1===i.has(e)&&i.set(e,{name:e,property:t,type:r}),t}hasBuiltin(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;return void 0!==this.builtins[t]&&this.builtins[t].has(e)}getVertexIndex(){return"vertex"===this.shaderStage?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){let t=e.layout,r=this.flowShaderNode(e),n=[];for(let e of t.inputs)n.push(e.name+" : "+this.getType(e.type));let i="fn ".concat(t.name,"( ").concat(n.join(", ")," ) -> ").concat(this.getType(t.type)," {\n").concat(r.vars,"\n").concat(r.code,"\n");return r.result&&(i+="	return ".concat(r.result,";\n")),i+="\n}\n"}getInstanceIndex(){return"vertex"===this.shaderStage?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){let t=[],r=this.directives[e];if(void 0!==r)for(let e of r)t.push("enable ".concat(e,";"));return t.join("\n")}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances","array<f32, ".concat(e," >"),"vertex")}getBuiltins(e){let t=[],r=this.builtins[e];if(void 0!==r)for(let{name:e,property:n,type:i}of r.values())t.push("@builtin( ".concat(e," ) ").concat(n," : ").concat(i));return t.join(",\n	")}getScopedArray(e,t,r,n){return!1===this.scopedArrays.has(e)&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:r,bufferCount:n}),e}getScopedArrays(e){if("compute"!==e)return;let t=[];for(let{name:e,scope:r,bufferType:n,bufferCount:i}of this.scopedArrays.values()){let a=this.getType(n);t.push("var<".concat(r,"> ").concat(e,": array< ").concat(a,", ").concat(i," >;"))}return t.join("\n")}getAttributes(e){let t=[];if("compute"===e&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),"vertex"===e||"compute"===e){let e=this.getBuiltins("attribute");e&&t.push(e);let r=this.getAttributesArray();for(let e=0,n=r.length;e<n;e++){let n=r[e],i=n.name,a=this.getType(n.type);t.push("@location( ".concat(e," ) ").concat(i," : ").concat(a))}}return t.join(",\n	")}getStructMembers(e){let t=[];for(let r of e.members){let n=e.output?"@location( "+r.index+" ) ":"",i=this.getType(r.type);r.atomic&&(i="atomic< "+i+" >"),t.push("	".concat(n+r.name," : ").concat(i))}return e.output&&t.push("	".concat(this.getBuiltins("output"))),t.join(",\n")}getStructs(e){let t="",r=this.structs[e];if(r.length>0){let e=[];for(let t of r){let r="struct ".concat(t.name," {\n");r+=this.getStructMembers(t),r+="\n};",e.push(r)}t="\n"+e.join("\n\n")+"\n"}return t}getVar(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n="var ".concat(t," : ");return null!==r?n+=this.generateArrayDeclaration(e,r):n+=this.getType(e),n}getVars(e){let t=[],r=this.vars[e];if(void 0!==r)for(let e of r)t.push("	".concat(this.getVar(e.type,e.name,e.count),";"));return"\n".concat(t.join("\n"),"\n")}getVaryings(e){let t=[];if("vertex"===e&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),"vertex"===e||"fragment"===e){let r=this.varyings,n=this.vars[e];for(let i=0;i<r.length;i++){let a=r[i];if(a.needsInterpolation){let e="@location( ".concat(i," )");if(a.interpolationType){let t=null!==a.interpolationSampling?", ".concat(a.interpolationSampling," )"):" )";e+=" @interpolate( ".concat(a.interpolationType).concat(t)}else/^(int|uint|ivec|uvec)/.test(a.type)&&(e+=" @interpolate( ".concat(this.renderer.backend.compatibilityMode?"flat, either":"flat"," )"));t.push("".concat(e," ").concat(a.name," : ").concat(this.getType(a.type)))}else"vertex"===e&&!1===n.includes(a)&&n.push(a)}}let r=this.getBuiltins(e);r&&t.push(r);let n=t.join(",\n	");return"vertex"===e?this._getWGSLStruct("VaryingsStruct","	"+n):n}isCustomStruct(e){let t=e.value,r=e.node,n=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&null!==r.structTypeNode,i=r.value&&r.value.array&&"number"==typeof r.value.itemSize&&r.value.array.length>r.value.itemSize;return n&&!i}getUniforms(e){let t=this.uniforms[e],r=[],n=[],i=[],a={};for(let i of t){let t=i.groupNode.name,s=this.bindingsIndexes[t];if("texture"===i.type||"cubeTexture"===i.type||"storageTexture"===i.type||"texture3D"===i.type){let t,n=i.node.value;!1===this.isUnfilterable(n)&&!0!==i.node.isStorageTextureNode&&(this.isSampleCompare(n)?r.push("@binding( ".concat(s.binding++," ) @group( ").concat(s.group," ) var ").concat(i.name,"_sampler : sampler_comparison;")):r.push("@binding( ".concat(s.binding++," ) @group( ").concat(s.group," ) var ").concat(i.name,"_sampler : sampler;")));let a="",{primarySamples:o}=this.renderer.backend.utils.getTextureSampleData(n);if(o>1&&(a="_multisampled"),!0===n.isCubeTexture)t="texture_cube<f32>";else if(!0===n.isDepthTexture)t=this.renderer.backend.compatibilityMode&&null===n.compareFunction?"texture".concat(a,"_2d<f32>"):"texture_depth".concat(a,"_2d").concat(!0===n.isArrayTexture?"_array":"");else if(!0===i.node.isStorageTextureNode){let r=Be(n),a=this.getStorageAccess(i.node,e),s=i.node.value.is3DTexture,o=i.node.value.isArrayTexture,l=s?"3d":"2d".concat(o?"_array":"");t="texture_storage_".concat(l,"<").concat(r,", ").concat(a,">")}else if(!0===n.isArrayTexture||!0===n.isDataArrayTexture||!0===n.isCompressedArrayTexture)t="texture_2d_array<f32>";else if(!0===n.is3DTexture||!0===n.isData3DTexture)t="texture_3d<f32>";else{let e=this.getComponentTypeFromTexture(n).charAt(0);t="texture".concat(a,"_2d<").concat(e,"32>")}r.push("@binding( ".concat(s.binding++," ) @group( ").concat(s.group," ) var ").concat(i.name," : ").concat(t,";"))}else if("buffer"===i.type||"storageBuffer"===i.type||"indirectStorageBuffer"===i.type){let t=i.node,r=this.getType(t.getNodeType(this)),a=t.bufferCount,o=a>0&&"buffer"===i.type?", "+a:"",l=t.isStorageBufferNode?"storage, ".concat(this.getStorageAccess(t,e)):"uniform";if(this.isCustomStruct(i))n.push("@binding( ".concat(s.binding++," ) @group( ").concat(s.group," ) var<").concat(l,"> ").concat(i.name," : ").concat(r,";"));else{let e=t.isAtomic?"atomic<".concat(r,">"):"".concat(r),a="	value : array< ".concat(e).concat(o," >");n.push(this._getWGSLStructBinding(i.name,a,l,s.binding++,s.group))}}else{let e=this.getType(this.getVectorType(i.type)),t=i.groupNode.name;(a[t]||(a[t]={index:s.binding++,id:s.group,snippets:[]})).snippets.push("	".concat(i.name," : ").concat(e))}}for(let e in a){let t=a[e];i.push(this._getWGSLStructBinding(e,t.snippets.join(",\n"),"uniform",t.index,t.id))}let s=r.join("\n");return s+=n.join("\n"),s+=i.join("\n")}buildCode(){let e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};for(let t in this.sortBindingGroups(),e){this.shaderStage=t;let r=e[t];r.uniforms=this.getUniforms(t),r.attributes=this.getAttributes(t),r.varyings=this.getVaryings(t),r.structs=this.getStructs(t),r.vars=this.getVars(t),r.codes=this.getCodes(t),r.directives=this.getDirectives(t),r.scopedArrays=this.getScopedArrays(t);let n="// code\n\n";n+=this.flowCode[t];let i=this.flowNodes[t],a=i[i.length-1],s=a.outputNode,o=void 0!==s&&!0===s.isOutputStructNode;for(let e of i){let i=this.getFlowData(e),l=e.name;if(l&&(n.length>0&&(n+="\n"),n+="	// flow -> ".concat(l,"\n")),n+="".concat(i.code,"\n	"),e===a&&"compute"!==t){if(n+="// result\n\n	","vertex"===t)n+="varyings.Vertex = ".concat(i.result,";");else if("fragment"===t)if(o)r.returnType=s.getNodeType(this),r.structs+="var<private> output : "+r.returnType+";",n+="return ".concat(i.result,";");else{let e="	@location(0) color: vec4<f32>",t=this.getBuiltins("output");t&&(e+=",\n	"+t),r.returnType="OutputStruct",r.structs+=this._getWGSLStruct("OutputStruct",e),r.structs+="\nvar<private> output : OutputStruct;",n+="output.color = ".concat(i.result,";\n\n	return output;")}}}r.flow=n}if(this.shaderStage=null,null!==this.material)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{let t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==r&&(t=this._getWGSLMethod(e+"_"+r)),void 0===t&&(t=this._getWGSLMethod(e)),t||e}getBitcastMethod(e){let t=this.getType(e);return"bitcast<".concat(t,">")}getTernary(e,t,r){return"select( ".concat(r,", ").concat(t,", ").concat(e," )")}getType(e){return Bd[e]||e}isAvailable(e){let t=Bc[e];return void 0===t&&("float32Filterable"===e?t=this.renderer.hasFeature("float32-filterable"):"clipDistance"===e&&(t=this.renderer.hasFeature("clip-distances")),Bc[e]=t),t}_getWGSLMethod(e){return void 0!==Bp[e]&&this._include(e),Bf[e]}_include(e){let t=Bp[e];return t.build(this),null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return"".concat(this.getSignature(),"\n// directives\n").concat(e.directives,"\n\n// structs\n").concat(e.structs,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\nvar<private> varyings : VaryingsStruct;\n\n// codes\n").concat(e.codes,"\n\n@vertex\nfn main( ").concat(e.attributes," ) -> VaryingsStruct {\n\n	// vars\n	").concat(e.vars,"\n\n	// flow\n	").concat(e.flow,"\n\n	return varyings;\n\n}\n")}_getWGSLFragmentCode(e){return"".concat(this.getSignature(),"\n// global\n").concat(Bm,"\n\n// structs\n").concat(e.structs,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// codes\n").concat(e.codes,"\n\n@fragment\nfn main( ").concat(e.varyings," ) -> ").concat(e.returnType," {\n\n	// vars\n	").concat(e.vars,"\n\n	// flow\n	").concat(e.flow,"\n\n}\n")}_getWGSLComputeCode(e,t){let[r,n,i]=t;return"".concat(this.getSignature(),"\n// directives\n").concat(e.directives,"\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n").concat(e.scopedArrays,"\n\n// structs\n").concat(e.structs,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// codes\n").concat(e.codes,"\n\n@compute @workgroup_size( ").concat(r,", ").concat(n,", ").concat(i," )\nfn main( ").concat(e.attributes," ) {\n\n	// system\n	instanceIndex = globalId.x\n		+ globalId.y * ( ").concat(r," * numWorkgroups.x )\n		+ globalId.z * ( ").concat(r," * numWorkgroups.x ) * ( ").concat(n," * numWorkgroups.y );\n\n	// vars\n	").concat(e.vars,"\n\n	// flow\n	").concat(e.flow,"\n\n}\n")}_getWGSLStruct(e,t){return"\nstruct ".concat(e," {\n").concat(t,"\n};")}_getWGSLStructBinding(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e+"Struct",s=this._getWGSLStruct(a,t);return"".concat(s,"\n@binding( ").concat(n," ) @group( ").concat(i," )\nvar<").concat(r,"> ").concat(e," : ").concat(a,";")}constructor(e,t){super(e,t,new Ba),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}}class By{getCurrentDepthStencilFormat(e){let t;return null!==e.depthTexture?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=Dz.Depth24PlusStencil8:e.depth&&(t=Dz.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){let e=this.backend.renderer,r=e.getRenderTarget();t=r?r.samples:e.samples}else e.renderTarget&&(t=e.renderTarget.samples);let r=(t=t||1)>1&&null!==e.renderTarget&&!0!==e.isDepthTexture&&!0!==e.isFramebufferTexture,n=r?1:t;return{samples:t,primarySamples:n,isMSAA:r}}getCurrentColorFormat(e){return null!==e.textures?this.getTextureFormatGPU(e.textures[0]):this.getPreferredCanvasFormat()}getCurrentColorSpace(e){return null!==e.textures?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){return e.isPoints?DL.PointList:e.isLineSegments||e.isMesh&&!0===t.wireframe?DL.LineList:e.isLine?DL.LineStrip:e.isMesh?DL.TriangleList:void 0}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return null!==e.textures?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){let e=this.backend.parameters.outputType;if(void 0===e)return navigator.gpu.getPreferredCanvasFormat();if(1009===e)return Dz.BGRA8Unorm;if(1016===e)return Dz.RGBA16Float;throw Error("Unsupported outputType")}constructor(e){this.backend=e}}let Bv=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);"undefined"!=typeof Float16Array&&Bv.set(Float16Array,["float16"]);let Bx=new Map([[rm,["float16"]]]),B_=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class Bb{createAttribute(e,t){let r=this._getBufferAttribute(e),n=this.backend,i=n.get(r),a=i.buffer;if(void 0===a){let s=n.device,o=r.array;if(!1===e.normalized){if(o.constructor===Int16Array||o.constructor===Int8Array)o=new Int32Array(o);else if((o.constructor===Uint16Array||o.constructor===Uint8Array)&&(o=new Uint32Array(o),t&GPUBufferUsage.INDEX))for(let e=0;e<o.length;e++)65535===o[e]&&(o[e]=0xffffffff)}if(r.array=o,(r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute)&&3===r.itemSize){o=new o.constructor(4*r.count);for(let e=0;e<r.count;e++)o.set(r.array.subarray(3*e,3*e+3),4*e);r.itemSize=4,r.array=o,i._force3to4BytesAlignment=!0}let l=o.byteLength;a=s.createBuffer({label:r.name,size:l+(4-l%4)%4,usage:t,mappedAtCreation:!0}),new o.constructor(a.getMappedRange()).set(o),a.unmap(),i.buffer=a}}updateAttribute(e){let t=this._getBufferAttribute(e),r=this.backend,n=r.device,i=r.get(t),a=r.get(t).buffer,s=t.array;if(!0===i._force3to4BytesAlignment){s=new s.constructor(4*t.count);for(let e=0;e<t.count;e++)s.set(t.array.subarray(3*e,3*e+3),4*e);t.array=s}let o=this._isTypedArray(s),l=t.updateRanges;if(0===l.length)n.queue.writeBuffer(a,0,s,0);else{let e=o?1:s.BYTES_PER_ELEMENT;for(let t=0,r=l.length;t<r;t++){let r,u,c=l[t];if(!0===i._force3to4BytesAlignment){let t=Math.floor(c.start/3),n=Math.ceil(c.count/3);r=4*t*e,u=4*n*e}else r=c.start*e,u=c.count*e;let h=r*(o?s.BYTES_PER_ELEMENT:1);n.queue.writeBuffer(a,h,s,r,u)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){let t=e.getAttributes(),r=new Map;for(let e=0;e<t.length;e++){let n=t[e],i=n.array.BYTES_PER_ELEMENT,a=this._getBufferAttribute(n),s=r.get(a);if(void 0===s){let e,t;!0===n.isInterleavedBufferAttribute?(e=n.data.stride*i,t=n.data.isInstancedInterleavedBuffer?D0.Instance:D0.Vertex):(e=n.itemSize*i,t=n.isInstancedBufferAttribute?D0.Instance:D0.Vertex),!1===n.normalized&&(n.array.constructor===Int16Array||n.array.constructor===Uint16Array)&&(e=4),s={arrayStride:e,attributes:[],stepMode:t},r.set(a,s)}let o=this._getVertexFormat(n),l=!0===n.isInterleavedBufferAttribute?n.offset*i:0;s.attributes.push({shaderLocation:e,offset:l,format:o})}return Array.from(r.values())}destroyAttribute(e){let t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){let t=this.backend,r=t.device,n=t.get(this._getBufferAttribute(e)).buffer,i=n.size,a=r.createBuffer({label:"".concat(e.name,"_readback"),size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),s=r.createCommandEncoder({label:"readback_encoder_".concat(e.name)});s.copyBufferToBuffer(n,0,a,0,i);let o=s.finish();r.queue.submit([o]),await a.mapAsync(GPUMapMode.READ);let l=a.getMappedRange(),u=new e.array.constructor(l.slice(0));return a.unmap(),u.buffer}_getVertexFormat(e){let t,{itemSize:r,normalized:n}=e,i=e.array.constructor,a=e.constructor;if(1===r)t=B_.get(i);else{let e=(Bx.get(a)||Bv.get(i))[+!!n];if(e){let n=4*Math.floor((i.BYTES_PER_ELEMENT*r+3)/4)/i.BYTES_PER_ELEMENT;if(n%1)throw Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");t="".concat(e,"x").concat(n)}}return t||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),t}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}constructor(e){this.backend=e}}class BS{createBindingsLayout(e){let t=this.backend,r=t.device,n=[],i=0;for(let r of e.bindings){let e={binding:i++,visibility:r.visibility};if(r.isUniformBuffer||r.isStorageBuffer){let t={};r.isStorageBuffer&&(4&r.visibility&&(r.access===yu.READ_WRITE||r.access===yu.WRITE_ONLY)?t.type=DX.Storage:t.type=DX.ReadOnlyStorage),e.buffer=t}else if(r.isSampledTexture&&r.store){let t={};t.format=this.backend.get(r.texture).texture.format;let n=r.access;n===yu.READ_WRITE?t.access=DQ.ReadWrite:n===yu.WRITE_ONLY?t.access=DQ.WriteOnly:t.access=DQ.ReadOnly,r.texture.isArrayTexture?t.viewDimension=DJ.TwoDArray:r.texture.is3DTexture&&(t.viewDimension=DJ.ThreeD),e.storageTexture=t}else if(r.isSampledTexture){let n={},{primarySamples:i}=t.utils.getTextureSampleData(r.texture);if(i>1&&(n.multisampled=!0,r.texture.isDepthTexture||(n.sampleType=DK.UnfilterableFloat)),r.texture.isDepthTexture)t.compatibilityMode&&null===r.texture.compareFunction?n.sampleType=DK.UnfilterableFloat:n.sampleType=DK.Depth;else if(r.texture.isDataTexture||r.texture.isDataArrayTexture||r.texture.isData3DTexture){let e=r.texture.type;1013===e?n.sampleType=DK.SInt:1014===e?n.sampleType=DK.UInt:1015===e&&(this.backend.hasFeature("float32-filterable")?n.sampleType=DK.Float:n.sampleType=DK.UnfilterableFloat)}r.isSampledCubeTexture?n.viewDimension=DJ.Cube:r.texture.isArrayTexture||r.texture.isDataArrayTexture||r.texture.isCompressedArrayTexture?n.viewDimension=DJ.TwoDArray:r.isSampledTexture3D&&(n.viewDimension=DJ.ThreeD),e.texture=n}else if(r.isSampler){let n={};r.texture.isDepthTexture&&(null!==r.texture.compareFunction?n.type=DY.Comparison:t.compatibilityMode&&(n.type=DY.NonFiltering)),e.sampler=n}else console.error('WebGPUBindingUtils: Unsupported binding "'.concat(r,'".'));n.push(e)}return r.createBindGroupLayout({entries:n})}createBindings(e,t,r){let n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,{backend:a,bindGroupLayoutCache:s}=this,o=a.get(e),l=s.get(e.bindingsReference);void 0===l&&(l=this.createBindingsLayout(e),s.set(e.bindingsReference,l)),r>0&&(void 0===o.groups&&(o.groups=[],o.versions=[]),o.versions[r]===i&&(n=o.groups[r])),void 0===n&&(n=this.createBindGroup(e,l),r>0&&(o.groups[r]=n,o.versions[r]=i)),o.group=n,o.layout=l}updateBinding(e){let t=this.backend,r=t.device,n=e.buffer,i=t.get(e).buffer;r.queue.writeBuffer(i,0,n,0)}createBindGroupIndex(e,t){let r=this.backend.device,n=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i=e[0],a=r.createBuffer({label:"bindingCameraIndex_"+i,size:16,usage:n});r.queue.writeBuffer(a,0,e,0);let s=[{binding:0,resource:{buffer:a}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+i,layout:t,entries:s})}createBindGroup(e,t){let r=this.backend,n=r.device,i=0,a=[];for(let t of e.bindings){if(t.isUniformBuffer){let e=r.get(t);if(void 0===e.buffer){let r=t.byteLength,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST;e.buffer=n.createBuffer({label:"bindingBuffer_"+t.name,size:r,usage:i})}a.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isStorageBuffer){let e=r.get(t);if(void 0===e.buffer){let n=t.attribute;e.buffer=r.get(n).buffer}a.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isSampledTexture){let e,s=r.get(t.texture);if(void 0!==s.externalTexture)e=n.importExternalTexture({source:s.externalTexture});else{let r=t.store?1:s.texture.mipLevelCount,n="view-".concat(s.texture.width,"-").concat(s.texture.height);if(s.texture.depthOrArrayLayers>1&&(n+="-".concat(s.texture.depthOrArrayLayers)),n+="-".concat(r),void 0===(e=s[n])){let i,a=D$.All;i=t.isSampledCubeTexture?DJ.Cube:t.isSampledTexture3D?DJ.ThreeD:t.texture.isArrayTexture||t.texture.isDataArrayTexture||t.texture.isCompressedArrayTexture?DJ.TwoDArray:DJ.TwoD,e=s[n]=s.texture.createView({aspect:a,dimension:i,mipLevelCount:r})}}a.push({binding:i,resource:e})}else if(t.isSampler){let e=r.get(t.texture);a.push({binding:i,resource:e.sampler})}i++}return n.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:a})}constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}}class BT{setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){let r,{object:n,material:i,geometry:a,pipeline:s}=e,{vertexProgram:o,fragmentProgram:l}=s,u=this.backend,c=u.device,h=u.utils,d=u.get(s),A=[];for(let t of e.getBindings()){let e=u.get(t);A.push(e.layout)}let p=u.attributeUtils.createShaderVertexBuffers(e);0!==i.blending&&(1!==i.blending||!1!==i.transparent)&&(r=this._getBlending(i));let f={};!0===i.stencilWrite&&(f={compare:this._getStencilCompare(i),failOp:this._getStencilOperation(i.stencilFail),depthFailOp:this._getStencilOperation(i.stencilZFail),passOp:this._getStencilOperation(i.stencilZPass)});let m=this._getColorWriteMask(i),g=[];if(null!==e.context.textures){let t=e.context.textures;for(let e=0;e<t.length;e++){let n=h.getTextureFormatGPU(t[e]);g.push({format:n,blend:r,writeMask:m})}}else{let t=h.getCurrentColorFormat(e.context);g.push({format:t,blend:r,writeMask:m})}let y=u.get(o).module,v=u.get(l).module,x=this._getPrimitiveState(n,a,i),_=this._getDepthCompare(i),b=h.getCurrentDepthStencilFormat(e.context),S=this._getSampleCount(e.context),T={label:"renderPipeline_".concat(i.name||i.type,"_").concat(i.id),vertex:Object.assign({},y,{buffers:p}),fragment:Object.assign({},v,{targets:g}),primitive:x,multisample:{count:S,alphaToCoverageEnabled:i.alphaToCoverage&&S>1},layout:c.createPipelineLayout({bindGroupLayouts:A})},w={},M=e.context.depth,E=e.context.stencil;if((!0===M||!0===E)&&(!0===M&&(w.format=b,w.depthWriteEnabled=i.depthWrite,w.depthCompare=_),!0===E&&(w.stencilFront=f,w.stencilBack={},w.stencilReadMask=i.stencilFuncMask,w.stencilWriteMask=i.stencilWriteMask),!0===i.polygonOffset&&(w.depthBias=i.polygonOffsetUnits,w.depthBiasSlopeScale=i.polygonOffsetFactor,w.depthBiasClamp=0),T.depthStencil=w),null===t)d.pipeline=c.createRenderPipeline(T);else{let e=new Promise(e=>{c.createRenderPipelineAsync(T).then(t=>{d.pipeline=t,e()})});t.push(e)}}createBundleEncoder(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"renderBundleEncoder",{utils:r,device:n}=this.backend,i=r.getCurrentDepthStencilFormat(e),a=r.getCurrentColorFormat(e),s=this._getSampleCount(e);return n.createRenderBundleEncoder({label:t,colorFormats:[a],depthStencilFormat:i,sampleCount:s})}createComputePipeline(e,t){let r=this.backend,n=r.device,i=r.get(e.computeProgram).module,a=r.get(e),s=[];for(let e of t){let t=r.get(e);s.push(t.layout)}a.pipeline=n.createComputePipeline({compute:i,layout:n.createPipelineLayout({bindGroupLayouts:s})})}_getBlending(e){let t,r,n=e.blending,i=e.blendSrc,a=e.blendDst,s=e.blendEquation;if(5===n){let n=null!==e.blendSrcAlpha?e.blendSrcAlpha:i,o=null!==e.blendDstAlpha?e.blendDstAlpha:a,l=null!==e.blendEquationAlpha?e.blendEquationAlpha:s;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(s)},r={srcFactor:this._getBlendFactor(n),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(l)}}else{let i=e.premultipliedAlpha,a=(e,n,i,a)=>{t={srcFactor:e,dstFactor:n,operation:DH.Add},r={srcFactor:i,dstFactor:a,operation:DH.Add}};if(i)switch(n){case 1:a(DG.One,DG.OneMinusSrcAlpha,DG.One,DG.OneMinusSrcAlpha);break;case 2:a(DG.One,DG.One,DG.One,DG.One);break;case 3:a(DG.Zero,DG.OneMinusSrc,DG.Zero,DG.One);break;case 4:a(DG.Dst,DG.OneMinusSrcAlpha,DG.Zero,DG.One)}else switch(n){case 1:a(DG.SrcAlpha,DG.OneMinusSrcAlpha,DG.One,DG.OneMinusSrcAlpha);break;case 2:a(DG.SrcAlpha,DG.One,DG.One,DG.One);break;case 3:console.error("THREE.WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:console.error("THREE.WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true")}}if(void 0!==t&&void 0!==r)return{color:t,alpha:r};console.error("THREE.WebGPURenderer: Invalid blending: ",n)}_getBlendFactor(e){let t;switch(e){case 200:t=DG.Zero;break;case 201:t=DG.One;break;case 202:t=DG.Src;break;case 203:t=DG.OneMinusSrc;break;case 204:t=DG.SrcAlpha;break;case 205:t=DG.OneMinusSrcAlpha;break;case 208:t=DG.Dst;break;case 209:t=DG.OneMinusDst;break;case 206:t=DG.DstAlpha;break;case 207:t=DG.OneMinusDstAlpha;break;case 210:t=DG.SrcAlphaSaturated;break;case 211:t=DG.Constant;break;case 212:t=DG.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t,r=e.stencilFunc;switch(r){case 512:t=DD.Never;break;case 519:t=DD.Always;break;case 513:t=DD.Less;break;case 515:t=DD.LessEqual;break;case 514:t=DD.Equal;break;case 518:t=DD.GreaterEqual;break;case 516:t=DD.Greater;break;case 517:t=DD.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",r)}return t}_getStencilOperation(e){let t;switch(e){case 7680:t=DW.Keep;break;case 0:t=DW.Zero;break;case 7681:t=DW.Replace;break;case 5386:t=DW.Invert;break;case 7682:t=DW.IncrementClamp;break;case 7683:t=DW.DecrementClamp;break;case 34055:t=DW.IncrementWrap;break;case 34056:t=DW.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case 100:t=DH.Add;break;case 101:t=DH.Subtract;break;case 102:t=DH.ReverseSubtract;break;case 103:t=DH.Min;break;case 104:t=DH.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,r){let n={};n.topology=this.backend.utils.getPrimitiveTopology(e,r),null!==t.index&&!0===e.isLine&&!0!==e.isLineSegments&&(n.stripIndexFormat=t.index.array instanceof Uint16Array?Dk.Uint16:Dk.Uint32);let i=1===r.side;return e.isMesh&&0>e.matrixWorld.determinant()&&(i=!i),n.frontFace=!0===i?DU.CW:DU.CCW,n.cullMode=2===r.side?DO.None:DO.Back,n}_getColorWriteMask(e){return!0===e.colorWrite?Dj.All:Dj.None}_getDepthCompare(e){let t;if(!1===e.depthTest)t=DD.Always;else{let r=e.depthFunc;switch(r){case 0:t=DD.Never;break;case 1:t=DD.Always;break;case 2:t=DD.Less;break;case 3:t=DD.LessEqual;break;case 4:t=DD.Equal;break;case 5:t=DD.GreaterEqual;break;case 6:t=DD.Greater;break;case 7:t=DD.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",r)}}return t}constructor(e){this.backend=e,this._activePipelines=new WeakMap}}class Bw extends DN{allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return eP("WebGPUTimestampQueryPool [".concat(this.type,"]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.").concat(this.type.toUpperCase()," ).")),null;let t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||0===this.currentQueryIndex||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if("unmapped"!==this.resultBuffer.mapState)return this.lastValue;let e=new Map(this.queryOffsets),t=this.currentQueryIndex,r=8*t;this.currentQueryIndex=0,this.queryOffsets.clear();let n=this.device.createCommandEncoder();n.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),n.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,r);let i=n.finish();if(this.device.queue.submit([i]),"unmapped"!==this.resultBuffer.mapState)return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,r),this.isDisposed)return"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),this.lastValue;let a=new BigUint64Array(this.resultBuffer.getMappedRange(0,r)),s=0;for(let[,t]of e){let e=a[t],r=a[t+1],n=Number(r-e)/1e6;s+=n}return this.resultBuffer.unmap(),this.lastValue=s,s}catch(e){return console.error("Error resolving queries:",e),"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&"mapped"===this.resultBuffer.mapState)try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}constructor(e,t,r=2048){super(r),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:"queryset_global_timestamp_".concat(t)});let n=8*this.maxQueries;this.resolveBuffer=this.device.createBuffer({label:"buffer_timestamp_resolve_".concat(t),size:n,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:"buffer_timestamp_result_".concat(t),size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}}class BM extends Dp{async init(e){let t;await super.init(e);let r=this.parameters;if(void 0===r.device){let e={powerPreference:r.powerPreference,featureLevel:r.compatibilityMode?"compatibility":void 0},n="undefined"!=typeof navigator?await navigator.gpu.requestAdapter(e):null;if(null===n)throw Error("WebGPUBackend: Unable to create WebGPU adapter.");let i=Object.values(D1),a=[];for(let e of i)n.features.has(e)&&a.push(e);let s={requiredFeatures:a,requiredLimits:r.requiredLimits};t=await n.requestDevice(s)}else t=r.device;t.lost.then(t=>{let r={api:"WebGPU",message:t.message||"Unknown reason",reason:t.reason||null,originalEvent:t};e.onDeviceLost(r)});let n=void 0!==r.context?r.context:e.domElement.getContext("webgpu");this.device=t,this.context=n;let i=r.alpha?"premultiplied":"opaque",a=eD.getToneMappingMode(this.renderer.outputColorSpace);this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i,toneMapping:{mode:a}}),this.trackTimestamp=this.trackTimestamp&&this.hasFeature(D1.TimestampQuery),this.updateSize()}get coordinateSystem(){return 2001}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(null===e){let t=this.renderer;e={colorAttachments:[{view:null}]},(!0===this.renderer.depth||!0===this.renderer.stencil)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(t.depth,t.stencil).createView()});let r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}let t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.renderTarget,n=this.get(r),i=n.descriptors;(void 0===i||n.width!==r.width||n.height!==r.height||n.samples!==r.samples)&&(n.descriptors=i={});let a=e.getCacheKey(),s=i[a];if(void 0===s){let t,o=e.textures,l=[],u=this._isRenderCameraDepthArray(e);for(let n=0;n<o.length;n++){let i=this.get(o[n]),a={label:"colorAttachment_".concat(n),baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:DJ.TwoD};if(r.isRenderTarget3D)t=e.activeCubeFace,a.baseArrayLayer=0,a.dimension=DJ.ThreeD,a.depthOrArrayLayers=o[n].image.depth;else if(r.isRenderTarget&&o[n].image.depth>1)if(!0===u){let t=e.camera.cameras;for(let e=0;e<t.length;e++){let t={...a,baseArrayLayer:e,arrayLayerCount:1,dimension:DJ.TwoD},r=i.texture.createView(t);l.push({view:r,resolveTarget:void 0,depthSlice:void 0})}}else a.dimension=DJ.TwoDArray,a.depthOrArrayLayers=o[n].image.depth;if(!0!==u){let e,r,n=i.texture.createView(a);void 0!==i.msaaTexture?(e=i.msaaTexture.createView(),r=n):(e=n,r=void 0),l.push({view:e,resolveTarget:r,depthSlice:t})}}if(s={textureViews:l},e.depth){let t=this.get(e.depthTexture),r={};e.depthTexture.isArrayTexture&&(r.dimension=DJ.TwoD,r.arrayLayerCount=1,r.baseArrayLayer=e.activeCubeFace),s.depthStencilView=t.texture.createView(r)}i[a]=s,n.width=r.width,n.height=r.height,n.samples=r.samples,n.activeMipmapLevel=e.activeMipmapLevel,n.activeCubeFace=e.activeCubeFace}let o={colorAttachments:[]};for(let e=0;e<s.textureViews.length;e++){let r=s.textureViews[e],n={r:0,g:0,b:0,a:1};0===e&&t.clearValue&&(n=t.clearValue),o.colorAttachments.push({view:r.view,depthSlice:r.depthSlice,resolveTarget:r.resolveTarget,loadOp:t.loadOp||DF.Load,storeOp:t.storeOp||DB.Store,clearValue:n})}return s.depthStencilView&&(o.depthStencilAttachment={view:s.depthStencilView}),o}beginRender(e){let t,r,n=this.get(e);n.frameCalls=this.renderer.info.render.frameCalls;let i=this.device,a=e.occlusionQueryCount;a>0&&(n.currentOcclusionQuerySet&&n.currentOcclusionQuerySet.destroy(),n.currentOcclusionQueryBuffer&&n.currentOcclusionQueryBuffer.destroy(),n.currentOcclusionQuerySet=n.occlusionQuerySet,n.currentOcclusionQueryBuffer=n.occlusionQueryBuffer,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.occlusionQuerySet=t=i.createQuerySet({type:"occlusion",count:a,label:"occlusionQuerySet_".concat(e.id)}),n.occlusionQueryIndex=0,n.occlusionQueryObjects=Array(a),n.lastOcclusionObject=null),r=null===e.textures?this._getDefaultRenderPassDescriptor():this._getRenderPassDescriptor(e,{loadOp:DF.Load}),this.initTimestampQuery(en.RENDER,this.getTimestampUID(e),r),r.occlusionQuerySet=t;let s=r.depthStencilAttachment;if(null!==e.textures){let t=r.colorAttachments;for(let r=0;r<t.length;r++){let n=t[r];e.clearColor?(n.clearValue=0===r?e.clearColorValue:{r:0,g:0,b:0,a:1},n.loadOp=DF.Clear):n.loadOp=DF.Load,n.storeOp=DB.Store}}else{let t=r.colorAttachments[0];e.clearColor?(t.clearValue=e.clearColorValue,t.loadOp=DF.Clear):t.loadOp=DF.Load,t.storeOp=DB.Store}e.depth&&(e.clearDepth?(s.depthClearValue=e.clearDepthValue,s.depthLoadOp=DF.Clear):s.depthLoadOp=DF.Load,s.depthStoreOp=DB.Store),e.stencil&&(e.clearStencil?(s.stencilClearValue=e.clearStencilValue,s.stencilLoadOp=DF.Clear):s.stencilLoadOp=DF.Load,s.stencilStoreOp=DB.Store);let o=i.createCommandEncoder({label:"renderContext_"+e.id});if(!0===this._isRenderCameraDepthArray(e)){let t=e.camera.cameras;n.layerDescriptors&&n.layerDescriptors.length===t.length?this._updateDepthLayerDescriptors(e,n,t):this._createDepthLayerDescriptors(e,n,r,t),n.bundleEncoders=[],n.bundleSets=[];for(let r=0;r<t.length;r++){let t=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+r),i={attributes:{},bindingGroups:[],pipeline:null,index:null};n.bundleEncoders.push(t),n.bundleSets.push(i)}n.currentPass=null}else{let t=o.beginRenderPass(r);if(n.currentPass=t,e.viewport&&this.updateViewport(e),e.scissor){let{x:r,y:n,width:i,height:a}=e.scissorValue;t.setScissorRect(r,n,i,a)}}n.descriptor=r,n.encoder=o,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.renderBundles=[]}_createDepthLayerDescriptors(e,t,r,n){let i=r.depthStencilAttachment;t.layerDescriptors=[];let a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let s=0;s<n.length;s++){let n={...r,colorAttachments:[{...r.colorAttachments[0],view:r.colorAttachments[s].view}]};if(r.depthStencilAttachment){let t=s;a.viewCache[t]||(a.viewCache[t]=a.texture.createView({dimension:DJ.TwoD,baseArrayLayer:s,arrayLayerCount:1})),n.depthStencilAttachment={view:a.viewCache[t],depthLoadOp:i.depthLoadOp||DF.Clear,depthStoreOp:i.depthStoreOp||DB.Store,depthClearValue:i.depthClearValue||1},e.stencil&&(n.depthStencilAttachment.stencilLoadOp=i.stencilLoadOp,n.depthStencilAttachment.stencilStoreOp=i.stencilStoreOp,n.depthStencilAttachment.stencilClearValue=i.stencilClearValue)}else n.depthStencilAttachment={...i};t.layerDescriptors.push(n)}}_updateDepthLayerDescriptors(e,t,r){for(let n=0;n<r.length;n++){let r=t.layerDescriptors[n];if(r.depthStencilAttachment){let t=r.depthStencilAttachment;e.depth&&(e.clearDepth?(t.depthClearValue=e.clearDepthValue,t.depthLoadOp=DF.Clear):t.depthLoadOp=DF.Load),e.stencil&&(e.clearStencil?(t.stencilClearValue=e.clearStencilValue,t.stencilLoadOp=DF.Clear):t.stencilLoadOp=DF.Load)}}}finishRender(e){let t=this.get(e),r=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),r>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();let n=t.encoder;if(!0===this._isRenderCameraDepthArray(e)){let r=[];for(let e=0;e<t.bundleEncoders.length;e++){let n=t.bundleEncoders[e];r.push(n.finish())}for(let i=0;i<t.layerDescriptors.length;i++)if(i<r.length){let a=t.layerDescriptors[i],s=n.beginRenderPass(a);if(e.viewport){let{x:t,y:r,width:n,height:i,minDepth:a,maxDepth:o}=e.viewportValue;s.setViewport(t,r,n,i,a,o)}if(e.scissor){let{x:t,y:r,width:n,height:i}=e.scissorValue;s.setScissorRect(t,r,n,i)}s.executeBundles([r[i]]),s.end()}}else t.currentPass&&t.currentPass.end();if(r>0){let n=8*r,i=this.occludedResolveCache.get(n);void 0===i&&(i=this.device.createBuffer({size:n,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(n,i));let a=this.device.createBuffer({size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,r,i,0),t.encoder.copyBufferToBuffer(i,0,a,0,n),t.occlusionQueryBuffer=a,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),null!==e.textures){let t=e.textures;for(let e=0;e<t.length;e++){let r=t[e];!0===r.generateMipmaps&&this.textureUtils.generateMipmaps(r)}}}isOccluded(e,t){let r=this.get(e);return r.occluded&&r.occluded.has(t)}async resolveOccludedAsync(e){let t=this.get(e),{currentOcclusionQueryBuffer:r,currentOcclusionQueryObjects:n}=t;if(r&&n){let e=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await r.mapAsync(GPUMapMode.READ);let i=new BigUint64Array(r.getMappedRange());for(let t=0;t<n.length;t++)i[t]===BigInt(0)&&e.add(n[t]);r.destroy(),t.occluded=e}}updateViewport(e){let{currentPass:t}=this.get(e),{x:r,y:n,width:i,height:a,minDepth:s,maxDepth:o}=e.viewportValue;t.setViewport(r,n,i,a,s,o)}getClearColor(){let e=super.getClearColor();return!0===this.renderer.alpha&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,r){let n,i,a,s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=this.device,u=this.renderer,c=[];if(e){let e=this.getClearColor();i={r:e.r,g:e.g,b:e.b,a:e.a}}if(null===o){a=u.depth,s=u.stencil;let t=this._getDefaultRenderPassDescriptor();if(e){let e=(c=t.colorAttachments)[0];e.clearValue=i,e.loadOp=DF.Clear,e.storeOp=DB.Store}(a||s)&&(n=t.depthStencilAttachment)}else{a=o.depth,s=o.stencil;let l={loadOp:e?DF.Clear:DF.Load,clearValue:e?i:void 0};a&&(l.depthLoadOp=t?DF.Clear:DF.Load,l.depthClearValue=t?u.getClearDepth():void 0,l.depthStoreOp=DB.Store),s&&(l.stencilLoadOp=r?DF.Clear:DF.Load,l.stencilClearValue=r?u.getClearStencil():void 0,l.stencilStoreOp=DB.Store);let h=this._getRenderPassDescriptor(o,l);c=h.colorAttachments,n=h.depthStencilAttachment}a&&n&&(t?(n.depthLoadOp=DF.Clear,n.depthClearValue=u.getClearDepth()):n.depthLoadOp=DF.Load,n.depthStoreOp=DB.Store),s&&n&&(r?(n.stencilLoadOp=DF.Clear,n.stencilClearValue=u.getClearStencil()):n.stencilLoadOp=DF.Load,n.stencilStoreOp=DB.Store);let h=l.createCommandEncoder({label:"clear"});h.beginRenderPass({colorAttachments:c,depthStencilAttachment:n}).end(),l.queue.submit([h.finish()])}beginCompute(e){let t=this.get(e);t.frameCalls=this.renderer.info.compute.frameCalls;let r={label:"computeGroup_"+e.id};this.initTimestampQuery(en.COMPUTE,this.getTimestampUID(e),r),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(r)}compute(e,t,r,n){let i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=this.get(t),{passEncoderGPU:o}=this.get(e),l=this.get(n).pipeline;this.pipelineUtils.setPipeline(o,l);for(let e=0,t=r.length;e<t;e++){let t=r[e],n=this.get(t);o.setBindGroup(e,n.group)}if(null===a&&(a=t.count),"number"==typeof a){let e=a;if(void 0===s.dispatchSize||s.count!==e){s.dispatchSize=[0,1,1],s.count=e;let r=t.workgroupSize,n=r[0];for(let e=1;e<r.length;e++)n*=r[e];let a=Math.ceil(e/n),o=this.device.limits.maxComputeWorkgroupsPerDimension;i=[a,1,1],a>o&&(i[0]=Math.min(a,o),i[1]=Math.ceil(a/o)),s.dispatchSize=i}i=s.dispatchSize}else i=a;o.dispatchWorkgroups(i[0],i[1]||1,i[2]||1)}finishCompute(e){let t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){let{object:r,material:n,context:i,pipeline:a}=e,s=e.getBindings(),o=this.get(i),l=this.get(a).pipeline,u=e.getIndex(),c=null!==u,h=e.getDrawParameters();if(null===h)return;let d=(t,r)=>{this.pipelineUtils.setPipeline(t,l),r.pipeline=l;let a=r.bindingGroups;for(let e=0,r=s.length;e<r;e++){let r=s[e],n=this.get(r);a[r.index]!==r.id&&(t.setBindGroup(r.index,n.group),a[r.index]=r.id)}if(!0===c&&r.index!==u){let e=this.get(u).buffer,n=u.array instanceof Uint16Array?Dk.Uint16:Dk.Uint32;t.setIndexBuffer(e,n),r.index=u}let h=e.getVertexBuffers();for(let e=0,n=h.length;e<n;e++){let n=h[e];if(r.attributes[e]!==n){let i=this.get(n).buffer;t.setVertexBuffer(e,i),r.attributes[e]=n}}!0===i.stencil&&!0===n.stencilWrite&&o.currentStencilRef!==n.stencilRef&&(t.setStencilReference(n.stencilRef),o.currentStencilRef=n.stencilRef)},A=(n,i)=>{if(d(n,i),!0===r.isBatchedMesh){let e=r._multiDrawStarts,i=r._multiDrawCounts,a=r._multiDrawCount,s=r._multiDrawInstances;null!==s&&eP("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let o=0;o<a;o++){let a=s?s[o]:1,l=a>1?0:o;!0===c?n.drawIndexed(i[o],a,e[o]/u.array.BYTES_PER_ELEMENT,0,l):n.draw(i[o],a,e[o],l),t.update(r,i[o],a)}}else if(!0===c){let{vertexCount:i,instanceCount:a,firstVertex:s}=h,o=e.getIndirect();if(null!==o){let e=this.get(o).buffer;n.drawIndexedIndirect(e,0)}else n.drawIndexed(i,a,s,0,0);t.update(r,i,a)}else{let{vertexCount:i,instanceCount:a,firstVertex:s}=h,o=e.getIndirect();if(null!==o){let e=this.get(o).buffer;n.drawIndirect(e,0)}else n.draw(i,a,s,0);t.update(r,i,a)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){let t=this.get(e.camera),n=e.camera.cameras,a=e.getBindingGroup("cameraIndex");if(void 0===t.indexesGPU||t.indexesGPU.length!==n.length){let e=this.get(a),r=[],i=new Uint32Array([0,0,0,0]);for(let t=0,a=n.length;t<a;t++){i[0]=t;let n=this.bindingUtils.createBindGroupIndex(i,e.layout);r.push(n)}t.indexesGPU=r}let s=this.renderer.getPixelRatio();for(let e=0,l=n.length;e<l;e++){let l=n[e];if(r.layers.test(l.layers)){let r=l.viewport,n=o.currentPass,u=o.currentSets;if(o.bundleEncoders){let t=o.bundleEncoders[e],r=o.bundleSets[e];n=t,u=r}r&&n.setViewport(Math.floor(r.x*s),Math.floor(r.y*s),Math.floor(r.width*s),Math.floor(r.height*s),i.viewportValue.minDepth,i.viewportValue.maxDepth),a&&t.indexesGPU&&(n.setBindGroup(a.index,t.indexesGPU[e]),u.bindingGroups[a.index]=a.id),A(n,u)}}}else if(o.currentPass){if(void 0!==o.occlusionQuerySet){let e=o.lastOcclusionObject;e!==r&&(null!==e&&!0===e.occlusionTest&&(o.currentPass.endOcclusionQuery(),o.occlusionQueryIndex++),!0===r.occlusionTest&&(o.currentPass.beginOcclusionQuery(o.occlusionQueryIndex),o.occlusionQueryObjects[o.occlusionQueryIndex]=r),o.lastOcclusionObject=r)}A(o.currentPass,o.currentSets)}}needsRenderUpdate(e){let t=this.get(e),{object:r,material:n}=e,i=this.utils,a=i.getSampleCountRenderContext(e.context),s=i.getCurrentColorSpace(e.context),o=i.getCurrentColorFormat(e.context),l=i.getCurrentDepthStencilFormat(e.context),u=i.getPrimitiveTopology(r,n),c=!1;return(t.material!==n||t.materialVersion!==n.version||t.transparent!==n.transparent||t.blending!==n.blending||t.premultipliedAlpha!==n.premultipliedAlpha||t.blendSrc!==n.blendSrc||t.blendDst!==n.blendDst||t.blendEquation!==n.blendEquation||t.blendSrcAlpha!==n.blendSrcAlpha||t.blendDstAlpha!==n.blendDstAlpha||t.blendEquationAlpha!==n.blendEquationAlpha||t.colorWrite!==n.colorWrite||t.depthWrite!==n.depthWrite||t.depthTest!==n.depthTest||t.depthFunc!==n.depthFunc||t.stencilWrite!==n.stencilWrite||t.stencilFunc!==n.stencilFunc||t.stencilFail!==n.stencilFail||t.stencilZFail!==n.stencilZFail||t.stencilZPass!==n.stencilZPass||t.stencilFuncMask!==n.stencilFuncMask||t.stencilWriteMask!==n.stencilWriteMask||t.side!==n.side||t.alphaToCoverage!==n.alphaToCoverage||t.sampleCount!==a||t.colorSpace!==s||t.colorFormat!==o||t.depthStencilFormat!==l||t.primitiveTopology!==u||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=n,t.materialVersion=n.version,t.transparent=n.transparent,t.blending=n.blending,t.premultipliedAlpha=n.premultipliedAlpha,t.blendSrc=n.blendSrc,t.blendDst=n.blendDst,t.blendEquation=n.blendEquation,t.blendSrcAlpha=n.blendSrcAlpha,t.blendDstAlpha=n.blendDstAlpha,t.blendEquationAlpha=n.blendEquationAlpha,t.colorWrite=n.colorWrite,t.depthWrite=n.depthWrite,t.depthTest=n.depthTest,t.depthFunc=n.depthFunc,t.stencilWrite=n.stencilWrite,t.stencilFunc=n.stencilFunc,t.stencilFail=n.stencilFail,t.stencilZFail=n.stencilZFail,t.stencilZPass=n.stencilZPass,t.stencilFuncMask=n.stencilFuncMask,t.stencilWriteMask=n.stencilWriteMask,t.side=n.side,t.alphaToCoverage=n.alphaToCoverage,t.sampleCount=a,t.colorSpace=s,t.colorFormat=o,t.depthStencilFormat=l,t.primitiveTopology=u,t.clippingContextCacheKey=e.clippingContextCacheKey,c=!0),c}getRenderCacheKey(e){let{object:t,material:r}=e,n=this.utils,i=e.context,a=t.isMesh&&0>t.matrixWorld.determinant();return[r.transparent,r.blending,r.premultipliedAlpha,r.blendSrc,r.blendDst,r.blendEquation,r.blendSrcAlpha,r.blendDstAlpha,r.blendEquationAlpha,r.colorWrite,r.depthWrite,r.depthTest,r.depthFunc,r.stencilWrite,r.stencilFunc,r.stencilFail,r.stencilZFail,r.stencilZPass,r.stencilFuncMask,r.stencilWriteMask,r.side,a,n.getSampleCountRenderContext(i),n.getCurrentColorSpace(i),n.getCurrentColorFormat(i),n.getCurrentDepthStencilFormat(i),n.getPrimitiveTopology(t,r),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,n,i,a){return this.textureUtils.copyTextureToBuffer(e,t,r,n,i,a)}initTimestampQuery(e,t,r){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new Bw(this.device,e,2048));let n=this.timestampQueryPool[e],i=n.allocateQueriesForContext(t);r.timestampWrites={querySet:n.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}createNodeBuilder(e,t){return new Bg(e,t)}createProgram(e){this.get(e).module={module:this.device.createShaderModule({code:e.code,label:e.stage+(""!==e.name?"_".concat(e.name):"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){let t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){let r=this.get(e),n=r.currentPass.finish();this.get(t).bundleGPU=n,r.currentSets=r._currentSets,r.currentPass=r._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,r,n){this.bindingUtils.createBindings(e,t,r,n)}updateBindings(e,t,r,n){this.bindingUtils.createBindings(e,t,r,n)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=0,o=0,l=0,u=0,c=0,h=0,d=e.image.width,A=e.image.height,p=1;null!==r&&(!0===r.isBox3?(u=r.min.x,c=r.min.y,h=r.min.z,d=r.max.x-r.min.x,A=r.max.y-r.min.y,p=r.max.z-r.min.z):(u=r.min.x,c=r.min.y,d=r.max.x-r.min.x,A=r.max.y-r.min.y,p=1)),null!==n&&(s=n.x,o=n.y,l=n.z||0);let f=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),m=this.get(e).texture,g=this.get(t).texture;f.copyTextureToTexture({texture:m,mipLevel:i,origin:{x:u,y:c,z:h}},{texture:g,mipLevel:a,origin:{x:s,y:o,z:l}},[d,A,p]),this.device.queue.submit([f.finish()]),0===a&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,r){let n,i=this.get(t),a=null;a=t.renderTarget?e.isDepthTexture?this.get(t.depthTexture).texture:this.get(t.textures[0]).texture:e.isDepthTexture?this.textureUtils.getDepthBuffer(t.depth,t.stencil):this.context.getCurrentTexture();let s=this.get(e).texture;if(a.format!==s.format)return void console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",a.format,s.format);if(i.currentPass?(i.currentPass.end(),n=i.encoder):n=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),n.copyTextureToTexture({texture:a,origin:[r.x,r.y,0]},{texture:s},[r.z,r.w]),i.currentPass){let{descriptor:e}=i;for(let t=0;t<e.colorAttachments.length;t++)e.colorAttachments[t].loadOp=DF.Load;if(t.depth&&(e.depthStencilAttachment.depthLoadOp=DF.Load),t.stencil&&(e.depthStencilAttachment.stencilLoadOp=DF.Load),i.currentPass=n.beginRenderPass(e),i.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){let{x:e,y:r,width:n,height:a}=t.scissorValue;i.currentPass.setScissorRect(e,r,n,a)}}else this.device.queue.submit([n.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=void 0===e.alpha||e.alpha,this.parameters.compatibilityMode=void 0!==e.compatibilityMode&&e.compatibilityMode,this.parameters.requiredLimits=void 0===e.requiredLimits?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new By(this),this.attributeUtils=new Bb(this),this.bindingUtils=new BS(this),this.pipelineUtils=new BT(this),this.textureUtils=new D9(this),this.occludedResolveCache=new Map}}class BE extends sN{copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),this.iesMap=null}}class BR extends sN{copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),this.aspect=null}}class BC extends LL{constructor(){super(),this.addMaterial(MS,"MeshPhongMaterial"),this.addMaterial(EJ,"MeshStandardMaterial"),this.addMaterial(E0,"MeshPhysicalMaterial"),this.addMaterial(E4,"MeshToonMaterial"),this.addMaterial(Mp,"MeshBasicMaterial"),this.addMaterial(M_,"MeshLambertMaterial"),this.addMaterial(Mr,"MeshNormalMaterial"),this.addMaterial(E7,"MeshMatcapMaterial"),this.addMaterial(w5,"LineBasicMaterial"),this.addMaterial(w7,"LineDashedMaterial"),this.addMaterial(Rn,"PointsMaterial"),this.addMaterial(Re,"SpriteMaterial"),this.addMaterial(Ro,"ShadowMaterial"),this.addLight(Pq,sB),this.addLight(La,sO),this.addLight(Lu,sz),this.addLight(Lc,sN),this.addLight(Lp,sk),this.addLight(Lf,sT),this.addLight(Lm,sq),this.addLight(Lh,BE),this.addLight(LA,BR),this.addToneMapping(C9,1),this.addToneMapping(Ne,2),this.addToneMapping(Nt,3),this.addToneMapping(Nn,4),this.addToneMapping(No,6),this.addToneMapping(Nl,7)}}class BN extends L0{constructor(e={}){let t;e.forceWebGL?t=DI:(t=BM,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new DI(e))),super(new t(e),e),this.library=new BC,this.isWebGPURenderer=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}e.s(["BRDF_GGX",()=>BP,"BRDF_Lambert",()=>BI,"BasicPointShadowFilter",()=>BL,"BasicShadowFilter",()=>BD,"Break",()=>BB,"Const",()=>BF,"Continue",()=>BU,"DFGApprox",()=>BO,"D_GGX",()=>Bk,"Discard",()=>Bz,"EPSILON",()=>BV,"F_Schlick",()=>Bq,"Fn",()=>BG,"INFINITY",()=>BH,"If",()=>Bj,"Loop",()=>BW,"NodeAccess",()=>BX,"NodeShaderStage",()=>BQ,"NodeType",()=>BY,"NodeUpdateType",()=>BK,"OnMaterialUpdate",()=>VH,"OnObjectUpdate",()=>VG,"PCFShadowFilter",()=>BZ,"PCFSoftShadowFilter",()=>BJ,"PI",()=>B$,"PI2",()=>B0,"PointShadowFilter",()=>B1,"Return",()=>B2,"Schlick_to_F0",()=>B3,"ScriptableNodeResources",()=>B4,"ShaderNode",()=>B5,"Stack",()=>B6,"Switch",()=>B7,"TBNViewMatrix",()=>B8,"VSMShadowFilter",()=>B9,"V_GGX_SmithCorrelated",()=>Fe,"Var",()=>Ft,"VarIntent",()=>Fr,"abs",()=>Fn,"acesFilmicToneMapping",()=>Fi,"acos",()=>Fa,"add",()=>Fs,"addMethodChaining",()=>Fo,"addNodeElement",()=>Fl,"agxToneMapping",()=>Fu,"all",()=>Fc,"alphaT",()=>Fh,"and",()=>Fd,"anisotropy",()=>FA,"anisotropyB",()=>Fp,"anisotropyT",()=>Ff,"any",()=>Fm,"append",()=>Fg,"array",()=>Fy,"arrayBuffer",()=>Fv,"asin",()=>Fx,"assign",()=>F_,"atan",()=>Fb,"atan2",()=>FS,"atomicAdd",()=>FT,"atomicAnd",()=>Fw,"atomicFunc",()=>FM,"atomicLoad",()=>FE,"atomicMax",()=>FR,"atomicMin",()=>FC,"atomicOr",()=>FN,"atomicStore",()=>FP,"atomicSub",()=>FI,"atomicXor",()=>FL,"attenuationColor",()=>FD,"attenuationDistance",()=>FB,"attribute",()=>FF,"attributeArray",()=>FU,"backgroundBlurriness",()=>FO,"backgroundIntensity",()=>Fk,"backgroundRotation",()=>Fz,"batch",()=>FV,"bentNormalView",()=>Fq,"billboarding",()=>FG,"bitAnd",()=>FH,"bitNot",()=>Fj,"bitOr",()=>FW,"bitXor",()=>FX,"bitangentGeometry",()=>FQ,"bitangentLocal",()=>FY,"bitangentView",()=>FK,"bitangentWorld",()=>FZ,"bitcast",()=>FJ,"blendBurn",()=>F$,"blendColor",()=>F0,"blendDodge",()=>F1,"blendOverlay",()=>F2,"blendScreen",()=>F3,"blur",()=>F4,"bool",()=>F5,"buffer",()=>F6,"bufferAttribute",()=>F7,"builtin",()=>Ue,"bumpMap",()=>F8,"burn",()=>F9,"bvec2",()=>Ut,"bvec3",()=>Ur,"bvec4",()=>Un,"bypass",()=>Ui,"cache",()=>Ua,"call",()=>Us,"cameraFar",()=>Uo,"cameraIndex",()=>Ul,"cameraNear",()=>Uu,"cameraNormalMatrix",()=>Uc,"cameraPosition",()=>Uh,"cameraProjectionMatrix",()=>Ud,"cameraProjectionMatrixInverse",()=>UA,"cameraViewMatrix",()=>Up,"cameraViewport",()=>Uf,"cameraWorldMatrix",()=>Um,"cbrt",()=>Ug,"cdl",()=>Uy,"ceil",()=>Uv,"checker",()=>Ux,"cineonToneMapping",()=>U_,"clamp",()=>Ub,"clearcoat",()=>US,"clearcoatNormalView",()=>UT,"clearcoatRoughness",()=>Uw,"code",()=>UM,"color",()=>UE,"colorSpaceToWorking",()=>UR,"colorToDirection",()=>UC,"compute",()=>UN,"computeKernel",()=>UP,"computeSkinning",()=>UI,"context",()=>UL,"convert",()=>UD,"convertColorSpace",()=>UB,"convertToTexture",()=>UF,"cos",()=>UU,"cross",()=>UO,"cubeTexture",()=>Uk,"cubeTextureBase",()=>Uz,"cubeToUV",()=>UV,"dFdx",()=>Uq,"dFdy",()=>UG,"dashSize",()=>UH,"debug",()=>Uj,"decrement",()=>UW,"decrementBefore",()=>UX,"defaultBuildStages",()=>UQ,"defaultShaderStages",()=>UY,"defined",()=>UK,"degrees",()=>UZ,"deltaTime",()=>UJ,"densityFog",()=>U$,"densityFogFactor",()=>U0,"depth",()=>U1,"depthPass",()=>U2,"determinant",()=>U3,"difference",()=>U4,"diffuseColor",()=>U5,"directPointLight",()=>U6,"directionToColor",()=>U7,"directionToFaceDirection",()=>U8,"dispersion",()=>U9,"distance",()=>Oe,"div",()=>Ot,"dodge",()=>Or,"dot",()=>On,"drawIndex",()=>Oi,"dynamicBufferAttribute",()=>Oa,"element",()=>Os,"emissive",()=>Oo,"equal",()=>Ol,"equals",()=>Ou,"equirectUV",()=>Oc,"exp",()=>Oh,"exp2",()=>Od,"expression",()=>OA,"faceDirection",()=>Op,"faceForward",()=>Of,"faceforward",()=>Om,"float",()=>Og,"floatBitsToInt",()=>Oy,"floatBitsToUint",()=>Ov,"floor",()=>Ox,"fog",()=>O_,"fract",()=>Ob,"frameGroup",()=>OS,"frameId",()=>OT,"frontFacing",()=>Ow,"fwidth",()=>OM,"gain",()=>OE,"gapSize",()=>OR,"getConstNodeType",()=>OC,"getCurrentStack",()=>ON,"getDirection",()=>OP,"getDistanceAttenuation",()=>OI,"getGeometryRoughness",()=>OL,"getNormalFromDepth",()=>OD,"getParallaxCorrectNormal",()=>OB,"getRoughness",()=>OF,"getScreenPosition",()=>OU,"getShIrradianceAt",()=>OO,"getShadowMaterial",()=>Ok,"getShadowRenderObjectFunction",()=>Oz,"getTextureIndex",()=>OV,"getViewPosition",()=>Oq,"globalId",()=>OG,"glsl",()=>OH,"glslFn",()=>Oj,"grayscale",()=>OW,"greaterThan",()=>OX,"greaterThanEqual",()=>OQ,"hash",()=>OY,"highpModelNormalViewMatrix",()=>OK,"highpModelViewMatrix",()=>OZ,"hue",()=>OJ,"increment",()=>O$,"incrementBefore",()=>O0,"instance",()=>O1,"instanceIndex",()=>O2,"instancedArray",()=>O3,"instancedBufferAttribute",()=>O4,"instancedDynamicBufferAttribute",()=>O5,"instancedMesh",()=>O6,"int",()=>O7,"intBitsToFloat",()=>O8,"inverse",()=>O9,"inverseSqrt",()=>ke,"inversesqrt",()=>kt,"invocationLocalIndex",()=>kr,"invocationSubgroupIndex",()=>kn,"ior",()=>ki,"iridescence",()=>ka,"iridescenceIOR",()=>ks,"iridescenceThickness",()=>ko,"ivec2",()=>kl,"ivec3",()=>ku,"ivec4",()=>kc,"js",()=>kh,"label",()=>kd,"length",()=>kA,"lengthSq",()=>kp,"lessThan",()=>kf,"lessThanEqual",()=>km,"lightPosition",()=>kg,"lightProjectionUV",()=>ky,"lightShadowMatrix",()=>kv,"lightTargetDirection",()=>kx,"lightTargetPosition",()=>k_,"lightViewPosition",()=>kb,"lightingContext",()=>kS,"lights",()=>kT,"linearDepth",()=>kw,"linearToneMapping",()=>kM,"localId",()=>kE,"log",()=>kR,"log2",()=>kC,"logarithmicDepthToViewZ",()=>kN,"luminance",()=>kP,"mat2",()=>kI,"mat3",()=>kL,"mat4",()=>kD,"matcapUV",()=>kB,"materialAO",()=>kF,"materialAlphaTest",()=>kU,"materialAnisotropy",()=>kO,"materialAnisotropyVector",()=>kk,"materialAttenuationColor",()=>kz,"materialAttenuationDistance",()=>kV,"materialClearcoat",()=>kq,"materialClearcoatNormal",()=>kG,"materialClearcoatRoughness",()=>kH,"materialColor",()=>kj,"materialDispersion",()=>kW,"materialEmissive",()=>kX,"materialEnvIntensity",()=>kQ,"materialEnvRotation",()=>kY,"materialIOR",()=>kK,"materialIridescence",()=>kZ,"materialIridescenceIOR",()=>kJ,"materialIridescenceThickness",()=>k$,"materialLightMap",()=>k0,"materialLineDashOffset",()=>k1,"materialLineDashSize",()=>k2,"materialLineGapSize",()=>k3,"materialLineScale",()=>k4,"materialLineWidth",()=>k5,"materialMetalness",()=>k6,"materialNormal",()=>k7,"materialOpacity",()=>k8,"materialPointSize",()=>k9,"materialReference",()=>ze,"materialReflectivity",()=>zt,"materialRefractionRatio",()=>zr,"materialRotation",()=>zn,"materialRoughness",()=>zi,"materialSheen",()=>za,"materialSheenRoughness",()=>zs,"materialShininess",()=>zo,"materialSpecular",()=>zl,"materialSpecularColor",()=>zu,"materialSpecularIntensity",()=>zc,"materialSpecularStrength",()=>zh,"materialThickness",()=>zd,"materialTransmission",()=>zA,"max",()=>zp,"maxMipLevel",()=>zf,"mediumpModelViewMatrix",()=>zm,"metalness",()=>zg,"min",()=>zy,"mix",()=>zv,"mixElement",()=>zx,"mod",()=>z_,"modInt",()=>zb,"modelDirection",()=>zS,"modelNormalMatrix",()=>zT,"modelPosition",()=>zw,"modelRadius",()=>zM,"modelScale",()=>zE,"modelViewMatrix",()=>zR,"modelViewPosition",()=>zC,"modelViewProjection",()=>zN,"modelWorldMatrix",()=>zP,"modelWorldMatrixInverse",()=>zI,"morphReference",()=>zL,"mrt",()=>zD,"mul",()=>zB,"mx_aastep",()=>zF,"mx_add",()=>zU,"mx_atan2",()=>zO,"mx_cell_noise_float",()=>zk,"mx_contrast",()=>zz,"mx_divide",()=>zV,"mx_fractal_noise_float",()=>zq,"mx_fractal_noise_vec2",()=>zG,"mx_fractal_noise_vec3",()=>zH,"mx_fractal_noise_vec4",()=>zj,"mx_frame",()=>zW,"mx_heighttonormal",()=>zX,"mx_hsvtorgb",()=>zQ,"mx_ifequal",()=>zY,"mx_ifgreater",()=>zK,"mx_ifgreatereq",()=>zZ,"mx_invert",()=>zJ,"mx_modulo",()=>z$,"mx_multiply",()=>z0,"mx_noise_float",()=>z1,"mx_noise_vec3",()=>z2,"mx_noise_vec4",()=>z3,"mx_place2d",()=>z4,"mx_power",()=>z5,"mx_ramp4",()=>z6,"mx_ramplr",()=>z7,"mx_ramptb",()=>z8,"mx_rgbtohsv",()=>z9,"mx_rotate2d",()=>Ve,"mx_rotate3d",()=>Vt,"mx_safepower",()=>Vr,"mx_separate",()=>Vn,"mx_splitlr",()=>Vi,"mx_splittb",()=>Va,"mx_srgb_texture_to_lin_rec709",()=>Vs,"mx_subtract",()=>Vo,"mx_timer",()=>Vl,"mx_transform_uv",()=>Vu,"mx_unifiednoise2d",()=>Vc,"mx_unifiednoise3d",()=>Vh,"mx_worley_noise_float",()=>Vd,"mx_worley_noise_vec2",()=>VA,"mx_worley_noise_vec3",()=>Vp,"negate",()=>Vf,"neutralToneMapping",()=>Vm,"nodeArray",()=>Vg,"nodeImmutable",()=>Vy,"nodeObject",()=>Vv,"nodeObjectIntent",()=>Vx,"nodeObjects",()=>V_,"nodeProxy",()=>Vb,"nodeProxyIntent",()=>VS,"normalFlat",()=>VT,"normalGeometry",()=>Vw,"normalLocal",()=>VM,"normalMap",()=>VE,"normalView",()=>VR,"normalViewGeometry",()=>VC,"normalWorld",()=>VN,"normalWorldGeometry",()=>VP,"normalize",()=>VI,"not",()=>VL,"notEqual",()=>VD,"numWorkgroups",()=>VB,"objectDirection",()=>VF,"objectGroup",()=>VU,"objectPosition",()=>VO,"objectRadius",()=>Vk,"objectScale",()=>Vz,"objectViewPosition",()=>VV,"objectWorldMatrix",()=>Vq,"oneMinus",()=>Vj,"or",()=>VW,"orthographicDepthToViewZ",()=>VX,"oscSawtooth",()=>VQ,"oscSine",()=>VY,"oscSquare",()=>VK,"oscTriangle",()=>VZ,"output",()=>VJ,"outputStruct",()=>V$,"overlay",()=>V0,"overloadingFn",()=>V1,"parabola",()=>V2,"parallaxDirection",()=>V3,"parallaxUV",()=>V4,"parameter",()=>V5,"pass",()=>V6,"passTexture",()=>V7,"pcurve",()=>V8,"perspectiveDepthToViewZ",()=>V9,"pmremTexture",()=>qe,"pointShadow",()=>qt,"pointUV",()=>qr,"pointWidth",()=>qn,"positionGeometry",()=>qi,"positionLocal",()=>qa,"positionPrevious",()=>qs,"positionView",()=>qo,"positionViewDirection",()=>ql,"positionWorld",()=>qu,"positionWorldDirection",()=>qc,"posterize",()=>qh,"pow",()=>qd,"pow2",()=>qA,"pow3",()=>qp,"pow4",()=>qf,"premultiplyAlpha",()=>qm,"property",()=>qg,"radians",()=>qy,"rand",()=>qv,"range",()=>qx,"rangeFog",()=>q_,"rangeFogFactor",()=>qb,"reciprocal",()=>qS,"reference",()=>qT,"referenceBuffer",()=>qw,"reflect",()=>qM,"reflectVector",()=>qE,"reflectView",()=>qR,"reflector",()=>qC,"refract",()=>qN,"refractVector",()=>qP,"refractView",()=>qI,"reinhardToneMapping",()=>qL,"remap",()=>qD,"remapClamp",()=>qB,"renderGroup",()=>qF,"renderOutput",()=>qU,"rendererReference",()=>qO,"rotate",()=>qk,"rotateUV",()=>qz,"roughness",()=>qV,"round",()=>qq,"rtt",()=>qG,"sRGBTransferEOTF",()=>qH,"sRGBTransferOETF",()=>qj,"sample",()=>qW,"sampler",()=>qX,"samplerComparison",()=>qQ,"saturate",()=>qY,"saturation",()=>qK,"screen",()=>qZ,"screenCoordinate",()=>qJ,"screenDPR",()=>q$,"screenSize",()=>q0,"screenUV",()=>q1,"scriptable",()=>q2,"scriptableValue",()=>q3,"select",()=>q4,"setCurrentStack",()=>q5,"setName",()=>q6,"shaderStages",()=>q7,"shadow",()=>q8,"shadowPositionWorld",()=>q9,"shapeCircle",()=>Ge,"sharedUniformGroup",()=>Gt,"sheen",()=>Gr,"sheenRoughness",()=>Gn,"shiftLeft",()=>Gi,"shiftRight",()=>Ga,"shininess",()=>Gs,"sign",()=>Go,"sin",()=>Gl,"sinc",()=>Gu,"skinning",()=>Gc,"smoothstep",()=>Gh,"smoothstepElement",()=>Gd,"specularColor",()=>GA,"specularF90",()=>Gp,"spherizeUV",()=>Gf,"split",()=>Gm,"spritesheetUV",()=>Gg,"sqrt",()=>Gy,"stack",()=>Gv,"step",()=>Gx,"stepElement",()=>G_,"storage",()=>Gb,"storageBarrier",()=>GS,"storageObject",()=>GT,"storageTexture",()=>Gw,"string",()=>GM,"struct",()=>GE,"sub",()=>GR,"subBuild",()=>GF,"subgroupAdd",()=>GC,"subgroupAll",()=>GN,"subgroupAnd",()=>GP,"subgroupAny",()=>GI,"subgroupBallot",()=>GL,"subgroupBroadcast",()=>GD,"subgroupBroadcastFirst",()=>GB,"subgroupElect",()=>GU,"subgroupExclusiveAdd",()=>GO,"subgroupExclusiveMul",()=>Gk,"subgroupInclusiveAdd",()=>Gz,"subgroupInclusiveMul",()=>GV,"subgroupIndex",()=>Gq,"subgroupMax",()=>GG,"subgroupMin",()=>GH,"subgroupMul",()=>Gj,"subgroupOr",()=>GW,"subgroupShuffle",()=>GX,"subgroupShuffleDown",()=>GQ,"subgroupShuffleUp",()=>GY,"subgroupShuffleXor",()=>GK,"subgroupSize",()=>GZ,"subgroupXor",()=>GJ,"tan",()=>G$,"tangentGeometry",()=>G0,"tangentLocal",()=>G1,"tangentView",()=>G2,"tangentWorld",()=>G3,"texture",()=>G4,"texture3D",()=>G5,"textureBarrier",()=>G6,"textureBicubic",()=>G7,"textureBicubicLevel",()=>G8,"textureCubeUV",()=>G9,"textureLoad",()=>He,"textureSize",()=>Ht,"textureStore",()=>Hr,"thickness",()=>Hn,"time",()=>Hi,"toneMapping",()=>Ha,"toneMappingExposure",()=>Hs,"toonOutlinePass",()=>Ho,"transformDirection",()=>Hl,"transformNormal",()=>Hu,"transformNormalToView",()=>Hc,"transformedClearcoatNormalView",()=>Hh,"transformedNormalView",()=>Hd,"transformedNormalWorld",()=>HA,"transmission",()=>Hp,"transpose",()=>Hf,"triNoise3D",()=>Hm,"triplanarTexture",()=>Hg,"triplanarTextures",()=>Hy,"trunc",()=>Hv,"uint",()=>Hx,"uintBitsToFloat",()=>H_,"uniform",()=>Hb,"uniformArray",()=>HS,"uniformCubeTexture",()=>HT,"uniformFlow",()=>HM,"uniformGroup",()=>Hw,"uniformTexture",()=>HE,"unpremultiplyAlpha",()=>HR,"userData",()=>HC,"uv",()=>HN,"uvec2",()=>HP,"uvec3",()=>HI,"uvec4",()=>HL,"varying",()=>HD,"varyingProperty",()=>HB,"vec2",()=>HF,"vec3",()=>HU,"vec4",()=>HO,"vectorComponents",()=>Hk,"velocity",()=>Hz,"vertexColor",()=>HV,"vertexIndex",()=>Hq,"vertexStage",()=>HG,"vibrance",()=>HH,"viewZToLogarithmicDepth",()=>Hj,"viewZToOrthographicDepth",()=>HW,"viewZToPerspectiveDepth",()=>HX,"viewport",()=>HQ,"viewportCoordinate",()=>HY,"viewportDepthTexture",()=>HK,"viewportLinearDepth",()=>HZ,"viewportMipTexture",()=>HJ,"viewportResolution",()=>H$,"viewportSafeUV",()=>H0,"viewportSharedTexture",()=>H1,"viewportSize",()=>H2,"viewportTexture",()=>H3,"viewportUV",()=>H4,"wgsl",()=>H5,"wgslFn",()=>H6,"workgroupArray",()=>H7,"workgroupBarrier",()=>H8,"workgroupId",()=>H9,"workingToColorSpace",()=>je,"xor",()=>jt],95372);let BP=II.BRDF_GGX,BI=II.BRDF_Lambert,BL=II.BasicPointShadowFilter,BD=II.BasicShadowFilter,BB=II.Break,BF=II.Const,BU=II.Continue,BO=II.DFGApprox,Bk=II.D_GGX,Bz=II.Discard,BV=II.EPSILON,Bq=II.F_Schlick,BG=II.Fn,BH=II.INFINITY,Bj=II.If,BW=II.Loop,BX=II.NodeAccess,BQ=II.NodeShaderStage,BY=II.NodeType,BK=II.NodeUpdateType,BZ=II.PCFShadowFilter,BJ=II.PCFSoftShadowFilter,B$=II.PI,B0=II.PI2,B1=II.PointShadowFilter,B2=II.Return,B3=II.Schlick_to_F0,B4=II.ScriptableNodeResources,B5=II.ShaderNode,B6=II.Stack,B7=II.Switch,B8=II.TBNViewMatrix,B9=II.VSMShadowFilter,Fe=II.V_GGX_SmithCorrelated,Ft=II.Var,Fr=II.VarIntent,Fn=II.abs,Fi=II.acesFilmicToneMapping,Fa=II.acos,Fs=II.add,Fo=II.addMethodChaining,Fl=II.addNodeElement,Fu=II.agxToneMapping,Fc=II.all,Fh=II.alphaT,Fd=II.and,FA=II.anisotropy,Fp=II.anisotropyB,Ff=II.anisotropyT,Fm=II.any,Fg=II.append,Fy=II.array,Fv=II.arrayBuffer,Fx=II.asin,F_=II.assign,Fb=II.atan,FS=II.atan2,FT=II.atomicAdd,Fw=II.atomicAnd,FM=II.atomicFunc,FE=II.atomicLoad,FR=II.atomicMax,FC=II.atomicMin,FN=II.atomicOr,FP=II.atomicStore,FI=II.atomicSub,FL=II.atomicXor,FD=II.attenuationColor,FB=II.attenuationDistance,FF=II.attribute,FU=II.attributeArray,FO=II.backgroundBlurriness,Fk=II.backgroundIntensity,Fz=II.backgroundRotation,FV=II.batch,Fq=II.bentNormalView,FG=II.billboarding,FH=II.bitAnd,Fj=II.bitNot,FW=II.bitOr,FX=II.bitXor,FQ=II.bitangentGeometry,FY=II.bitangentLocal,FK=II.bitangentView,FZ=II.bitangentWorld,FJ=II.bitcast,F$=II.blendBurn,F0=II.blendColor,F1=II.blendDodge,F2=II.blendOverlay,F3=II.blendScreen,F4=II.blur,F5=II.bool,F6=II.buffer,F7=II.bufferAttribute,F8=II.bumpMap,F9=II.burn,Ue=II.builtin,Ut=II.bvec2,Ur=II.bvec3,Un=II.bvec4,Ui=II.bypass,Ua=II.cache,Us=II.call,Uo=II.cameraFar,Ul=II.cameraIndex,Uu=II.cameraNear,Uc=II.cameraNormalMatrix,Uh=II.cameraPosition,Ud=II.cameraProjectionMatrix,UA=II.cameraProjectionMatrixInverse,Up=II.cameraViewMatrix,Uf=II.cameraViewport,Um=II.cameraWorldMatrix,Ug=II.cbrt,Uy=II.cdl,Uv=II.ceil,Ux=II.checker,U_=II.cineonToneMapping,Ub=II.clamp,US=II.clearcoat,UT=II.clearcoatNormalView,Uw=II.clearcoatRoughness,UM=II.code,UE=II.color,UR=II.colorSpaceToWorking,UC=II.colorToDirection,UN=II.compute,UP=II.computeKernel,UI=II.computeSkinning,UL=II.context,UD=II.convert,UB=II.convertColorSpace,UF=II.convertToTexture,UU=II.cos,UO=II.cross,Uk=II.cubeTexture,Uz=II.cubeTextureBase,UV=II.cubeToUV,Uq=II.dFdx,UG=II.dFdy,UH=II.dashSize,Uj=II.debug,UW=II.decrement,UX=II.decrementBefore,UQ=II.defaultBuildStages,UY=II.defaultShaderStages,UK=II.defined,UZ=II.degrees,UJ=II.deltaTime,U$=II.densityFog,U0=II.densityFogFactor,U1=II.depth,U2=II.depthPass,U3=II.determinant,U4=II.difference,U5=II.diffuseColor,U6=II.directPointLight,U7=II.directionToColor,U8=II.directionToFaceDirection,U9=II.dispersion,Oe=II.distance,Ot=II.div,Or=II.dodge,On=II.dot,Oi=II.drawIndex,Oa=II.dynamicBufferAttribute,Os=II.element,Oo=II.emissive,Ol=II.equal,Ou=II.equals,Oc=II.equirectUV,Oh=II.exp,Od=II.exp2,OA=II.expression,Op=II.faceDirection,Of=II.faceForward,Om=II.faceforward,Og=II.float,Oy=II.floatBitsToInt,Ov=II.floatBitsToUint,Ox=II.floor,O_=II.fog,Ob=II.fract,OS=II.frameGroup,OT=II.frameId,Ow=II.frontFacing,OM=II.fwidth,OE=II.gain,OR=II.gapSize,OC=II.getConstNodeType,ON=II.getCurrentStack,OP=II.getDirection,OI=II.getDistanceAttenuation,OL=II.getGeometryRoughness,OD=II.getNormalFromDepth,OB=II.getParallaxCorrectNormal,OF=II.getRoughness,OU=II.getScreenPosition,OO=II.getShIrradianceAt,Ok=II.getShadowMaterial,Oz=II.getShadowRenderObjectFunction,OV=II.getTextureIndex,Oq=II.getViewPosition,OG=II.globalId,OH=II.glsl,Oj=II.glslFn,OW=II.grayscale,OX=II.greaterThan,OQ=II.greaterThanEqual,OY=II.hash,OK=II.highpModelNormalViewMatrix,OZ=II.highpModelViewMatrix,OJ=II.hue,O$=II.increment,O0=II.incrementBefore,O1=II.instance,O2=II.instanceIndex,O3=II.instancedArray,O4=II.instancedBufferAttribute,O5=II.instancedDynamicBufferAttribute,O6=II.instancedMesh,O7=II.int,O8=II.intBitsToFloat,O9=II.inverse,ke=II.inverseSqrt,kt=II.inversesqrt,kr=II.invocationLocalIndex,kn=II.invocationSubgroupIndex,ki=II.ior,ka=II.iridescence,ks=II.iridescenceIOR,ko=II.iridescenceThickness,kl=II.ivec2,ku=II.ivec3,kc=II.ivec4,kh=II.js,kd=II.label,kA=II.length,kp=II.lengthSq,kf=II.lessThan,km=II.lessThanEqual,kg=II.lightPosition,ky=II.lightProjectionUV,kv=II.lightShadowMatrix,kx=II.lightTargetDirection,k_=II.lightTargetPosition,kb=II.lightViewPosition,kS=II.lightingContext,kT=II.lights,kw=II.linearDepth,kM=II.linearToneMapping,kE=II.localId,kR=II.log,kC=II.log2,kN=II.logarithmicDepthToViewZ,kP=II.luminance,kI=II.mat2,kL=II.mat3,kD=II.mat4,kB=II.matcapUV,kF=II.materialAO,kU=II.materialAlphaTest,kO=II.materialAnisotropy,kk=II.materialAnisotropyVector,kz=II.materialAttenuationColor,kV=II.materialAttenuationDistance,kq=II.materialClearcoat,kG=II.materialClearcoatNormal,kH=II.materialClearcoatRoughness,kj=II.materialColor,kW=II.materialDispersion,kX=II.materialEmissive,kQ=II.materialEnvIntensity,kY=II.materialEnvRotation,kK=II.materialIOR,kZ=II.materialIridescence,kJ=II.materialIridescenceIOR,k$=II.materialIridescenceThickness,k0=II.materialLightMap,k1=II.materialLineDashOffset,k2=II.materialLineDashSize,k3=II.materialLineGapSize,k4=II.materialLineScale,k5=II.materialLineWidth,k6=II.materialMetalness,k7=II.materialNormal,k8=II.materialOpacity,k9=II.materialPointSize,ze=II.materialReference,zt=II.materialReflectivity,zr=II.materialRefractionRatio,zn=II.materialRotation,zi=II.materialRoughness,za=II.materialSheen,zs=II.materialSheenRoughness,zo=II.materialShininess,zl=II.materialSpecular,zu=II.materialSpecularColor,zc=II.materialSpecularIntensity,zh=II.materialSpecularStrength,zd=II.materialThickness,zA=II.materialTransmission,zp=II.max,zf=II.maxMipLevel,zm=II.mediumpModelViewMatrix,zg=II.metalness,zy=II.min,zv=II.mix,zx=II.mixElement,z_=II.mod,zb=II.modInt,zS=II.modelDirection,zT=II.modelNormalMatrix,zw=II.modelPosition,zM=II.modelRadius,zE=II.modelScale,zR=II.modelViewMatrix,zC=II.modelViewPosition,zN=II.modelViewProjection,zP=II.modelWorldMatrix,zI=II.modelWorldMatrixInverse,zL=II.morphReference,zD=II.mrt,zB=II.mul,zF=II.mx_aastep,zU=II.mx_add,zO=II.mx_atan2,zk=II.mx_cell_noise_float,zz=II.mx_contrast,zV=II.mx_divide,zq=II.mx_fractal_noise_float,zG=II.mx_fractal_noise_vec2,zH=II.mx_fractal_noise_vec3,zj=II.mx_fractal_noise_vec4,zW=II.mx_frame,zX=II.mx_heighttonormal,zQ=II.mx_hsvtorgb,zY=II.mx_ifequal,zK=II.mx_ifgreater,zZ=II.mx_ifgreatereq,zJ=II.mx_invert,z$=II.mx_modulo,z0=II.mx_multiply,z1=II.mx_noise_float,z2=II.mx_noise_vec3,z3=II.mx_noise_vec4,z4=II.mx_place2d,z5=II.mx_power,z6=II.mx_ramp4,z7=II.mx_ramplr,z8=II.mx_ramptb,z9=II.mx_rgbtohsv,Ve=II.mx_rotate2d,Vt=II.mx_rotate3d,Vr=II.mx_safepower,Vn=II.mx_separate,Vi=II.mx_splitlr,Va=II.mx_splittb,Vs=II.mx_srgb_texture_to_lin_rec709,Vo=II.mx_subtract,Vl=II.mx_timer,Vu=II.mx_transform_uv,Vc=II.mx_unifiednoise2d,Vh=II.mx_unifiednoise3d,Vd=II.mx_worley_noise_float,VA=II.mx_worley_noise_vec2,Vp=II.mx_worley_noise_vec3,Vf=II.negate,Vm=II.neutralToneMapping,Vg=II.nodeArray,Vy=II.nodeImmutable,Vv=II.nodeObject,Vx=II.nodeObjectIntent,V_=II.nodeObjects,Vb=II.nodeProxy,VS=II.nodeProxyIntent,VT=II.normalFlat,Vw=II.normalGeometry,VM=II.normalLocal,VE=II.normalMap,VR=II.normalView,VC=II.normalViewGeometry,VN=II.normalWorld,VP=II.normalWorldGeometry,VI=II.normalize,VL=II.not,VD=II.notEqual,VB=II.numWorkgroups,VF=II.objectDirection,VU=II.objectGroup,VO=II.objectPosition,Vk=II.objectRadius,Vz=II.objectScale,VV=II.objectViewPosition,Vq=II.objectWorldMatrix,VG=II.OnObjectUpdate,VH=II.OnMaterialUpdate,Vj=II.oneMinus,VW=II.or,VX=II.orthographicDepthToViewZ,VQ=II.oscSawtooth,VY=II.oscSine,VK=II.oscSquare,VZ=II.oscTriangle,VJ=II.output,V$=II.outputStruct,V0=II.overlay,V1=II.overloadingFn,V2=II.parabola,V3=II.parallaxDirection,V4=II.parallaxUV,V5=II.parameter,V6=II.pass,V7=II.passTexture,V8=II.pcurve,V9=II.perspectiveDepthToViewZ,qe=II.pmremTexture,qt=II.pointShadow,qr=II.pointUV,qn=II.pointWidth,qi=II.positionGeometry,qa=II.positionLocal,qs=II.positionPrevious,qo=II.positionView,ql=II.positionViewDirection,qu=II.positionWorld,qc=II.positionWorldDirection,qh=II.posterize,qd=II.pow,qA=II.pow2,qp=II.pow3,qf=II.pow4,qm=II.premultiplyAlpha,qg=II.property,qy=II.radians,qv=II.rand,qx=II.range,q_=II.rangeFog,qb=II.rangeFogFactor,qS=II.reciprocal,qT=II.reference,qw=II.referenceBuffer,qM=II.reflect,qE=II.reflectVector,qR=II.reflectView,qC=II.reflector,qN=II.refract,qP=II.refractVector,qI=II.refractView,qL=II.reinhardToneMapping,qD=II.remap,qB=II.remapClamp,qF=II.renderGroup,qU=II.renderOutput,qO=II.rendererReference,qk=II.rotate,qz=II.rotateUV,qV=II.roughness,qq=II.round,qG=II.rtt,qH=II.sRGBTransferEOTF,qj=II.sRGBTransferOETF,qW=II.sample,qX=II.sampler,qQ=II.samplerComparison,qY=II.saturate,qK=II.saturation,qZ=II.screen,qJ=II.screenCoordinate,q$=II.screenDPR,q0=II.screenSize,q1=II.screenUV,q2=II.scriptable,q3=II.scriptableValue,q4=II.select,q5=II.setCurrentStack,q6=II.setName,q7=II.shaderStages,q8=II.shadow,q9=II.shadowPositionWorld,Ge=II.shapeCircle,Gt=II.sharedUniformGroup,Gr=II.sheen,Gn=II.sheenRoughness,Gi=II.shiftLeft,Ga=II.shiftRight,Gs=II.shininess,Go=II.sign,Gl=II.sin,Gu=II.sinc,Gc=II.skinning,Gh=II.smoothstep,Gd=II.smoothstepElement,GA=II.specularColor,Gp=II.specularF90,Gf=II.spherizeUV,Gm=II.split,Gg=II.spritesheetUV,Gy=II.sqrt,Gv=II.stack,Gx=II.step,G_=II.stepElement,Gb=II.storage,GS=II.storageBarrier,GT=II.storageObject,Gw=II.storageTexture,GM=II.string,GE=II.struct,GR=II.sub,GC=II.subgroupAdd,GN=II.subgroupAll,GP=II.subgroupAnd,GI=II.subgroupAny,GL=II.subgroupBallot,GD=II.subgroupBroadcast,GB=II.subgroupBroadcastFirst,GF=II.subBuild,GU=II.subgroupElect,GO=II.subgroupExclusiveAdd,Gk=II.subgroupExclusiveMul,Gz=II.subgroupInclusiveAdd,GV=II.subgroupInclusiveMul,Gq=II.subgroupIndex,GG=II.subgroupMax,GH=II.subgroupMin,Gj=II.subgroupMul,GW=II.subgroupOr,GX=II.subgroupShuffle,GQ=II.subgroupShuffleDown,GY=II.subgroupShuffleUp,GK=II.subgroupShuffleXor,GZ=II.subgroupSize,GJ=II.subgroupXor,G$=II.tan,G0=II.tangentGeometry,G1=II.tangentLocal,G2=II.tangentView,G3=II.tangentWorld,G4=II.texture,G5=II.texture3D,G6=II.textureBarrier,G7=II.textureBicubic,G8=II.textureBicubicLevel,G9=II.textureCubeUV,He=II.textureLoad,Ht=II.textureSize,Hr=II.textureStore,Hn=II.thickness,Hi=II.time,Ha=II.toneMapping,Hs=II.toneMappingExposure,Ho=II.toonOutlinePass,Hl=II.transformDirection,Hu=II.transformNormal,Hc=II.transformNormalToView,Hh=II.transformedClearcoatNormalView,Hd=II.transformedNormalView,HA=II.transformedNormalWorld,Hp=II.transmission,Hf=II.transpose,Hm=II.triNoise3D,Hg=II.triplanarTexture,Hy=II.triplanarTextures,Hv=II.trunc,Hx=II.uint,H_=II.uintBitsToFloat,Hb=II.uniform,HS=II.uniformArray,HT=II.uniformCubeTexture,Hw=II.uniformGroup,HM=II.uniformFlow,HE=II.uniformTexture,HR=II.unpremultiplyAlpha,HC=II.userData,HN=II.uv,HP=II.uvec2,HI=II.uvec3,HL=II.uvec4,HD=II.varying,HB=II.varyingProperty,HF=II.vec2,HU=II.vec3,HO=II.vec4,Hk=II.vectorComponents,Hz=II.velocity,HV=II.vertexColor,Hq=II.vertexIndex,HG=II.vertexStage,HH=II.vibrance,Hj=II.viewZToLogarithmicDepth,HW=II.viewZToOrthographicDepth,HX=II.viewZToPerspectiveDepth,HQ=II.viewport,HY=II.viewportCoordinate,HK=II.viewportDepthTexture,HZ=II.viewportLinearDepth,HJ=II.viewportMipTexture,H$=II.viewportResolution,H0=II.viewportSafeUV,H1=II.viewportSharedTexture,H2=II.viewportSize,H3=II.viewportTexture,H4=II.viewportUV,H5=II.wgsl,H6=II.wgslFn,H7=II.workgroupArray,H8=II.workgroupBarrier,H9=II.workgroupId,je=II.workingToColorSpace,jt=II.xor;var jr=e.i(95372);let jn=new eZ,ji=new ex;class ja extends sj{applyMatrix4(e){let t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),r.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let r=new oR(t,6,1);return this.setAttribute("instanceStart",new r7(r,3,0)),this.setAttribute("instanceEnd",new r7(r,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let r=new oR(t,6,1);return this.setAttribute("instanceColorStart",new r7(r,3,0)),this.setAttribute("instanceColorEnd",new r7(r,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new ak(e.geometry)),this}fromLineSegments(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new eZ);let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),jn.setFromBufferAttribute(t),this.boundingBox.union(jn))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ta),null===this.boundingBox&&this.computeBoundingBox();let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){let r=this.boundingSphere.center;this.boundingBox.getCenter(r);let n=0;for(let i=0,a=e.count;i<a;i++)ji.fromBufferAttribute(e,i),n=Math.max(n,r.distanceToSquared(ji)),ji.fromBufferAttribute(t,i),n=Math.max(n,r.distanceToSquared(ji));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new rg([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new rg([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}}lx.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ey(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},l_.line={uniforms:rG.merge([lx.common,lx.fog,lx.line]),vertexShader:"\n		#include <common>\n		#include <color_pars_vertex>\n		#include <fog_pars_vertex>\n		#include <logdepthbuf_pars_vertex>\n		#include <clipping_planes_pars_vertex>\n\n		uniform float linewidth;\n		uniform vec2 resolution;\n\n		attribute vec3 instanceStart;\n		attribute vec3 instanceEnd;\n\n		attribute vec3 instanceColorStart;\n		attribute vec3 instanceColorEnd;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#ifdef USE_DASH\n\n			uniform float dashScale;\n			attribute float instanceDistanceStart;\n			attribute float instanceDistanceEnd;\n			varying float vLineDistance;\n\n		#endif\n\n		void trimSegment( const in vec4 start, inout vec4 end ) {\n\n			// trim end segment so it terminates between the camera plane and the near plane\n\n			// conservative estimate of the near plane\n			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n			float nearEstimate = - 0.5 * b / a;\n\n			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n			end.xyz = mix( start.xyz, end.xyz, alpha );\n\n		}\n\n		void main() {\n\n			#ifdef USE_COLOR\n\n				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n			#endif\n\n			#ifdef USE_DASH\n\n				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n				vUv = uv;\n\n			#endif\n\n			float aspect = resolution.x / resolution.y;\n\n			// camera space\n			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n			#ifdef WORLD_UNITS\n\n				worldStart = start.xyz;\n				worldEnd = end.xyz;\n\n			#else\n\n				vUv = uv;\n\n			#endif\n\n			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n			// perhaps there is a more elegant solution -- WestLangley\n\n			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n			if ( perspective ) {\n\n				if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n					trimSegment( start, end );\n\n				} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n					trimSegment( end, start );\n\n				}\n\n			}\n\n			// clip space\n			vec4 clipStart = projectionMatrix * start;\n			vec4 clipEnd = projectionMatrix * end;\n\n			// ndc space\n			vec3 ndcStart = clipStart.xyz / clipStart.w;\n			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n			// direction\n			vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n			// account for clip-space aspect ratio\n			dir.x *= aspect;\n			dir = normalize( dir );\n\n			#ifdef WORLD_UNITS\n\n				vec3 worldDir = normalize( end.xyz - start.xyz );\n				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n				vec3 worldFwd = cross( worldDir, worldUp );\n				worldPos = position.y < 0.5 ? start: end;\n\n				// height offset\n				float hw = linewidth * 0.5;\n				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n				// don't extend the line if we're rendering dashes because we\n				// won't be rendering the endcaps\n				#ifndef USE_DASH\n\n					// cap extension\n					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n					// add width to the box\n					worldPos.xyz += worldFwd * hw;\n\n					// endcaps\n					if ( position.y > 1.0 || position.y < 0.0 ) {\n\n						worldPos.xyz -= worldFwd * 2.0 * hw;\n\n					}\n\n				#endif\n\n				// project the worldpos\n				vec4 clip = projectionMatrix * worldPos;\n\n				// shift the depth of the projected points so the line\n				// segments overlap neatly\n				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n				clip.z = clipPose.z * clip.w;\n\n			#else\n\n				vec2 offset = vec2( dir.y, - dir.x );\n				// undo aspect ratio adjustment\n				dir.x /= aspect;\n				offset.x /= aspect;\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				// endcaps\n				if ( position.y < 0.0 ) {\n\n					offset += - dir;\n\n				} else if ( position.y > 1.0 ) {\n\n					offset += dir;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth;\n\n				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n				offset /= resolution.y;\n\n				// select end\n				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n				// back to clip space\n				offset *= clip.w;\n\n				clip.xy += offset;\n\n			#endif\n\n			gl_Position = clip;\n\n			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n			#include <logdepthbuf_vertex>\n			#include <clipping_planes_vertex>\n			#include <fog_vertex>\n\n		}\n		",fragmentShader:"\n		uniform vec3 diffuse;\n		uniform float opacity;\n		uniform float linewidth;\n\n		#ifdef USE_DASH\n\n			uniform float dashOffset;\n			uniform float dashSize;\n			uniform float gapSize;\n\n		#endif\n\n		varying float vLineDistance;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#include <common>\n		#include <color_pars_fragment>\n		#include <fog_pars_fragment>\n		#include <logdepthbuf_pars_fragment>\n		#include <clipping_planes_pars_fragment>\n\n		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n			float mua;\n			float mub;\n\n			vec3 p13 = p1 - p3;\n			vec3 p43 = p4 - p3;\n\n			vec3 p21 = p2 - p1;\n\n			float d1343 = dot( p13, p43 );\n			float d4321 = dot( p43, p21 );\n			float d1321 = dot( p13, p21 );\n			float d4343 = dot( p43, p43 );\n			float d2121 = dot( p21, p21 );\n\n			float denom = d2121 * d4343 - d4321 * d4321;\n\n			float numer = d1343 * d4321 - d1321 * d4343;\n\n			mua = numer / denom;\n			mua = clamp( mua, 0.0, 1.0 );\n			mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n			mub = clamp( mub, 0.0, 1.0 );\n\n			return vec2( mua, mub );\n\n		}\n\n		void main() {\n\n			float alpha = opacity;\n			vec4 diffuseColor = vec4( diffuse, alpha );\n\n			#include <clipping_planes_fragment>\n\n			#ifdef USE_DASH\n\n				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n			#endif\n\n			#ifdef WORLD_UNITS\n\n				// Find the closest points on the view ray and the line segment\n				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n				vec3 lineDir = worldEnd - worldStart;\n				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n				vec3 p1 = worldStart + lineDir * params.x;\n				vec3 p2 = rayEnd * params.y;\n				vec3 delta = p1 - p2;\n				float len = length( delta );\n				float norm = len / linewidth;\n\n				#ifndef USE_DASH\n\n					#ifdef USE_ALPHA_TO_COVERAGE\n\n						float dnorm = fwidth( norm );\n						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n					#else\n\n						if ( norm > 0.5 ) {\n\n							discard;\n\n						}\n\n					#endif\n\n				#endif\n\n			#else\n\n				#ifdef USE_ALPHA_TO_COVERAGE\n\n					// artifacts appear on some hardware if a derivative is taken within a conditional\n					float a = vUv.x;\n					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n					float len2 = a * a + b * b;\n					float dlen = fwidth( len2 );\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n					}\n\n				#else\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						float a = vUv.x;\n						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n						float len2 = a * a + b * b;\n\n						if ( len2 > 1.0 ) discard;\n\n					}\n\n				#endif\n\n			#endif\n\n			#include <logdepthbuf_fragment>\n			#include <color_fragment>\n\n			gl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n			#include <tonemapping_fragment>\n			#include <colorspace_fragment>\n			#include <fog_fragment>\n			#include <premultiplied_alpha_fragment>\n\n		}\n		"};class js extends rH{get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){!0===e!==this.dashed&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(!0===e!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===e?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}constructor(e){super({type:"LineMaterial",uniforms:rG.clone(l_.line.uniforms),vertexShader:l_.line.vertexShader,fragmentShader:l_.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}}let jo=new eH,jl=new ex,ju=new ex,jc=new eH,jh=new eH,jd=new eH,jA=new ex,jp=new tp,jf=new oQ,jm=new ex,jg=new eZ,jy=new ta,jv=new eH;function jx(e,t,r){return jv.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),jv.multiplyScalar(1/jv.w),jv.x=A/r.width,jv.y=A/r.height,jv.applyMatrix4(e.projectionMatrixInverse),jv.multiplyScalar(1/jv.w),Math.abs(Math.max(jv.x,jv.y))}class j_ extends rU{computeLineDistances(){let e=this.geometry,t=e.attributes.instanceStart,r=e.attributes.instanceEnd,n=new Float32Array(2*t.count);for(let e=0,i=0,a=t.count;e<a;e++,i+=2)jl.fromBufferAttribute(t,e),ju.fromBufferAttribute(r,e),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+jl.distanceTo(ju);let i=new oR(n,2,1);return e.setAttribute("instanceDistanceStart",new r7(i,1,0)),e.setAttribute("instanceDistanceEnd",new r7(i,1,1)),this}raycast(e,t){let r,n,i=this.material.worldUnits,a=e.camera;null!==a||i||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');let s=void 0!==e.params.Line2&&e.params.Line2.threshold||0;d=e.ray;let o=this.matrixWorld,l=this.geometry,u=this.material;if(A=u.linewidth+s,null===l.boundingSphere&&l.computeBoundingSphere(),jy.copy(l.boundingSphere).applyMatrix4(o),i)r=.5*A;else{let e=Math.max(a.near,jy.distanceToPoint(d.origin));r=jx(a,e,u.resolution)}if(jy.radius+=r,!1!==d.intersectsSphere(jy)){if(null===l.boundingBox&&l.computeBoundingBox(),jg.copy(l.boundingBox).applyMatrix4(o),i)n=.5*A;else{let e=Math.max(a.near,jg.distanceToPoint(d.origin));n=jx(a,e,u.resolution)}jg.expandByScalar(n),!1!==d.intersectsBox(jg)&&(i?function(e,t){let r=e.matrixWorld,n=e.geometry,i=n.attributes.instanceStart,a=n.attributes.instanceEnd,s=Math.min(n.instanceCount,i.count);for(let n=0;n<s;n++){jf.start.fromBufferAttribute(i,n),jf.end.fromBufferAttribute(a,n),jf.applyMatrix4(r);let s=new ex,o=new ex;d.distanceSqToSegment(jf.start,jf.end,o,s),o.distanceTo(s)<.5*A&&t.push({point:o,pointOnLine:s,distance:d.origin.distanceTo(o),object:e,face:null,faceIndex:n,uv:null,uv1:null})}}(this,t):function(e,t,r){let n=t.projectionMatrix,i=e.material.resolution,a=e.matrixWorld,s=e.geometry,o=s.attributes.instanceStart,l=s.attributes.instanceEnd,u=Math.min(s.instanceCount,o.count),c=-t.near;d.at(1,jd),jd.w=1,jd.applyMatrix4(t.matrixWorldInverse),jd.applyMatrix4(n),jd.multiplyScalar(1/jd.w),jd.x*=i.x/2,jd.y*=i.y/2,jd.z=0,jA.copy(jd),jp.multiplyMatrices(t.matrixWorldInverse,a);for(let t=0;t<u;t++){if(jc.fromBufferAttribute(o,t),jh.fromBufferAttribute(l,t),jc.w=1,jh.w=1,jc.applyMatrix4(jp),jh.applyMatrix4(jp),jc.z>c&&jh.z>c)continue;if(jc.z>c){let e=jc.z-jh.z,t=(jc.z-c)/e;jc.lerp(jh,t)}else if(jh.z>c){let e=jh.z-jc.z,t=(jh.z-c)/e;jh.lerp(jc,t)}jc.applyMatrix4(n),jh.applyMatrix4(n),jc.multiplyScalar(1/jc.w),jh.multiplyScalar(1/jh.w),jc.x*=i.x/2,jc.y*=i.y/2,jh.x*=i.x/2,jh.y*=i.y/2,jf.start.copy(jc),jf.start.z=0,jf.end.copy(jh),jf.end.z=0;let s=jf.closestPointToPointParameter(jA,!0);jf.at(s,jm);let u=eg.lerp(jc.z,jh.z,s),h=u>=-1&&u<=1,p=jA.distanceTo(jm)<.5*A;if(h&&p){jf.start.fromBufferAttribute(o,t),jf.end.fromBufferAttribute(l,t),jf.start.applyMatrix4(a),jf.end.applyMatrix4(a);let n=new ex,i=new ex;d.distanceSqToSegment(jf.start,jf.end,i,n),r.push({point:i,pointOnLine:n,distance:d.origin.distanceTo(i),object:e,face:null,faceIndex:t,uv:null,uv1:null})}}}(this,a,t))}}onBeforeRender(e){let t=this.material.uniforms;t&&t.resolution&&(e.getViewport(jo),this.material.uniforms.resolution.value.set(jo.z,jo.w))}constructor(e=new ja,t=new js({color:0xffffff*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}}class jb extends ja{setPositions(e){let t=e.length-3,r=new Float32Array(2*t);for(let n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return super.setPositions(r),this}setColors(e){let t=e.length-3,r=new Float32Array(2*t);for(let n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return super.setColors(r),this}setFromPoints(e){let t=e.length-1,r=new Float32Array(6*t);for(let n=0;n<t;n++)r[6*n]=e[n].x,r[6*n+1]=e[n].y,r[6*n+2]=e[n].z||0,r[6*n+3]=e[n+1].x,r[6*n+4]=e[n+1].y,r[6*n+5]=e[n+1].z||0;return super.setPositions(r),this}fromLine(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}}class jS extends j_{constructor(e=new jb,t=new js({color:0xffffff*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}class jT extends aM{constructor(e,t={}){let r=t.font;if(void 0===r)super();else{let n=r.generateShapes(e,t.size);void 0===t.depth&&(t.depth=50),void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(n,t)}this.type="TextGeometry"}}function jw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function jM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw TypeError("Private element is not present on this object")}function jE(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function jR(e,t,r){return t=jU(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e,jk()?Reflect.construct(t,r||[],jU(e).constructor):t.apply(e,r))}function jC(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function jN(e,t){return e.get(jM(e,t))}function jP(e,t,r){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function jI(e,t,r){return e.set(jM(e,t),r),r}function jL(e,t,r){if(jk())return Reflect.construct.apply(null,arguments);var n=[null];return n.push.apply(n,t),new(e.bind.apply(e,n))}function jD(e,t,r){return t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jQ(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jB(e,t,r){return(t=jQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jF(){return(jF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!({}).hasOwnProperty.call(e,t)&&null!==(e=jU(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function jU(e){return(jU=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jO(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jH(e,t)}function jk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(jk=function(){return!!e})()}function jz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function jV(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jz(Object(r),!0).forEach(function(t){jB(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jz(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function jq(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function a(r,n,i,a){var l=Object.create((n&&n.prototype instanceof o?n:o).prototype);return jG(l,"_invoke",function(r,n,i){var a,o,l,u=0,c=i||[],h=!1,d={p:0,n:0,v:e,a:A,f:A.bind(e,4),d:function(t,r){return a=t,o=0,l=e,d.n=r,s}};function A(r,n){for(o=r,l=n,t=0;!h&&u&&!i&&t<c.length;t++){var i,a=c[t],A=d.p,p=a[2];r>3?(i=p===n)&&(l=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=A&&((i=r<2&&A<a[1])?(o=0,d.v=n,d.n=a[1]):A<p&&(i=r<3||a[0]>n||n>p)&&(a[4]=r,a[5]=n,d.n=p,o=0))}if(i||r>1)return s;throw h=!0,n}return function(i,c,p){if(u>1)throw TypeError("Generator is already running");for(h&&1===c&&A(c,p),o=c,l=p;(t=o<2?e:l)||!h;){a||(o?o<3?(o>1&&(d.n=-1),A(o,l)):d.n=l:d.v=l);try{if(u=2,a){if(o||(i="next"),t=a[i]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=a.return)&&t.call(a),o<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),o=1);a=e}else if((t=(h=d.n<0)?l:r.call(n,d))!==s)break}catch(t){a=e,o=1,l=t}finally{u=1}}return{value:t,done:h}}}(r,i,a),!0),l}var s={};function o(){}function l(){}function u(){}t=Object.getPrototypeOf;var c=u.prototype=o.prototype=Object.create([][n]?t(t([][n]())):(jG(t={},n,function(){return this}),t));function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,jG(e,i,"GeneratorFunction")),e.prototype=Object.create(c),e}return l.prototype=u,jG(c,"constructor",u),jG(u,"constructor",l),l.displayName="GeneratorFunction",jG(u,i,"GeneratorFunction"),jG(c),jG(c,i,"Generator"),jG(c,n,function(){return this}),jG(c,"toString",function(){return"[object Generator]"}),(jq=function(){return{w:a,m:h}})()}function jG(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(jG=function(e,t,r,n){function a(t,r){jG(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))})(e,t,r,n)}function jH(e,t){return(jH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function jj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}(e,t)||jY(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jW(e,t,r,n){var i=jF(jU(e.prototype),t,r);return"function"==typeof i?function(e){return i.apply(r,e)}:i}function jX(e){return function(e){if(Array.isArray(e))return jw(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||jY(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jQ(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function jY(e,t){if(e){if("string"==typeof e)return jw(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jw(e,t):void 0}}new ex,new tp,new tp,new ex,new ex;var jK=function(e){e instanceof Array?e.forEach(jK):(e.map&&e.map.dispose(),e.dispose())},jZ=function(e){e.geometry&&e.geometry.dispose(),e.material&&jK(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(jZ)},jJ=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),jZ(t)}};function j$(e,t){var r=new t;return{linkProp:function(t){return{default:r[t](),onChange:function(r,n){n[e][t](r)},triggerUpdate:!1}},linkMethod:function(t){return function(r){for(var n=r[e],i=arguments.length,a=Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];var o=n[t].apply(n,a);return o===n?this:o}}}}function j0(){return 100}function j1(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180,a=100*(1+r),s=Math.sin(n);return{x:a*s*Math.cos(i),y:a*Math.cos(n),z:a*s*Math.sin(i)}}function j2(e){var t=e.x,r=e.y,n=e.z,i=Math.sqrt(t*t+r*r+n*n),a=Math.atan2(n,t);return{lat:90-180*Math.acos(r/i)/Math.PI,lng:90-180*a/Math.PI-360*(a<-Math.PI/2),altitude:i/100-1}}function j3(e){return e*Math.PI/180}var j4=window.THREE?window.THREE:{BackSide:1,BufferAttribute:rl,Color:t6,Mesh:rU,ShaderMaterial:rH},j5=function(e){function t(e){var r,n,i,a,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=o.color,u=o.size,c=o.coefficient,h=o.power,d=o.hollowRadius,A=o.backside;jC(this,t),s=jR(this,t);var p=function(e,t){for(var r=e.clone(),n=new Float32Array(3*e.attributes.position.count),i=0,a=n.length;i<a;i++){var s=e.attributes.normal.array[i],o=e.attributes.position.array[i];n[i]=o+s*t}return r.setAttribute("position",new j4.BufferAttribute(n,3)),r}(e,void 0===u?2:u),f=(r=void 0===c?.5:c,n=void 0===l?"gold":l,i=void 0===h?1:h,a=void 0===d?0:d,new j4.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:"\nuniform float hollowRadius;\n\nvarying vec3 vVertexWorldPosition;\nvarying vec3 vVertexNormal;\nvarying float vCameraDistanceToObjCenter;\nvarying float vVertexAngularDistanceToHollowRadius;\n\nvoid main() {    \n  vVertexNormal	= normalize(normalMatrix * normal);\n  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n  \n  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);\n  vCameraDistanceToObjCenter = length(objCenterViewPosition);\n  \n  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);\n  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));\n  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;\n\n  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"\nuniform vec3 color;\nuniform float coefficient;\nuniform float power;\nuniform float hollowRadius;\n\nvarying vec3 vVertexNormal;\nvarying vec3 vVertexWorldPosition;\nvarying float vCameraDistanceToObjCenter;\nvarying float vVertexAngularDistanceToHollowRadius;\n\nvoid main() {\n  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius\n  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius\n\n  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;\n  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;\n  viewCameraToVertex = normalize(viewCameraToVertex);\n  float intensity	= pow(\n    coefficient + dot(vVertexNormal, viewCameraToVertex),\n    power\n  );\n  gl_FragColor = vec4(color, intensity);\n}",uniforms:{coefficient:{value:r},color:{value:new j4.Color(n)},power:{value:i},hollowRadius:{value:a}}}));return(void 0===A||A)&&(f.side=j4.BackSide),s.geometry=p,s.material=f,s}return jO(t,e),jD(t)}(j4.Mesh),j6=window.THREE?window.THREE:{Color:t6,Group:r$,LineBasicMaterial:ia,LineSegments:iy,Mesh:rU,MeshPhongMaterial:aW,SphereGeometry:aD,SRGBColorSpace:J,TextureLoader:sb},j7=c4({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeCurvatureResolution:{default:4},globeTileEngineUrl:{onChange:function(e,t){t.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,t){t.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,t){t.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return void 0!==t?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){jJ(e.globeObj),jJ(e.tileEngine),jJ(e.graticulesObj)}},stateInit:function(){var e=new j6.MeshPhongMaterial({color:0}),t=new j6.Mesh(void 0,e);t.rotation.y=-Math.PI/2;var r=new A9(100),n=new j6.Group;return n.__globeObjType="globe",n.add(t),n.add(r),{globeGroup:n,globeObj:t,graticulesObj:new j6.LineSegments(new pF((function(){var e,t,r,n,i,a,s,o,l,u,c,h,d=10,A=10,p=90,f=360,m=2.5;function g(){return{type:"MultiLineString",coordinates:y()}}function y(){return pz(dB(n/p)*p,r,p).map(c).concat(pz(dB(o/f)*f,s,f).map(h)).concat(pz(dB(t/d)*d,e,d).filter(function(e){return dP(e%p)>1e-6}).map(l)).concat(pz(dB(a/A)*A,i,A).filter(function(e){return dP(e%f)>1e-6}).map(u))}return g.lines=function(){return y().map(function(e){return{type:"LineString",coordinates:e}})},g.outline=function(){return{type:"Polygon",coordinates:[c(n).concat(h(s).slice(1),c(r).reverse().slice(1),h(o).reverse().slice(1))]}},g.extent=function(e){return arguments.length?g.extentMajor(e).extentMinor(e):g.extentMinor()},g.extentMajor=function(e){return arguments.length?(n=+e[0][0],r=+e[1][0],o=+e[0][1],s=+e[1][1],n>r&&(e=n,n=r,r=e),o>s&&(e=o,o=s,s=e),g.precision(m)):[[n,o],[r,s]]},g.extentMinor=function(r){return arguments.length?(t=+r[0][0],e=+r[1][0],a=+r[0][1],i=+r[1][1],t>e&&(r=t,t=e,e=r),a>i&&(r=a,a=i,i=r),g.precision(m)):[[t,a],[e,i]]},g.step=function(e){return arguments.length?g.stepMajor(e).stepMinor(e):g.stepMinor()},g.stepMajor=function(e){return arguments.length?(p=+e[0],f=+e[1],g):[p,f]},g.stepMinor=function(e){return arguments.length?(d=+e[0],A=+e[1],g):[d,A]},g.precision=function(d){return arguments.length?(m=+d,l=pV(a,i,90),u=pq(t,e,m),c=pV(o,s,90),h=pq(n,r,m),g):m},g.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])})()(),100,2),new j6.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1})),defaultGlobeMaterial:e,tileEngine:r}},init:function(e,t){jJ(e),t.scene=e,t.scene.add(t.globeGroup),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var r=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),t.hasOwnProperty("globeCurvatureResolution")){null==(n=e.globeObj.geometry)||n.dispose();var n,i=Math.max(4,Math.round(360/e.globeCurvatureResolution));e.globeObj.geometry=new j6.SphereGeometry(100,i,i/2),e.tileEngine.curvatureResolution=e.globeCurvatureResolution}if(t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new j6.TextureLoader().load(e.globeImageUrl,function(t){t.colorSpace=j6.SRGBColorSpace,r.map=t,r.color=null,r.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):r.color||(r.color=new j6.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new j6.TextureLoader().load(e.bumpImageUrl,function(e){r.bumpMap=e,r.needsUpdate=!0}):(r.bumpMap=null,r.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),jJ(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var a=e.atmosphereObj=new j5(e.globeObj.geometry,{color:e.atmosphereColor,size:100*e.atmosphereAltitude,hollowRadius:100,coefficient:.1,power:3.5});a.visible=!!e.showAtmosphere,a.__globeObjType="atmosphere",e.scene.add(a)}e.ready||e.globeImageUrl&&!e.globeTileEngineUrl||(e.ready=!0,e.onReady())}}),j8=function(e){return isNaN(e)?parseInt(p7(e).toHex(),16):e},j9=function(e){return e&&isNaN(e)?hk(e).opacity:1},We=function(e){var t,r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=1,a=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(a){var s=jj(a.slice(1),4),o=s[0],l=s[1],u=s[2],c=s[3];t=new t6("rgb(".concat(+o,",").concat(+l,",").concat(+u,")")),i=Math.min(+c,1)}else t=new t6(e);n&&t.convertLinearToSRGB();var h=t.toArray();return r?[].concat(jX(h),[i]):h},Wt=window.THREE?window.THREE:{BufferAttribute:rl};function Wr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float32Array;if(1===t)return new Wt.BufferAttribute(new r(e),t);for(var n=new Wt.BufferAttribute(new r(e.length*t),t),i=0,a=e.length;i<a;i++)n.set(e[i],i*t);return n}var Wn=new WeakMap,Wi=new WeakMap,Wa=new WeakMap,Ws=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.dataBindAttr,a=n.objBindAttr,s=n.removeDelay;return jC(this,t),jB(r=jR(this,t),"scene",void 0),jP(r,Wn,void 0),jP(r,Wi,void 0),jP(r,Wa,void 0),r.scene=e,jI(Wn,r,void 0===i?"__data":i),jI(Wi,r,void 0===a?"__threeObj":a),jI(Wa,r,void 0===s?0:s),r.onRemoveObj(function(){}),r}return jO(t,e),jD(t,[{key:"onCreateObj",value:function(e){var r=this;return jW(t,"onCreateObj",this)([function(t){var n=e(t);return t[jN(Wi,r)]=n,n[jN(Wn,r)]=t,r.scene.add(n),n}]),this}},{key:"onRemoveObj",value:function(e){var r=this;return jW(t,"onRemoveObj",this)([function(n,i){var a=jW(t,"getData",r)([n]);e(n,i);var s=function(){r.scene.remove(n),jJ(n),delete a[jN(Wi,r)]};jN(Wa,r)?setTimeout(s,jN(Wa,r)):s()}]),this}}])}(fU),Wo=window.THREE?window.THREE:{BufferGeometry:rw,CylinderGeometry:iO,Matrix4:tp,Mesh:rU,MeshLambertMaterial:aY,Object3D:tV,Vector3:ex},Wl=Object.assign({},p2),Wu=Wl.BufferGeometryUtils||Wl,Wc=c4({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjPoint"})},update:function(e,t){var r=p3(e.pointLat),n=p3(e.pointLng),i=p3(e.pointAltitude),a=p3(e.pointRadius),s=p3(e.pointColor),o=new Wo.CylinderGeometry(1,1,1,e.pointResolution);o.applyMatrix4(new Wo.Matrix4().makeRotationX(Math.PI/2)),o.applyMatrix4(new Wo.Matrix4().makeTranslation(0,0,-.5));var l=2*Math.PI*100/360,u={};if(!e.pointsMerge&&t.hasOwnProperty("pointsMerge")&&jJ(e.scene),e.dataMapper.scene=e.pointsMerge?new Wo.Object3D:e.scene,e.dataMapper.onCreateObj(function(){var e=new Wo.Mesh(o);return e.__globeObjType="point",e}).onUpdateObj(function(t,o){var c=function(r){var n=t.__currentTargetD=r,i=n.r,a=n.alt,s=n.lat,o=n.lng;Object.assign(t.position,j1(s,o));var u=e.pointsMerge?new Wo.Vector3(0,0,0):e.scene.localToWorld(new Wo.Vector3(0,0,0));t.lookAt(u),t.scale.x=t.scale.y=Math.min(30,i)*l,t.scale.z=Math.max(100*a,.1)},h={alt:+i(o),r:+a(o),lat:+r(o),lng:+n(o)},d=t.__currentTargetD||Object.assign({},h,{alt:-.001});if(Object.keys(h).some(function(e){return d[e]!==h[e]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?c(h):e.tweenGroup.add(new ht(d).to(h,e.pointsTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(c).start())),!e.pointsMerge){var A=s(o),p=A?j9(A):0,f=!!p;t.visible=f,f&&(u.hasOwnProperty(A)||(u[A]=new Wo.MeshLambertMaterial({color:j8(A),transparent:p<1,opacity:p})),t.material=u[A])}}).digest(e.pointsData),e.pointsMerge){var c=e.pointsData.length?(Wu.mergeGeometries||Wu.mergeBufferGeometries)(e.pointsData.map(function(t){var r=e.dataMapper.getObj(t),n=r.geometry.clone();r.updateMatrix(),n.applyMatrix4(r.matrix);var i=We(s(t));return n.setAttribute("color",Wr(Array(n.getAttribute("position").count).fill(i),4)),n})):new Wo.BufferGeometry,h=new Wo.Mesh(c,new Wo.MeshLambertMaterial({color:0xffffff,transparent:!0,vertexColors:!0}));h.__globeObjType="points",h.__data=e.pointsData,e.dataMapper.clear(),jJ(e.scene),e.scene.add(h)}}}),Wh=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:"\n    ".concat(lv.common,"\n    ").concat(lv.logdepthbuf_pars_vertex,"\n  \n    uniform float dashTranslate; \n\n    attribute vec4 color;\n    varying vec4 vColor;\n    \n    attribute float relDistance;\n    varying float vRelDistance;\n\n    void main() {\n      // pass through colors and distances\n      vColor = color;\n      vRelDistance = relDistance + dashTranslate;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  \n      ").concat(lv.logdepthbuf_vertex,"\n    }\n  "),fragmentShader:"\n    ".concat(lv.logdepthbuf_pars_fragment,"\n\n    uniform float dashOffset; \n    uniform float dashSize;\n    uniform float gapSize; \n    \n    varying vec4 vColor;\n    varying float vRelDistance;\n    \n    void main() {\n      // ignore pixels in the gap\n      if (vRelDistance < dashOffset) discard;\n      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;\n    \n      // set px color: [r, g, b, a], interpolated between vertices \n      gl_FragColor = vColor; \n  \n      ").concat(lv.logdepthbuf_fragment,"\n    }\n  ")}},Wd=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=("attribute float surfaceRadius;\nvarying float vSurfaceRadius;\nvarying vec3 vPos;\n"+e.vertexShader).replace("void main() {","void main() {\nvSurfaceRadius = surfaceRadius;\nvPos = position;"),e.fragmentShader=("uniform float surfaceRadius;\nvarying float vSurfaceRadius;\nvarying vec3 vPos;\n"+e.fragmentShader).replace("void main() {","void main() {\nif (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"),e},WA=function(e){return e.vertexShader="\n    attribute float r;\n    \n    const float PI = 3.1415926535897932384626433832795;\n    float toRad(in float a) {\n      return a * PI / 180.0;\n    }\n    \n    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]\n      float phi = toRad(90.0 - c.x);\n      float theta = toRad(90.0 - c.y);\n      float r = c.z;\n      return vec3( // x,y,z\n        r * sin(phi) * cos(theta),\n        r * cos(phi),\n        r * sin(phi) * sin(theta)\n      );\n    }\n    \n    vec2 Cartesian2Polar(in vec3 p) {\n      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n      float phi = acos(p.y / r);\n      float theta = atan(p.z, p.x);\n      return vec2( // lat,lng\n        90.0 - phi * 180.0 / PI,\n        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)\n      );\n    }\n    ".concat(e.vertexShader.replace("}","                  \n        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n      }\n    "),"\n  "),e},Wp=function(e,t){return e.onBeforeCompile=function(r){e.userData.shader=t(r)},e},Wf=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(e.userData.shader)t(e.userData.shader.uniforms);else{var r=e.onBeforeCompile;e.onBeforeCompile=function(e){r(e),t(e.uniforms)}}},Wm=["stroke"],Wg=window.THREE?window.THREE:{BufferGeometry:rw,CubicBezierCurve3:i6,Curve:iX,Group:r$,Line:iA,Mesh:rU,NormalBlending:1,ShaderMaterial:rH,TubeGeometry:aO,Vector3:ex},Wy=fO.default.default||fO.default,Wv=c4({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcStartAltitude:{default:0},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcEndAltitude:{default:0},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;null==(t=e.ticker)||t.pause()},resumeAnimation:function(e){var t;null==(t=e.ticker)||t.resume()},_destructor:function(e){var t;e.sharedMaterial.dispose(),null==(t=e.ticker)||t.dispose()}},stateInit:function(e){return{tweenGroup:e.tweenGroup,ticker:new Wy,sharedMaterial:new Wg.ShaderMaterial(jV(jV({},Wh()),{},{transparent:!0,blending:Wg.NormalBlending}))}},init:function(e,t){jJ(e),t.scene=e,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjArc"}).onCreateObj(function(){var e=new Wg.Group;return e.__globeObjType="arc",e}),t.ticker.onTick.add(function(e,r){t.dataMapper.entries().map(function(e){return jj(e,2)[1]}).filter(function(e){return e.children.length&&e.children[0].material&&e.children[0].__dashAnimateStep}).forEach(function(e){var t=e.children[0],n=t.__dashAnimateStep*r,i=t.material.uniforms.dashTranslate.value%1e9;t.material.uniforms.dashTranslate.value=i+n})})},update:function(e){var t=p3(e.arcStartLat),r=p3(e.arcStartLng),n=p3(e.arcStartAltitude),i=p3(e.arcEndLat),a=p3(e.arcEndLng),s=p3(e.arcEndAltitude),o=p3(e.arcAltitude),l=p3(e.arcAltitudeAutoScale),u=p3(e.arcStroke),c=p3(e.arcColor),h=p3(e.arcDashLength),d=p3(e.arcDashGap),A=p3(e.arcDashInitialGap),p=p3(e.arcDashAnimateTime);e.dataMapper.onUpdateObj(function(f,m){var g=u(m),y=null!=g;if(!f.children.length||y!==("Mesh"===f.children[0].type)){jJ(f);var v=y?new Wg.Mesh:new Wg.Line(new Wg.BufferGeometry);v.material=e.sharedMaterial.clone(),f.add(v)}var x=f.children[0];Object.assign(x.material.uniforms,{dashSize:{value:h(m)},gapSize:{value:d(m)},dashOffset:{value:A(m)}});var _=p(m);x.__dashAnimateStep=_>0?1e3/_:0;var b=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e instanceof Array||e instanceof Function){var i=e instanceof Array?dT().domain(e.map(function(t,r){return r/(e.length-1)})).range(e):e;r=function(e){return We(i(e),!0,!0)}}else{var a=We(e,!0,!0);r=function(){return a}}for(var s=[],o=0,l=t+1;o<l;o++)for(var u=r(o/(l-1)),c=0;c<n;c++)s.push(u);return Wr(s,4)}(c(m),e.arcCurveResolution,y?e.arcCircularResolution+1:1),S=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],i=0,a=e+1;i<a;i++)for(var s=i/(a-1),o=0;o<t;o++)n.push(s);return r&&n.reverse(),Wr(n,1)}(e.arcCurveResolution,y?e.arcCircularResolution+1:1,!0);x.geometry.setAttribute("color",b),x.geometry.setAttribute("relDistance",S);var T=function(t){var r=f.__currentTargetD=t,n=r.stroke,i=function(e){var t=e.alt,r=e.altAutoScale,n=e.startLat,i=e.startLng,a=e.startAlt,s=e.endLat,o=e.endLng,l=e.endAlt,u=function(e){var t=jj(e,3),r=t[0],n=j1(t[1],r,t[2]),i=n.x,a=n.y,s=n.z;return new Wg.Vector3(i,a,s)},c=[i,n],h=[o,s],d=t;if(null==d&&(d=pw(c,h)/2*r+Math.max(a,l)),!d&&!a&&!l)return(function(e,t){var r=e.angleTo(t),n=0===r?function(){return e.clone()}:function(n){return new Wg.Vector3().addVectors(e.clone().multiplyScalar(Math.sin((1-n)*r)),t.clone().multiplyScalar(Math.sin(n*r))).divideScalar(Math.sin(r))},i=new Wg.Curve;return i.getPoint=n,i}).apply(void 0,jX([[].concat(c,[.001]),[].concat(h,[.001])].map(u)));var A=pM(c,h),p=jj([.25,.75].map(function(e){var t,r;return[].concat(jX(A(e)),[(t=e<.5?a:l,(r=d)+(r-t)*(t<r?.5:.25))])}),2),f=p[0],m=p[1];return jL(Wg.CubicBezierCurve3,jX([[].concat(c,[a]),f,m,[].concat(h,[l])].map(u)))}(function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(r,Wm));y?(x.geometry&&x.geometry.dispose(),x.geometry=new Wg.TubeGeometry(i,e.arcCurveResolution,n/2,e.arcCircularResolution),x.geometry.setAttribute("color",b),x.geometry.setAttribute("relDistance",S)):x.geometry.setFromPoints(i.getPoints(e.arcCurveResolution))},w={stroke:g,alt:o(m),altAutoScale:+l(m),startLat:+t(m),startLng:+r(m),startAlt:+n(m),endLat:+i(m),endLng:+a(m),endAlt:+s(m)},M=f.__currentTargetD||Object.assign({},w,{altAutoScale:-.001});Object.keys(w).some(function(e){return M[e]!==w[e]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?T(w):e.tweenGroup.add(new ht(M).to(w,e.arcsTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(T).start()))}).digest(e.arcsData)}}),Wx=window.THREE?window.THREE:{BufferGeometry:rw,DoubleSide:2,Mesh:rU,MeshLambertMaterial:aY,Object3D:tV},W_=Object.assign({},p2),Wb=W_.BufferGeometryUtils||W_,WS=c4({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){return .01*e.sumWeight}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,t){var r=p3(e.hexBinPointLat),n=p3(e.hexBinPointLng),i=p3(e.hexBinPointWeight),a=p3(e.hexAltitude),s=p3(e.hexTopColor),o=p3(e.hexSideColor),l=p3(e.hexMargin),u=Object.entries(gw(e.hexBinPointsData.map(function(t){return jV(jV({},t),{},{h3Idx:function(e,t,r){var n=gM._malloc(gF);gM.HEAPF64.set([e,t].map(gJ),n/8);var i=gM._malloc(gB);try{gL(gD.latLngToCell(n,r,i));var a=gj(i);if(!a)throw gI(1002);return a}finally{gM._free(i),gM._free(n)}}(r(t),n(t),e.hexBinResolution)})}),"h3Idx")).map(function(e){var t=jj(e,2),r=t[0],n=t[1];return{h3Idx:r,points:n,sumWeight:n.reduce(function(e,t){return e+ +i(t)},0)}}),c={};if(!e.hexBinMerge&&t.hasOwnProperty("hexBinMerge")&&jJ(e.scene),e.dataMapper.scene=e.hexBinMerge?new Wx.Object3D:e.scene,e.dataMapper.id(function(e){return e.h3Idx}).onCreateObj(function(e){var t=new Wx.Mesh;t.__hexCenter=gY(e.h3Idx),t.__hexGeoJson=gK(e.h3Idx,!0).reverse();var r=t.__hexCenter[1];return t.__hexGeoJson.forEach(function(e){var t=e[0];Math.abs(r-t)>170&&(e[0]+=r>t?360:-360)}),t.__globeObjType="hexbin",t}).onUpdateObj(function(t,r){var n=Math.max(0,Math.min(1,+l(r))),i=jj(t.__hexCenter,2),u=i[0],h=i[1],d=0===n?t.__hexGeoJson:t.__hexGeoJson.map(function(e){var t=jj(e,2);return[[t[0],h],[t[1],u]].map(function(e){var t=jj(e,2),r=t[0];return r-(r-t[1])*n})}),A=e.hexTopCurvatureResolution;t.geometry&&t.geometry.dispose(),t.geometry=new g_([d],0,100,!1,!0,!0,A);var p={alt:+a(r)},f=function(e){var r=(t.__currentTargetD=e).alt;t.scale.x=t.scale.y=t.scale.z=1+r,t.geometry.setAttribute("surfaceRadius",Wr(Array(t.geometry.getAttribute("position").count).fill(100/(r+1)),1))},m=t.__currentTargetD||Object.assign({},p,{alt:-.001});if(Object.keys(p).some(function(e){return m[e]!==p[e]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?f(p):e.tweenGroup.add(new ht(m).to(p,e.hexTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(f).start())),!e.hexBinMerge){var g=o(r),y=s(r);[g,y].forEach(function(e){if(!c.hasOwnProperty(e)){var t=j9(e);c[e]=Wp(new Wx.MeshLambertMaterial({color:j8(e),transparent:t<1,opacity:t,side:Wx.DoubleSide}),Wd)}}),t.material=[g,y].map(function(e){return c[e]})}}).digest(u),e.hexBinMerge){var h=u.length?(Wb.mergeGeometries||Wb.mergeBufferGeometries)(u.map(function(t){var r=e.dataMapper.getObj(t),n=r.geometry.toNonIndexed();r.updateMatrix(),n.applyMatrix4(r.matrix);var i=We(s(t)),a=We(o(t)),l=n.getAttribute("position").count,u=n.groups[0].count;return n.setAttribute("color",Wr(jX(Array(l)).map(function(e,t){return t>=u?i:a}),4)),n})):new Wx.BufferGeometry,d=new Wx.MeshLambertMaterial({color:0xffffff,transparent:!0,vertexColors:!0,side:Wx.DoubleSide});d.onBeforeCompile=function(e){d.userData.shader=Wd(e)};var A=new Wx.Mesh(h,d);A.__globeObjType="hexBinPoints",A.__data=u,e.dataMapper.clear(),jJ(e.scene),e.scene.add(A)}}}),WT=function(e){return e*e},Ww=function(e){return e*Math.PI/180},WM=Math.sqrt(2*Math.PI),WE=function(e){var t=jj(e,2),r=t[0],n=t[1],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a.lngAccessor,o=void 0===s?function(e){return e[0]}:s,l=a.latAccessor,u=void 0===l?function(e){return e[1]}:l,c=a.weightAccessor,h=void 0===c?function(){return 1}:c,d=a.bandwidth,A=[r,n],p=d*Math.PI/180;return function(e,t){let r=0;for(let t of e)(t*=1)&&(r+=t);return r}(i.map(function(e){var t,r,n,i,a,s,l,c,d=h(e);if(!d)return 0;var f=(t=[o(e),u(e)],r=Math.sqrt,n=Math.cos,i=function(e){return WT(Math.sin(e/2))},a=Ww(A[1]),s=Ww(t[1]),l=Ww(A[0]),c=Ww(t[0]),2*Math.asin(r(i(s-a)+n(a)*n(s)*i(c-l))));return Math.exp(-WT(f/p)/2)/(p*WM)*d}))},WR=function(){var e,t=(e=jq().m(function e(t){var r,n,i,a,s,o,l,u,c,h,d,A,p,f,m,g,y,v,x,_,b,S,T,w,M,E,R,C,N,P,I,L,D,B,F,U,O,k,z,V,q=arguments;return jq().w(function(e){for(;;)switch(e.n){case 0:if(n=q.length>1&&void 0!==q[1]?q[1]:[],s=void 0===(a=(i=q.length>2&&void 0!==q[2]?q[2]:{}).lngAccessor)?function(e){return e[0]}:a,l=void 0===(o=i.latAccessor)?function(e){return e[1]}:o,c=void 0===(u=i.weightAccessor)?function(){return 1}:u,h=i.bandwidth,null!=(r=navigator)&&r.gpu){e.n=1;break}return console.warn("WebGPU not enabled in browser. Please consider enabling it to improve performance."),e.a(2,t.map(function(e){return WE(e,n,{lngAccessor:s,latAccessor:l,weightAccessor:c,bandwidth:h})}));case 1:return d=jr.Fn,A=jr.If,p=jr.uniform,f=jr.storage,m=jr.float,g=jr.instanceIndex,y=jr.Loop,v=jr.sqrt,x=jr.sin,_=jr.cos,b=jr.asin,S=jr.exp,T=jr.negate,w=f(new CD(new Float32Array(t.flat().map(Ww)),2),"vec2",t.length),M=f(new CD(new Float32Array(n.map(function(e){return[Ww(s(e)),Ww(l(e)),c(e)]}).flat()),3),"vec3",n.length),R=f(E=new CD(t.length,1),"float",t.length),C=v(m(Math.PI).mul(2)),N=function(e){return e.mul(e)},P=function(e){return N(x(e.div(2)))},I=function(e,t){var r=m(e[1]),n=m(t[1]),i=m(e[0]),a=m(t[0]);return m(2).mul(b(v(P(n.sub(r)).add(_(r).mul(_(n)).mul(P(a.sub(i)))))))},L=p(Ww(h)),D=p(Ww(4*h)),B=p(n.length),F=d(function(){var e=w.element(g),t=R.element(g);t.assign(0),y(B,function(r){var n=r.i,i=M.element(n),a=i.z;A(a,function(){var r=I(i.xy,e.xy);A(r&&r.lessThan(D),function(){t.addAssign(S(T(N(r.div(L)).div(2))).div(L.mul(C)).mul(a))})})})})().compute(t.length),U=new BN,e.n=2,U.computeAsync(F);case 2:return O=Array,k=Float32Array,e.n=3,U.getArrayBufferAsync(E);case 3:return z=e.v,V=new k(z),e.a(2,O.from.call(O,V))}},e)}),function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function s(e){jE(a,n,i,s,o,"next",e)}function o(e){jE(a,n,i,s,o,"throw",e)}s(void 0)})});return function(e){return t.apply(this,arguments)}}(),WC=window.THREE?window.THREE:{Mesh:rU,MeshLambertMaterial:aY,SphereGeometry:aD},WN=function(e){var t,r=hk("rgb("+Math.max(0,Math.min(255,Math.round(34.61+(t=Math.max(0,Math.min(1,t=e)))*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")");return r.opacity=Math.cbrt(e),r.formatRgb()},WP=c4({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return WN}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj(function(){var e=new WC.Mesh(new WC.SphereGeometry(100),Wp(new WC.MeshLambertMaterial({vertexColors:!0,transparent:!0}),WA));return e.__globeObjType="heatmap",e})},update:function(e){var t=p3(e.heatmapPoints),r=p3(e.heatmapPointLat),n=p3(e.heatmapPointLng),i=p3(e.heatmapPointWeight),a=p3(e.heatmapBandwidth),s=p3(e.heatmapColorFn),o=p3(e.heatmapColorSaturation),l=p3(e.heatmapBaseAltitude),u=p3(e.heatmapTopAltitude);e.dataMapper.onUpdateObj(function(c,h){var d=a(h),A=s(h),p=o(h),f=l(h),m=u(h),g=t(h).map(function(e){var t=r(e),a=n(e),s=j1(t,a);return{x:s.x,y:s.y,z:s.z,lat:t,lng:a,weight:i(e)}}),y=Math.ceil(360/(Math.max(.1,d/3.5)||-1));c.geometry.parameters.widthSegments!==y&&(c.geometry.dispose(),c.geometry=new WC.SphereGeometry(100,y,y/2)),WR((function(e){for(var t=e.itemSize,r=[],n=0;n<e.count;n++)r.push(e.array.slice(n*t,(n+1)*t));return r})(c.geometry.getAttribute("position")).map(function(e){var t=jj(e,3),r=j2({x:t[0],y:t[1],z:t[2]});return[r.lng,r.lat]}),g,{latAccessor:function(e){return e.lat},lngAccessor:function(e){return e.lng},weightAccessor:function(e){return e.weight},bandwidth:d}).then(function(t){var r=jX(Array(100)).map(function(e,t){return We(A(t/99))}),n=function(e){var t=c.__currentTargetD=e,n=t.kdeVals,i=t.topAlt,a=t.saturation,s=function(e,t){let r;for(let t of e)null!=t&&(r<t||void 0===r&&t>=t)&&(r=t);return r}(n.map(Math.abs))||1e-15,o=function e(){var t,r=0,n=1,i=1,a=[.5],s=[0,1];function o(e){return null!=e&&e<=e?s[hb(a,e,0,i)]:t}function l(){var e=-1;for(a=Array(i);++e<i;)a[e]=((e+1)*n-(e-i)*r)/(i+1);return o}return o.domain=function(e){return arguments.length?([r,n]=e,r*=1,n*=1,l()):[r,n]},o.range=function(e){return arguments.length?(i=(s=Array.from(e)).length-1,l()):s.slice()},o.invertExtent=function(e){var t=s.indexOf(e);return t<0?[NaN,NaN]:t<1?[r,a[0]]:t>=i?[a[i-1],n]:[a[t-1],a[t]]},o.unknown=function(e){return arguments.length&&(t=e),o},o.thresholds=function(){return a.slice()},o.copy=function(){return e().domain([r,n]).range(s).unknown(t)},dd.apply(dS(o),arguments)}([0,s/a],r);c.geometry.setAttribute("color",Wr(n.map(function(e){return o(Math.abs(e))}),4));var l=dT([0,s],[100*(1+f),100*(1+(i||f))]);c.geometry.setAttribute("r",Wr(n.map(l)))},i={kdeVals:t,topAlt:m,saturation:p},a=c.__currentTargetD||Object.assign({},i,{kdeVals:t.map(function(){return 0}),topAlt:m?f:m,saturation:.5});a.kdeVals.length!==t.length&&(a.kdeVals=t.slice()),Object.keys(i).some(function(e){return a[e]!==i[e]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?n(i):e.tweenGroup.add(new ht(a).to(i,e.heatmapsTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(n).start()))})}).digest(e.heatmapsData)}}),WI=window.THREE?window.THREE:{DoubleSide:2,Group:r$,LineBasicMaterial:ia,LineSegments:iy,Mesh:rU,MeshBasicMaterial:re},WL=c4({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjPolygon"}).id(function(e){return e.id}).onCreateObj(function(){var e=new WI.Group;return e.__defaultSideMaterial=Wp(new WI.MeshBasicMaterial({side:WI.DoubleSide,depthWrite:!0}),Wd),e.__defaultCapMaterial=new WI.MeshBasicMaterial({side:WI.DoubleSide,depthWrite:!0}),e.add(new WI.Mesh(void 0,[e.__defaultSideMaterial,e.__defaultCapMaterial])),e.add(new WI.LineSegments(void 0,new WI.LineBasicMaterial)),e.__globeObjType="polygon",e})},update:function(e){var t=p3(e.polygonGeoJsonGeometry),r=p3(e.polygonAltitude),n=p3(e.polygonCapCurvatureResolution),i=p3(e.polygonCapColor),a=p3(e.polygonCapMaterial),s=p3(e.polygonSideColor),o=p3(e.polygonSideMaterial),l=p3(e.polygonStrokeColor),u=[];e.polygonsData.forEach(function(e){var c={data:e,capColor:i(e),capMaterial:a(e),sideColor:s(e),sideMaterial:o(e),strokeColor:l(e),altitude:+r(e),capCurvatureResolution:+n(e)},h=t(e),d=e.__id||"".concat(Math.round(1e9*Math.random()));e.__id=d,"Polygon"===h.type?u.push(jV({id:"".concat(d,"_0"),coords:h.coordinates},c)):"MultiPolygon"===h.type?u.push.apply(u,jX(h.coordinates.map(function(e,t){return jV({id:"".concat(d,"_").concat(t),coords:e},c)}))):console.warn("Unsupported GeoJson geometry type: ".concat(h.type,". Skipping geometry..."))}),e.dataMapper.onUpdateObj(function(t,r){var n=r.coords,i=r.capColor,a=r.capMaterial,s=r.sideColor,o=r.sideMaterial,l=r.strokeColor,u=r.altitude,c=r.capCurvatureResolution,h=jj(t.children,2),d=h[0],A=h[1],p=!!l;A.visible=p;var f=!!(i||a),m=!!(s||o);!function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return function(e,t){return e===t}};return Object.entries(t).every(function(t){var n=jj(t,2),i=n[0],a=n[1];return e.hasOwnProperty(i)&&r(i)(e[i],a)})}(d.geometry.parameters||{},{polygonGeoJson:n,curvatureResolution:c,closedTop:f,includeSides:m})&&(d.geometry&&d.geometry.dispose(),d.geometry=new g_(n,0,100,!1,f,m,c)),p&&(!A.geometry.parameters||A.geometry.parameters.geoJson.coordinates!==n||A.geometry.parameters.resolution!==c)&&(A.geometry&&A.geometry.dispose(),A.geometry=new pF({type:"Polygon",coordinates:n},100,c));var g=m?0:-1,y=f?+!!m:-1;if(g>=0&&(d.material[g]=o||t.__defaultSideMaterial),y>=0&&(d.material[y]=a||t.__defaultCapMaterial),[[!o&&s,g],[!a&&i,y]].forEach(function(e){var t=jj(e,2),r=t[0],n=t[1];if(r&&!(n<0)){var i=d.material[n],a=j9(r);i.color.set(j8(r)),i.transparent=a<1,i.opacity=a}}),p){var v=A.material,x=j9(l);v.color.set(j8(l)),v.transparent=x<1,v.opacity=x}var _={alt:u},b=function(e){var r=(t.__currentTargetD=e).alt;d.scale.x=d.scale.y=d.scale.z=1+r,p&&(A.scale.x=A.scale.y=A.scale.z=1+r+1e-4),Wf(t.__defaultSideMaterial,function(e){return e.surfaceRadius.value=100/(r+1)})},S=t.__currentTargetD||Object.assign({},_,{alt:-.001});Object.keys(_).some(function(e){return S[e]!==_[e]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||S.alt===_.alt?b(_):e.tweenGroup.add(new ht(S).to(_,e.polygonsTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(b).start()))}).digest(u)}}),WD=window.THREE?window.THREE:{BufferGeometry:rw,DoubleSide:2,Mesh:rU,MeshLambertMaterial:aY,Vector3:ex},WB=Object.assign({},p2),WF=WB.BufferGeometryUtils||WB,WU=c4({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj(function(){var e=new WD.Mesh(void 0,new WD.MeshLambertMaterial({side:WD.DoubleSide}));return e.__globeObjType="hexPolygon",e})},update:function(e){var t=p3(e.hexPolygonGeoJsonGeometry),r=p3(e.hexPolygonColor),n=p3(e.hexPolygonAltitude),i=p3(e.hexPolygonResolution),a=p3(e.hexPolygonMargin),s=p3(e.hexPolygonUseDots),o=p3(e.hexPolygonCurvatureResolution),l=p3(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj(function(u,c){var h=t(c),d=i(c),A=n(c),p=Math.max(0,Math.min(1,+a(c))),f=s(c),m=o(c),g=l(c),y=r(c),v=j9(y);u.material.color.set(j8(y)),u.material.transparent=v<1,u.material.opacity=v;var x={alt:A,margin:p,curvatureResolution:m},_={geoJson:h,h3Res:d},b=u.__currentTargetD||Object.assign({},x,{alt:-.001}),S=u.__currentMemD||_;if(Object.keys(x).some(function(e){return b[e]!==x[e]})||Object.keys(_).some(function(e){return S[e]!==_[e]})){u.__currentMemD=_;var T=[];"Polygon"===h.type?gZ(h.coordinates,d,!0).forEach(function(e){return T.push(e)}):"MultiPolygon"===h.type?h.coordinates.forEach(function(e){return gZ(e,d,!0).forEach(function(e){return T.push(e)})}):console.warn("Unsupported GeoJson geometry type: ".concat(h.type,". Skipping geometry..."));var w=T.map(function(e){var t=gY(e),r=gK(e,!0).reverse(),n=t[1];return r.forEach(function(e){var t=e[0];Math.abs(n-t)>170&&(e[0]+=n>t?360:-360)}),{h3Idx:e,hexCenter:t,hexGeoJson:r}}),M=function(e){var t=u.__currentTargetD=e,r=t.alt,n=t.margin,i=t.curvatureResolution;u.geometry&&u.geometry.dispose(),u.geometry=w.length?(WF.mergeGeometries||WF.mergeBufferGeometries)(w.map(function(e){var t=jj(e.hexCenter,2),a=t[0],s=t[1];if(!f)return new g_([0===n?e.hexGeoJson:e.hexGeoJson.map(function(e){var t=jj(e,2);return[[t[0],s],[t[1],a]].map(function(e){var t=jj(e,2),r=t[0];return r-(r-t[1])*n})})],100,100*(1+r),!1,!0,!1,i);var o=j1(a,s,r),l=j1(e.hexGeoJson[0][1],e.hexGeoJson[0][0],r),u=new iU(.85*(1-n)*new WD.Vector3(o.x,o.y,o.z).distanceTo(new WD.Vector3(l.x,l.y,l.z)),g);return u.rotateX(j3(-a)),u.rotateY(j3(s)),u.translate(o.x,o.y,o.z),u})):new WD.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?M(x):e.tweenGroup.add(new ht(b).to(x,e.hexPolygonsTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(M).start())}}).digest(e.hexPolygonsData)}}),WO=window.THREE?window.THREE:{Vector3:ex},Wk=window.THREE?window.THREE:{BufferGeometry:rw,Color:t6,Group:r$,Line:iA,NormalBlending:1,ShaderMaterial:rH,Vector3:ex},Wz=fO.default.default||fO.default,WV=c4({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;null==(t=e.ticker)||t.pause()},resumeAnimation:function(e){var t;null==(t=e.ticker)||t.resume()},_destructor:function(e){var t;null==(t=e.ticker)||t.dispose()}},stateInit:function(e){return{tweenGroup:e.tweenGroup,ticker:new Wz,sharedMaterial:new Wk.ShaderMaterial(jV(jV({},Wh()),{},{transparent:!0,blending:Wk.NormalBlending}))}},init:function(e,t){jJ(e),t.scene=e,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjPath"}).onCreateObj(function(){var e=new Wk.Group;return e.__globeObjType="path",e}),t.ticker.onTick.add(function(e,r){t.dataMapper.entries().map(function(e){return jj(e,2)[1]}).filter(function(e){return e.children.length&&e.children[0].material&&e.children[0].__dashAnimateStep}).forEach(function(e){var t=e.children[0],n=t.__dashAnimateStep*r;if("Line"===t.type){var i=t.material.uniforms.dashTranslate.value%1e9;t.material.uniforms.dashTranslate.value=i+n}else if("Line2"===t.type){for(var a=t.material.dashOffset-n,s=t.material.dashSize+t.material.gapSize;a<=-s;)a+=s;t.material.dashOffset=a}})})},update:function(e){var t=p3(e.pathPoints),r=p3(e.pathPointLat),n=p3(e.pathPointLng),i=p3(e.pathPointAlt),a=p3(e.pathStroke),s=p3(e.pathColor),o=p3(e.pathDashLength),l=p3(e.pathDashGap),u=p3(e.pathDashInitialGap),c=p3(e.pathDashAnimateTime);function h(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(e instanceof Array||e instanceof Function){var a=e instanceof Array?dT().domain(e.map(function(t,r){return r/(e.length-1)})).range(e):e;r=function(e){return We(a(e),i,!0)}}else{var s=We(e,i,!0);r=function(){return s}}for(var o=[],l=0,u=t+1;l<u;l++)for(var c=r(l/(u-1)),h=0;h<n;h++)o.push(c);return Wr(o,i?4:3)}e.dataMapper.onUpdateObj(function(d,A){var p,f,m,g,y=a(A),v=null!=y;if(!d.children.length||v===("Line"===d.children[0].type)){jJ(d);var x=v?new jS(new jb,new js):new Wk.Line(new Wk.BufferGeometry,e.sharedMaterial.clone());d.add(x)}var _=d.children[0],b=(T=t(A),w=r,M=n,E=i,R=e.pathResolution,C=function(e,t,r){for(var n=[],i=1;i<=r;i++)n.push(e+(t-e)*i/(r+1));return n},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[],n=null;return e.forEach(function(e){if(n){for(;Math.abs(n[1]-e[1])>180;)n[1]+=360*(n[1]<e[1]?1:-1);var i=Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2));if(i>t)for(var a=Math.floor(i/t),s=C(n[0],e[0],a),o=C(n[1],e[1],a),l=C(n[2],e[2],a),u=0,c=s.length;u<c;u++)r.push([s[u],o[u],l[u]])}r.push(n=e)}),r})(T.map(function(e){return[w(e),M(e),E(e)]}),R).map(function(e){var t=jj(e,3),r=j1(t[0],t[1],t[2]),n=r.x,i=r.y,a=r.z;return new Wk.Vector3(n,i,a)})),S=c(A);if(_.__dashAnimateStep=S>0?1e3/S:0,v){_.material.resolution=e.rendererSize;var T,w,M,E,R,C,N,P,I=o(A),L=l(A),D=u(A);_.material.dashed=L>0,_.material.dashed?_.material.defines.USE_DASH="":delete _.material.defines.USE_DASH,_.material.dashed&&(_.material.dashScale=1/(P=0,b.forEach(function(e){N&&(P+=N.distanceTo(e)),N=e}),P),_.material.dashSize=I,_.material.gapSize=L,_.material.dashOffset=-D);var B=s(A);if(B instanceof Array){var F=h(s(A),b.length-1,1,!1);_.geometry.setColors(F.array),_.material.vertexColors=!0}else{var U=j9(B);_.material.color=new Wk.Color(j8(B)),_.material.transparent=U<1,_.material.opacity=U,_.material.vertexColors=!1}_.material.needsUpdate=!0}else{Object.assign(_.material.uniforms,{dashSize:{value:o(A)},gapSize:{value:l(A)},dashOffset:{value:u(A)}});var O=h(s(A),b.length),k=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],i=0,a=e+1;i<a;i++)for(var s=i/(a-1),o=0;o<t;o++)n.push(s);return r&&n.reverse(),Wr(n,1)}(b.length,1,!0);_.geometry.setAttribute("color",O),_.geometry.setAttribute("relDistance",k)}var z=(p=d.__currentTargetD&&d.__currentTargetD.points||[b[0]],f=function(e,t){var r=e[e.length-1];return[].concat(jX(e),jX(Array(t-e.length).fill(r)))},m=Math.max(p.length,b.length),g=h8.apply(void 0,jX([p,b].map(function(e){return e.map(function(e){return[e.x,e.y,e.z]})}).map(function(e){return f(e,m)}))),function(e){return 0===e?p:1===e?b:g(e).map(function(e){var t=jj(e,3),r=t[0],n=t[1],i=t[2];return new WO.Vector3(r,n,i)})}),V=function(e){var t,r=d.__currentTargetD=e,n=r.stroke,i=r.interpolK,a=d.__currentTargetD.points=z(i);v?(_.geometry.setPositions((t=[]).concat.apply(t,jX(a.map(function(e){return[e.x,e.y,e.z]})))),_.material.linewidth=n,_.material.dashed&&_.computeLineDistances()):(_.geometry.setFromPoints(a),_.geometry.computeBoundingSphere())},q={stroke:y,interpolK:1},G=Object.assign({},d.__currentTargetD||q,{interpolK:0});Object.keys(q).some(function(e){return G[e]!==q[e]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?V(q):e.tweenGroup.add(new ht(G).to(q,e.pathTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(V).start()))}).digest(e.pathsData)}}),Wq=window.THREE?window.THREE:{Euler:tT,Mesh:rU,MeshLambertMaterial:aY,SphereGeometry:aD},WG=c4({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new Wq.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjTile"}).onCreateObj(function(){var e=new Wq.Mesh;return e.__globeObjType="tile",e})},update:function(e){var t=p3(e.tileLat),r=p3(e.tileLng),n=p3(e.tileAltitude),i=p3(e.tileWidth),a=p3(e.tileHeight),s=p3(e.tileUseGlobeProjection),o=p3(e.tileMaterial),l=p3(e.tileCurvatureResolution);e.dataMapper.onUpdateObj(function(u,c){u.material=o(c);var h=s(c),d=l(c),A=function(e){var t=u.__currentTargetD=e,r=t.lat,n=t.lng,i=t.alt,a=t.width,s=t.height,o=WH(n),l=WH(-r);u.geometry&&u.geometry.dispose(),u.geometry=new Wq.SphereGeometry(100*(1+i),Math.ceil(a/(d||-1)),Math.ceil(s/(d||-1)),WH(90-a/2)+(h?o:0),WH(a),WH(90-s/2)+(h?l:0),WH(s)),h||u.setRotationFromEuler(new Wq.Euler(l,o,0,"YXZ"))},p={lat:+t(c),lng:+r(c),alt:+n(c),width:+i(c),height:+a(c)},f=u.__currentTargetD||Object.assign({},p,{width:0,height:0});Object.keys(p).some(function(e){return f[e]!==p[e]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?A(p):e.tweenGroup.add(new ht(f).to(p,e.tilesTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(A).start()))}).digest(e.tilesData)}}),WH=function(e){return e*Math.PI/180},Wj=window.THREE?window.THREE:{BufferGeometry:rw,Color:t6,Points:iw,PointsMaterial:ix},WW=c4({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,t){jJ(e),t.scene=e,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjParticles"}).onCreateObj(function(){var e=new Wj.Points(new Wj.BufferGeometry,new Wj.PointsMaterial);return e.__globeObjType="particles",e}).onUpdateObj(function(e,r){var n=p3(t.particlesList),i=p3(t.particleLat),a=p3(t.particleLng),s=p3(t.particleAltitude);e.geometry.setAttribute("position",Wr(n(r).map(function(e){return Object.values(j1(i(e),a(e),s(e)))}),3))})},update:function(e,t){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some(function(e){return t.hasOwnProperty(e)})&&e.dataMapper.digest(e.particlesData);var r=p3(e.particlesColor),n=p3(e.particlesSize),i=p3(e.particlesSizeAttenuation),a=p3(e.particlesTexture);e.dataMapper.entries().forEach(function(t){var s=jj(t,2),o=s[0],l=s[1];if(l.material.size=n(o),l.material.sizeAttenuation=i(o),e.particlesTexture)l.material.color=new Wj.Color(0xffffff),l.material.transparent=!1,l.material.alphaTest=.5,l.material.map=a(o);else{var u=r(o),c=j9(u);l.material.color=new Wj.Color(j8(u)),l.material.transparent=c<1,l.material.opacity=c,l.material.alphaTest=0}})}}),WX=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;jC(this,t),(e=jR(this,t)).type="CircleLineGeometry",e.parameters={radius:r,segmentCount:n};for(var i=[],a=0;a<=n;a++){var s=(a/n-.25)*Math.PI*2;i.push({x:Math.cos(s)*r,y:Math.sin(s)*r,z:0})}return e.setFromPoints(i),e}return jO(t,e),jD(t)}((window.THREE?window.THREE:{BufferGeometry:rw}).BufferGeometry),WQ=window.THREE?window.THREE:{Color:t6,Group:r$,Line:iA,LineBasicMaterial:ia,Vector3:ex},WY=fO.default.default||fO.default,WK=c4({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;null==(t=e.ticker)||t.pause()},resumeAnimation:function(e){var t;null==(t=e.ticker)||t.resume()},_destructor:function(e){var t;null==(t=e.ticker)||t.dispose()}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj(function(){var e=new WQ.Group;return e.__globeObjType="ring",e}),t.ticker=new WY,t.ticker.onTick.add(function(e){if(t.ringsData.length){var r=p3(t.ringColor),n=p3(t.ringAltitude),i=p3(t.ringMaxRadius),a=p3(t.ringPropagationSpeed),s=p3(t.ringRepeatPeriod);t.dataMapper.entries().filter(function(e){return jj(e,2)[1]}).forEach(function(o){var l=jj(o,2),u=l[0],c=l[1];if((c.__nextRingTime||0)<=e){var h,d,A,p=s(u)/1e3;c.__nextRingTime=e+(p<=0?1/0:p);var f=new WQ.Line(new WX(1,t.ringResolution),new WQ.LineBasicMaterial),m=r(u),g=m instanceof Array||m instanceof Function;g?m instanceof Array?(A=dT().domain(m.map(function(e,t){return t/(m.length-1)})).range(m),f.material.transparent=m.some(function(e){return 1>j9(e)})):(A=m,f.material.transparent=!0):(f.material.color=new WQ.Color(j8(m)),(h=f.material).opacity=d=j9(m),h.transparent=d<1,h.depthWrite=d>=1);var y=100*(1+n(u)),v=i(u),x=v*Math.PI/180,_=a(u),b=_<=0,S=function(e){var t=e.t,r=(b?1-t:t)*x;if(f.scale.x=f.scale.y=y*Math.sin(r),f.position.z=y*(1-Math.cos(r)),g){var n=A(t);f.material.color=new WQ.Color(j8(n)),f.material.transparent&&(f.material.opacity=j9(n))}};if(0===_)S({t:0}),c.add(f);else{var T=1e3*Math.abs(v/_);t.tweenGroup.add(new ht({t:0}).to({t:1},T).onUpdate(S).onStart(function(){return c.add(f)}).onComplete(function(){c.remove(f),jZ(f)}).start())}}})}})},update:function(e){var t=p3(e.ringLat),r=p3(e.ringLng),n=p3(e.ringAltitude),i=e.scene.localToWorld(new WQ.Vector3(0,0,0));e.dataMapper.onUpdateObj(function(e,a){var s=t(a),o=r(a),l=n(a);Object.assign(e.position,j1(s,o,l)),e.lookAt(i)}).digest(e.ringsData)}}),WZ=jV(jV({},window.THREE?window.THREE:{BoxGeometry:rk,CircleGeometry:iU,DoubleSide:2,Group:r$,Mesh:rU,MeshLambertMaterial:aY,TextGeometry:jT,Vector3:ex}),{},{Font:class{generateShapes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=[],n=function(e,t,r){let n=Array.from(e),i=t/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,s=[],o=0,l=0;for(let e=0;e<n.length;e++){let t=n[e];if("\n"===t)o=0,l-=a;else{let e=function(e,t,r,n,i){let a,s,o,l,u,c,h,d,A=i.glyphs[e]||i.glyphs["?"];if(!A)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");let p=new lA;if(A.o){let e=A._cachedOutline||(A._cachedOutline=A.o.split(" "));for(let i=0,A=e.length;i<A;)switch(e[i++]){case"m":a=e[i++]*t+r,s=e[i++]*t+n,p.moveTo(a,s);break;case"l":a=e[i++]*t+r,s=e[i++]*t+n,p.lineTo(a,s);break;case"q":o=e[i++]*t+r,l=e[i++]*t+n,u=e[i++]*t+r,c=e[i++]*t+n,p.quadraticCurveTo(u,c,o,l);break;case"b":o=e[i++]*t+r,l=e[i++]*t+n,u=e[i++]*t+r,c=e[i++]*t+n,h=e[i++]*t+r,d=e[i++]*t+n,p.bezierCurveTo(u,c,h,d,o,l)}}return{offsetX:A.ha*t,path:p}}(t,i,o,l,r);o+=e.offsetX,s.push(e.path)}}return s}(e,t,this.data);for(let e=0,t=n.length;e<t;e++)r.push(...n[e].toShapes());return r}constructor(e){this.isFont=!0,this.type="Font",this.data=e}},TextGeometry:jT}),WJ=c4({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:.002},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:{glyphs:{0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},cssFontWeight:"normal",ascender:1189,underlinePosition:-100,cssFontStyle:"normal",boundingBox:{yMin:-334,xMin:-111,yMax:1189,xMax:1672},resolution:1e3,original_font_information:{postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},descender:-334,familyName:"Helvetiker",lineHeight:1522,underlineThickness:50},onChange:function(e,t){t.font=new WZ.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n;var i=new WZ.CircleGeometry(1,32);t.dataMapper=new Ws(e,{objBindAttr:"__threeObjLabel"}).onCreateObj(function(){var e=new WZ.MeshLambertMaterial;e.side=2;var t=new WZ.Group;t.add(new WZ.Mesh(i,e));var r=new WZ.Mesh(void 0,e);t.add(r);var n=new WZ.Mesh;return n.visible=!1,r.add(n),t.__globeObjType="label",t})},update:function(e){var t=p3(e.labelLat),r=p3(e.labelLng),n=p3(e.labelAltitude),i=p3(e.labelText),a=p3(e.labelSize),s=p3(e.labelRotation),o=p3(e.labelColor),l=p3(e.labelIncludeDot),u=p3(e.labelDotRadius),c=p3(e.labelDotOrientation),h=new Set(["right","top","bottom"]),d=2*Math.PI*100/360;e.dataMapper.onUpdateObj(function(A,p){var f=jj(A.children,2),m=f[0],g=f[1],y=jj(g.children,1)[0],v=o(p),x=j9(v);g.material.color.set(j8(v)),g.material.transparent=x<1,g.material.opacity=x;var _=l(p),b=c(p);!_||h.has(b)||(b="bottom");var S=_?u(p)*d:1e-12;m.scale.x=m.scale.y=S;var T=a(p)*d;if(g.geometry&&g.geometry.dispose(),g.geometry=new WZ.TextGeometry(i(p),{font:e.font,size:T,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),y.geometry&&y.geometry.dispose(),g.geometry.computeBoundingBox(),y.geometry=jL(WZ.BoxGeometry,jX(new WZ.Vector3().subVectors(g.geometry.boundingBox.max,g.geometry.boundingBox.min).clampScalar(0,1/0).toArray())),"right"!==b&&g.geometry.center(),_){var w=S+T/2;"right"===b&&(g.position.x=w),g.position.y=({right:-T/2,top:w+T/2,bottom:-w-T/2})[b]}var M=function(t){var r=A.__currentTargetD=t,n=r.lat,i=r.lng,a=r.alt,s=r.rot,o=r.scale;Object.assign(A.position,j1(n,i,a)),A.lookAt(e.scene.localToWorld(new WZ.Vector3(0,0,0))),A.rotateY(Math.PI),A.rotateZ(-s*Math.PI/180),A.scale.x=A.scale.y=A.scale.z=o},E={lat:+t(p),lng:+r(p),alt:+n(p),rot:+s(p),scale:1},R=A.__currentTargetD||Object.assign({},E,{scale:1e-12});Object.keys(E).some(function(e){return R[e]!==E[e]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?M(E):e.tweenGroup.add(new ht(R).to(E,e.labelsTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(M).start()))}).digest(e.labelsData)}}),W$=jV(jV({},window.THREE?window.THREE:{}),{},{CSS2DObject:class extends tV{copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new ey(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&null!==e.element.parentNode&&e.element.remove()})})}}}),W0=c4({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){e.dataMapper&&(t?[t]:e.dataMapper.entries().map(function(e){return jj(e,2)[1]}).filter(function(e){return e})).forEach(function(t){var r=!e.isBehindGlobe||!e.isBehindGlobe(t.position);e.htmlElementVisibilityModifier?(t.visible=!0,e.htmlElementVisibilityModifier(t.element,r)):t.visible=r})}},init:function(e,t,r){var n=r.tweenGroup;jJ(e),t.scene=e,t.tweenGroup=n,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjHtml"}).onCreateObj(function(e){var r=p3(t.htmlElement)(e),n=new W$.CSS2DObject(r);return n.__globeObjType="html",n})},update:function(e,t){var r=this,n=p3(e.htmlLat),i=p3(e.htmlLng),a=p3(e.htmlAltitude);t.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(t,s){var o=function(e){var n=t.__currentTargetD=e,i=n.alt,a=n.lat,s=n.lng;Object.assign(t.position,j1(a,s,i)),r.updateObjVisibility(t)},l={lat:+n(s),lng:+i(s),alt:+a(s)};e.htmlTransitionDuration&&!(e.htmlTransitionDuration<0)&&t.__currentTargetD?e.tweenGroup.add(new ht(t.__currentTargetD).to(l,e.htmlTransitionDuration).easing(c5.Quadratic.InOut).onUpdate(o).start()):o(l)}).digest(e.htmlElementsData)}}),W1=window.THREE?window.THREE:{Group:r$,Mesh:rU,MeshLambertMaterial:aY,SphereGeometry:aD},W2=c4({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new W1.Mesh(new W1.SphereGeometry(1,16,8),new W1.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){jJ(e),t.scene=e,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjObject"}).onCreateObj(function(e){var r=p3(t.objectThreeObject)(e);t.objectThreeObject===r&&(r=r.clone());var n=new W1.Group;return n.add(r),n.__globeObjType="object",n})},update:function(e,t){var r=p3(e.objectLat),n=p3(e.objectLng),i=p3(e.objectAltitude),a=p3(e.objectFacesSurface),s=p3(e.objectRotation);t.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(e,t){var o=+r(t),l=+n(t),u=+i(t);Object.assign(e.position,j1(o,l,u)),a(t)?e.setRotationFromEuler(new tT(j3(-o),j3(l),0,"YXZ")):e.rotation.set(0,0,0);var c=e.children[0],h=s(t);h&&c.setRotationFromEuler(new tT(j3(h.x||0),j3(h.y||0),j3(h.z||0)))}).digest(e.objectsData)}}),W3=c4({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){jJ(e),t.scene=e,t.dataMapper=new Ws(e,{objBindAttr:"__threeObjCustom"}).onCreateObj(function(e){var r=p3(t.customThreeObject)(e,100);return r&&(t.customThreeObject===r&&(r=r.clone()),r.__globeObjType="custom"),r})},update:function(e,t){e.customThreeObjectUpdate||jJ(e.scene);var r=p3(e.customThreeObjectUpdate);t.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(e,t){return r(e,t,100)}).digest(e.customLayerData)}}),W4=window.THREE?window.THREE:{Camera:rj,Group:r$,Vector2:ey,Vector3:ex},W5=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],W6=j$("globeLayer",j7),W7=Object.assign.apply(Object,jX(["globeImageUrl","bumpImageUrl","globeCurvatureResolution","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(e){return jB({},e,W6.linkProp(e))}))),W8=Object.assign.apply(Object,jX(["globeMaterial"].map(function(e){return jB({},e,W6.linkMethod(e))}))),W9=j$("pointsLayer",Wc),Xe=Object.assign.apply(Object,jX(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(e){return jB({},e,W9.linkProp(e))}))),Xt=j$("arcsLayer",Wv),Xr=Object.assign.apply(Object,jX(["arcsData","arcStartLat","arcStartLng","arcStartAltitude","arcEndLat","arcEndLng","arcEndAltitude","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(e){return jB({},e,Xt.linkProp(e))}))),Xn=j$("hexBinLayer",WS),Xi=Object.assign.apply(Object,jX(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(e){return jB({},e,Xn.linkProp(e))}))),Xa=j$("heatmapsLayer",WP),Xs=Object.assign.apply(Object,jX(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(e){return jB({},e,Xa.linkProp(e))}))),Xo=j$("hexedPolygonsLayer",WU),Xl=Object.assign.apply(Object,jX(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(e){return jB({},e,Xo.linkProp(e))}))),Xu=j$("polygonsLayer",WL),Xc=Object.assign.apply(Object,jX(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(e){return jB({},e,Xu.linkProp(e))}))),Xh=j$("pathsLayer",WV),Xd=Object.assign.apply(Object,jX(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(e){return jB({},e,Xh.linkProp(e))}))),XA=j$("tilesLayer",WG),Xp=Object.assign.apply(Object,jX(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(e){return jB({},e,XA.linkProp(e))}))),Xf=j$("particlesLayer",WW),Xm=Object.assign.apply(Object,jX(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map(function(e){return jB({},e,Xf.linkProp(e))}))),Xg=j$("ringsLayer",WK),Xy=Object.assign.apply(Object,jX(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(e){return jB({},e,Xg.linkProp(e))}))),Xv=j$("labelsLayer",WJ),Xx=Object.assign.apply(Object,jX(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(e){return jB({},e,Xv.linkProp(e))}))),X_=j$("htmlElementsLayer",W0),Xb=Object.assign.apply(Object,jX(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map(function(e){return jB({},e,X_.linkProp(e))}))),XS=j$("objectsLayer",W2),XT=Object.assign.apply(Object,jX(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(e){return jB({},e,XS.linkProp(e))}))),Xw=j$("customLayer",W3),XM=Object.assign.apply(Object,jX(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(e){return jB({},e,Xw.linkProp(e))}))),XE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=function(t){function n(){var t;jC(this,n);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return(t=jR(this,n,[].concat(a))).__kapsuleInstance=jL(e,[].concat(jX(r?[t]:[]),a)),t}return jO(n,t),jD(n)}(t);return Object.keys(e()).forEach(function(e){return n.prototype[e]=function(){var t,r=(t=this.__kapsuleInstance)[e].apply(t,arguments);return r===this.__kapsuleInstance?this:r}}),n}(c4({props:jV(jV(jV(jV(jV(jV(jV(jV(jV(jV(jV(jV(jV(jV(jV({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new W4.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},W7),Xe),Xr),Xi),Xs),Xc),Xl),Xd),Xp),Xm),Xy),Xx),Xb),XT),XM),methods:jV({getGlobeRadius:j0,getCoords:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return j1.apply(void 0,r)},toGeoCoords:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return j2.apply(void 0,r)},setPointOfView:function(e,t){var r,n,i,a,s=t instanceof W4.Camera?t.position:t,o=j0(),l=void 0;e.scene&&s&&(l=function(t){void 0===r&&(r=s.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),void 0===n&&(n=r.length()),void 0===i&&(i=Math.sqrt(Math.pow(n,2)-Math.pow(o,2))),void 0===a&&(a=Math.acos(i/n));var l=r.distanceTo(t);if(l<i)return!1;var u=t.length();return Math.acos((Math.pow(n,2)+Math.pow(l,2)-Math.pow(u,2))/(2*n*l))<a}),e.layersThatNeedUpdatePov.forEach(function(e){return e.updatePov(t)}),e.layersThatNeedBehindGlobeChecker.forEach(function(e){return e.isBehindGlobe(l)})},pauseAnimation:function(e){return null!==e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(e){var t;return null==(t=e.pauseAnimation)?void 0:t.call(e)}),this},resumeAnimation:function(e){return null===e.animationFrameRequestId&&this._animationCycle(),e.pausableLayers.forEach(function(e){var t;return null==(t=e.resumeAnimation)?void 0:t.call(e)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(e){return e._destructor()})}},W8),stateInit:function(){var e=new c7,t={tweenGroup:e},r={globeLayer:j7(t),pointsLayer:Wc(t),arcsLayer:Wv(t),hexBinLayer:WS(t),heatmapsLayer:WP(t),polygonsLayer:WL(t),hexedPolygonsLayer:WU(t),pathsLayer:WV(t),tilesLayer:WG(t),particlesLayer:WW(t),ringsLayer:WK(t),labelsLayer:WJ(t),htmlElementsLayer:W0(t),objectsLayer:W2(t),customLayer:W3(t)};return jV(jV({tweenGroup:e},r),{},{layersThatNeedUpdatePov:Object.values(r).filter(function(e){return e.hasOwnProperty("updatePov")}),layersThatNeedBehindGlobeChecker:Object.values(r).filter(function(e){return e.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(r).filter(function(e){return e.hasOwnProperty("_destructor")}),pausableLayers:Object.values(r).filter(function(e){return e.hasOwnProperty("pauseAnimation")})})},init:function(e,t,r){var n=r.animateIn,i=void 0===n||n,a=r.waitForGlobeReady;jJ(e),t.scene=e,t.scene.visible=!1,W5.forEach(function(e){var r=new W4.Group;t.scene.add(r),t[e](r)});var s=function(){if(i){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new ht({k:1e-6}).to({k:1},600).easing(c5.Quadratic.Out).onUpdate(function(e){var r=e.k;return t.scene.scale.set(r,r,r)}).start());var e=new W4.Vector3(0,1,0);t.tweenGroup.add(new ht({rot:2*Math.PI}).to({rot:0},1200).easing(c5.Quintic.Out).onUpdate(function(r){var n=r.rot;return t.scene.setRotationFromAxisAngle(e,n)}).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};void 0===a||a?t.globeLayer.onReady(s):s(),this._animationCycle()},update:function(e){}}),(window.THREE?window.THREE:{Group:r$}).Group,!0);e.i(47167);var XR=X,XC=e.i(39695),XN=e.i(30224);let XP=e=>{let t,r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,a={setState:n,getState:i,getInitialState:()=>s,subscribe:e=>(r.add(e),()=>r.delete(e))},s=t=e(n,i,a);return a},{useSyncExternalStoreWithSelector:XI}=XN.default,XL=e=>e,XD=(e,t)=>{let r=(e=>e?XP(e):XP)(e),n=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:XL,r=arguments.length>2?arguments[2]:void 0,n=XI(e.subscribe,e.getState,e.getInitialState,t,r);return X.default.useDebugValue(n),n}(r,e,n)};return Object.assign(n,r),n},XB=[];function XF(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;let n=e.length;if(t.length!==n)return!1;for(let i=0;i<n;i++)if(!r(e[i],t[i]))return!1;return!0}function XU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(let i of(null===t&&(t=[e]),XB))if(XF(t,i.keys,i.equal)){if(r)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return n.lifespan&&n.lifespan>0&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.remove,n.lifespan)),i.response;if(!r)throw i.promise}let i={keys:t,equal:n.equal,remove:()=>{let e=XB.indexOf(i);-1!==e&&XB.splice(e,1)},promise:("object"==typeof e&&"function"==typeof e.then?e:e(...t)).then(e=>{i.response=e,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(e=>i.error=e)};if(XB.push(i),!r)throw i.promise}var XO=e.i(98133),Xk=e.i(95087),Xz=X;function XV(e,t,r){if(!e)return;if(!0===r(e))return e;let n=t?e.return:e.child;for(;n;){let e=XV(n,t,r);if(e)return e;n=t?null:n.sibling}}function Xq(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}(()=>{var e,t;return"undefined"!=typeof window&&((null==(e=window.document)?void 0:e.createElement)||(null==(t=window.navigator)?void 0:t.product)==="ReactNative")})()?Xz.useLayoutEffect:Xz.useEffect;let XG=Xq(Xz.createContext(null));class XH extends Xz.Component{render(){return Xz.createElement(XG.Provider,{value:this._reactInternals},this.props.children)}}function Xj(){let e=Xz.useContext(XG);if(null===e)throw Error("its-fine: useFiber must be called within a <FiberProvider />!");let t=Xz.useId();return Xz.useMemo(()=>{for(let r of[e,null==e?void 0:e.alternate]){if(!r)continue;let e=XV(r,!1,e=>{let r=e.memoizedState;for(;r;){if(r.memoizedState===t)return!0;r=r.next}});if(e)return e}},[e,t])}let XW=Symbol.for("react.context"),XX=e=>null!==e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===XW;function XQ(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}XR.act;let XY=e=>null!=e&&("string"==typeof e||"number"==typeof e||e.isColor),XK=((e,t)=>"undefined"!=typeof window&&((null==(e=window.document)?void 0:e.createElement)||(null==(t=window.navigator)?void 0:t.product)==="ReactNative"))()?XR.useLayoutEffect:XR.useEffect;function XZ(e){let t=XR.useRef(e);return XK(()=>void(t.current=e),[e]),t}function XJ(e){let{set:t}=e;return XK(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}let X$=(e=>((e=class extends XR.Component{componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}constructor(...e){super(...e),this.state={error:!1}}}).getDerivedStateFromError=()=>({error:!0}),e))();function X0(e){var t;let r="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}function X1(e){var t;return null==(t=e.__r3f)?void 0:t.root.getState()}let X2={obj:e=>e===Object(e)&&!X2.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,nul:e=>null===e,arr:e=>Array.isArray(e),equ(e,t){let r,{arrays:n="shallow",objects:i="reference",strict:a=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!=typeof t||!!e!=!!t)return!1;if(X2.str(e)||X2.num(e)||X2.boo(e))return e===t;let s=X2.obj(e);if(s&&"reference"===i)return e===t;let o=X2.arr(e);if(o&&"reference"===n)return e===t;if((o||s)&&e===t)return!0;for(r in e)if(!(r in t))return!1;if(s&&"shallow"===n&&"shallow"===i){for(r in a?t:e)if(!X2.equ(e[r],t[r],{strict:a,objects:"reference"}))return!1}else for(r in a?t:e)if(e[r]!==t[r])return!1;if(X2.und(r)){if(o&&0===e.length&&0===t.length||s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}},X3=["children","key","ref"];function X4(e,t,r,n){let i=null==e?void 0:e.__r3f;return!i&&(i={root:t,type:r,parent:null,children:[],props:function(e){let t={};for(let r in e)X3.includes(r)||(t[r]=e[r]);return t}(n),object:e,eventCount:0,handlers:{},isHidden:!1},e&&(e.__r3f=i)),i}function X5(e,t){let r=e[t];if(!t.includes("-"))return{root:e,key:t,target:r};for(let i of(r=e,t.split("-"))){var n;t=i,e=r,r=null==(n=r)?void 0:n[t]}return{root:e,key:t,target:r}}let X6=/-\d+$/;function X7(e,t){if(X2.str(t.props.attach)){if(X6.test(t.props.attach)){let r=t.props.attach.replace(X6,""),{root:n,key:i}=X5(e.object,r);Array.isArray(n[i])||(n[i]=[])}let{root:r,key:n}=X5(e.object,t.props.attach);t.previousAttach=r[n],r[n]=t.object}else X2.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function X8(e,t){if(X2.str(t.props.attach)){let{root:r,key:n}=X5(e.object,t.props.attach),i=t.previousAttach;void 0===i?delete r[n]:r[n]=i}else null==t.previousAttach||t.previousAttach(e.object,t.object);delete t.previousAttach}let X9=[...X3,"args","dispose","attach","object","onUpdate","dispose"],Qe=new Map,Qt=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Qr=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Qn(e,t){var r,n;let i=e.__r3f,a=i&&XQ(i).getState(),s=null==i?void 0:i.eventCount;for(let r in t){let s=t[r];if(X9.includes(r))continue;if(i&&Qr.test(r)){"function"==typeof s?i.handlers[r]=s:delete i.handlers[r],i.eventCount=Object.keys(i.handlers).length;continue}if(void 0===s)continue;let{root:o,key:l,target:u}=X5(e,r);u instanceof tw&&s instanceof tw?u.mask=s.mask:u instanceof t6&&XY(s)?u.set(s):null!==u&&"object"==typeof u&&"function"==typeof u.set&&"function"==typeof u.copy&&null!=s&&s.constructor&&u.constructor===s.constructor?u.copy(s):null!==u&&"object"==typeof u&&"function"==typeof u.set&&Array.isArray(s)?"function"==typeof u.fromArray?u.fromArray(s):u.set(...s):null!==u&&"object"==typeof u&&"function"==typeof u.set&&"number"==typeof s?"function"==typeof u.setScalar?u.setScalar(s):u.set(s):(o[l]=s,a&&!a.linear&&Qt.includes(l)&&null!=(n=o[l])&&n.isTexture&&1023===o[l].format&&1009===o[l].type&&(o[l].colorSpace=J))}if(null!=i&&i.parent&&null!=a&&a.internal&&null!=(r=i.object)&&r.isObject3D&&s!==i.eventCount){let e=i.object,t=a.internal.interaction.indexOf(e);t>-1&&a.internal.interaction.splice(t,1),i.eventCount&&null!==e.raycast&&a.internal.interaction.push(e)}return i&&void 0===i.props.attach&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&Qi(i),e}function Qi(e){var t;if(!e.parent)return;null==e.props.onUpdate||e.props.onUpdate(e.object);let r=null==(t=e.root)||null==t.getState?void 0:t.getState();r&&0===r.internal.frames&&r.invalidate()}let Qa=e=>null==e?void 0:e.isObject3D;function Qs(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Qo(e,t,r,n){let i=r.get(t);i&&(r.delete(t),0===r.size&&(e.delete(n),i.target.releasePointerCapture(n)))}let Ql=e=>!!(null!=e&&e.render),Qu=XR.createContext(null);function Qc(){let e=XR.useContext(Qu);if(!e)throw Error("R3F: Hooks can only be used within the Canvas component!");return e}function Qh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return Qc()(e,t)}let Qd=new WeakMap;function QA(e,t){return function(r){let n;for(var i,a=arguments.length,s=Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];return"function"==typeof r&&(null==r||null==(i=r.prototype)?void 0:i.constructor)===r?(n=Qd.get(r))||(n=new r,Qd.set(r,n)):n=r,e&&e(n),Promise.all(s.map(e=>new Promise((r,i)=>n.load(e,e=>{Qa(null==e?void 0:e.scene)&&Object.assign(e,function(e){let t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material),e.isMesh&&!t.meshes[e.name]&&(t.meshes[e.name]=e)}),t}(e.scene)),r(e)},t,t=>i(Error("Could not load ".concat(e,": ").concat(null==t?void 0:t.message)))))))}}function Qp(e,t,r,n){let i=Array.isArray(t)?t:[t],a=XU(QA(r,n),[e,...i],!1,{equal:X2.equ});return Array.isArray(t)?a:a[0]}Qp.preload=function(e,t,r){let n,i=Array.isArray(t)?t:[t];XU(QA(r),[e,...i],!0,n)},Qp.clear=function(e,t){var r=[e,...Array.isArray(t)?t:[t]];if(void 0===r||0===r.length)XB.splice(0,XB.length);else{let e=XB.find(e=>XF(r,e.keys,e.equal));e&&e.remove()}};let Qf={},Qm=/^three(?=[A-Z])/,Qg=e=>"".concat(e[0].toUpperCase()).concat(e.slice(1)),Qy=0;function Qv(e){if("function"==typeof e){let t="".concat(Qy++);return Qf[t]=e,t}Object.assign(Qf,e)}function Qx(e,t){let r=Qg(e),n=Qf[r];if("primitive"!==e&&!n)throw Error("R3F: ".concat(r," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if("primitive"===e&&!t.object)throw Error("R3F: Primitives without 'object' are invalid!");if(void 0!==t.args&&!Array.isArray(t.args))throw Error("R3F: The args prop must be an array!")}function Q_(e){if(e.isHidden){var t;e.props.attach&&null!=(t=e.parent)&&t.object?X7(e.parent,e):Qa(e.object)&&!1!==e.props.visible&&(e.object.visible=!0),e.isHidden=!1,Qi(e)}}function Qb(e,t,r){let n=t.root.getState();if(e.parent||e.object===n.scene){if(!t.object){var i,a;let e=Qf[Qg(t.type)];t.object=null!=(i=t.props.object)?i:new e(...null!=(a=t.props.args)?a:[]),t.object.__r3f=t}if(Qn(t.object,t.props),t.props.attach)X7(e,t);else if(Qa(t.object)&&Qa(e.object)){let n=e.object.children.indexOf(null==r?void 0:r.object);if(r&&-1!==n){let r=e.object.children.indexOf(t.object);-1!==r?(e.object.children.splice(r,1),e.object.children.splice(r<n?n-1:n,0,t.object)):(t.object.parent=e.object,e.object.children.splice(n,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object}))}else e.object.add(t.object)}for(let e of t.children)Qb(t,e);Qi(t)}}function QS(e,t){t&&(t.parent=e,e.children.push(t),Qb(e,t))}function QT(e,t,r){if(!t||!r)return;t.parent=e;let n=e.children.indexOf(r);-1!==n?e.children.splice(n,0,t):e.children.push(t),Qb(e,t,r)}function Qw(e){if("function"==typeof e.dispose){let t=()=>{try{e.dispose()}catch(e){}};"undefined"!=typeof IS_REACT_ACT_ENVIRONMENT?t():(0,Xk.unstable_scheduleCallback)(Xk.unstable_IdlePriority,t)}}function QM(e,t,r){if(!t)return;t.parent=null;let n=e.children.indexOf(t);-1!==n&&e.children.splice(n,1),t.props.attach?X8(e,t):Qa(t.object)&&Qa(e.object)&&(e.object.remove(t.object),function(e,t){let{internal:r}=e.getState();r.interaction=r.interaction.filter(e=>e!==t),r.initialHits=r.initialHits.filter(e=>e!==t),r.hovered.forEach((e,n)=>{(e.eventObject===t||e.object===t)&&r.hovered.delete(n)}),r.capturedMap.forEach((e,n)=>{Qo(r.capturedMap,t,e,n)})}(XQ(t),t.object));let i=null!==t.props.dispose&&!1!==r;for(let e=t.children.length-1;e>=0;e--){let r=t.children[e];QM(t,r,i)}t.children.length=0,delete t.object.__r3f,i&&"primitive"!==t.type&&"Scene"!==t.object.type&&Qw(t.object),void 0===r&&Qi(t)}let QE=[],QR=()=>{},QC={},QN=0,QP=function(e){let t=(0,XO.default)(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:XR.version}),t}({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:function(e,t,r){var n;return Qx(e=Qg(e)in Qf?e:e.replace(Qm,""),t),"primitive"===e&&null!=(n=t.object)&&n.__r3f&&delete t.object.__r3f,X4(t.object,r,e,t)},removeChild:QM,appendChild:QS,appendInitialChild:QS,insertBefore:QT,appendChildToContainer(e,t){let r=e.getState().scene.__r3f;t&&r&&QS(r,t)},removeChildFromContainer(e,t){let r=e.getState().scene.__r3f;t&&r&&QM(r,t)},insertInContainerBefore(e,t,r){let n=e.getState().scene.__r3f;t&&r&&n&&QT(n,t,r)},getRootHostContext:()=>QC,getChildHostContext:()=>QC,commitUpdate(e,t,r,n,i){var a,s,o;Qx(t,n);let l=!1;if("primitive"===e.type&&r.object!==n.object||(null==(a=n.args)?void 0:a.length)!==(null==(s=r.args)?void 0:s.length)?l=!0:null!=(o=n.args)&&o.some((e,t)=>{var n;return e!==(null==(n=r.args)?void 0:n[t])})&&(l=!0),l)QE.push([e,{...n},i]);else{let t=function(e,t){let r={};for(let n in t)if(!X9.includes(n)&&!X2.equ(t[n],e.props[n]))for(let e in r[n]=t[n],t)e.startsWith("".concat(n,"-"))&&(r[e]=t[e]);for(let n in e.props){if(X9.includes(n)||t.hasOwnProperty(n))continue;let{root:i,key:a}=X5(e.object,n);if(i.constructor&&0===i.constructor.length){let e=function(e){let t=Qe.get(e.constructor);try{t||(t=new e.constructor,Qe.set(e.constructor,t))}catch(e){}return t}(i);X2.und(e)||(r[a]=e[a])}else r[a]=0}return r}(e,n);Object.keys(t).length&&(Object.assign(e.props,t),Qn(e.object,t))}(null===i.sibling||(4&i.flags)==0)&&function(){for(let[e]of QE){let t=e.parent;if(t)for(let r of(e.props.attach?X8(t,e):Qa(e.object)&&Qa(t.object)&&t.object.remove(e.object),e.children))r.props.attach?X8(e,r):Qa(r.object)&&Qa(e.object)&&e.object.remove(r.object);e.isHidden&&Q_(e),e.object.__r3f&&delete e.object.__r3f,"primitive"!==e.type&&Qw(e.object)}for(let[n,i,a]of QE){n.props=i;let s=n.parent;if(s){let i=Qf[Qg(n.type)];n.object=null!=(e=n.props.object)?e:new i(...null!=(t=n.props.args)?t:[]),n.object.__r3f=n;var e,t,r=n.object;for(let e of[a,a.alternate])if(null!==e)if("function"==typeof e.ref){null==e.refCleanup||e.refCleanup();let t=e.ref(r);"function"==typeof t&&(e.refCleanup=t)}else e.ref&&(e.ref.current=r);for(let e of(Qn(n.object,n.props),n.props.attach?X7(s,n):Qa(n.object)&&Qa(s.object)&&s.object.add(n.object),n.children))e.props.attach?X7(n,e):Qa(e.object)&&Qa(n.object)&&n.object.add(e.object);Qi(n)}}QE.length=0}()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>null==e?void 0:e.object,prepareForCommit:()=>null,preparePortalMount:e=>X4(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:function(e){if(!e.isHidden){var t;e.props.attach&&null!=(t=e.parent)&&t.object?X8(e.parent,e):Qa(e.object)&&(e.object.visible=!1),e.isHidden=!0,Qi(e)}},unhideInstance:Q_,createTextInstance:QR,hideTextInstance:QR,unhideTextInstance:QR,scheduleTimeout:"function"==typeof setTimeout?setTimeout:void 0,cancelTimeout:"function"==typeof clearTimeout?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:XR.createContext(null),setCurrentUpdatePriority(e){QN=e},getCurrentUpdatePriority:()=>QN,resolveUpdatePriority(){var e;if(0!==QN)return QN;switch("undefined"!=typeof window&&(null==(e=window.event)?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return XC.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return XC.ContinuousEventPriority;default:return XC.DefaultEventPriority}},resetFormInstance(){}}),QI=new Map,QL={objects:"shallow",strict:!1};function QD(e){let{store:t,children:r,onCreated:n,rootElement:i}=e;return XK(()=>{let e=t.getState();e.set(e=>({internal:{...e.internal,active:!0}})),n&&n(e),t.getState().events.connected||null==e.events.connect||e.events.connect(i)},[]),(0,W.jsx)(Qu.Provider,{value:t,children:r})}function QB(e,t){let r=QI.get(e),n=null==r?void 0:r.fiber;if(n){let i=null==r?void 0:r.store.getState();i&&(i.internal.active=!1),QP.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{null==i.events.disconnect||i.events.disconnect(),null==(r=i.gl)||null==(n=r.renderLists)||null==n.dispose||n.dispose(),null==(a=i.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(s=i.gl)&&s.xr&&i.xr.disconnect();var r,n,a,s,o=i.scene;for(let e in"Scene"!==o.type&&(null==o.dispose||o.dispose()),o){let t=o[e];(null==t?void 0:t.type)!=="Scene"&&(null==t||null==t.dispose||t.dispose())}QI.delete(e),t&&t(e)}catch(e){}},500)})}}let QF=new Set,QU=new Set,QO=new Set;function Qk(e,t){if(e.size)for(let{callback:r}of e.values())r(t)}function Qz(e,t){switch(e){case"before":return Qk(QF,t);case"after":return Qk(QU,t);case"tail":return Qk(QO,t)}}function QV(e,t,r){let n=t.clock.getDelta();"never"===t.frameloop&&"number"==typeof e&&(n=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),p=t.internal.subscribers;for(let e=0;e<p.length;e++)(f=p[e]).ref.current(f.store.getState(),n,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}let Qq=!1,QG=!1;function QH(e){for(let r of(g=requestAnimationFrame(QH),Qq=!0,m=0,Qz("before",e),QG=!0,QI.values())){var t;(y=r.store.getState()).internal.active&&("always"===y.frameloop||y.internal.frames>0)&&!(null!=(t=y.gl.xr)&&t.isPresenting)&&(m+=QV(e,y))}if(QG=!1,Qz("after",e),0===m)return Qz("tail",e),Qq=!1,cancelAnimationFrame(g)}function Qj(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return QI.forEach(e=>Qj(e.store.getState(),r));(null==(t=e.gl.xr)||!t.isPresenting)&&e.internal.active&&"never"!==e.frameloop&&(r>1?e.internal.frames=Math.min(60,e.internal.frames+r):QG?e.internal.frames=2:e.internal.frames=1,Qq||(Qq=!0,requestAnimationFrame(QH)))}function QW(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(t&&Qz("before",e),r)QV(e,r,n);else for(let t of QI.values())QV(e,t.store.getState());t&&Qz("after",e)}let QX={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function QQ(e){let{handlePointer:t}=function(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var r;return null==(r=e.__r3f)?void 0:r.handlers["onPointer"+t]}))}function r(t){let{internal:r}=e.getState();for(let e of r.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){let n=e.eventObject.__r3f;if(r.hovered.delete(Qs(e)),null!=n&&n.eventCount){let r=n.handlers,i={...e,intersections:t};null==r.onPointerOut||r.onPointerOut(i),null==r.onPointerLeave||r.onPointerLeave(i)}}}function n(e,t){for(let r=0;r<t.length;r++){let n=t[r].__r3f;null==n||null==n.handlers.onPointerMissed||n.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return t=>{let{internal:n}=e.getState();"pointerId"in t&&n.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{n.capturedMap.has(t.pointerId)&&(n.capturedMap.delete(t.pointerId),r([]))})}}return function(a){let{onPointerMissed:s,internal:o}=e.getState();o.lastEvent.current=a;let l="onPointerMove"===i,u="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,c=function(t,r){let n=e.getState(),i=new Set,a=[],s=r?r(n.internal.interaction):n.internal.interaction;for(let e=0;e<s.length;e++){let t=X1(s[e]);t&&(t.raycaster.camera=void 0)}n.previousRoot||null==n.events.compute||n.events.compute(t,n);let o=s.flatMap(function(e){let r=X1(e);if(!r||!r.events.enabled||null===r.raycaster.camera)return[];if(void 0===r.raycaster.camera){var n;null==r.events.compute||r.events.compute(t,r,null==(n=r.previousRoot)?void 0:n.getState()),void 0===r.raycaster.camera&&(r.raycaster.camera=null)}return r.raycaster.camera?r.raycaster.intersectObject(e,!0):[]}).sort((e,t)=>{let r=X1(e.object),n=X1(t.object);return r&&n&&n.events.priority-r.events.priority||e.distance-t.distance}).filter(e=>{let t=Qs(e);return!i.has(t)&&(i.add(t),!0)});for(let e of(n.events.filter&&(o=n.events.filter(o,n)),o)){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&a.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&n.internal.capturedMap.has(t.pointerId))for(let e of n.internal.capturedMap.get(t.pointerId).values())i.has(Qs(e.intersection))||a.push(e.intersection);return a}(a,l?t:void 0),h=u?function(t){let{internal:r}=e.getState(),n=t.offsetX-r.initialClick[0],i=t.offsetY-r.initialClick[1];return Math.round(Math.sqrt(n*n+i*i))}(a):0;"onPointerDown"===i&&(o.initialClick=[a.offsetX,a.offsetY],o.initialHits=c.map(e=>e.eventObject)),u&&!c.length&&h<=2&&(n(a,o.interaction),s&&s(a)),l&&r(c),!function(e,t,n,i){if(e.length){let a={stopped:!1};for(let s of e){let o=X1(s.object);if(o||s.object.traverseAncestors(e=>{let t=X1(e);if(t)return o=t,!1}),o){let{raycaster:l,pointer:u,camera:c,internal:h}=o,d=new ex(u.x,u.y,0).unproject(c),A=e=>{var t,r;return null!=(t=null==(r=h.capturedMap.get(e))?void 0:r.has(s.eventObject))&&t},p=e=>{let r={intersection:s,target:t.target};h.capturedMap.has(e)?h.capturedMap.get(e).set(s.eventObject,r):h.capturedMap.set(e,new Map([[s.eventObject,r]])),t.target.setPointerCapture(e)},f=e=>{let t=h.capturedMap.get(e);t&&Qo(h.capturedMap,s.eventObject,t,e)},m={};for(let e in t){let r=t[e];"function"!=typeof r&&(m[e]=r)}let g={...s,...m,pointer:u,intersections:e,stopped:a.stopped,delta:n,unprojectedPoint:d,ray:l.ray,camera:c,stopPropagation(){let n="pointerId"in t&&h.capturedMap.get(t.pointerId);(!n||n.has(s.eventObject))&&(g.stopped=a.stopped=!0,h.hovered.size&&Array.from(h.hovered.values()).find(e=>e.eventObject===s.eventObject)&&r([...e.slice(0,e.indexOf(s)),s]))},target:{hasPointerCapture:A,setPointerCapture:p,releasePointerCapture:f},currentTarget:{hasPointerCapture:A,setPointerCapture:p,releasePointerCapture:f},nativeEvent:t};if(i(g),!0===a.stopped)break}}}}(c,a,h,function(e){let t=e.eventObject,r=t.__r3f;if(!(null!=r&&r.eventCount))return;let s=r.handlers;if(l){if(s.onPointerOver||s.onPointerEnter||s.onPointerOut||s.onPointerLeave){let t=Qs(e),r=o.hovered.get(t);r?r.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==s.onPointerOver||s.onPointerOver(e),null==s.onPointerEnter||s.onPointerEnter(e))}null==s.onPointerMove||s.onPointerMove(e)}else{let r=s[i];r?(!u||o.initialHits.includes(t))&&(n(a,o.interaction.filter(e=>!o.initialHits.includes(e))),r(e)):u&&o.initialHits.includes(t)&&n(a,o.interaction.filter(e=>!o.initialHits.includes(e)))}})}}}}(e);return{priority:1,enabled:!0,compute(e,t,r){t.pointer.set(e.offsetX/t.size.width*2-1,-(2*(e.offsetY/t.size.height))+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(QX).reduce((e,r)=>({...e,[r]:t(r)}),{}),update:()=>{var t;let{events:r,internal:n}=e.getState();null!=(t=n.lastEvent)&&t.current&&r.handlers&&r.handlers.onPointerMove(n.lastEvent.current)},connect:t=>{let{set:r,events:n}=e.getState();if(null==n.disconnect||n.disconnect(),r(e=>({events:{...e.events,connected:t}})),n.handlers)for(let e in n.handlers){let r=n.handlers[e],[i,a]=QX[e];t.addEventListener(i,r,{passive:a})}},disconnect:()=>{let{set:t,events:r}=e.getState();if(r.connected){if(r.handlers)for(let e in r.handlers){let t=r.handlers[e],[n]=QX[e];r.connected.removeEventListener(n,t)}t(e=>({events:{...e.events,connected:void 0}}))}}}}e.s(["ACESFilmicToneMapping",()=>4,"AddEquation",()=>100,"AddOperation",()=>2,"AdditiveAnimationBlendMode",()=>2501,"AdditiveBlending",()=>2,"AgXToneMapping",()=>6,"AlphaFormat",()=>1021,"AlwaysCompare",()=>519,"AlwaysDepth",()=>1,"AlwaysStencilFunc",()=>519,"AmbientLight",()=>sk,"AnimationAction",()=>o_,"AnimationClip",()=>sl,"AnimationLoader",()=>sm,"AnimationMixer",()=>oS,"AnimationObjectGroup",()=>ox,"AnimationUtils",()=>a5,"ArcCurve",()=>iY,"ArrayCamera",()=>s5,"ArrowHelper",()=>lh,"AttachedBindMode",()=>K,"Audio",()=>on,"AudioAnalyser",()=>ou,"AudioContext",()=>s$,"AudioListener",()=>or,"AudioLoader",()=>s0,"AxesHelper",()=>ld,"BackSide",()=>1,"BasicDepthPacking",()=>3200,"BasicShadowMap",()=>0,"BatchedMesh",()=>ii,"Bone",()=>nM,"BooleanKeyframeTrack",()=>st,"Box2",()=>oz,"Box3",()=>eZ,"Box3Helper",()=>ll,"BoxGeometry",()=>rk,"BoxHelper",()=>lo,"BufferAttribute",()=>rl,"BufferGeometry",()=>rw,"BufferGeometryLoader",()=>sW,"ByteType",()=>1010,"Cache",()=>su,"Camera",()=>rj,"CameraHelper",()=>li,"CanvasTexture",()=>iL,"CapsuleGeometry",()=>iF,"CatmullRomCurve3",()=>i1,"CineonToneMapping",()=>3,"CircleGeometry",()=>iU,"ClampToEdgeWrapping",()=>1001,"Clock",()=>s6,"Color",()=>t6,"ColorKeyframeTrack",()=>sr,"ColorManagement",()=>eD,"CompressedArrayTexture",()=>iP,"CompressedCubeTexture",()=>iI,"CompressedTexture",()=>iN,"CompressedTextureLoader",()=>sg,"ConeGeometry",()=>ik,"ConstantAlphaFactor",()=>213,"ConstantColorFactor",()=>211,"Controls",()=>lp,"CubeCamera",()=>rK,"CubeReflectionMapping",()=>301,"CubeRefractionMapping",()=>302,"CubeTexture",()=>rZ,"CubeTextureLoader",()=>sx,"CubeUVReflectionMapping",()=>306,"CubicBezierCurve",()=>i5,"CubicBezierCurve3",()=>i6,"CubicInterpolant",()=>a7,"CullFaceBack",()=>1,"CullFaceFront",()=>2,"CullFaceFrontBack",()=>3,"CullFaceNone",()=>0,"Curve",()=>iX,"CurvePath",()=>an,"CustomBlending",()=>5,"CustomToneMapping",()=>5,"CylinderGeometry",()=>iO,"Cylindrical",()=>oU,"Data3DTexture",()=>eY,"DataArrayTexture",()=>eX,"DataTexture",()=>nE,"DataTextureLoader",()=>s_,"DataUtils",()=>ri,"DecrementStencilOp",()=>7683,"DecrementWrapStencilOp",()=>34056,"DefaultLoadingManager",()=>sh,"DepthFormat",()=>1026,"DepthStencilFormat",()=>1027,"DepthTexture",()=>iD,"DetachedBindMode",()=>Z,"DirectionalLight",()=>sO,"DirectionalLightHelper",()=>lt,"DiscreteInterpolant",()=>a9,"DodecahedronGeometry",()=>iV,"DoubleSide",()=>2,"DstAlphaFactor",()=>206,"DstColorFactor",()=>208,"DynamicCopyUsage",()=>35050,"DynamicDrawUsage",()=>35048,"DynamicReadUsage",()=>35049,"EdgesGeometry",()=>iW,"EllipseCurve",()=>iQ,"EqualCompare",()=>514,"EqualDepth",()=>4,"EqualStencilFunc",()=>514,"EquirectangularReflectionMapping",()=>303,"EquirectangularRefractionMapping",()=>304,"Euler",()=>tT,"EventDispatcher",()=>es,"ExternalTexture",()=>iB,"ExtrudeGeometry",()=>aM,"FileLoader",()=>sf,"Float16BufferAttribute",()=>rm,"Float32BufferAttribute",()=>rg,"FloatType",()=>1015,"Fog",()=>r3,"FogExp2",()=>r2,"FramebufferTexture",()=>iC,"FrontSide",()=>0,"Frustum",()=>nX,"FrustumArray",()=>nK,"GLBufferAttribute",()=>oC,"GLSL1",()=>"100","GLSL3",()=>er,"GreaterCompare",()=>516,"GreaterDepth",()=>6,"GreaterEqualCompare",()=>518,"GreaterEqualDepth",()=>5,"GreaterEqualStencilFunc",()=>518,"GreaterStencilFunc",()=>516,"GridHelper",()=>o6,"Group",()=>r$,"HalfFloatType",()=>1016,"HemisphereLight",()=>sT,"HemisphereLightHelper",()=>o5,"IcosahedronGeometry",()=>aR,"ImageBitmapLoader",()=>sJ,"ImageLoader",()=>sv,"ImageUtils",()=>eU,"IncrementStencilOp",()=>7682,"IncrementWrapStencilOp",()=>34055,"InstancedBufferAttribute",()=>nP,"InstancedBufferGeometry",()=>sj,"InstancedInterleavedBuffer",()=>oR,"InstancedMesh",()=>nk,"Int16BufferAttribute",()=>rd,"Int32BufferAttribute",()=>rp,"Int8BufferAttribute",()=>ru,"IntType",()=>1013,"InterleavedBuffer",()=>r5,"InterleavedBufferAttribute",()=>r7,"Interpolant",()=>a6,"InterpolateDiscrete",()=>2300,"InterpolateLinear",()=>2301,"InterpolateSmooth",()=>2302,"InterpolationSamplingMode",()=>ea,"InterpolationSamplingType",()=>ei,"InvertStencilOp",()=>5386,"KeepStencilOp",()=>7680,"KeyframeTrack",()=>se,"LOD",()=>nf,"LatheGeometry",()=>aC,"Layers",()=>tw,"LessCompare",()=>513,"LessDepth",()=>2,"LessEqualCompare",()=>515,"LessEqualDepth",()=>3,"LessEqualStencilFunc",()=>515,"LessStencilFunc",()=>513,"Light",()=>sS,"LightProbe",()=>sq,"Line",()=>iA,"Line3",()=>oQ,"LineBasicMaterial",()=>ia,"LineCurve",()=>i7,"LineCurve3",()=>i8,"LineDashedMaterial",()=>a$,"LineLoop",()=>iv,"LineSegments",()=>iy,"LinearFilter",()=>1006,"LinearInterpolant",()=>a8,"LinearMipMapLinearFilter",()=>1008,"LinearMipMapNearestFilter",()=>1007,"LinearMipmapLinearFilter",()=>1008,"LinearMipmapNearestFilter",()=>1007,"LinearSRGBColorSpace",()=>$,"LinearToneMapping",()=>1,"LinearTransfer",()=>ee,"Loader",()=>sd,"LoaderUtils",()=>sH,"LoadingManager",()=>sc,"LoopOnce",()=>2200,"LoopPingPong",()=>2202,"LoopRepeat",()=>2201,"MOUSE",()=>Q,"Material",()=>t9,"MaterialLoader",()=>sG,"MathUtils",()=>eg,"Matrix2",()=>oO,"Matrix3",()=>eS,"Matrix4",()=>tp,"MaxEquation",()=>104,"Mesh",()=>rU,"MeshBasicMaterial",()=>re,"MeshDepthMaterial",()=>aK,"MeshDistanceMaterial",()=>aZ,"MeshLambertMaterial",()=>aY,"MeshMatcapMaterial",()=>aJ,"MeshNormalMaterial",()=>aQ,"MeshPhongMaterial",()=>aW,"MeshPhysicalMaterial",()=>aj,"MeshStandardMaterial",()=>aH,"MeshToonMaterial",()=>aX,"MinEquation",()=>103,"MirroredRepeatWrapping",()=>1002,"MixOperation",()=>1,"MultiplyBlending",()=>4,"MultiplyOperation",()=>0,"NearestFilter",()=>1003,"NearestMipMapLinearFilter",()=>1005,"NearestMipMapNearestFilter",()=>1004,"NearestMipmapLinearFilter",()=>1005,"NearestMipmapNearestFilter",()=>1004,"NeutralToneMapping",()=>7,"NeverCompare",()=>512,"NeverDepth",()=>0,"NeverStencilFunc",()=>512,"NoBlending",()=>0,"NoColorSpace",()=>"","NoToneMapping",()=>0,"NormalAnimationBlendMode",()=>2500,"NormalBlending",()=>1,"NotEqualCompare",()=>517,"NotEqualDepth",()=>7,"NotEqualStencilFunc",()=>517,"NumberKeyframeTrack",()=>sn,"Object3D",()=>tV,"ObjectLoader",()=>sX,"ObjectSpaceNormalMap",()=>1,"OctahedronGeometry",()=>aN,"OneFactor",()=>201,"OneMinusConstantAlphaFactor",()=>214,"OneMinusConstantColorFactor",()=>212,"OneMinusDstAlphaFactor",()=>207,"OneMinusDstColorFactor",()=>209,"OneMinusSrcAlphaFactor",()=>205,"OneMinusSrcColorFactor",()=>203,"OrthographicCamera",()=>sF,"PCFShadowMap",()=>1,"PCFSoftShadowMap",()=>2,"PMREMGenerator",()=>lq,"Path",()=>ai,"PerspectiveCamera",()=>rY,"Plane",()=>nG,"PlaneGeometry",()=>aP,"PlaneHelper",()=>lu,"PointLight",()=>sB,"PointLightHelper",()=>o1,"Points",()=>iw,"PointsMaterial",()=>ix,"PolarGridHelper",()=>o7,"PolyhedronGeometry",()=>iz,"PositionalAudio",()=>ol,"PropertyBinding",()=>ov,"PropertyMixer",()=>oc,"QuadraticBezierCurve",()=>i9,"QuadraticBezierCurve3",()=>ae,"Quaternion",()=>ev,"QuaternionKeyframeTrack",()=>sa,"QuaternionLinearInterpolant",()=>si,"RED_GREEN_RGTC2_Format",()=>36285,"RED_RGTC1_Format",()=>36283,"REVISION",()=>"180","RGBADepthPacking",()=>3201,"RGBAFormat",()=>1023,"RGBAIntegerFormat",()=>1033,"RGBA_ASTC_10x10_Format",()=>37819,"RGBA_ASTC_10x5_Format",()=>37816,"RGBA_ASTC_10x6_Format",()=>37817,"RGBA_ASTC_10x8_Format",()=>37818,"RGBA_ASTC_12x10_Format",()=>37820,"RGBA_ASTC_12x12_Format",()=>37821,"RGBA_ASTC_4x4_Format",()=>37808,"RGBA_ASTC_5x4_Format",()=>37809,"RGBA_ASTC_5x5_Format",()=>37810,"RGBA_ASTC_6x5_Format",()=>37811,"RGBA_ASTC_6x6_Format",()=>37812,"RGBA_ASTC_8x5_Format",()=>37813,"RGBA_ASTC_8x6_Format",()=>37814,"RGBA_ASTC_8x8_Format",()=>37815,"RGBA_BPTC_Format",()=>36492,"RGBA_ETC2_EAC_Format",()=>37496,"RGBA_PVRTC_2BPPV1_Format",()=>35843,"RGBA_PVRTC_4BPPV1_Format",()=>35842,"RGBA_S3TC_DXT1_Format",()=>33777,"RGBA_S3TC_DXT3_Format",()=>33778,"RGBA_S3TC_DXT5_Format",()=>33779,"RGBDepthPacking",()=>3202,"RGBFormat",()=>1022,"RGBIntegerFormat",()=>1032,"RGB_BPTC_SIGNED_Format",()=>36494,"RGB_BPTC_UNSIGNED_Format",()=>36495,"RGB_ETC1_Format",()=>36196,"RGB_ETC2_Format",()=>37492,"RGB_PVRTC_2BPPV1_Format",()=>35841,"RGB_PVRTC_4BPPV1_Format",()=>35840,"RGB_S3TC_DXT1_Format",()=>33776,"RGDepthPacking",()=>3203,"RGFormat",()=>1030,"RGIntegerFormat",()=>1031,"RawShaderMaterial",()=>aG,"Ray",()=>tA,"Raycaster",()=>oP,"RectAreaLight",()=>sz,"RedFormat",()=>1028,"RedIntegerFormat",()=>1029,"ReinhardToneMapping",()=>2,"RenderTarget",()=>ej,"RenderTarget3D",()=>oT,"RepeatWrapping",()=>1e3,"ReplaceStencilOp",()=>7681,"ReverseSubtractEquation",()=>102,"RingGeometry",()=>aI,"SIGNED_RED_GREEN_RGTC2_Format",()=>36286,"SIGNED_RED_RGTC1_Format",()=>36284,"SRGBColorSpace",()=>J,"SRGBTransfer",()=>et,"Scene",()=>r4,"ShaderChunk",()=>lv,"ShaderLib",()=>l_,"ShaderMaterial",()=>rH,"ShadowMaterial",()=>aq,"Shape",()=>aa,"ShapeGeometry",()=>aL,"ShapePath",()=>lA,"ShapeUtils",()=>aS,"ShortType",()=>1011,"Skeleton",()=>nN,"SkeletonHelper",()=>o0,"SkinnedMesh",()=>nw,"Source",()=>ek,"Sphere",()=>ta,"SphereGeometry",()=>aD,"Spherical",()=>oF,"SphericalHarmonics3",()=>sV,"SplineCurve",()=>at,"SpotLight",()=>sN,"SpotLightHelper",()=>oK,"Sprite",()=>nh,"SpriteMaterial",()=>r8,"SrcAlphaFactor",()=>204,"SrcAlphaSaturateFactor",()=>210,"SrcColorFactor",()=>202,"StaticCopyUsage",()=>35046,"StaticDrawUsage",()=>35044,"StaticReadUsage",()=>35045,"StereoCamera",()=>s4,"StreamCopyUsage",()=>35042,"StreamDrawUsage",()=>35040,"StreamReadUsage",()=>35041,"StringKeyframeTrack",()=>ss,"SubtractEquation",()=>101,"SubtractiveBlending",()=>3,"TOUCH",()=>Y,"TangentSpaceNormalMap",()=>0,"TetrahedronGeometry",()=>aB,"Texture",()=>eG,"TextureLoader",()=>sb,"TextureUtils",()=>lm,"Timer",()=>oD,"TimestampQuery",()=>en,"TorusGeometry",()=>aF,"TorusKnotGeometry",()=>aU,"Triangle",()=>t1,"TriangleFanDrawMode",()=>2,"TriangleStripDrawMode",()=>1,"TrianglesDrawMode",()=>0,"TubeGeometry",()=>aO,"UVMapping",()=>300,"Uint16BufferAttribute",()=>rA,"Uint32BufferAttribute",()=>rf,"Uint8BufferAttribute",()=>rc,"Uint8ClampedBufferAttribute",()=>rh,"Uniform",()=>ow,"UniformsGroup",()=>oE,"UniformsLib",()=>lx,"UniformsUtils",()=>rG,"UnsignedByteType",()=>1009,"UnsignedInt101111Type",()=>35899,"UnsignedInt248Type",()=>1020,"UnsignedInt5999Type",()=>35902,"UnsignedIntType",()=>1014,"UnsignedShort4444Type",()=>1017,"UnsignedShort5551Type",()=>1018,"UnsignedShortType",()=>1012,"VSMShadowMap",()=>3,"Vector2",()=>ey,"Vector3",()=>ex,"Vector4",()=>eH,"VectorKeyframeTrack",()=>so,"VideoFrameTexture",()=>iR,"VideoTexture",()=>iE,"WebGL3DRenderTarget",()=>eK,"WebGLArrayRenderTarget",()=>eQ,"WebGLCoordinateSystem",()=>2e3,"WebGLCubeRenderTarget",()=>rJ,"WebGLRenderTarget",()=>eW,"WebGLRenderer",()=>cR,"WebGLUtils",()=>c_,"WebGPUCoordinateSystem",()=>2001,"WebXRController",()=>r1,"WireframeGeometry",()=>ak,"WrapAroundEnding",()=>2402,"ZeroCurvatureEnding",()=>2400,"ZeroFactor",()=>200,"ZeroSlopeEnding",()=>2401,"ZeroStencilOp",()=>0,"createCanvasElement",()=>eC],32009),e.i(8560);var QY=e.i(32009);function QK(e,t){let r;return function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];window.clearTimeout(r),r=window.setTimeout(()=>e(...i),t)}}let QZ=["x","y","top","bottom","left","right","width","height"];function QJ(e){let{ref:t,children:r,fallback:n,resize:i,style:a,gl:s,events:o=QQ,eventSource:l,eventPrefix:u,shadows:c,linear:h,flat:d,legacy:A,orthographic:p,frameloop:f,dpr:m,performance:g,raycaster:y,camera:v,scene:x,onPointerMissed:_,onCreated:b,...S}=e;X.useMemo(()=>Qv(QY),[]);let T=function(){let e=Xj(),t=function(){let e=function(){let e=Xj(),[t]=Xz.useState(()=>new Map);t.clear();let r=e;for(;r;){let e=r.type;XX(e)&&e!==XG&&!t.has(e)&&t.set(e,Xz.use(Xq(e))),r=r.return}return t}();return Xz.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>Xz.createElement(t,null,Xz.createElement(r.Provider,{...n,value:e.get(r)})),e=>Xz.createElement(XH,{...e})),[e])}();return XR.useMemo(()=>r=>{let{children:n}=r,i=XV(e,!0,e=>e.type===XR.StrictMode)?XR.StrictMode:XR.Fragment;return(0,W.jsx)(i,{children:(0,W.jsx)(t,{children:n})})},[e,t])}(),[w,M]=function(){var e,t,r;let{debounce:n,scroll:i,polyfill:a,offsetSize:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1,offsetSize:!1},o=a||("undefined"==typeof window?class{}:window.ResizeObserver);if(!o)throw Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[l,u]=(0,X.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=(0,X.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l,orientationHandler:null}),h=n?"number"==typeof n?n:n.scroll:null,d=n?"number"==typeof n?n:n.resize:null,A=(0,X.useRef)(!1);(0,X.useEffect)(()=>(A.current=!0,()=>void(A.current=!1)));let[p,f,m]=(0,X.useMemo)(()=>{let e=()=>{let e,t;if(!c.current.element)return;let{left:r,top:n,width:i,height:a,bottom:o,right:l,x:h,y:d}=c.current.element.getBoundingClientRect(),p={left:r,top:n,width:i,height:a,bottom:o,right:l,x:h,y:d};c.current.element instanceof HTMLElement&&s&&(p.height=c.current.element.offsetHeight,p.width=c.current.element.offsetWidth),Object.freeze(p),A.current&&(e=c.current.lastBounds,t=p,!QZ.every(r=>e[r]===t[r]))&&u(c.current.lastBounds=p)};return[e,d?QK(e,d):e,h?QK(e,h):e]},[u,s,h,d]);function g(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",m,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function y(){c.current.element&&(c.current.resizeObserver=new o(m),c.current.resizeObserver.observe(c.current.element),i&&c.current.scrollContainers&&c.current.scrollContainers.forEach(e=>e.addEventListener("scroll",m,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}return e=m,t=!!i,(0,X.useEffect)(()=>{if(t)return window.addEventListener("scroll",e,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",e,!0)},[e,t]),r=f,(0,X.useEffect)(()=>(window.addEventListener("resize",r),()=>void window.removeEventListener("resize",r)),[r]),(0,X.useEffect)(()=>{g(),y()},[i,m,f]),(0,X.useEffect)(()=>g,[]),[e=>{e&&e!==c.current.element&&(g(),c.current.element=e,c.current.scrollContainers=function e(t){let r=[];if(!t||t===document.body)return r;let{overflow:n,overflowX:i,overflowY:a}=window.getComputedStyle(t);return[n,i,a].some(e=>"auto"===e||"scroll"===e)&&r.push(t),[...r,...e(t.parentElement)]}(e),y())},l,p]}({scroll:!0,debounce:{scroll:50,resize:0},...i}),E=X.useRef(null),R=X.useRef(null);X.useImperativeHandle(t,()=>E.current);let C=XZ(_),[N,P]=X.useState(!1),[I,L]=X.useState(!1);if(N)throw N;if(I)throw I;let D=X.useRef(null);XK(()=>{let e=E.current;M.width>0&&M.height>0&&e&&(D.current||(D.current=function(e){let t,r,n=QI.get(e),i=null==n?void 0:n.fiber,a=null==n?void 0:n.store;n&&console.warn("R3F.createRoot should only be called once!");let s="function"==typeof reportError?reportError:console.error,o=a||((e,t)=>{let r,n,i=(r=(r,n)=>{let i,a=new ex,s=new ex,o=new ex;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n().size,{width:i,height:l,top:u,left:c}=r,h=i/l;t.isVector3?o.copy(t):o.set(...t);let d=e.getWorldPosition(a).distanceTo(o);if(e&&e.isOrthographicCamera)return{width:i/e.zoom,height:l/e.zoom,top:u,left:c,factor:1,distance:d,aspect:h};{let t=2*Math.tan(e.fov*Math.PI/180/2)*d,r=i/l*t;return{width:r,height:t,top:u,left:c,factor:i/r,distance:d,aspect:h}}}let u=e=>r(t=>({performance:{...t.performance,current:e}})),c=new ey;return{set:r,get:n,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(n(),t)},advance:(e,r)=>t(e,r,n()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new s6,pointer:c,mouse:c,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let e=n();i&&clearTimeout(i),e.performance.current!==e.performance.min&&u(e.performance.min),i=setTimeout(()=>u(n().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>r(t=>({...t,events:{...t.events,...e}})),setSize:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=n().camera,u={width:e,height:t,top:i,left:a};r(e=>({size:u,viewport:{...e.viewport,...l(o,s,u)}}))},setDpr:e=>r(t=>{let r=X0(e);return{viewport:{...t.viewport,dpr:r,initialDpr:t.viewport.initialDpr||r}}}),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always",t=n().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),r(()=>({frameloop:e}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:XR.createRef(),active:!1,frames:0,priority:0,subscribe:(e,t,r)=>{let i=n().internal;return i.priority=i.priority+ +(t>0),i.subscribers.push({ref:e,priority:t,store:r}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{let r=n().internal;null!=r&&r.subscribers&&(r.priority=r.priority-(t>0),r.subscribers=r.subscribers.filter(t=>t.ref!==e))}}}}})?XD(r,n):XD,a=i.getState(),s=a.size,o=a.viewport.dpr,l=a.camera;return i.subscribe(()=>{let{camera:e,size:t,viewport:r,gl:n,set:a}=i.getState();if(t.width!==s.width||t.height!==s.height||r.dpr!==o){s=t,o=r.dpr,function(e,t){!e.manual&&(e&&e.isOrthographicCamera?(e.left=-(t.width/2),e.right=t.width/2,e.top=t.height/2,e.bottom=-(t.height/2)):e.aspect=t.width/t.height,e.updateProjectionMatrix())}(e,t),r.dpr>0&&n.setPixelRatio(r.dpr);let i="undefined"!=typeof HTMLCanvasElement&&n.domElement instanceof HTMLCanvasElement;n.setSize(t.width,t.height,i)}e!==l&&(l=e,a(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),i.subscribe(t=>e(t)),i})(Qj,QW),l=i||QP.createContainer(o,XC.ConcurrentRoot,null,!1,null,"",s,s,s,null);n||QI.set(e,{fiber:l,store:o});let u=!1,c=null;return{async configure(){var n,i;let a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c=new Promise(e=>a=e);let{gl:l,size:h,scene:d,events:A,onCreated:p,shadows:f=!1,linear:m=!1,flat:g=!1,legacy:y=!1,orthographic:v=!1,frameloop:x="always",dpr:_=[1,2],performance:b,raycaster:S,camera:T,onPointerMissed:w}=s,M=o.getState(),E=M.gl;if(!M.gl){let t={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},r="function"==typeof l?await l(t):l;E=Ql(r)?r:new cR({...t,...l}),M.set({gl:E})}let R=M.raycaster;R||M.set({raycaster:R=new oP});let{params:C,...N}=S||{};if(X2.equ(N,R,QL)||Qn(R,{...N}),X2.equ(C,R.params,QL)||Qn(R,{params:{...R.params,...C}}),!M.camera||M.camera===r&&!X2.equ(r,T,QL)){r=T;let e=null==T?void 0:T.isCamera,t=e?T:v?new sF(0,0,0,0,.1,1e3):new rY(75,0,.1,1e3);!e&&(t.position.z=5,T&&(Qn(t,T),!t.manual&&("aspect"in T||"left"in T||"right"in T||"bottom"in T||"top"in T)&&(t.manual=!0,t.updateProjectionMatrix())),M.camera||null!=T&&T.rotation||t.lookAt(0,0,0)),M.set({camera:t}),R.camera=t}if(!M.scene){let e;null!=d&&d.isScene?X4(e=d,o,"",{}):(X4(e=new r4,o,"",{}),d&&Qn(e,d)),M.set({scene:e})}A&&!M.events.handlers&&M.set({events:A(o)});let P=function(e,t){if(!t&&"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){let{width:t,height:r,top:n,left:i}=e.parentElement.getBoundingClientRect();return{width:t,height:r,top:n,left:i}}return!t&&"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0,...t}}(e,h);if(X2.equ(P,M.size,QL)||M.setSize(P.width,P.height,P.top,P.left),_&&M.viewport.dpr!==X0(_)&&M.setDpr(_),M.frameloop!==x&&M.setFrameloop(x),M.onPointerMissed||M.set({onPointerMissed:w}),b&&!X2.equ(b,M.performance,QL)&&M.set(e=>({performance:{...e.performance,...b}})),!M.xr){let e=(e,t)=>{let r=o.getState();"never"!==r.frameloop&&QW(e,!0,r,t)},t=()=>{let t=o.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||Qj(t)},r={connect(){let e=o.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){let e=o.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(n=E.xr)?void 0:n.addEventListener)&&r.connect(),M.set({xr:r})}if(E.shadowMap){let e=E.shadowMap.enabled,t=E.shadowMap.type;E.shadowMap.enabled=!!f,X2.boo(f)?E.shadowMap.type=2:X2.str(f)?E.shadowMap.type=null!=(i=({basic:0,percentage:1,soft:2,variance:3})[f])?i:2:X2.obj(f)&&Object.assign(E.shadowMap,f),(e!==E.shadowMap.enabled||t!==E.shadowMap.type)&&(E.shadowMap.needsUpdate=!0)}return eD.enabled=!y,u||(E.outputColorSpace=m?$:J,E.toneMapping=4*!g),M.legacy!==y&&M.set(()=>({legacy:y})),M.linear!==m&&M.set(()=>({linear:m})),M.flat!==g&&M.set(()=>({flat:g})),!l||X2.fun(l)||Ql(l)||X2.equ(l,E,QL)||Qn(E,l),t=p,u=!0,a(),this},render(r){return u||c||this.configure(),c.then(()=>{QP.updateContainer((0,W.jsx)(QD,{store:o,children:r,onCreated:t,rootElement:e}),l,null,()=>void 0)}),o},unmount(){QB(e)}}}(e)),async function(){await D.current.configure({gl:s,scene:x,events:o,shadows:c,linear:h,flat:d,legacy:A,orthographic:p,frameloop:f,dpr:m,performance:g,raycaster:y,camera:v,size:M,onPointerMissed:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==C.current?void 0:C.current(...t)},onCreated:e=>{null==e.events.connect||e.events.connect(l?l&&l.hasOwnProperty("current")?l.current:l:R.current),u&&e.setEvents({compute:(e,t)=>{let r=e[u+"X"],n=e[u+"Y"];t.pointer.set(r/t.size.width*2-1,-(2*(n/t.size.height))+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==b||b(e)}}),D.current.render((0,W.jsx)(T,{children:(0,W.jsx)(X$,{set:L,children:(0,W.jsx)(X.Suspense,{fallback:(0,W.jsx)(XJ,{set:P}),children:null!=r?r:null})})}))}())}),X.useEffect(()=>{let e=E.current;if(e)return()=>QB(e)},[]);let B=l?"none":"auto";return(0,W.jsx)("div",{ref:R,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:B,...a},...S,children:(0,W.jsx)("div",{ref:w,style:{width:"100%",height:"100%"},children:(0,W.jsx)("canvas",{ref:E,style:{display:"block"},children:n})})})}function Q$(e){return(0,W.jsx)(XH,{children:(0,W.jsx)(QJ,{...e})})}function Q0(){return(Q0=Object.assign.bind()).apply(null,arguments)}var Q1=Object.defineProperty;class Q2{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e);e.target=null}}constructor(){((e,t,r)=>((e,t,r)=>t in e?Q1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r))(this,"_listeners")}}var Q3=Object.defineProperty,Q4=(e,t,r)=>(((e,t,r)=>t in e?Q3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),r);let Q5=new tA,Q6=new nG,Q7=Math.cos(Math.PI/180*70),Q8=(e,t)=>(e%t+t)%t;class Q9 extends Q2{constructor(e,t){super(),Q4(this,"object"),Q4(this,"domElement"),Q4(this,"enabled",!0),Q4(this,"target",new ex),Q4(this,"minDistance",0),Q4(this,"maxDistance",1/0),Q4(this,"minZoom",0),Q4(this,"maxZoom",1/0),Q4(this,"minPolarAngle",0),Q4(this,"maxPolarAngle",Math.PI),Q4(this,"minAzimuthAngle",-1/0),Q4(this,"maxAzimuthAngle",1/0),Q4(this,"enableDamping",!1),Q4(this,"dampingFactor",.05),Q4(this,"enableZoom",!0),Q4(this,"zoomSpeed",1),Q4(this,"enableRotate",!0),Q4(this,"rotateSpeed",1),Q4(this,"enablePan",!0),Q4(this,"panSpeed",1),Q4(this,"screenSpacePanning",!0),Q4(this,"keyPanSpeed",7),Q4(this,"zoomToCursor",!1),Q4(this,"autoRotate",!1),Q4(this,"autoRotateSpeed",2),Q4(this,"reverseOrbit",!1),Q4(this,"reverseHorizontalOrbit",!1),Q4(this,"reverseVerticalOrbit",!1),Q4(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Q4(this,"mouseButtons",{LEFT:Q.ROTATE,MIDDLE:Q.DOLLY,RIGHT:Q.PAN}),Q4(this,"touches",{ONE:Y.ROTATE,TWO:Y.DOLLY_PAN}),Q4(this,"target0"),Q4(this,"position0"),Q4(this,"zoom0"),Q4(this,"_domElementKeyEvents",null),Q4(this,"getPolarAngle"),Q4(this,"getAzimuthalAngle"),Q4(this,"setPolarAngle"),Q4(this,"setAzimuthalAngle"),Q4(this,"getDistance"),Q4(this,"getZoomScale"),Q4(this,"listenToKeyEvents"),Q4(this,"stopListenToKeyEvents"),Q4(this,"saveState"),Q4(this,"reset"),Q4(this,"update"),Q4(this,"connect"),Q4(this,"dispose"),Q4(this,"dollyIn"),Q4(this,"dollyOut"),Q4(this,"getScale"),Q4(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=e=>{let t=Q8(e,2*Math.PI),n=u.phi;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-n);2*Math.PI-i<i&&(t<n?t+=2*Math.PI:n+=2*Math.PI),c.phi=t-n,r.update()},this.setAzimuthalAngle=e=>{let t=Q8(e,2*Math.PI),n=u.theta;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-n);2*Math.PI-i<i&&(t<n?t+=2*Math.PI:n+=2*Math.PI),c.theta=t-n,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",K),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",K),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),o=s.NONE},this.update=(()=>{let t=new ex,i=new ex(0,1,0),a=new ev().setFromUnitVectors(e.up,i),A=a.clone().invert(),p=new ex,f=new ev,m=2*Math.PI;return function(){let g=r.object.position;a.setFromUnitVectors(e.up,i),A.copy(a).invert(),t.copy(g).sub(r.target),t.applyQuaternion(a),u.setFromVector3(t),r.autoRotate&&o===s.NONE&&R(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(u.theta+=c.theta*r.dampingFactor,u.phi+=c.phi*r.dampingFactor):(u.theta+=c.theta,u.phi+=c.phi);let y=r.minAzimuthAngle,v=r.maxAzimuthAngle;isFinite(y)&&isFinite(v)&&(y<-Math.PI?y+=m:y>Math.PI&&(y-=m),v<-Math.PI?v+=m:v>Math.PI&&(v-=m),y<=v?u.theta=Math.max(y,Math.min(v,u.theta)):u.theta=u.theta>(y+v)/2?Math.max(y,u.theta):Math.min(v,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(d,r.dampingFactor):r.target.add(d),r.zoomToCursor&&T||r.object.isOrthographicCamera?u.radius=B(u.radius):u.radius=B(u.radius*h),t.setFromSpherical(u),t.applyQuaternion(A),g.copy(r.target).add(t),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),!0===r.enableDamping?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,d.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),d.set(0,0,0));let x=!1;if(r.zoomToCursor&&T){let n=null;if(r.object instanceof rY&&r.object.isPerspectiveCamera){let e=t.length();n=B(e*h);let i=e-n;r.object.position.addScaledVector(b,i),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){let e=new ex(S.x,S.y,0);e.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix(),x=!0;let i=new ex(S.x,S.y,0);i.unproject(r.object),r.object.position.sub(i).add(e),r.object.updateMatrixWorld(),n=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==n&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(n).add(r.object.position):(Q5.origin.copy(r.object.position),Q5.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(Q5.direction))<Q7?e.lookAt(r.target):(Q6.setFromNormalAndCoplanarPoint(r.object.up,r.target),Q5.intersectPlane(Q6,r.target))))}else r.object instanceof sF&&r.object.isOrthographicCamera&&(x=1!==h)&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix());return h=1,T=!1,!!(x||p.distanceToSquared(r.object.position)>l||8*(1-f.dot(r.object.quaternion))>l)&&(r.dispatchEvent(n),p.copy(r.object.position),f.copy(r.object.quaternion),x=!1,!0)}})(),this.connect=e=>{r.domElement=e,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",Z),r.domElement.addEventListener("pointerdown",H),r.domElement.addEventListener("pointercancel",W),r.domElement.addEventListener("wheel",X)},this.dispose=()=>{var e,t,n,i,a,s;r.domElement&&(r.domElement.style.touchAction="auto"),null==(e=r.domElement)||e.removeEventListener("contextmenu",Z),null==(t=r.domElement)||t.removeEventListener("pointerdown",H),null==(n=r.domElement)||n.removeEventListener("pointercancel",W),null==(i=r.domElement)||i.removeEventListener("wheel",X),null==(a=r.domElement)||a.ownerDocument.removeEventListener("pointermove",j),null==(s=r.domElement)||s.ownerDocument.removeEventListener("pointerup",W),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",K)};let r=this,n={type:"change"},i={type:"start"},a={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},o=s.NONE,l=1e-6,u=new oF,c=new oF,h=1,d=new ex,A=new ey,p=new ey,f=new ey,m=new ey,g=new ey,y=new ey,v=new ey,x=new ey,_=new ey,b=new ex,S=new ey,T=!1,w=[],M={};function E(){return Math.pow(.95,r.zoomSpeed)}function R(e){r.reverseOrbit||r.reverseHorizontalOrbit?c.theta+=e:c.theta-=e}function C(e){r.reverseOrbit||r.reverseVerticalOrbit?c.phi+=e:c.phi-=e}let N=(()=>{let e=new ex;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),d.add(e)}})(),P=(()=>{let e=new ex;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),d.add(e)}})(),I=(()=>{let e=new ex;return function(t,n){let i=r.domElement;if(i&&r.object instanceof rY&&r.object.isPerspectiveCamera){let a=r.object.position;e.copy(a).sub(r.target);let s=e.length();N(2*t*(s*=Math.tan(r.object.fov/2*Math.PI/180))/i.clientHeight,r.object.matrix),P(2*n*s/i.clientHeight,r.object.matrix)}else i&&r.object instanceof sF&&r.object.isOrthographicCamera?(N(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),P(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function L(e){r.object instanceof rY&&r.object.isPerspectiveCamera||r.object instanceof sF&&r.object.isOrthographicCamera?h=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function D(e){if(!r.zoomToCursor||!r.domElement)return;T=!0;let t=r.domElement.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,a=t.width,s=t.height;S.x=n/a*2-1,S.y=-(i/s*2)+1,b.set(S.x,S.y,1).unproject(r.object).sub(r.object.position).normalize()}function B(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function F(e){A.set(e.clientX,e.clientY)}function U(e){m.set(e.clientX,e.clientY)}function O(){if(1==w.length)A.set(w[0].pageX,w[0].pageY);else{let e=.5*(w[0].pageX+w[1].pageX),t=.5*(w[0].pageY+w[1].pageY);A.set(e,t)}}function k(){if(1==w.length)m.set(w[0].pageX,w[0].pageY);else{let e=.5*(w[0].pageX+w[1].pageX),t=.5*(w[0].pageY+w[1].pageY);m.set(e,t)}}function z(){let e=w[0].pageX-w[1].pageX,t=w[0].pageY-w[1].pageY,r=Math.sqrt(e*e+t*t);v.set(0,r)}function V(e){if(1==w.length)p.set(e.pageX,e.pageY);else{let t=$(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);p.set(r,n)}f.subVectors(p,A).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(R(2*Math.PI*f.x/t.clientHeight),C(2*Math.PI*f.y/t.clientHeight)),A.copy(p)}function q(e){if(1==w.length)g.set(e.pageX,e.pageY);else{let t=$(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);g.set(r,n)}y.subVectors(g,m).multiplyScalar(r.panSpeed),I(y.x,y.y),m.copy(g)}function G(e){var t;let n=$(e),i=e.pageX-n.x,a=e.pageY-n.y,s=Math.sqrt(i*i+a*a);x.set(0,s),_.set(0,Math.pow(x.y/v.y,r.zoomSpeed)),t=_.y,L(h/t),v.copy(x)}function H(e){var t,n,a;!1!==r.enabled&&(0===w.length&&(null==(t=r.domElement)||t.ownerDocument.addEventListener("pointermove",j),null==(n=r.domElement)||n.ownerDocument.addEventListener("pointerup",W)),a=e,w.push(a),"touch"===e.pointerType?function(e){switch(J(e),w.length){case 1:switch(r.touches.ONE){case Y.ROTATE:if(!1===r.enableRotate)return;O(),o=s.TOUCH_ROTATE;break;case Y.PAN:if(!1===r.enablePan)return;k(),o=s.TOUCH_PAN;break;default:o=s.NONE}break;case 2:switch(r.touches.TWO){case Y.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&z(),r.enablePan&&k(),o=s.TOUCH_DOLLY_PAN;break;case Y.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&z(),r.enableRotate&&O(),o=s.TOUCH_DOLLY_ROTATE;break;default:o=s.NONE}break;default:o=s.NONE}o!==s.NONE&&r.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Q.DOLLY:if(!1===r.enableZoom)return;D(e),v.set(e.clientX,e.clientY),o=s.DOLLY;break;case Q.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;U(e),o=s.PAN}else{if(!1===r.enableRotate)return;F(e),o=s.ROTATE}break;case Q.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;F(e),o=s.ROTATE}else{if(!1===r.enablePan)return;U(e),o=s.PAN}break;default:o=s.NONE}o!==s.NONE&&r.dispatchEvent(i)}(e))}function j(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(J(e),o){case s.TOUCH_ROTATE:if(!1===r.enableRotate)return;V(e),r.update();break;case s.TOUCH_PAN:if(!1===r.enablePan)return;q(e),r.update();break;case s.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&G(e),r.enablePan&&q(e),r.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&G(e),r.enableRotate&&V(e),r.update();break;default:o=s.NONE}}(e):function(e){if(!1!==r.enabled)switch(o){case s.ROTATE:if(!1===r.enableRotate)return;p.set(e.clientX,e.clientY),f.subVectors(p,A).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(R(2*Math.PI*f.x/t.clientHeight),C(2*Math.PI*f.y/t.clientHeight)),A.copy(p),r.update();break;case s.DOLLY:var n,i;if(!1===r.enableZoom)return;(x.set(e.clientX,e.clientY),_.subVectors(x,v),_.y>0)?(n=E(),L(h/n)):_.y<0&&(i=E(),L(h*i)),v.copy(x),r.update();break;case s.PAN:if(!1===r.enablePan)return;g.set(e.clientX,e.clientY),y.subVectors(g,m).multiplyScalar(r.panSpeed),I(y.x,y.y),m.copy(g),r.update()}}(e))}function W(e){var t,n,i;(function(e){delete M[e.pointerId];for(let t=0;t<w.length;t++)if(w[t].pointerId==e.pointerId)return void w.splice(t,1)})(e),0===w.length&&(null==(t=r.domElement)||t.releasePointerCapture(e.pointerId),null==(n=r.domElement)||n.ownerDocument.removeEventListener("pointermove",j),null==(i=r.domElement)||i.ownerDocument.removeEventListener("pointerup",W)),r.dispatchEvent(a),o=s.NONE}function X(e){if(!1!==r.enabled&&!1!==r.enableZoom&&(o===s.NONE||o===s.ROTATE)){var t,n;e.preventDefault(),r.dispatchEvent(i),(D(e),e.deltaY<0)?(t=E(),L(h*t)):e.deltaY>0&&(n=E(),L(h/n)),r.update(),r.dispatchEvent(a)}}function K(e){if(!1!==r.enabled&&!1!==r.enablePan){let t=!1;switch(e.code){case r.keys.UP:I(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:I(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:I(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:I(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}}function Z(e){!1!==r.enabled&&e.preventDefault()}function J(e){let t=M[e.pointerId];void 0===t&&(t=new ey,M[e.pointerId]=t),t.set(e.pageX,e.pageY)}function $(e){return M[(e.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}this.dollyIn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E();L(h*e),r.update()},this.dollyOut=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E();L(h/e),r.update()},this.getScale=()=>h,this.setScale=e=>{L(e),r.update()},this.getZoomScale=()=>E(),void 0!==t&&this.connect(t),this.update()}}let Ye=X.forwardRef((e,t)=>{let{makeDefault:r,camera:n,regress:i,domElement:a,enableDamping:s=!0,keyEvents:o=!1,onChange:l,onStart:u,onEnd:c,...h}=e,d=Qh(e=>e.invalidate),A=Qh(e=>e.camera),p=Qh(e=>e.gl),f=Qh(e=>e.events),m=Qh(e=>e.setEvents),g=Qh(e=>e.set),y=Qh(e=>e.get),v=Qh(e=>e.performance),x=n||A,_=a||f.connected||p.domElement,b=X.useMemo(()=>new Q9(x),[x]);return!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Qc(),n=r.getState().internal.subscribe,i=XZ(e);XK(()=>n(i,t,r),[t,n,r])}(()=>{b.enabled&&b.update()},-1),X.useEffect(()=>(o&&b.connect(!0===o?_:o),b.connect(_),()=>void b.dispose()),[o,_,i,b,d]),X.useEffect(()=>{let e=e=>{d(),i&&v.regress(),l&&l(e)},t=e=>{u&&u(e)},r=e=>{c&&c(e)};return b.addEventListener("change",e),b.addEventListener("start",t),b.addEventListener("end",r),()=>{b.removeEventListener("start",t),b.removeEventListener("end",r),b.removeEventListener("change",e)}},[l,u,c,b,d,m]),X.useEffect(()=>{if(r){let e=y().controls;return g({controls:b}),()=>g({controls:e})}},[r,b]),X.createElement("primitive",Q0({ref:t,object:b,enableDamping:s},h))});var Yt=e.i(83958);function Yr(e){let{globeConfig:t,data:r}=e,n=(0,X.useRef)(null),i=(0,X.useRef)(),[a,s]=(0,X.useState)(!1),o={pointSize:1,atmosphereColor:"#ffffff",showAtmosphere:!0,atmosphereAltitude:.1,polygonColor:"rgba(255,255,255,0.7)",globeColor:"#1d072e",emissive:"#000000",emissiveIntensity:.1,shininess:.9,arcTime:2e3,arcLength:.9,rings:1,maxRings:3,...t};return(0,X.useEffect)(()=>{!n.current&&i.current&&(n.current=new XE,i.current.add(n.current),s(!0))},[]),(0,X.useEffect)(()=>{if(!n.current||!a)return;let e=n.current.globeMaterial();e.color=new t6(t.globeColor),e.emissive=new t6(t.emissive),e.emissiveIntensity=t.emissiveIntensity||.1,e.shininess=t.shininess||.9},[a,t.globeColor,t.emissive,t.emissiveIntensity,t.shininess]),(0,X.useEffect)(()=>{if(!n.current||!a||!r)return;let e=[];for(let t=0;t<r.length;t++){let n=r[t];Ya(n.color),e.push({size:o.pointSize,order:n.order,color:n.color,lat:n.startLat,lng:n.startLng}),e.push({size:o.pointSize,order:n.order,color:n.color,lat:n.endLat,lng:n.endLng})}let t=e.filter((e,t,r)=>r.findIndex(t=>["lat","lng"].every(r=>t[r]===e[r]))===t);n.current.hexPolygonsData(Yt.default.features).hexPolygonResolution(3).hexPolygonMargin(.7).showAtmosphere(o.showAtmosphere).atmosphereColor(o.atmosphereColor).atmosphereAltitude(o.atmosphereAltitude).hexPolygonColor(()=>o.polygonColor),n.current.arcsData(r).arcStartLat(e=>+e.startLat).arcStartLng(e=>+e.startLng).arcEndLat(e=>+e.endLat).arcEndLng(e=>+e.endLng).arcColor(e=>e.color).arcAltitude(e=>+e.arcAlt).arcStroke(()=>[.32,.28,.3][Math.round(2*Math.random())]).arcDashLength(o.arcLength).arcDashInitialGap(e=>+e.order).arcDashGap(15).arcDashAnimateTime(()=>o.arcTime),n.current.pointsData(t).pointColor(e=>e.color).pointsMerge(!0).pointAltitude(0).pointRadius(2),n.current.ringsData([]).ringColor(()=>o.polygonColor).ringMaxRadius(o.maxRings).ringPropagationSpeed(3).ringRepeatPeriod(o.arcTime*o.arcLength/o.rings)},[a,r,o.pointSize,o.showAtmosphere,o.atmosphereColor,o.atmosphereAltitude,o.polygonColor,o.arcLength,o.arcTime,o.rings,o.maxRings]),(0,X.useEffect)(()=>{if(!n.current||!a||!r)return;let e=setInterval(()=>{if(!n.current)return;let e=Ys(0,r.length,Math.floor(4*r.length/5)),t=r.filter((t,r)=>e.includes(r)).map(e=>({lat:e.startLat,lng:e.startLng,color:e.color}));n.current.ringsData(t)},2e3);return()=>{clearInterval(e)}},[a,r]),(0,W.jsx)("group",{ref:i})}function Yn(){let{gl:e,size:t}=Qh();return(0,X.useEffect)(()=>{e.setPixelRatio(window.devicePixelRatio),e.setSize(t.width,t.height),e.setClearColor(0xffaaff,0)},[]),null}function Yi(e){let{globeConfig:t}=e,r=new r4;return r.fog=new r3(0xffffff,400,2e3),(0,W.jsxs)(Q$,{scene:r,camera:new rY(50,1.2,180,1800),children:[(0,W.jsx)(Yn,{}),(0,W.jsx)("ambientLight",{color:t.ambientLight,intensity:.6}),(0,W.jsx)("directionalLight",{color:t.directionalLeftLight,position:new ex(-400,100,400)}),(0,W.jsx)("directionalLight",{color:t.directionalTopLight,position:new ex(-200,500,200)}),(0,W.jsx)("pointLight",{color:t.pointLight,position:new ex(-200,500,200),intensity:.8}),(0,W.jsx)(Yr,{...e}),(0,W.jsx)(Ye,{enablePan:!1,enableZoom:!1,minDistance:300,maxDistance:300,autoRotateSpeed:1,autoRotate:!0,minPolarAngle:Math.PI/3.5,maxPolarAngle:Math.PI-Math.PI/3})]})}function Ya(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,r,n){return t+t+r+r+n+n});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function Ys(e,t,r){let n=[];for(;n.length<r;){let r=Math.floor(Math.random()*(t-e))+e;-1===n.indexOf(r)&&n.push(r)}return n}Qv({ThreeGlobe:XE})},14722,e=>{e.n(e.i(56823))}]);